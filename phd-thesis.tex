\documentclass[a4paper, 12pt, reqno]{amsart}

\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{hyperref}
\usepackage[margin = 0.75in]{geometry}
\usepackage{enumitem}
\usepackage{tikz-cd}
\usepackage[nameinlink]{cleveref}
\usepackage{stmaryrd}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}

\crefformat{section}{\S#2#1#3}
\crefformat{subsection}{\S#2#1#3}

\numberwithin{equation}{subsection}

\setenumerate[0]{label = \normalfont(\roman*)}

\DeclareMathOperator{\Vir}{Vir}
\DeclareMathOperator{\Id}{Id}
\DeclareMathOperator{\gr}{gr}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\ch}{ch}
\DeclareMathOperator{\lm}{lm}
\DeclareMathOperator{\vspan}{span}
\DeclareMathOperator{\Ind}{Ind}
\DeclareMathOperator{\len}{len}
\DeclareMathOperator{\psn}{psn}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\Res}{Res}
\DeclareMathOperator{\vac}{|0\rangle}
\DeclareMathOperator{\vachalf}{|1/2\rangle}
\DeclareMathOperator{\vacsixteen}{|1/16\rangle}
\DeclareMathOperator{\zero}{\overline{0}}
\DeclareMathOperator{\one}{\overline{1}}
\DeclareMathOperator{\Der}{Der}
\DeclareMathOperator{\Lie}{Lie}
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\Cur}{Cur}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\fs}{fs}
\DeclareMathOperator{\tc}{tc}
\DeclareMathOperator{\sdim}{sdim}
\DeclareMathOperator{\Sing}{Sing}
\DeclareMathOperator{\Zhu}{Zhu}

\begin{document}

\begin{abstract}
  To every $h + \mathbb{N}$-graded module $M$ over an $\mathbb{N}$-graded conformal vertex algebra $V$, we associate an increasing filtration $(G^pM)_{p \in \mathbb{Z}}$ which is compatible with the filtrations introduced by Haisheng Li.
  The associated graded vector space $\gr^G(M)$ is naturally a module over the vertex Poisson algebra $\gr^G(V)$.
  We study $\gr^G(M)$ for the three irreducible modules of the Ising model $\Vir_{3, 4}$, namely $\Vir_{3,4} = L(1/2, 0)$, $L(1/2, 1/2)$ and $L(1/2, 1/16)$.
  We obtain an explicit monomial basis of each of these modules and a formula for their refined characters which are related to Nahm sums for the matrix $\left(\begin{smallmatrix} 8 & 3 \\ 3 & 2 \end{smallmatrix}\right)$.
\end{abstract}

\title{PBW bases of irreducible Ising modules}
\author{Diego Salazar Gutierrez}
\address{Instituto de Matem√°tica Pura e Aplicada, Rio de Janeiro, RJ, Brazil}
\email{diego.salazar@impa.br}
\date{\today}
\maketitle

\tableofcontents

\section{Introduction}
\label{sec:introduction}

In \cite{li_vertex_2004}, Li introduced an increasing filtration $(G^pV)_{p \in \mathbb{Z}}$ on an arbitrary $\mathbb{N}$-graded vertex algebra $V$.
The associated graded space $\gr^G(V)$ with respect to this increasing filtration then carries the structure of an $\mathbb{N}$-graded vertex Poisson algebra.

Then in \cite{li_abelianizing_2005}, Li introduced a decreasing filtration $(F_pV)_{p \in \mathbb{Z}}$ on an arbitrary vertex algebra $V$, not necessarily $\mathbb{N}$-graded.
The associated graded space $\gr_F(V)$ with respect to this decreasing filtration again carries the structure of a vertex Poisson algebra.
Li also introduced a decreasing filtration $(F_pM)_{p \in \mathbb{Z}}$ for modules $M$ over a vertex algebra $V$ and showed that the associated graded space $\gr_F(M)$ is a module over the vertex Poisson algebra $\gr_F(V)$.

In summary, Li constructed three functors
\begin{align*}
  \gr^G: \{\text{$\mathbb{N}$-graded vertex algebras}\} &\to \{\text{$\mathbb{N}$-graded vertex Poisson algebras}\}, \\
  \gr_F: \{\text{vertex algebras}\} &\to \{\text{vertex Poisson algebras}\}, \\
  \gr_F: \{\text{$V$-modules}\} &\to \{\text{$\gr_F(V)$-modules}\}.
\end{align*}

Then Arakawa shows in \cite[Proposition 2.6.1]{arakawa_remark_2012} that when $V$ is $\mathbb{N}$-graded, $\gr_F(V)$ and $\gr^G(V)$ are isomorphic as vertex Poisson algebras.

In this thesis, we define an increasing filtration $(G^pM)_{p \in \mathbb{Z}}$ for $h + \mathbb{N}$-graded modules $M$ over an $\mathbb{N}$-graded conformal vertex algebra $(V, \omega)$.
So we construct a functor
\begin{equation*}
  \gr^G: \{\text{$h + \mathbb{N}$-graded $(V, \omega)$-modules}\} \to \{\text{$h + \mathbb{N}$-graded $\gr^G(V)$-modules}\}.
\end{equation*}
Parallel to what was done in \cite{arakawa_remark_2012}, we show that $\gr_F(M)$ and $\gr^G(M)$ are isomorphic as modules.
However, for our purposes, the filtration $(G^pM)_{p \in \mathbb{Z}}$ is better suited.

In \cite{andrews_singular_2022}, two theorems about the Virasoro minimal model $\Vir_{3, 4} = L(1/2, 0)$, also known as the Ising model, are proved

\begin{theorem}
  \label{thr:1}
  The refined character of $\gr^G(\Vir_{3,4})$ is given by
  \begin{equation*}
    \ch_{\gr^G(\Vir_{3, 4})}(t, q) = \sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2}}{(q)_{k_1}(q)_{k_2}}(1 - q^{k_1} + q^{k_1 + k_2}).
  \end{equation*}
\end{theorem}

Let $R^0$ be the following set of partitions
\begin{align*}
  &[r, r, r], [r + 1, r, r], [r + 1, r + 1, r], [r + 2, r + 1, r], [r + 2, r + 2, r], &(r \ge 2) \\
  &[r + 2, r, r], &(r \ge 3) \\
  &[r + 3, r + 3, r, r], [r + 4, r + 3, r, r],  [r + 4, r + 3, r + 1, r], [r + 4, r + 4, r + 1, r], &(r \ge 2) \\
  &[r + 6, r + 5, r + 3, r + 1, r], &(r \ge 2) \\
  &[5, 4, 2, 2], [7, 6, 4, 2, 2], [7, 7, 4, 2, 2], [9, 8, 6, 4, 2, 2].
\end{align*}
Let $P^0$ be the set of partitions $\lambda = [\lambda_1, \dots, \lambda_m]$ with $\lambda_m \ge 2$ that don't contain any partition in $R^0$.

\begin{theorem}
  \label{thr:2}
  The set
  \begin{equation*}
    \{L_{-\lambda_1}L_{-\lambda_2}\dots L_{-\lambda_m}\vac \mid \lambda = [\lambda_1, \dots, \lambda_m] \in P^0\}
  \end{equation*}
  is a vector space basis of $\Vir_{3, 4}$.
\end{theorem}

In this thesis, we prove two similar results about $L(1/2, 1/2)$.

\begin{theorem}
  \label{thr:3}
  The refined character of $\gr^G(L(1/2, 1/2))$ is given by
  \begin{equation*}
    \ch_{\gr^G(L(1/2, 1/2))}(t, q) = q^{1/2}\left(\sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2}}{(q)_{k_1}(q)_{k_2}}(q^{3k_1 + 2k_2} + q^{5k_1 + 2k_2 + 1}t + q^{6k_1 + 3k_2 + 2}t^2)\right).
  \end{equation*}
\end{theorem}

Let $R$ be the following set of partitions
\begin{align*}
    &[r, r, r], [r + 1, r, r], [r + 1, r + 1, r], [r + 2, r + 1, r], [r + 2, r + 2, r], &(r \ge 3) \\
    &[r + 2, r, r], &(r \ge 3) \\
    &[r + 3, r + 3, r, r], [r + 4, r + 3, r, r],  [r + 4, r + 3, r + 1, r], [r + 4, r + 4, r + 1, r], &(r \ge 3)\\
    &[r + 6, r + 5, r + 3, r + 1, r], &(r \ge 3) \\
    &[2], [1, 1, 1], [3, 1, 1], [3, 3], [4, 3, 1], [4, 4, 1], [5, 4, 1, 1], [6, 5, 3, 1].
\end{align*}
Let $P$ be the set of partitions that don't contain any partition in $R$.

\begin{theorem}
  \label{thr:4}
  The set
  \begin{equation*}
    \{L_{-\lambda_1}L_{-\lambda_2}\dots L_{-\lambda_m}\vachalf \mid \lambda = [\lambda_1, \dots, \lambda_m] \in P\}
  \end{equation*}
  is a vector space basis of $L(1/2, 1/2)$.
\end{theorem}

Specializing the character formula in \Cref{thr:7} to $t = 1$, we obtain that the character of $L(1/2, 1/2)$ is the sum of three Nahm sums for the same matrix $\left(\begin{smallmatrix} 8 & 3 \\ 3 & 2 \end{smallmatrix}\right)$ (cf.\ \cite{Nahm2007}).

We can do a similar argument for $L(1/2, 1/16)$ and obtain the following theorem

\begin{theorem}
  \label{thr:5}
  The refined character of $\gr^G(L(1/2, 1/16))$ is given by
  \begin{equation*}
    \ch_{\gr^G(L(1/2, 1/16))}(t, q) = q^{1/16}\left(\sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2}}{(q)_{k_1}(q)_{k_2}}(q^{k_1 + k_2} + q^{4k_1 + 2k_2 + 1}t + q^{7k_1 + 3k_2 + 3}t^3)\right).
  \end{equation*}
  Let $R^{1/16}$ be the following set of partitions
  \begin{align*}
      &[r, r, r], [r + 1, r, r], [r + 1, r + 1, r], [r + 2, r + 1, r], [r + 2, r + 2, r], &(r \ge 3) \\
      &[r + 2, r, r], &(r \ge 3) \\
      &[r + 3, r + 3, r, r], [r + 4, r + 3, r, r],  [r + 4, r + 3, r + 1, r], [r + 4, r + 4, r + 1, r], &(r \ge 3)\\
      &[r + 6, r + 5, r + 3, r + 1, r], &(r \ge 3) \\
      &[2], [1, 1, 1, 1], [3, 1, 1, 1], [3, 3, 1], [4, 3, 1], [4, 4, 1, 1], [5, 4, 1, 1, 1], [5, 5, 1, 1, 1], \\
      &[6, 5, 3, 1, 1], [6, 6, 3, 1, 1], [7, 6, 4, 1, 1, 1], [8, 7, 5, 3, 1, 1].
  \end{align*}
  Let $P^{1/16}$ be the set of partitions that don't contain any partition in $R^{1/16}$.
  The set
  \begin{equation*}
    \{L_{-\lambda_1}L_{-\lambda_2}\dots L_{-\lambda_m}\vacsixteen \mid \lambda = [\lambda_1, \dots, \lambda_m] \in P^{1/16}\}
  \end{equation*}
  is a vector space basis of $L(1/2, 1/16)$.
\end{theorem}

In this thesis, we develop the theory needed to prove the theorems above assuming very little.
All but the most elementary definitions are written explicitly.
Mathematical terms are typeset with \emph{italics} when they are officially defined.
Not everything is proved, but there are references to every result used in this thesis.

This thesis is organized as follows: In \Cref{sec:vert-supera-their}, we introduce the notion of vertex superalgebras and their modules while trying to compile several well-known results.
We develop the theory from scratch.
In \Cref{sec:high-weight-repr}, we review the theory of representations of the Virasoro Lie algebra with the objective of describing explicitly the maximal subrepresentation of Verma modules.
In \Cref{sec:modules-over-simple}, we quickly review the theory of the Zhu algebra to use it to prove the theorems at hand.
In \Cref{sec:vert-poiss-supera}, the theory of filtrations of vertex algebras and their modules started by Haisheng Li is presented, we introduce the standard filtration for modules and prove it is compatible with the definitions already given by Li.
In \Cref{sec:pbw-basis-l12}, we carry out the computations needed to obtain the PBW basis of $L(1/2, 1/2)$ and its refined characters using results from the previous sections.
In the appendices, we recall a couple results about almost commutative algebras needed to describe $\gr^G(\Vir^c)$, we show the SageMath \cite{sagemath} program used compute a Poisson submodule related to the exceptional partitions appearing in $Q$ and also consider the case $L(1/2, 1/16)$.
The software systems Mathematica \cite{Mathematica} and Singular \cite{Singular} were also very useful to verify the series identities and compute Gr\"{o}bner bases.

I would like to thank my advisor Reimundo Heluani, Instituto de Matematica Pura e Aplicada (IMPA) and Conselho Nacional de Desenvolvimento Cient√≠fico e Tecnol√≥gico (CNPq) for their support.
Professor Jethro Van Ekeren made some valuable suggestions as well.

\numberwithin{theorem}{subsection}

\section{Vertex superalgebras and their modules}
\label{sec:vert-supera-their}

In this section, we first review formal calculus and Lie conformal superalgebras in a purely algebraic way mainly following \cite{nozaradan_introduction_2008} (meaning convergence of series is never considered).
Then present three detailed examples: the Virasoro Lie conformal algebra, the Current Lie conformal superalgebra and the Fermionic Lie conformal superalgebra.
Afterwards, we specialize the theory of formal calculus when the series are $\End(V)$-valued, where $V$ is a vector space.
This is the case that appears the most in the theory of vertex superalgebras and leads to the concept of fields over vector spaces.
Then the concept of vertex superalgebra is introduced and I've tried to collect most of the results related to general vertex superalgebras.
It is shown how to construct a vertex superalgebra from a Lie conformal superalgebra.
Later, we introduce Hamiltonians and conformal vectors of vertex superalgebras which leads to graded and conformal vertex superalgebras, respectively.
Probably most vertex superalgebras that appear naturally are either graded or conformal.
Next, modules over vertex superalgebras are introduced and again I've tried to collect most of the results related to modules over vertex superalgebras.
The articles \cite{de_sole_finite_2006} and \cite{callegaro_introduction_2017} contain a good introduction to vertex superalgebras.
The book \cite{kac_vertex_1998} is also very good (though the notation and style might be somewhat outdated).
Finally, we construct a couple of functors from the category of vertex superalgebras to the category of Lie superalgebras.
This will be useful when we consider the Zhu algebra of a vertex algebra in a \Cref{sec:modules-over-simple}.
These constructions were inspired by the paper \cite{dong_twisted_1998}.

\subsection{Formal calculus}
\label{sec:formal-calculus}

All vector spaces and all algebras are over $\mathbb{C}$, the field of complex numbers.
The set of natural numbers $\{0, 1, \dots\}$ is denoted by $\mathbb{N}$, the set of integers is denoted by $\mathbb{Z}$, the set of positive integers $\{1, 2, \dots\}$ is denoted by $\mathbb{Z}_+$ and the set of negative integers $\{-1, -2, \dots\}$ is denoted by $\mathbb{Z}_-$.

The vector space of \emph{formal distributions} in $n \in \mathbb{N}$ variables, denoted by $\mathbb{C}[[x_1^{\pm 1}, \dots, x_n^{\pm 1}]]$, is the set of functions $f: \mathbb{Z}^n \to \mathbb{C}$, written as $f(x_1, \dots, x_n) = \sum_{m_1, \dots, m_n \in \mathbb{Z}}f_{m_1, \dots, m_n}x_1^{m_1}\dots x_n^{m_n}$ with the natural operations of addition and multiplication by a scalar.
The field of \emph{rational functions} in $n$ variables, denoted by $\mathbb{C}(x_1, \dots, x_n)$, is the field of fractions $\Frac(\mathbb{C}[x_1, \dots, x_n])$.
The field of \emph{formal Laurent series} is the subalgebra of elements $f(x) \in \mathbb{C}[[x^{\pm 1}]]$ such that there is $N \in \mathbb{Z}$ with $f_n = 0$ for $n \le N$.
We also have $\mathbb{C}((x)) = \Frac(\mathbb{C}[[x]])$.
The field of \emph{joint Laurent series} in $n$ variables, denoted by $\mathbb{C}((x_1, \dots, x_n))$, is $\Frac(\mathbb{C}[[x_1, \dots, x_n]])$.

If $V$ is a vector space, we similarly define $V[[x_1^{\pm 1}, \dots, x_n^{\pm 1}]]$ and $V((x))$ but in this case, $V((x))$ is only a vector space.

Let $V$ be a vector space.
The \emph{Fourier expansion} of a formal distribution $a(z) \in V[[z^{\pm 1}]]$, written as $a(z) = \sum_{n \in \mathbb{Z}} a_nz^n$, is conventionally written in the theory of vertex superalgebras as
\begin{equation*}
  a(z) = \sum_{n \in \mathbb{Z}}a_{(n)}z^{-n - 1},
\end{equation*}
where
\begin{equation*}
  a_{(n)} = a_{-n - 1}.
\end{equation*}
The \emph{residue} of a formal distribution $a(z) \in V[[z^{\pm 1}]]$ is defined as
\begin{equation*}
  \Res_z(a(z)) = a_{(0)} = a_{-1}.
\end{equation*}

If $P \in R[[z_1^{\pm 1}, \dots, z_n^{\pm 1}]]$ and $Q \in R[[w_1^{\pm 1}, \dots, w_m^{\pm 1}]]$, then $PQ \in R[[z_1^{\pm 1}, \dots z_n^{\pm 1}, w_1^{\pm 1}, \dots, w_m^{\pm 1}]]$ is defined in the natural way.
However, if both $P$ and $Q$ belong to $R[[z_1^{\pm 1}, \dots, z_n^{\pm 1}]]$, we may run into trouble because infinite sums may appear.

An important formal distribution in two variables $z, w$ is the \emph{formal delta distribution} which is defined by
\begin{equation*}
  \delta(z, w) = \sum_{n \in \mathbb{Z}}z^nw^{-n - 1} \in \mathbb{C}[[z^{\pm 1}, w^{\pm 1}]].
\end{equation*}

The \emph{expansion in the domain} $|z| > |w|$ is the field homomorphism $i_{z, w}: \mathbb{C}((z, w)) \to \mathbb{C}((z))((w))$ such that the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    {\mathbb{C}[[z, w]]} \arrow[rd] \arrow[r] & {\mathbb{C}((z, w))} \arrow[d, "{i_{z, w}}"] \\
    & \mathbb{C}((z))((w))
  \end{tikzcd}
\end{equation*}
where the unlabeled homomorphisms are the natural ones.
Similarly, the expansion in the domain $|w| > |z|$ is the field homomorphism $i_{w, z}: \mathbb{C}((z, w)) \to \mathbb{C}((w))((z))$ such that the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    {\mathbb{C}[[z, w]]} \arrow[rd] \arrow[r] & {\mathbb{C}((z, w))} \arrow[d, "{i_{w, z}}"] \\
    & \mathbb{C}((w))((z))
  \end{tikzcd}
\end{equation*}

We have natural inclusions $\mathbb{C}((z))((w)) \to \mathbb{C}[[z^{\pm 1}, w^{\pm 1}]]$ and $\mathbb{C}((w))((z)) \to \mathbb{C}[[z^{\pm 1}, w^{\pm 1}]]$.
The diagram
\begin{equation*}
  \begin{tikzcd}
    & {\mathbb{C}((z, w))} \arrow[ld, "{i_{z,w}}"'] \arrow[rd, "{i_{w,z}}"] &\\
    \mathbb{C}((z))((w)) \arrow[rd] && {C}((w))((z)) \arrow[ld] \\
    & {\mathbb{C}[[z^{\pm 1}, w^{\pm 1}]]} &
  \end{tikzcd}
\end{equation*}
doesn't commute.
In fact, the formal delta distribution can be expressed as
\begin{equation*}
  \delta(z, w) = i_{z, w}\left(\frac{1}{z - w}\right) - i_{w, z}\left(\frac{1}{z - w}\right),
\end{equation*}
where we consider $i_{z, w}(\frac{1}{z - w})$ and $i_{w, z}(\frac{1}{z - w})$ as elements of $\mathbb{C}[[z^{\pm 1}, w^{\pm 1}]]$.
From now on, we will consider $i_{z, w}$ and $i_{w, z}$ as mapped into $\mathbb{C}[[z^{\pm 1}, w^{\pm 1}]]$.

Let $V$ be a vector space.
A formal distribution $a(z, w) \in V[[z^{\pm 1}, w^{\pm 1}]]$ is \emph{local} if there is $N \in \mathbb{N}$ such that
\begin{equation*}
  (z - w)^Na(z, w)=0.
\end{equation*}
For example, the formal delta distribution $\delta(z, w)$ is local with $(z - w)\delta(z, w) = 0$.

\begin{theorem}[{\cite[Proposition 2.2]{kac_vertex_1998}}]
  \label{thr:6}
  Let $a(z, w) \in V[[z^{\pm 1}, w^{\pm 1}]]$ be a local formal distribution.
  Then $a(z, w)$ can be written uniquely as a sum
  \begin{equation*}
    a(z, w) = \sum_{j \in \mathbb{N}}\frac{\partial_w^j\delta(z, w)}{j!}c^j(w),
  \end{equation*}
  where $c^j(w) \in V[[w^{\pm 1}]]$ are formal distributions given by
  \begin{equation*}
    c^j(w) = \Res_z(z - w)^ja(z, w) \quad \text{for }j \in \mathbb{N}.
  \end{equation*}
  In addition, the converse is true.
\end{theorem}

Let $V$ be a vector space and  $a(z) \in V[[z^{\pm 1}]]$ be a formal distribution.
Define
\begin{equation*}
  i_{z, w}a(z + w) = \sum_{n \in \mathbb{Z}} a_ni_{z, w}(z + w)^n.
\end{equation*}
We have a formal version of the usual Taylor series expansion.

\begin{proposition}[{\cite[Proposition 3.4.1]{nozaradan_introduction_2008}}]
  \label{prp:1}
  We have
  \begin{equation*}
    i_{z, w}a(z + w) = \sum_{j \in \mathbb{N}}\frac{\partial^ja(z)}{j!}w^j.
  \end{equation*}
\end{proposition}

We now define the notion of Fourier transform in two cases: in one and two variables. Let $V$ be a vector space and let $a(z) \in V[[z^{\pm 1}]]$.
We define the \emph{Fourier transform in one variable} of $a(z)$ by
\begin{equation*}
  F^{\lambda}_za(z) = \Res_z(e^{\lambda z}a(z)) \in V[[\lambda]].
\end{equation*}

\begin{proposition}[{\cite[Proposition 1.5.2]{nozaradan_introduction_2008}}]
  \label{prp:2}
  The Fourier transform in one variable satisfies the following properties for $a(z) \in V[[z^{\pm 1}]]$:
  \begin{enumerate}
  \item $F^{\lambda}_z\partial_za(z) = -\lambda F^{\lambda}_za(z)$;
  \item $F^{\lambda}_z(e^{zT}a(z)) = F^{z + T}_z(a(z))$ where $T \in \End(V)$ and $a(z) \in V((z))$;
  \item $F^{\lambda}_z(a(-z)) = -F^{-\lambda}_za(z)$;
  \item $F^{\lambda}_z\partial^n_w\delta(z, w) = e^{\lambda w}\lambda^n$.
  \end{enumerate}
\end{proposition}

Now let $a(z, w) \in V[[z^{\pm 1}, w^{\pm 1}]]$.
We define the \emph{Fourier transform in two variables} of $a(z, w)$ by
\begin{equation*}
  F^{\lambda}_{z, w}a(z, w) = \Res_z(e^{\lambda(z - w)}a(z, w)) \in V[[w^{\pm 1}]][[\lambda]].
\end{equation*}

Expanding the definition of $F^{\lambda}_{z, w}$, we obtain another expression
\begin{equation*}
  F^{\lambda}_{z, w}a(z, w) = \sum_{j \in \mathbb{N}}\frac{\lambda^j}{j!}c^j(w),
\end{equation*}
where
\begin{equation*}
  c^j(w) = \Res_z((z - w)^ja(z, w)) \quad \text{for }j \in \mathbb{N}.
\end{equation*}

\begin{proposition}[{\cite[Proposition 1.5.4]{nozaradan_introduction_2008}}]
  \label{prp:3}
  The Fourier transform in two variables satisfies the following properties for $a(z, w) \in V[[z^{\pm 1}, w^{\pm 1}]]$:
  \begin{enumerate}
  \item If $a(z, w)$ is local then $F^{\lambda}_{z, w}a(z, w) \in V[[w^{\pm 1}]][\lambda]$;
  \item $F^{\lambda}_{z, w}\partial_za(z, w) = -\lambda F^{\lambda}_{z, w}a(z, w) = [\partial_w, F^{\lambda}_{z, w}]a(z, w)$;
  \item If $a(z, w)$ is local, then $F^{\lambda}_{z, w}a(w, z) = F^{-\lambda - \partial_w}_{z, w}a(z, w)$, where we set $F^{-\lambda - \partial_w}_{z, w}a(z, w) = F^{\mu}_{z, w}a(z, w)|_{\mu = -\lambda - \partial_w}$.
  \end{enumerate}
\end{proposition}

\begin{remark}
  \label{rmk:1}
  In the theory of vertex superalgebras, one usually has to interpret equations like in \Cref{prp:3}(iii).
\end{remark}

\subsection{Lie conformal superalgebras}
\label{sec:lie-conf-super}

A \emph{vector superspace} is a $\mathbb{Z}_2$-graded vector space $V = V_{\zero} \oplus V_{\one}$ where $\mathbb{Z}_2 = \mathbb{Z}/2\mathbb{Z} = \{\zero, \one\}$, $\zero = 0 + 2\mathbb{Z}$ and $\one = 1 + 2\mathbb{Z}$.
We call $V_{\zero}$ the \emph{even subspace} of $V$ and $V_{\one}$ the \emph{odd subspace} of $V$.
Nonzero elements of $V_{\zero}\cup V_{\one}$ are called \emph{homogeneous}.
If $V$ is finite dimensional, its we define its superdimension by setting $\sdim(V) = \dim(V_{\zero}) - \dim(V_{\one})$.
A \emph{superalgebra} is a $\mathbb{Z}_2$-graded algebra $A = A_{\zero} \oplus A_{\one}$.
This means $A_{\alpha}A_{\beta} \subseteq A_{\alpha + \beta}$ for $\alpha, \beta \in \mathbb{Z}_2$.

We set $(-1)^{\zero} = 1$, $(-1)^{\one} = -1$.
If $a \in V_\alpha$, $v\neq 0$ is homogeneous, we set $p(a) = \alpha$ and call it the \emph{parity} of $a$.
If $a$ and $b$ are homogeneous, we set $p(a, b) = (-1)^{p(a)p(b)}$.
A \emph{Lie superalgebra} is a superalgebra $\mathfrak{g} = \mathfrak{g}_{\zero} \oplus \mathfrak{g}_{\one}$ with the a $\mathbb{C}$-bilinear product $[\bullet, \bullet]: \mathfrak{g} \times \mathfrak{g} \to \mathfrak{g}$ called \emph{Lie superbracket} satisfying the following properties for $a, b, c \in \mathfrak{g}$ homogeneous:
\begin{enumerate}
\item (Graded antisymmetry) $[a, b] = -p(a, b)[b, a]$;
\item (Graded Jacobi identity) $p(a, c)[a, [b, c]] + p(b, a)[b, [c, a]] + p(c, b)[c, [a, b]] = 0$.
\end{enumerate}

In an associative superalgebra $A$, we can define the superbracket of homogeneous elements $a, b$ by setting
\begin{equation*}
  [a, b] = ab - p(a, b)ba.
\end{equation*}
It can then be extended by linearity to nonhomogeneous elements.
With this superbracket, $A$ becomes a Lie superalgebra called the \emph{underlying Lie superalgebra} of $A$ and is denoted by $[A]$.

\begin{remark}
  \label{rmk:2}
  The even part $\mathfrak{g}_{\zero}$ of a Lie superalgebra $\mathfrak{g}$ is just a standard Lie algebra.
  However, unlike superspaces and superalgebras, a Lie superalgebra is not always a Lie algebra.
  This is why we prefer the term Lie superalgebra instead of $\mathbb{Z}_2$-graded Lie algebra.
\end{remark}

\begin{remark}
  \label{rmk:3}
  When a formula involves $p(a)$ it is assumed that $a$ is an homogeneous with parity $p(a)$ and the formula is extended to arbitrary $a$ by linearity.
\end{remark}

Probably the most important example of an associative superalgebra is the \emph{endomorphism superalgebra} $\End(V)$ of a superspace $V$ with the $\mathbb{Z}_2$-grading given by
\begin{equation*}
  \End(V)_{\alpha} = \{T \in \End(V) \mid \text{for }\beta \in \mathbb{Z}_2, T(V_\beta) \subseteq V_{\alpha + \beta}\} \quad \text{for }\alpha \in \mathbb{Z}_2.
\end{equation*}
We denote $\mathfrak{gl}(V) = [\End(V)]$.

Let $A$ be a not necessarily associative superalgebra.
A \emph{superderivation} of $A$ is an homogeneous endomorphism $\partial \in \End(A)$ such that
\begin{equation*}
  \partial(ab) = \partial(a)b + (-1)^{p(\partial)p(a)}b\partial(c) \quad \text{for }a, b \in A.
\end{equation*}
The \emph{subspace of superderivations} of $A$ is denoted by $\Der(A)$.
A \emph{differential superalgebra} is a superalgebra $A$ together with a superderivation $\partial$ of $A$.
A differential algebra is a differential superalgebra with odd subspace equal to $0$.

Assume $\mathfrak{g}$ is a Lie superalgebra and $\partial$ is a superderivation of $\mathfrak{g}$.
We can form the universal enveloping superalgebra $U(\mathfrak{g})$ which is now an associative superalgebra.
The derivation $\partial: \mathfrak{g} \to \mathfrak{g}$ can be extended uniquely to a derivation $DU(\partial): U(\mathfrak{g}) \to U(\mathfrak{g})$.
We have constructed a functor
\begin{align*}
  DU: \{\text{differential Lie superalgebras}\} &\to \{\text{associative differential superalgebras}\}, \\
  (\mathfrak{g}, \partial) &\mapsto (U(\mathfrak{g}), DU(\partial)).
\end{align*}

Let $\mathfrak{g}$ be a Lie superalgebra.
We first extend the Lie superbracket on $\mathfrak{g}$ to the \emph{Lie superbracket} between two $\mathfrak{g}$-valued formal distributions in one variable.
Starting from $a(z) = \sum_{m \in \mathbb{Z}}a_{(m)}z^{-m - 1} \in \mathfrak{g}[[z^{\pm 1}]]$ and $b(w) = \sum_{n \in \mathbb{Z}}b_{(n)}w^{-n - 1} \in \mathfrak{g}[[w^{\pm 1}]]$, we define a new formal distribution in two variables by defining the superbracket
\begin{equation*}
  [a(z), b(w)] = \sum_{m, n \in \mathbb{Z}}[a_{(m)}, b_{(n)}]z^{-m - 1}w^{-n - 1} \in \mathfrak{g}[[z^{\pm 1}, w^{\pm 1}]].
\end{equation*}

Let $\mathfrak{g}$ be a Lie superalgebra.
A pair $(a(z), b(z))$ of $\mathfrak{g}$-valued formal distributions is said \emph{local} if $[a(z), b(w)]$ is local.
By \Cref{thr:6}, this means that
\begin{equation*}
  [a(z), b(w)] = \sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}c^j(w),
\end{equation*}
where $c^j(w) = \Res_z((z - w)^j[a(z), b(w)]) \in \mathfrak{g}[[w^{\pm 1}]]$ for $j \in \mathbb{N}$.
Equivalently, we can write this equation as
\begin{equation}
  \label{eq:1}
  [a_{(m)}, b_{(n)}] = \sum_{j \in \mathbb{N}}c^j(w)_{(m + n - j)} \quad \text{for }m, n \in \mathbb{Z}.
\end{equation}

\begin{remark}
  \label{rmk:4}
  If $(a(z), b(z))$ is a local pair then $(\partial_za(z), b(z))$ is also a local pair.
\end{remark}

Let $\mathfrak{g}$ be a Lie superalgebra.
A subset $\mathfrak{F} \subseteq \mathfrak{g}[[z^{\pm 1}]]$ of formal distributions is called a \emph{local family} if all pairs of its elements are local.
Let $a(w)$ and $b(w)$ be two $\mathfrak{g}$-valued formal distributions.
For $j \in \mathbb{N}$, their \emph{$j$-product} is the $\mathbb{C}$-bilinear map defined by
\begin{align}
  \nonumber
  \bullet_{(j)}\bullet: \mathfrak{g}[[w^{\pm 1}]] \times \mathfrak{g}[[w^{\pm 1}]] &\to \mathfrak{g}[[w^{\pm 1}]], \\
  \label{eq:2}
  a(w)_{(j)}b(w) &= \Res_z((z - w)^j[a(z), b(w)]).
\end{align}
Expanding the right hand side we get
\begin{equation}
  \label{eq:3}
  (a(w)_{(j)}b(w))_{(m)} = \sum_{k = 0}^j\binom{j}{k}(-1)^k[a_{(j - k)},b_{(m + k)}] \quad \text{for }j \in \mathbb{N}\text{ and }m \in \mathbb{Z}.
\end{equation}
We define $a(w)_{(j)} \in \End(\mathfrak{g}[[w^{\pm 1}]])$ in the natural way.
If $(a(z), b(z))$ is a local pair, then \eqref{eq:1} becomes
\begin{equation}
  \label{eq:4}
  [a_{(m)}, b_{(n)}] = \sum_{j \in \mathbb{N}}\binom{m}{j}(a(w)_{(j)}b(w))_{(m + n - j)} \quad \text{for }m, n \in \mathbb{Z}.
\end{equation}
By \Cref{thr:6}, we also have
\begin{equation*}
  [a(z), b(w)] = \sum_{j \in \mathbb{N}}\frac{\partial_w^j\delta(z, w)}{j!}(a(w)_{(j)}b(w)).
\end{equation*}
All these identities led us to the define the following new algebraic structure that encodes the relevant information compactly.

Let $\mathfrak{g}$ be a Lie superalgebra.
The \emph{$\lambda$-bracket} of two $\mathfrak{g}$-valued formal distributions is defined by the $\mathbb{C}$-bilinear map
\begin{align*}
  [\bullet_{\lambda}\bullet]: \mathfrak{g}[[w^{\pm 1}]] \times \mathfrak{g}[[w^{\pm 1}]] &\to \mathfrak{g}[[w^{\pm 1}]][[\lambda]], \\
  [a(w)_{\lambda}b(w)] &= F^{\lambda}_{z, w}[a(z), b(w)].
\end{align*}
It can easily be shown that the $\lambda$-bracket is related to the $j$-products by
\begin{equation*}
  [a(w)_{\lambda}b(w)] = \sum_{j \in \mathbb{N}}a(w)_{(j)}b(w)\frac{\lambda^j}{j!}.
\end{equation*}
This suggest to see the $\lambda$-bracket as the generating function of the $j$-products.
It allows us to gather all the $j$-products in one product alone, the price to pay being the additional formal variable $\lambda$.
Note that for a local pair, the sum in the expansion of $[a(w)_{\lambda} b(w)]$ in terms of the $j$-products is finite, i.e.\ $[a(w)_{\lambda}b(w)] \in \mathfrak{g}[[w^{\pm 1}]][\lambda]$.

\begin{theorem}[{\cite[\S2.3]{nozaradan_introduction_2008}}]
  \label{thr:7}
  The $j$-products and the $\lambda$-bracket satisfy the following properties for $a(w), b(w) \in \mathfrak{g}[[w^{\pm 1}]]$ and $j \in \mathbb{N}$:
  \begin{enumerate}
  \item $(\partial a(w))_{(j)}b = -ja(w)_{(j - 1)}b(w)$;
  \item $a(w)_{(j)}\partial b(w) = \partial(a(w)_{(j)}b(w)) + ja(w)_{(j - 1)}b(w)$;
  \item $\partial(a(w)_{(j)}b(w)) = (\partial a(w))_{(j)}b(w) + a(w)_{(j)}\partial b(w)$;
  \item $[\partial a(w)_{\lambda}b(w)] = -\lambda[a(w)_{\lambda}b(w)]$;
  \item $[a(w)_{\lambda}\partial b(w)] = (\partial + \lambda)[a(w)_{\lambda}b(w)]$;
  \item $\partial[a(w)_{\lambda}b(w)] = [\partial a(w)_{\lambda}b(w)] + [a(w)_{\lambda}\partial b(w)]$.
  \end{enumerate}
\end{theorem}

\begin{remark}
  \label{rmk:5}
  Properties (iii) and (vi) of \Cref{thr:7} tell us that $\partial: \mathfrak{g}[[z^{\pm 1}]] \to \mathfrak{g}[[z^{\pm 1}]]$ acts as a derivation on the $j$-products and the $\lambda$-bracket.
\end{remark}

Let $V$ be vector superspace.
From now on, all coefficients of a formal distribution are assumed to have the same parity.
Therefore, we can define the \emph{parity} of a formal distribution $a(z) \in V[[z^{\pm 1}]]$ as $p(a(z)) = p(a_{(n)})$ for any $n \in \mathbb{Z}$.

\begin{theorem}[{\cite[\S2.3]{nozaradan_introduction_2008}}]
  \label{thr:8}
  The $j$-products and the $\lambda$-bracket satisfy the following properties for $a(w), b(w) \in \mathfrak{g}[[w^{\pm 1}]]$, $p, m \in \mathbb{Z}$ and $j \in \mathbb{N}$:
  \begin{enumerate}
  \item $b(w)_{(j)}a(w) = -p(a(w), b(w))\sum_{l = 0}^{\infty}(-1)^{j + l}\frac{\partial^l(a(w)_{(j + l)}b(w))}{l!}$ if $(a(w), b(w))$ is a local pair;
  \item $[a(w)_{(p)}, b(w)_{(m)}] = \sum_{k = 0}^p\binom{p}{k}(a(w)_{(k)}b(w))_{(p + m - k)}$;
  \item $[b(w)_{\lambda}a(w)] = -p(a(w), b(w))[a(w)_{-\lambda - \partial}b(w)]$ if $(a(w), b(w))$ is a local pair;
  \item $[a(w)_{\lambda}[b(w)_{\mu}c(w)]] = [[a(w)_{\lambda}b(w)]_{\lambda + \mu}c(w)] + p(a(w), b(w))[b(w)_{\mu}[a(w)_{\lambda}c(w)]]$;
  \item $F^{\lambda + \mu}_z[a(z)_{\lambda}b(z)] = [F^{\lambda}_za(z), F^{\mu}_zb(z)]$.
  \end{enumerate}
\end{theorem}

Let $\mathfrak{g}$ be a Lie superalgebra.
A \emph{formal distribution Lie superalgebra} is a pair $(\mathfrak{g}, \mathfrak{F})$ such that $\mathfrak{F}$ is a local family of $\mathfrak{g}$-valued formal distributions, denoted by $\{a^j(z) = \sum_{n \in \mathbb{Z}}a^j_{(n)}z^{-n - 1}\}_{j \in J}$, such that the coefficients $\{a^j_{(n)} \mid j \in J, n \in \mathbb{Z}\}$ span the whole $\mathfrak{g}$.
A \emph{regular} formal distribution Lie superalgebra is a triple $(\mathfrak{g}, \mathfrak{F}, T)$ such that:
\begin{enumerate}
\item $(\mathfrak{g}, \mathfrak{F})$ is a formal distribution Lie superalgebra;
\item $\mathbb{C}[\partial_z]\mathfrak{F}$ is closed under all $n$-th products for $n \in \mathbb{N}$;
\item $T \in \Der(\mathfrak{g})$ satisfies
  \begin{equation*}
    T(a^j(z)) = \partial_za^j(z) \quad \text{for }j \in J,
  \end{equation*}
  which is equivalent to
  \begin{equation}
    \label{eq:5}
    T(a^j_{(n)}) = -na^j_{(n - 1)} \quad \text{for }j \in J\text{ and }n \in \mathbb{Z}.
  \end{equation}
\end{enumerate}

\begin{remark}
  \label{rmk:6}
  Note that \eqref{eq:5} and the fact that $\{a^j_{(n)} \mid j \in J, n \in \mathbb{Z}\}$ span $\mathfrak{g}$ imply that if such $T$ exists, it is even and unique so we could remove $T$ from the notation, but we won't.
\end{remark}

Let $(\mathfrak{g}, \mathfrak{F})$ be a formal distribution Lie superalgebra.
The \emph{annihilation subalgebra} of $(\mathfrak{g}, \mathfrak{F})$ is
\begin{equation*}
  \mathfrak{g}_- = \vspan\{a^j_{(n)} \mid j \in J, n \in \mathbb{N}\},
\end{equation*}
the \emph{creation subalgebra} of $(\mathfrak{g}, \mathfrak{F})$ is
\begin{equation*}
  \mathfrak{g}_+ = \vspan\{a^j_{(-n - 1)} \mid j \in J, n \in \mathbb{N}\}
\end{equation*}
and the \emph{polar decomposition} of $(\mathfrak{g}, \mathfrak{F})$ is
\begin{equation*}
  \mathfrak{g} = \mathfrak{g}_- \oplus \mathfrak{g}_+.
\end{equation*}

By \Cref{rmk:4}, if $(\mathfrak{g}, \mathfrak{F})$ is a formal distribution Lie superalgebra then $\mathbb{C}[\partial_z]\mathfrak{F}$ is a local family.

The notions of $j$-products and $\lambda$-bracket were previously defined from $\mathfrak{g}$-valued formal distributions with $\mathfrak{g}$ being a given Lie superalgebra.
Those products were shown to satisfy several properties, coming either from their definition or from the fact that $\mathfrak{g}$ is a Lie superalgebra.
Now we take those properties as axioms of a new algebraic structure, defined intrinsically, without any reference either to $\mathfrak{g}$, nor to formal distributions.
For this reason, we write $\partial$ instead of $\partial_z$ in the following definition.

A $\mathbb{C}[\partial]$-module $\mathcal{R}$ is called a \emph{Lie conformal superalgebra} if it is endowed with a $\mathbb{C}$-bilinear map called \emph{$\lambda$-bracket}
\begin{equation*}
  [\bullet_{\lambda}\bullet]: \mathcal{R}\times\mathcal{R} \to \mathcal{R}[\lambda]
\end{equation*}
and satisfying the following properties for $a, b, c \in \mathcal{R}$:
\begin{enumerate}
\item (Sesquilinearity) $[\partial a_{\lambda}b] = -\lambda[a_{\lambda}b]$;
\item (Skewsymmetry) $[b_{\lambda}a] = -p(a, b)[a_{-\lambda - \partial}b]$;
\item (Jacobi identity) $[a_{\lambda}[b_{\mu}c]] = [[a_{\lambda}b]_{\lambda +\mu}c] + p(a, b)[b_{\mu}[a_{\lambda}c]]$.
\end{enumerate}

If we write
\begin{equation*}
  [a_{\lambda}b] = \sum_{j \in \mathbb{N}}(a_{(j)}b)\frac{\lambda^j}{j!},
\end{equation*}
where $a_{(j)} \in \End(\mathcal{R})$, these properties translate in terms of $j$-products as follows:
\begin{enumerate}
\item $(\partial a)_{(j)} = -ja_{(j - 1)}$;
\item $b_{(j)}a = -p(a, b)\sum_{l = 0}^{\infty}(-1)^{j + l}\frac{\partial^l(a_{(j + l)}b)}{l!}$;
\item $[a_{(p)}, b_{(m)}] = \sum_{k = 0}^p\binom{p}{k}(a_{(k)}b)_{(p + m - k)}$.
\end{enumerate}

\begin{proposition}[{\cite[Remark 2.5.3]{nozaradan_introduction_2008}}]
  \label{prp:4}
  Let $\mathcal{R}$ be a Lie conformal superalgebra and $a, b \in \mathcal{R}$.
  Then
  \begin{equation*}
    [a_{\lambda}\partial b] = (\partial + \lambda)[a_{\lambda}b],
  \end{equation*}
  or, equivalently,
  \begin{equation*}
    a_{(j)}\partial b = \partial(a_{(j)}b) + ja_{(j - 1)}b \quad \text{for }j \in \mathbb{N}.
  \end{equation*}
  In particular, $\partial$ is a derivation of the $\lambda$-bracket.
\end{proposition}

We have previously shown that any regular formal distribution Lie superalgebra $(\mathfrak{g}, \mathfrak{F}, T)$ was given the structure of Lie Conformal superalgebra $\mathcal{R}$ with $\mathcal{R} = \mathbb{C}[\partial_z]\mathfrak{F}$, $\partial = \partial_z$ and $[a(w)_{\lambda}b(w)] = F^{\lambda}_{z, w}([a(z), b(w)])$.
It turns out that the process can be reverted: to any Lie conformal superalgebra we can associate a regular formal distribution Lie superalgebra.
According to the definition of a formal distribution Lie superalgebra, we first have to define a Lie superalgebra, denoted by $\Lie(\mathcal{R})$, and then associate to it a conformal family $\mathcal{R}$ of $\Lie(\mathcal{R})$-valued formal distributions, whose coefficients span $\Lie(\mathcal{R})$ so that $(\Lie(\mathcal{R}), \mathcal{R})$ is then the expected formal distribution Lie superalgebra.
We proceed in two steps.

We first consider the space $\widetilde{\mathcal{R}} = \mathcal{R}[t, t^{-1}] = \mathcal{R} \otimes \mathbb{C}[t, t^{-1}]$ with $\widetilde{\partial} = \partial \otimes \Id + \Id \otimes \partial_t$ where $\Id$ appearing on the left (resp.\ right) of $\otimes$ is the identity operator acting on $\mathcal{R}$ (resp.\ $\mathbb{C}[t, t^{-1}]$).
This space is called the \emph{affinization} of $\mathcal{R}$.
Its generating elements can be written $a\otimes t^m$, where $a \in \mathcal{R}$ and $m \in \mathbb{Z}$.
For clarity, we will use the notation $at^m$ for its elements and $\widetilde{\partial} = \partial + \partial_t$.
Define the commutation relation on $\widetilde{\mathcal{R}}$ as
\begin{equation*}
  [at^m, bt^n] = \sum_{j \in \mathbb{N}}\binom{m}{j}(a_{(j)}b)t^{m + n - j} \quad \text{for }a, b \in \mathcal{R}\text{ and }m, n \in \mathbb{Z},
\end{equation*}
which gives $\widetilde{\mathcal{R}}$ the structure of algebra, denoted by $(\widetilde{\mathcal{R}},[\bullet, \bullet])$.

Now the second step.
We have to check that the commutator verifies the antisymmetry and Jacobi identities, considering that the terms $a_{(j)}b$ of the definition of $[\bullet, \bullet]$ satisfy the axioms of a Lie conformal superalgebra.
The latter ones are not sufficient.
Indeed, as we will see, another constraint has to be imposed on elements of $\widetilde{\mathcal{R}}$, namely $\widetilde{\partial}(at^m) = 0$.
The algebraic formulation of the latter condition is as follows: the space $\widetilde{\mathcal{R}}$ has to be quotiented by the subspace $I$ spanned by the elements of the form $\{(\partial a)t^n + nat^{n - 1} \mid n \in \mathbb{Z}\}$.
Using $\widetilde{\partial}$, we can write $I = \widetilde{\partial}\widetilde{\mathcal{R}}$.
This process has two goals: first transferring on $\widetilde{\mathcal{R}}/\widetilde{\partial}\widetilde{\mathcal{R}}$ the structure of algebra of $(\widetilde{\mathcal{R}}, [\bullet, \bullet])$ and then endowing $(\widetilde{\mathcal{R}}/\widetilde{\partial}\widetilde{\mathcal{R}}, [\bullet, \bullet])$ with the structure of Lie superalgebra.
The first goal is not direct.
Indeed, $\widetilde{\partial}\widetilde{\mathcal{R}}$ has to be a two-sided ideal of the algebra $(\widetilde{\mathcal{R}}, [\bullet, \bullet])$, which is the case.

\begin{lemma}[{\cite[Proposition 2.6.1]{nozaradan_introduction_2008}}]
  \label{lmm:1}
  $\widetilde{\partial}\widetilde{\mathcal{R}}$ is a two-sided ideal of the algebra $(\widetilde{\mathcal{R}}, [\bullet, \bullet])$.
\end{lemma}

Define the homomorphism $\phi: \widetilde{\mathcal{R}} \to \widetilde{\mathcal{R}}/\widetilde{\partial}\widetilde{\mathcal{R}}$ as the natural quotient map.
The commutator between two elements of $\widetilde{\partial}\widetilde{\mathcal{R}}$ is defined by
\begin{equation*}
  [\phi(at^m), \phi(bt^n)] = \sum_{j \in \mathbb{N}}\binom{m}{j}\phi((a_{(j)}b)t^{m + n - j}) \quad \text{for }a, b \in \mathcal{R}\text{ and }m, n \in \mathbb{Z}.
\end{equation*}

\begin{proposition}[{\cite[Proposition 2.6.3]{nozaradan_introduction_2008}}]
  \label{prp:5}
  $(\widetilde{\mathcal{R}}/\widetilde{\partial}\widetilde{\mathcal{R}}, [\bullet, \bullet])$ is a Lie superalgebra.
\end{proposition}

We set
\begin{equation*}
  \Lie(\mathcal{R}) = \widetilde{\mathcal{R}}/\widetilde{\partial}\widetilde{\mathcal{R}}.
\end{equation*}
Abusing notation, we define the family $\mathcal{R}$ of $\Lie(\mathcal{R})$-valued formal distributions, whose coefficients span $\Lie(\mathcal{R})$, by
\begin{equation*}
  \mathcal{R} = \left\{\sum_{n \in \mathbb{Z}}\phi(at^n)z^{-n - 1} \mid a \in \mathcal{R}\right\}.
\end{equation*}

\begin{theorem}[{\cite[Proposition 2.6.4]{nozaradan_introduction_2008}}]
  \label{thr:9}
  Let $\mathcal{R}$ be a Lie conformal superalgebra.
  Then $(\Lie(\mathcal{R}), \mathcal{R}, -\partial_t)$ is a regular formal distribution Lie superalgebra.
\end{theorem}

\begin{remark}
  \label{rmk:7}
  We haven't defined the category of regular formal distribution Lie superalgebras nor the category of Lie conformal superalgebras.
  But it's clear how they should be and they are equivalent categories
  \begin{align*}
    \{\text{regular formal distribution Lie superalgebra}\} &\leftrightarrow \{\text{Lie conformal superalgebra}\}, \\
    (\mathfrak{g}, \mathfrak{F}, T) &\mapsto (\mathbb{C}[\partial_z]\mathfrak{F}, F^{\lambda}_{z, w}([\bullet, \bullet])), \\
    (\Lie(\mathcal{R}), \mathcal{R}, -\partial_t) &\mapsfrom \mathcal{R}.
  \end{align*}
\end{remark}

\begin{theorem}
  \label{thr:10}
  Let $\mathcal{R}$ be a Lie conformal superalgebra, $a, b \in \mathcal{R}$ and $j, m \in \mathbb{N}$.
  Then
  \begin{equation*}
    (a_{(j)}b)_{(m)} = \sum_{k = 0}^j\binom{j}{k}(-1)^k[a_{(j - k)},b_{(m + k)}].
  \end{equation*}
\end{theorem}

\begin{proof}
  This is just \eqref{eq:3} in the language of Lie conformal superalgebras.
\end{proof}

We now show three examples of regular formal distribution Lie superalgebras and their respective Lie conformal superalgebras.

\begin{example}[\emph{Virasoro Lie conformal algebra}]
  \label{exa:1}
  The \emph{Virasoro Lie algebra}, denoted $\Vir$, is the Lie algebra given by
  \begin{equation*}
    \Vir = \bigoplus_{n \in \mathbb{Z}}\mathbb{C}L_{n} \oplus \mathbb{C}C.
  \end{equation*}
  These elements satisfy the following commutation relations:
  \begin{equation}
    \label{eq:6}
    \begin{split}
      [L_m, L_n] &= (m - n)L_{m + n} + \delta_{m, -n}\frac{m^3 - m}{12}C \quad \text{for }m, n \in \mathbb{Z}, \\
      [\Vir, C] &= 0.
    \end{split}
  \end{equation}
  We construct a $\Vir$-valued formal distribution by setting
  \begin{equation*}
    L(z) = \sum_{n \in \mathbb{Z}}L_{(n)}z^{-n - 1}\text{ with }L_{(n)} = L_{n - 1}\text{ for }n \in \mathbb{Z}.
  \end{equation*}
  Hence
  \begin{equation*}
    L(z) = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2}.
  \end{equation*}
  In terms of formal distributions, the commutation relations become:
  \begin{equation}
    \label{eq:7}
    \begin{split}
      [L(z), L(w)] &= \delta(z, w)\partial_wL(w) + \partial_w\delta(z, w)2L(w) + \partial^3_w\delta(z, w)\frac{C}{12}, \\
      [L(z), C] &= 0,
    \end{split}
  \end{equation}
  where $C$ denotes the constant formal distribution equal to $C \in \Vir$.
  In terms of $j$-products, the commutation relations become:
  \begin{equation}
    \label{eq:8}
    \begin{split}
      L(z)_{(0)}L(z) &= \partial_zL(z), \\
      L(z)_{(1)}L(z) &= 2L(z), \\
      L(z)_{(3)}L(z) &= \frac{C}{2}, \\
      L(z)_{(j)}L(z) &= 0 \quad \text{for }j \neq 0, 1, 3, \\
      L(z)_{(j)}C &= 0 \quad \text{for }j \in \mathbb{N}.
    \end{split}
\end{equation}
  In terms of the $\lambda$-bracket, the commutation relations become:
  \begin{equation}
    \label{eq:9}
    \begin{split}
      [L(z)_{\lambda}L(z)] &= (\partial + 2\lambda)L(z) + \frac{\lambda^3}{12}C, \\
      [L(z)_{\lambda}C] &= 0.
    \end{split}
\end{equation}
  By \Cref{thr:6}, $\{L(z), C\}$ is a local family.
  Therefore, $(\Vir, \{L(z), C\})$ is a formal distribution Lie algebra.
  Moreover, we can verify directly that $(\Vir, \{L(z), C\}, \ad(L_{-1}))$ is regular.
  We obtain a Lie conformal algebra $\mathcal{R} = \mathbb{C}[\partial]L + \mathbb{C}C$, with $L = L(z)$, $\partial C = 0$ and $\partial = \partial_z$.
  This is actually a direct sum and we get the Virasoro Lie conformal algebra
  \begin{equation*}
    \Vir = \mathbb{C}[\partial]L \oplus \mathbb{C}C.
  \end{equation*}
\end{example}

\begin{remark}
  \label{rmk:8}
  The notation $L(z) = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2}$ is contradictory with the notation we wrote in \cref{sec:formal-calculus}.
  However, this notation will acquire a meaning when we treat the notion of weight of an eigendistribution.
  In fact, this notation usually simplifies calculations, as we will see later.
\end{remark}

Let $\mathfrak{g}$ be a Lie superalgebra and $C \in \mathfrak{g}$.
A \emph{Virasoro formal distribution} $L(z) \in \mathfrak{g}[[z^{\pm 1}]]$ with central charge $C$ is a $\mathfrak{g}$-valued formal distribution satisfying \eqref{eq:6} or, equivalently, \eqref{eq:7}, \eqref{eq:8} or \eqref{eq:9}.

\begin{example}[\emph{Current Lie conformal superalgebra}]
  \label{exa:2}
  Let $\mathfrak{g} = \mathfrak{g}_{\zero} \oplus \mathfrak{g}_{\one}$ be a Lie superalgebra.
  A \emph{supersymmetric} bilinear form is a bilinear map $(\bullet| \bullet): \mathfrak{g} \times \mathfrak{g} \to \mathbb{C}$ such that
  \begin{equation*}
    (a| b) = (-1)^{p(a)}(b| a),
  \end{equation*}
  where $a$ and $b$ are homogeneous elements of $\mathfrak{g}$.
  Alternatively, we can define a supersymmetric bilinear form as a bilinear form that vanishes on $\mathfrak{g}_{\zero} \oplus \mathfrak{g}_{\one}$ and $\mathfrak{g}_{\one} \oplus \mathfrak{g}_{\zero}$, symmetric on $\mathfrak{g}_{\zero} \oplus \mathfrak{g}_{\zero}$ and antisymmetric on $\mathfrak{g}_{\one} \oplus \mathfrak{g}_{\one}$.
  A bilinear form $(\bullet| \bullet): \mathfrak{g} \times \mathfrak{g} \to \mathbb{C}$ is said \emph{invariant} if
  \begin{equation*}
    ([a, b]| c) = (a| [b, c])\quad \text{for }a, b, c \in \mathfrak{g}.
  \end{equation*}

  Let $\mathfrak{g}$ be a Lie superalgebra endowed with a supersymmetric invariant bilinear form $(\bullet| \bullet)$.
  The associated \emph{loop algebra}, denoted by $\tilde{\mathfrak{g}}$, is the superalgebra $\tilde{\mathfrak{g}} = \mathfrak{g} \otimes \mathbb{C}[t, t^{-1}] = \mathfrak{g}[t, t^{-1}]$, endowed with the superbracket defined by
  \begin{equation*}
    [a\otimes f(t), b\otimes g(t)] = [a, b]\otimes f(t)g(t) \quad \text{for }a, b \in \mathfrak{g}\text{ and }f(t), g(t) \in \mathbb{C}[t, t^{-1}]
  \end{equation*}
  and with parity given by $p(a\otimes f(t)) = p(a)$.
  This makes $\tilde{\mathfrak{g}}$ into a Lie superalgebra.
  Replacing $a\otimes t^n$ by $at^n$ for brevity, the commutation relations become
  \begin{equation*}
    [at^m, bt^n] = [a, b]t^{m + n} \quad \text{for }a, b \in \mathfrak{g}\text{ and }m, n \in \mathbb{Z}.
  \end{equation*}
  The central extension of the loop algebra is the algebra $\hat{\mathfrak{g}} = \tilde{\mathfrak{g}} \oplus \mathbb{C}K$ with the superbracket:
  \begin{equation*}
    \begin{split}
    [at^m, bt^n] &= [a, b]t^{m + n} + m\delta_{m, -n}(a| b)K \quad \text{for }a, b \in \mathfrak{g}\text{ and }m, n \in \mathbb{Z}, \\
    [\hat{\mathfrak{g}}, K] &= 0
    \end{split}
  \end{equation*}
  and with parity given by $p(K) = \zero$.
  This makes $\hat{\mathfrak{g}}$ into a Lie superalgebra called the \emph{affinization} of $\mathfrak{g}$.
  If $\mathfrak{g}$ is a finite-dimensional simple Lie superalgebra, then the affinization of $\mathfrak{g}$ leads to a \emph{Kac-Moody affinization}.
  We now construct $\hat{\mathfrak{g}}$-valued formal distributions by setting
  \begin{equation*}
    a(z) = \sum_{n \in \mathbb{Z}}at^nz^{-n - 1} \quad \text{for }a \in \mathfrak{g}.
  \end{equation*}
  These formal distributions are called \emph{currents}.
  In terms of currents, the commutation relations become:
  \begin{equation*}
    \begin{split}
    [a(z), b(w)] &= \delta(z, w)[a, b](w) + \partial_w\delta(z, w)K(a| b), \\
    [a(z), K] &= 0.
    \end{split}
  \end{equation*}
  In terms of the $\lambda$-bracket, the commutation relations become:
  \begin{equation*}
    \begin{split}
    [a(z)_{\lambda}b(z)] &= [a(z), b(z)] + (a| b)K\lambda, \\
    [a(z)_{\lambda}K] &= 0.
    \end{split}
  \end{equation*}
  By \Cref{thr:6}, $\{a(z) \mid a \in \mathfrak{g}\} \cup \{K\}$ is a local family.
  Therefore, $(\hat{\mathfrak{g}}, \{a(z) \mid a \in \mathfrak{g}\} \cup \{K\})$ is a formal distribution Lie superalgebra.
  Moreover, we can verify directly that $(\hat{\mathfrak{g}}, \{a(z) \mid a \in \mathfrak{g}\} \cup \{K\}, -\partial_t)$ is regular.
  In a similar way to the Virasoro Lie conformal algebra, we obtain the current Lie conformal superalgebra
  \begin{equation*}
    \Cur(\mathfrak{g}) = \mathbb{C}[\partial]\mathfrak{g} \oplus \mathbb{C}K.
  \end{equation*}
  Let $\mathfrak{g}$ be an abelian Lie superalgebra.
  In that case, $\Cur(\mathfrak{g})$ is known as the \emph{conformal algebra of free bosons} associated with the free bosons algebra $\hat{\mathfrak{g}}$, the latter being endowed with the relations $[at^m, bt^n] = m(a| b)\delta_{m, -n}K$.
\end{example}

\begin{example}[\emph{Fermionic Lie conformal superalgebra}]
  \label{exa:3}
  Let $V = V_{\zero} \oplus V_{\one}$ be a superspace.
  A bilinear form $\langle\bullet, \bullet\rangle: V \times V \to \mathbb{C}$ is \emph{antisupersymmetric} if it satisfies the relation
  \begin{equation*}
    \langle a, b\rangle = -(-1)^{p(a)}\langle b, a\rangle
  \end{equation*}
  for homogeneous elements $a, b \in V$.
  Alternatively, we can define an antisymmetric bilinear form as a bilinear form that vanishes on $V_{\zero} \oplus V_{\one}$ and $V_{\one} \oplus V_{\zero}$, is antisymmetric on the even part $V_{\zero} \oplus V_{\zero}$ and symmetric on the odd part $V_{\one} \oplus V_{\one}$.

  The \emph{Clifford affinization} of $V$ is defined by
  \begin{equation*}
    \widehat{V} = V[t, t^{-1}] \oplus \mathbb{C}K
  \end{equation*}
  with the superbracket:
  \begin{equation*}
    \begin{split}
      [at^m, bt^n] &= \delta_{m, -n - 1}\langle a, b\rangle K \quad \text{for }a, b \in V\text{ and }m, n \in \mathbb{Z}, \\
      [at^m, K] &= 0
    \end{split}
  \end{equation*}
  and with parity given by $p(at^n) = p(a)$ and $p(K) = \zero$.
  This makes $\widehat{V}$ into a Lie superalgebra.
  We now construct $\widehat{V}$-valued formal distributions by setting
  \begin{equation*}
    a(z) = \sum_{n \in \mathbb{Z}}at^nz^{-n - 1} \quad \text{for }a \in V.
  \end{equation*}
  In terms of formal distributions, the commutation relations become:
  \begin{equation*}
    \begin{split}
      [a(z), b(w)] &= \delta(z, w)\langle a, b\rangle K, \\
      [a(z), K] &= 0.
    \end{split}
  \end{equation*}
  In terms of the $\lambda$-bracket, the commutation relations become:
  \begin{equation*}
    \begin{split}
      [a(z)_{\lambda}b(z)] &= \langle a, b\rangle K, \\
      [a(z)_{\lambda}K] &= 0.
    \end{split}
  \end{equation*}
  As before, we obtain a regular formal distribution Lie superalgebra $(\widehat{V}, \{a(z) \mid a \in V\} \cup \{K\}, -\partial_t)$ from which we obtain the fermionic Lie conformal superalgebra
  \begin{equation*}
    F(V) = \mathbb{C}[\partial]V \oplus \mathbb{C}K.
  \end{equation*}
\end{example}

\subsection{Fields over vector spaces}
\label{sec:fields-over-vector}

In this section, we fix a vector superspace $V = V_{\zero} \oplus V_{\one}$ and all formal distributions are $\End(V)$-valued unless otherwise stated.
Let $a(z)$ be a formal distribution.
Set
\begin{align*}
  a(z)_+ &= \sum_{n \le -1}a_{(n)}z^{-n - 1}, \\
  a(z)_- &= \sum_{n \ge 0}a_{(n)}z^{-n - 1}.
\end{align*}

Let $a(z)$ and $b(z)$ be two formal distributions.
We define the \emph{normal product} between $a(z)$ and $b(z)$ as the following formal distribution in two variables
\begin{equation*}
  :a(z)b(w): = a(z)_+b(w) + p(a, b)b(w)a(z)_-.
\end{equation*}

\begin{theorem}[{\cite[Proposition 3.2.3]{nozaradan_introduction_2008}}]
  \label{thr:11}
  Let $(a(z), b(z))$ be a pair of local formal distributions.
  The following identities are known as the operator product expansion of $a(z)$ and $b(w)$:
  \begin{align*}
    a(z)b(w) &= \sum_{j \in \mathbb{N}}a(w)_{(j)}b(w)i_{z, w}\frac{1}{(z - w)^{j + 1}} + :a(z)b(w):, \\
    p(a, b)b(w)a(z) &= \sum_{j \in \mathbb{N}}a(w)_{(j)}b(w)i_{w, z}\frac{1}{(z - w)^{j + 1}} + :a(z)b(w):.
  \end{align*}
\end{theorem}

A formal distribution $a(z)$ is a \emph{field} if
\begin{equation*}
  a(z)b = \sum_{n \in \mathbb{Z}}a_{(n)}bz^{-n - 1} \in V((z)) \quad \text{for } b \in V.
\end{equation*}
The set of fields on $V$ is denoted by $\mathcal{F}(V)$.
Note that
\begin{equation*}
  \mathcal{F}(V) = \Hom(V, V((z))).
\end{equation*}
Therefore, we can define a field $a(z)$ by defining $a(z)b \in V((z))$ for $b \in V$.

\begin{proposition}[{\cite[Proposition 3.3.2]{nozaradan_introduction_2008}}]
  \label{prp:6}
  Let $a(z), b(z) \in \mathcal{F}(V)$ be two fields.
  Then $:a(z)b(z): \in \End(V)[[z,z^{-1}]]$ is again a field where $:a(z)b(z):$ is defined by
  \begin{equation*}
    :a(z)b(z):c = a(z)_+b(z)c + p(a, b)b(z)a(z)_-c \quad \text{for }c \in V.
  \end{equation*}
\end{proposition}

We thus defined the notion of \emph{normal ordered product} $:a(z)b(z):$ between fields $a(z), b(z) \in \mathcal{F}(V)$.
In general, the operation of normal ordered product is neither commutative nor associative.
We follow the convention that the normal ordered ordering is read from right to left, so that by definition
\begin{equation*}
  :a(z)b(z)c(z): = :a(z)(:b(z)c(z):):.
\end{equation*}
The normal ordered product between $a(z)$ and $b(z)$ is explicitly given in the following proposition.

\begin{lemma}[{\cite[Proposition 3.3.3]{nozaradan_introduction_2008}}]
  \label{lmm:2}
  Let $a(z)$ and $b(z)$ be two fields.
  Their normal ordered product is written explicitly as
  \begin{equation*}
    :a(z)b(z): = \sum_{j \in \mathbb{Z}}:ab:_{(j)}z^{-j - 1},
  \end{equation*}
  with
  \begin{equation*}
    :ab:_{(j)}c = \sum_{n \le -1}a_{(n)}b_{(j - n - 1)}c + p(a, b)\sum_{n \ge 0}b_{(j - n - 1)}a_{(n)}c \quad \text{for }c \in V.
  \end{equation*}
\end{lemma}

\begin{lemma}
  \label{lmm:3}
  Consider $s$ fields $a^1(z), \dots, a^s(z) \in \mathcal{F}(V)$ with $s \ge 2$ and $b \in V$.
  For $l \in \mathbb{Z}$,
  \begin{equation*}
    :a^1(z)a^2(z)\dots a^s(z):_{(l)}b = \sum_{n_1, \dots, n_{s - 1} \in \mathbb{N}}\sum_{k = 0}^{s - 1}R^{l, k}_{n_1, \dots, n_{s - 1}}(a^1(z), \dots, a^s(z))b,
  \end{equation*}
  where
  \begin{align*}
    &R^{l, k}_{n_1, \dots, n_{s - 1}}(a^1(z), \dots, a^s(z)) = \\
    &\sum_{\substack{1 \le i_1 < \dots < i_k \le s - 1 \\ 1 \le j_1 < \dots < j_{s - 1 - k} \le s - 1 \\ \{i_1, \dots, i_k\} \cup \{j_1, \dots, j_{s - 1 - k}\} = \{1, \dots, s - 1\}}}a^{j_1}_{(-n_{j_1} - 1)}\dots a^{j_{s - 1 - k}}_{(-n_{j_{s - 1 - k}} - 1)}a^s_{(l - k - \sum_{r = 1}^k n_{i_r} + \sum_{r = 1}^{s - 1 - k}n_{j_r})}a^{i_k}_{(n_{i_k})}\dots a^{i_1}_{(n_{i_1})}.
  \end{align*}
\end{lemma}

\begin{proof}
  This follows from \Cref{lmm:2} and induction on $s$.
\end{proof}

Now let's extend the $j$-products.
For $j \in \mathbb{N}$, set
\begin{equation}
  \label{eq:10}
  a(w)_{(-1 - j)}b(w) = \frac{:(\partial^j_wa(w))b(w):}{j!}.
\end{equation}

\begin{theorem}[{\cite[Proposition 3.4.3]{nozaradan_introduction_2008}}]
  \label{thr:12}
  The $j$-products \eqref{eq:2} and \eqref{eq:10} are special cases of the following generalized $j$-product defined by
  \begin{equation*}
    a(w)_{(j)}b(w)c = \Res_z(i_{z, w}(z - w)^ja(z)b(w)c - p(a, b)i_{w, z}(z - w)^jb(w)a(z)c) \quad \text{for }c \in V.
  \end{equation*}
\end{theorem}

The usual properties of $j$-products for $j \in \mathbb{N}$ carry over to the generalized $j$-products.

\begin{proposition}[{\cite[Proposition 3.4.4]{nozaradan_introduction_2008}}]
  \label{prp:7}
  Let $a(z)$ and $b(z)$ be fields.
  For $j \in \mathbb{Z}$:
  \begin{enumerate}
  \item $(\partial_za(z))_{(j)}b(z) = -ja(z)_{(j - 1)}b(z)$;
  \item $\partial_z(a(z)_{(j)}b(z)) = (\partial_za(z))_{(j)}b(z) + a(z)_{(j)}\partial_zb(z)$.
  \end{enumerate}
\end{proposition}

\begin{lemma}[Dong's lemma {\cite[Lemma 3.2]{kac_vertex_1998}}]
  \label{lmm:4}
  If $a(z)$, $b(z)$ and $c(z)$ are pairwise mutually local fields, then $(a(z), b(z)_{(n)}c(z))$ is a local pair of fields as well for $n \in \mathbb{Z}$.
\end{lemma}

Let $L(z)$ be a formal distribution.
An \emph{eigendistribution} of \emph{weight} $\Delta_a$ with respect to $L(z)$ is a formal distribution $a(z)$ satisfying
\begin{equation}
  \label{eq:11}
  [L_{\lambda}a] = (\partial + \Delta_a\lambda)a + O(\lambda^2),
\end{equation}
where $O(\lambda^2)$ denotes sums of terms of monomials $s\lambda^j$ with $j \ge 2$.
If $L$ is a Virasoro formal distribution, $\Delta_a$ is called the \emph{conformal weight}.
Clearly, $a(z)$ is an eigendistribution in the sense that it is an eigenvector of the endomorphism $L_{(1)}$ whose action is defined by $L_{(1)}(b) = L_{(1)}b$.
Indeed, \eqref{eq:11} implies $L_{(1)}a = \Delta_aa$.
Note that, by definition, a Virasoro formal distribution $L(z)$ is an eigendistribution of conformal weight $2$ with respect to itself.

\begin{theorem}[{\cite[Proposition 3.7.4]{nozaradan_introduction_2008}}]
  \label{thr:13}
  If $a(z)$ and $b(z)$ have weights $\Delta_a$ and $\Delta_b$ with an even formal distribution $L$, then $\Delta_{a_{(n)}b} = \Delta_a + \Delta_b - n - 1$ with respect to $L$.
  In particular, $\Delta_{:ab:} = \Delta_a + \Delta_b$ and $\Delta_{\partial a} = \Delta_a + 1$.
\end{theorem}

The expansion of an eigendistribution $a(z)$ of weight $\Delta_a$ is often adapted as follows
\begin{equation*}
  a(z) = \sum_{n \in \mathbb{Z} - \Delta_a}a_nz^{-n - \Delta_a}.
\end{equation*}
This justifies the way we wrote the Virasoro formal distribution when we defined the Virasoro Lie conformal algebra.
By comparison with the usual way of writing $a(z) = \sum_{m \in \mathbb{Z}}a_{(m)}z^{-m - 1}$, we must have
\begin{equation*}
  a_{(m)} = a_{m - \Delta_a + 1} \quad \text{for }m \in \mathbb{Z},
\end{equation*}
or the other way
\begin{equation*}
  a_n = a_{(n + \Delta_a - 1)} \quad \text{for }n \in \mathbb{Z} - \Delta_a.
\end{equation*}
One of the interesting features of this change of notation is that it reveals the gradation of the superbracket.

\begin{proposition}[{\cite[Proposition 3.7.6]{nozaradan_introduction_2008}}]
  \label{prp:8}
  In the new notation, we can write
  \begin{equation*}
    [a_m, b_n] = \sum_{j \in \mathbb{N}}\binom{m + \Delta_a - 1}{j}(a_{(j)}b)_{m + n}.
  \end{equation*}
\end{proposition}

An eigendistribution $a(z)$ is called \emph{primary} of conformal weight $\Delta_a$ if
\begin{equation*}
  [L_{\lambda}a(z)] = (\partial_z + \Delta_a\lambda)a(z),
\end{equation*}
where $L(z)$ is a Virasoro formal distribution.

Let's fix an operator $T \in \End(V)$.
A formal distribution $a(z)$ is \emph{covariant} with respect to $T$ if
\begin{equation*}
  [T, a(z)] = \partial_za(z).
\end{equation*}

\begin{theorem}[{\cite[Lemma 1]{callegaro_introduction_2017}}]
  \label{thr:14}
  Assume that $\vac \in V$ is such that $T\vac = 0$.
  Then:
  \begin{enumerate}
  \item For any translation covariant field $a(z)$ we have $a(z)\vac \in V[[z]]$;
  \item Set $a = a_{(-1)}\vac$.
    Then
    \begin{equation*}
      a(z)\vac = e^{Tz}a = \sum_{n = 0}^{\infty}\frac{T^n(a)}{n!}z^n.
    \end{equation*}
  \end{enumerate}
\end{theorem}

Let
\begin{equation*}
  \mathcal{F}_{\tc} = \{a(z) \in \mathcal{F}(V) \mid [T, a(z)] = \partial_za(z)\}
\end{equation*}
be the subspace of translation covariant fields.

\begin{lemma}[{\cite[Lemma 3]{callegaro_introduction_2017}}]
  \label{lmm:5}
  $\mathcal{F}_{\tc}$ contains $\Id_V$, it is $\partial_z$-invariant and is closed under all $n$-products, i.e., $\partial_za(z), a(z)_{(n)}b(z) \in \mathcal{F}_{\tc}$ for $a(z), b(z) \in \mathcal{F}_{\tc}$ and $n \in \mathbb{Z}$.
\end{lemma}

By \Cref{thr:14}, we can define a linear map
\begin{align*}
  \fs: \mathcal{F}_{\tc} &\to V, \\
  \fs(a(z)) &= a(z)\vac|_{z = 0}
\end{align*}
called the \emph{field-state correspondence}.

\begin{lemma}[{\cite[Proposition 4.3.2]{nozaradan_introduction_2008}}]
  \label{lmm:6}
  Let $A$ be a linear operator on a linear space $V$.
  The formal differential equation
  \begin{equation*}
    \frac{df(z)}{dz} = Af(z) \quad \text{for }f(z) \in V[[z]]
  \end{equation*}
  admits a unique solution, given an initial condition $f(0) = f_0$.
\end{lemma}

\begin{theorem}
  \label{thr:15}
  Let $a(z), b(z) \in \mathcal{F}_{\tc}$, $a = \fs(a(z))$, $b = \fs(b(z))$ and $n \in \mathbb{Z}$.
  Write $a(z) = \sum_{j \in \mathbb{Z}}a_{(j)}z^{-j - 1}$ and $b(z) = \sum_{j \in \mathbb{Z}}b_{(j)}z^{-j - 1}$.
  Then:
  \begin{enumerate}
  \item $\fs(\Id_V) = \vac$;
  \item $\fs(\partial_za(z)) = Ta$;
  \item \emph{($n$-product identity)} $\fs(a(z)_{(n)}b(z)) = a_{(n)}b$;
  \item $T(a_{(n)}b) = -na_{(n - 1)}b + a_{(n)}Tb$;
  \item $e^{Tw}a(z)e^{-Tw} = i_{z, w}a(z + w)$;
  \item \emph{(Borcherds identity)} If $a(z)$ and $b(z)$ are local then for $c \in V$,
    \begin{equation*}
      i_{z, w}(z - w)^na(z)b(w)c - p(a, b)i_{w, z}(z - w)^nb(w)a(z)c = \sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}a(w)_{(n + j)}b(w)c;
    \end{equation*}
  \item \emph{(Skewsymmetry)} If $a(z)$ and $b(z)$ are local then
    \begin{equation*}
      a(z)b = p(a, b)e^{Tz}b(-z)a.
    \end{equation*}
  \end{enumerate}
\end{theorem}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item Clear.
  \item
    \begin{align*}
      \fs(\partial_za(z)) &= [T, a(z)]\vac|_{z = 0} \\
      &= (Ta(z) - p(a(z), T)a(z)T)\vac|_{z = 0} \\
      &= Ta.
    \end{align*}
  \item By definition, we have
    \begin{equation*}
      \fs(a(z)_{(n)}b(z)) = a(z)_{(n)}b(z)\vac|_{z = 0},
    \end{equation*}
    and the right hand side, by \Cref{thr:12}, is equal to
    \begin{equation*}
      \Res_w(a(w)b(z)i_{w, z}(w - z)^n\vac - p(a, b)b(z)a(w)i_{z, w}(w - z)^n\vac)|_{z = 0}.
    \end{equation*}
    Now, since $a(w)\vac \in V[[w]]$ and $i_{z, w}(w - z)^n$ has only nonnegative powers of $w$, we have
    \begin{equation*}
      \Res_w(b(z)a(w)i_{z, w}(w - z)^n\vac) = 0.
    \end{equation*}
    For the first term, since $b(z)\vac \in V[[z]]$, we can let $z = 0$ before we calculate the residue, which gives
    \begin{equation*}
      \Res_w(a(w)b(z)i_{w, z}(w - z)^n\vac)|_{z = 0} = \Res_w(a(w)bw^n) = a_{(n)}b.
    \end{equation*}
  \item This follows from $[T, a_{(n)}] = -na_{(n - 1)}$ which is equivalent to translation covariance of the field $a(z)$.
  \item Set $b_1(z, w) = i_{z, w}a(z + w)$ and $b_2(z, w) = e^{Tw}a(z)e^{-Tw}$.
    By \Cref{prp:1} and translation covariance,
    \begin{align*}
      \frac{\partial b_1(z, w)}{\partial w} &= \sum_{j \in \mathbb{N}}\frac{\partial^{j + 1}_za(z)}{j!}w^j = \sum_{j \in \mathbb{N}}\frac{\partial^j[T, a(z)]}{j!} = [T, b_1(z, w)], \\
      b_1(z, 0) &= a(z), \\
      \frac{\partial b_1(z, w)}{\partial w} &= Te^{Tw}a(z)e^{-Tw} + e^{Tw}a(z)(-T)e^{-Tw} = [T, b_2(z, w)], \\
      b_2(z, 0) &= a(z).
    \end{align*}
    By \Cref{lmm:6}, $b_1(z, w) = b_2(z, w)$.
  \item The left hand side of the Borcherds identity is a local formal distribution in $z$ and $w$ applied to $c$.
    Apply \Cref{thr:6} to it to get that it is equal to
    \begin{equation*}
      \sum_{j \in \mathbb{N}} \frac{\partial^j_w\delta(z,w)}{j!}c^j(w)c,
    \end{equation*}
    where
    \begin{align*}
      c^j(w)c &= (\Res_z(z - w)^j(i_{z, w}(z - w)^na(z)b(w) - p(a, b)i_{w, z}(z - w)^nb(w)a(z)))c \\
      &= \Res_z(i_{z, w}(z - w)^{n + j}a(z)b(w)c - p(a, b)i_{w, z}(z - w)^{n + j}b(w)a(z)c) \\
      &= a(w)_{(n + j)}b(w)c.
    \end{align*}
  \item By locality, there is $N \in \mathbb{Z}$ such that
    \begin{equation*}
      (z - w)^Na(z)b(w) = p(a, b)(z - w)^Nb(w)a(z).
    \end{equation*}
    Apply $\vac$ to both sides; by \Cref{thr:14}, we get
    \begin{equation*}
      (z - w)^Na(z)e^{Tw}b = p(a, b)(z - w)^Nb(w)e^{Tz}a.
    \end{equation*}
    Now use (v) and \Cref{prp:1},
    \begin{equation*}
      RHS = p(a, b)(z - w)^Ne^{Tz}e^{-Tz}b(w)e^{Tz}a = p(a, b)(z - w)^Ne^{Tz}i_{w, z}b(w - z)a.
    \end{equation*}
    For $N$ big enough, this is a formal power series in $(z - w)$, so we can set $w = 0$ and get
    \begin{equation*}
      LHS = z^Na(z)b = p(a, b)e^{Tz}z^Nb(-z)a = RHS,
    \end{equation*}
    which proves the desired formula. \qedhere
  \end{enumerate}
\end{proof}

\begin{lemma}
  \label{lmm:7}
  Let $\mathcal{F}' \subseteq \mathcal{F}_{\tc}$ and $a(z) \in \mathcal{F}_{\tc}$.
  Assume that:
  \begin{enumerate}
  \item $\fs(a(z)) = 0$;
  \item $a(z)$ is local with any element in $\mathcal{F}'$;
  \item $\fs(\mathcal{F}') = V$.
  \end{enumerate}
  Then $a(z) = 0$.
\end{lemma}

\begin{proof}
  Let $b(z) \in \mathcal{F}'$.
  By the locality of $a(z)$ and $b(z)$, we have $(z - w)^N[a(z), b(w)] = 0$, for some $N \in \mathbb{N}$.
  Apply $\vac$ to both sides to get
  \begin{equation*}
    (z - w)^Na(z)b(w)\vac = \pm(z - w)^Nb(w)a(z)\vac.
  \end{equation*}
  By the property (i), we have $a_{(-1)}\vac = 0$ and $a(z)$ is translation covariant, hence by \Cref{thr:14}(i), $b(w)\vac \in V[[w]]$, so we can let $w = 0$ and get $z^Na(z)b = 0$, which means $a_{(n)}b = 0$ for any $n \in \mathbb{Z}$.
  This is true for any $b \in V$ by the property (iii).
  So in fact, we have $a(z) = 0$.
\end{proof}

\subsection{Vertex superalgebras}
\label{sec:vertex-superalgebras}

A \emph{vertex superalgebra} is the data consisting of four elements $(V, \vac, T, Y)$ satisfying the following properties:
\begin{enumerate}
\item $V$ is a superspace called the \emph{state space};
\item $\vac \in V_{\zero}$ is called the \emph{vacuum vector};
\item $T \in \End(V)_{\zero}$ is called the \emph{translation operator};
\item $Y: V \to \mathcal{F}(V)$ is a linear and parity preserving map called the \emph{state-field correspondence}.
\end{enumerate}
By parity preserving map we mean that for $a \in V$ homogeneous, $p(a_{(n)}) = p(a)$ for $n \in \mathbb{Z}$.
The operator $Y(a) = Y(a, z) \in \End(V)[[z^{\pm 1}]]$ for $a \in V$ is sometimes called a \emph{vertex operator}.
The data must satisfy the following axioms for $a \in V$:
\begin{enumerate}
\item (Vacuum axiom)
  \begin{align*}
    Y(\vac,z) &= \Id_V, \\
    Y(a, z)\vac &\in V[[z]], \\
    Y(a, z)\vac|_{z = 0} &= a, \\
    T\vac &= 0;
  \end{align*}
\item (Translation covariance) $[T, Y(a, z)] = \partial_zY(a, z)$;
\item (Locality) $\{Y(a, z) \mid a \in V\}$ is a local family of fields.
\end{enumerate}

\begin{remark}
  \label{rmk:9}
  Writing $Y(a, z) = \sum_{n \in \mathbb{Z}}a_{(n)}z^{-n - 1}$ for $a \in V$, the first two vertex superalgebra axioms imply that for $a \in V$:
  \begin{align*}
    \vac_{(n)}a &= \delta_{n, -1}a \quad \text{for }n \in \mathbb{Z}, \\
    a_{(n)}\vac &= \delta_{n, -1}a \quad \text{for }n \in \mathbb{N} \cup \{-1\}, \\
    [T, a_{(n)}] &= -na_{(n - 1)} \quad \text{for }n \in \mathbb{Z}.
  \end{align*}
\end{remark}

A vertex superalgebra with odd subspace equal to $0$ is called a \emph{vertex algebra}.

\begin{remark}
  \label{rmk:10}
  The even part $V_{\zero}$ of a vertex superalgebra $V$ is a vertex algebra.
\end{remark}

\begin{remark}
  \label{rmk:11}
  The translation covariance axiom together with \Cref{thr:14} permit us to express $T$ by
  \begin{equation}
    \label{eq:12}
    Ta = a_{(-2)}\vac.
  \end{equation}
  As a consequence, the data of the translation operator $T$ is redundant.
  The original definition with $T$ appears to be more natural, though.
\end{remark}

A \emph{vertex superalgebra homomorphism} $f: (V, \vac, T, Y) \to (V', \vac', T', Y')$ is a linear map $f: V \to V'$ such that $f(\vac) = \vac'$ and for $a, b \in V$,
\begin{equation*}
  f(Y(a, z)b) = \sum_{n \in \mathbb{Z}}f(a_{(n)}b)z^{-n - 1} = \sum_{n \in \mathbb{Z}}f(a)_{(n)}f(b)z^{-n - 1} = Y'(f(a), z)f(b).
\end{equation*}
We obtain the category of vertex superalgebras.

\begin{remark}
  \label{rmk:12}
  It is easy to verify that category of vertex superalgebras is abelian in a natural way.
\end{remark}

\begin{example}[\emph{Commutative vertex algebras}]
  \label{exa:4}
  A vertex algebra $V$ is called \emph{commutative} if all vertex operators $Y(a, z)$, $a \in V$ commute with each other.

  Suppose we are given a commutative vertex algebra $V$.
  Then for $a, b \in A$,
  \begin{equation*}
    Y(a, z)b = Y(a, z)Y(b, w)\vac|_{w = 0} = Y(b, w)Y(a, z)\vac|_{w = 0}.
  \end{equation*}
  But by the vacuum axiom, the last expression has no negative power of $z$.
  Therefore $Y(a, z)b \in V[[z]]$ for $a, b \in V$ so $Y(a, z) \in \End(V)[[z]]$ for $a \in V$.
  Conversely, suppose that we are given a vertex algebra $V$ in which $Y(a, z) \in \End(V)[[z]]$ for $a \in V$.
  Observe that if the equality $(z - w)^Nf_1(z, w) = (z - w)^Nf_2(z, w)$ holds for $f_1(z, w), f_2(z, w) \in \mathbb{C}[[z, w]]$ and $N \in \mathbb{N}$, then necessarily $f_1(z, w) = f_w(z, w)$.
  Therefore, we obtain that $[Y(a, z), Y(b, w)] = 0$ for all $a, b \in V$, so $V$ is commutative.

  Thus, a commutative vertex algebra may be defined as one in which all $Y(a, z)$ belong to $\End(V)[[z]]$.

  Denote by $Y_a$ the endomorphism of a commutative vertex algebra $V$ which is the constant term of $Y(a, z)$ for $a \in V$, and define a bilinear operation $\circ$ on $V$ by setting $a\circ b = Y_ab$.
  By construction, $Y_aY_b = Y_bY_a$.
  This implies both commutativity and associativity of $\circ$.
  Furthermore, the vacuum vector $\vac$ is a unit, and the operator $T$ is a derivation with respect to this product.
  Thus, we have the structure of a differential commutative associative algebra with unit on $V$.

  Conversely, let $V$ be a differential commutative associative algebra with a unit $1$ and a derivation $T$.
  Then $V$ can become a vertex algebra.
  Take $\vac = 1$, and set
  \begin{equation*}
    Y(a, z) = e^{Tz}a \quad \text{for }a \in V.
  \end{equation*}
  It is straightforward to check that all the axioms of a commutative vertex algebra are satisfied.

  Therefore, we obtain an isomorphism between the category of differential commutative associative algebras with unit and the category of commutative vertex algebras.
\end{example}

The theory done in the previous sections translates into the language of vertex superalgebras as the following theorem shows.

\begin{theorem}
  \label{thr:16}
  Let $V$ be a vertex superalgebra.
  For $a, b, c \in V$ and $m, n \in \mathbb{Z}$:
  \begin{enumerate}
  \item $Y: V \to \mathcal{F}(V)$ is injective;
  \item $Y(a, z)\vac \in V[[z]]$ and $Y(a, z)\vac = e^{Tz}a$ so $T^ja = j!a_{(-j - 1)}\vac$ for $j \in \mathbb{N}$;
  \item $Y(Ta, z) = \partial_zY(a, z)$ or, equivalently, $(Ta)_{(n)} = -na_{(n - 1)}$;
  \item \emph{($n$-product identity)} $Y(a, z)_{(n)}Y(b, z) = Y(a_{(n)}b, z)$;
  \item $[a_{(m)}, b_{(n)}] = \sum_{j \in \mathbb{N}}\binom{m}{j}(a_{(j)}b)_{(m + n - j)}$;
  \item \emph{($T$ as an even derivation)} $T(Y(a, z)b) = Y(Ta, z)b + Y(a, z)Tb$;
  \item $e^{Tw}Y(a, z)e^{-Tw} = i_{z, w}Y(a, z + w)$;
  \item \emph{(Borcherds identity)}
    \begin{equation*}
      i_{z, w}(z - w)^nY(a, z)Y(b, w)c - p(a, b)i_{w, z}(z - w)^nY(b, w)Y(a, z)c = \sum_{j \in \mathbb{N}}Y(a_{(n + j)}b, w)\frac{\partial^j_w\delta(z, w)}{j!}c;
    \end{equation*}
  \item \emph{(Skewsymmetry)} $Y(a, z)b = p(a, b)e^{Tz}Y(b, -z)a$;
  \item $(a_{(m)}b)_{(n)}c = \sum_{j \in \mathbb{N}}(-1)^j\binom{m}{j}(a_{(m - j)}b_{(n + j)}c - (-1)^mp(a, b)b_{(m + n - j)}a_{(j)}c)$.
  \end{enumerate}
\end{theorem}

\begin{theorem}[Original Borcherds identity]
  \label{thr:17}
  Let $V$ be a vertex superalgebra.
  For $a, b, c \in V$,
  \begin{equation*}
    \sum_{j \in \mathbb{N}}(-1)^j\binom{n}{j}\left(a_{(m + n - j)}(b_{(k + j)}c) - (-1)^np(a, b)b_{(n + k - j)}(a_{(m + j)}c)\right) = \sum_{j \in \mathbb{N}}\binom{m}{j}(a_{(n + j)}b)_{(m + k - j)}c,
  \end{equation*}
  or, equivalently, for $F(z, w) = z^mw(z - w)^k$, where $m, n, k \in \mathbb{Z}$,
  \begin{equation*}
    \begin{split}
      &\Res_{z - w}(Y(Y(a, z - w)b, w)ci_{w, z - w}F(z, w)) = \\
      &\Res_z(Y(a, z)Y(b, w)ci_{z, w}F(z, w)) - \Res_z(Y(b, w)Y(a, z)ci_{w, z}F(z, w)).
    \end{split}
  \end{equation*}
\end{theorem}

Let $V$ be a vertex superalgebra.
A \emph{vertex subalgebra} of $V$ is a subspace of $W$ of $V$ which contains $\vac$ and such that $Y(a, z)b \in W((z))$ for $a, b \in W$.
Because $Ta = a_{(-2)}\vac$ and $\vac \in W$, this implies that $TW \subseteq W$.
Thus, $(W, \vac, T|_{W}: W \to W, Y|_{W}: W \to \mathcal{F}(W))$ is a vertex superalgebra in its own right.
Let $S \subseteq V$ be a subset.
The \emph{vertex subalgebra generated} by $S$ is the smallest vertex subalgebra containing $S$ which is the intersection of all vertex subalgebras containing $S$.
It is denoted $\langle S \rangle$ and we can prove that
\begin{equation*}
  \langle S \rangle = \vspan\{a^1_{(n_1)}\dots a^s_{(n_s)}\vac \mid s \in \mathbb{N}, a^1, \dots, a^s \in S, n_1, \dots, n_s \in \mathbb{Z}\}.
\end{equation*}
The vertex superalgebra $V$ is strongly generated by $S \subseteq V$ if
\begin{equation*}
  V = \vspan\{a^1_{(-n_1 - 1)}\dots a^s_{(-n_s - 1)}\vac \mid s \in \mathbb{N}, a^1, \dots, a^s \in S, n_1, \dots, n_s \in \mathbb{N}\}.
\end{equation*}

An \emph{ideal} of a vertex superalgebra $V$ is a subspace $I$ of $V$ such that $Y(a, z)b \in I((z))$ and $Y(b, z)a \in I((z))$ for all $a \in V$ and $b \in I$.
For example, the kernel of vertex superalgebra homomorphism is an ideal.
A vertex superalgebra is \emph{simple} or \emph{irreducible} if $0$ is the only proper ideal.

\begin{remark}
  \label{rmk:13}
  Note that a right ideal $I$ is automatically $T$-invariant ($TI \subseteq I$) because of \eqref{eq:12}.
  Also, right ideals and $T$-invariant left ideals are automatically two-sided ideals because of skewsymmetry.
  However, to prove that a subspace is an ideal, it is usually easier to check that it is $T$-invariant and a left ideal.
\end{remark}

It follows that for any ideal $I$, $V/I$ inherits a natural \emph{quotient vertex superalgebra} structure $(V/I, \vac + I, T_{V/I}: V/I \to V/I, Y_{V/I}: V/I \to \mathcal{F}(V/I))$.
Let $S \subseteq V$ be a subset.
The \emph{ideal generated} by $S$ is the smallest ideal containing $S$ which is the intersection of all ideals containing $S$.
It is denoted by $(S)$ and we can prove that
\begin{equation*}
  (S) = \vspan\{b_{(n)}T^ma \mid b \in V, n \in \mathbb{Z}, m \in \mathbb{N}, a \in S\}.
\end{equation*}

We don't have examples of vertex superalgebras other than the ones coming from differential algebras.
It turns out is not an easy task to construct nontrivial vertex superalgebras.
We need a preliminary concept to do that task.
A \emph{pre-vertex superalgebra} is a quadruple $(V, \vac, T, \mathcal{F})$ where $V = V_{\zero} \oplus V_{\one}$ is a vector superspace, $\vac \in V_{\zero}$, $T \in \End(V)_{\zero}$ and $\mathcal{F} = \{a^j(z) = \sum_{n \in \mathbb{Z}}a^j_{(n)}z^{-n - 1}\}_{j \in J}$ is a collection of $\End(V)$-valued fields such that for $j \in J$, all $a^j_{(n)}$ for $n \in \mathbb{Z}$ have the same parity.
The above data satisfies the following axioms:
\begin{enumerate}
\item (Vacuum axiom) $T\vac = 0$;
\item (Translation covariance) $[T, a^j(z)] = \partial_za^j(z)$ for $j \in J$;
\item (Locality) $a^i(z)$ and $a^j(z)$ are mutually local for $i, j \in J$;
\item (Completeness) $\vspan\{a^{j_1}_{(n_1)}\dots a^{j_s}_{(n_s)}\vac \mid s \in \mathbb{N}, j_i \in J, n_i \in \mathbb{Z}\} = V$.
\end{enumerate}

Let $(V, \vac, T, \mathcal{F})$ be a pre-vertex superalgebra.
Define the following subspaces of $\mathcal{F}(V)$:
\begin{align*}
  \mathcal{F}_{\min} &= \vspan\{a^{j_1}(z)_{(n_1)}(a^{j_2}(z)_{(n_2)}\dots(a^{j_s}(z)_{(n_s)}\Id_V)\dots) \mid s \in \mathbb{N}, n_i \in \mathbb{Z}, j_i \in J\}, \\
  \mathcal{F}_{\max} &= \{a(z) \in \mathcal{F}(V) \mid [T, a(z)] = \partial_za(z)\text{ and for }j \in J, (a(z),a^j(z))\text{ is a local pair}\}.
\end{align*}
We have inclusions
\begin{equation*}
  \mathcal{F} \subseteq \mathcal{F}_{\min} \subseteq \mathcal{F}_{\max} \subseteq \mathcal{F}_{\tc}.
\end{equation*}
The first inclusion is because for $a(z) \in \mathcal{F}$, $a(z)_{(-1)}\Id_V = a(z) \in \mathcal{F}_{\min}$.
The second inclusion is by \Cref{lmm:5} and Dong's Lemma.
The last inclusion is by definition.

Now we come to a very fundamental theorem, which allows us to construct noncommutative vertex superalgebras and is the backbone of several of our most important examples of vertex superalgebras.

\begin{theorem}[Extension theorem]
  \label{thr:18}
  Let $(V, \vac, T, \mathcal{F})$ be a pre-vertex superalgebra and let $\mathcal{F}_{\min}, \mathcal{F}_{\max}$ be defined as above.
  Then:
  \begin{enumerate}
  \item $\mathcal{F}_{\min} = \mathcal{F}_{\max}$;
  \item The linear map
    \begin{align*}
      \fs: \mathcal{F}_{\max} &\to V, \\
      \fs(a(z)) &= a(z)\vac|_{z = 0}
    \end{align*}
    is well-defined and bijective.
    Denote by $Y: V \to \mathcal{F}(V)$ the inverse map;
  \item $(V, \vac, T, Y)$ is a vertex superalgebra with $Y: V \to \mathcal{F}(V)$ given explicitly by
    \begin{equation}
      \label{eq:13}
      Y(a^{j_1}_{(n_1)}a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac) = a^{j_1}(z)_{(n_1)}(a^{j_2}(z)_{(n_2)}\dots (a^{j_s}(z)_{(n_s)}\Id_V)\dots),
    \end{equation}
    for $s \in \mathbb{N}$, $j_1, \dots, j_s \in J$ and $n_1, \dots, n_s \in \mathbb{Z}$;
  \item The vertex superalgebra $V$ is generated by $\{a^j_{(-1)}\vac \mid j \in J\}$;
  \item The only vertex superalgebra structure on $V$ with $Y(a^j_{(-1)}\vac, z) = a^j(z)$ for $j \in J$ is the one given by \eqref{eq:13}.
  \end{enumerate}
\end{theorem}

\begin{proof}
  By \Cref{thr:14}, the map $\fs$ is well defined as was noted already in \Cref{sec:fields-over-vector}.
  By \Cref{thr:15}(i) and \Cref{thr:15}(iii), $\fs|_{\mathcal{F}_{\min}}: \mathcal{F}_{\min} \to V$ is given by
  \begin{equation*}
    \fs|_{\mathcal{F}_{\min}}(a^{j_1}(z)_{(n_1)}(a^{j_2}(z)_{(n_2)}\dots (a^{j_s}(z)_{(n_s)}\Id_V)\dots)) = a^{j_1}_{(n_1)}a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac.
  \end{equation*}
  By the completeness axiom of pre-vertex superalgebras, $\fs|_{\mathcal{F}_{\min}}$ is surjective.

  The map $\fs: \mathcal{F}_{\max} \to V$ is injective using \Cref{lmm:7} with $\mathcal{F}' = \mathcal{F}_{\min}$.
  Recall the inclusion $\mathcal{F}_{\min} \subseteq \mathcal{F}_{\max}$.
  We know that $\fs|_{\mathcal{F}_{\min}}$ is surjective and $\fs$ is injective, so we can conclude that is in fact bijective and $\mathcal{F}_{\min} = \mathcal{F}_{\max}$.
  This proves (i) and (ii).

  For (iii), we need to show that $Y(a, z)$ is translation covariant for $a \in V$ and that each pair $(Y(a, z), Y(b, w))$ is local for $a, b \in V$.
  Translation covariance comes from \Cref{lmm:5} and locality comes from Dong's lemma.

  Note that we have $Y(a^j_{(-1)}\vac, z) = a^j(z)$ for $j \in J$.
  Therefore, $(a^j_{(-1)}\vac)_{(n)} = a^j_{(n)}$ for $j \in J$ and $n \in \mathbb{Z}$.
  By the completeness axiom, we get (iv).

  Uniqueness of the vertex superalgebra structure follows from the completeness axiom of pre-vertex superalgebras, the $n$-product identity and the fact that $\vac \mapsto \Id_V$ in any vertex superalgebra.
  This finishes (v) and the proof of the theorem.
\end{proof}

\begin{corollary}
  \label{crl:1}
  Let $V$ be a vertex superalgebra, $s \in \mathbb{N}$, $a^1, \dots, a^s \in V$ and $n_1, \dots, n_s \in \mathbb{Z}$.
  Then
  \begin{equation*}
    Y(a^1_{(n_1)}a^2_{(n_2)}\dots a^s_{(n_s)}\vac, z) = Y(a^j, z)_{(n_1)}(Y(a^2, z)_{(n_2)}\dots (Y(a^s, z)_{(n_s)}\Id_V)\dots).
  \end{equation*}
  In particular, for $s, n_1, \dots, n_s \in \mathbb{N}$ and $a^1, \dots, a^s \in V$,
  \begin{equation*}
    Y(a^1_{(-n_1 - 1)}\dots a^s_{(-n_s - 1)}\vac, z) = \frac{:\partial^{n_1}_zY(a^1, z)\dots \partial^{n_s}_zY(a^s, z):}{n_1!\dots n_s!}.
  \end{equation*}
  If $V$ is given by a pre-vertex superalgebra $(V, \vac, T, \mathcal{F})$ as in the Extension Theorem, where $\mathcal{F} = \{a^j(z)\}_{j \in J}$, then for $s, n_1, \dots, n_s \in \mathbb{N}$ and $j_1, \dots, j_s \in J$,
  \begin{equation*}
    Y(a^{j_1}_{(-n_1 - 1)}\dots a^{j_s}_{(-n_s - 1)}\vac, z) = \frac{:\partial^{n_1}_za^{j_1}(z)\dots \partial^{n_s}_za^{j_s}(z):}{n_1!\dots n_s!}.
  \end{equation*}
\end{corollary}

Let $(\mathfrak{g}, \mathfrak{F}, T_0)$ be a regular formal distribution Lie superalgebra with $\mathfrak{F} = \{a^j(z)\}_{j \in J}$ and let $\mathfrak{g}_-$ be the annihilation subalgebra.
Since $T_0(\mathfrak{g}_-) \subseteq \mathfrak{g}_-$, $DU(T_0): U(\mathfrak{g}) \to U(\mathfrak{g})$ is a $(U(\mathfrak{g}), U(\mathfrak{g}_-))$-bimodule homomorphism.
Consider the trivial representation $0: \mathfrak{g}_- \to \mathfrak{gl}(\mathbb{C})$.
We define:
\begin{align*}
  V &= \Ind^{\mathfrak{g}}_{\mathfrak{g}_-}(\mathbb{C}) = U(\mathfrak{g}) \otimes_{U(\mathfrak{g}_-)} \mathbb{C}, \\
  \pi &= \Ind^{\mathfrak{g}}_{\mathfrak{g}_-}(0): \mathfrak{g} \to \mathfrak{gl}(V), \\
  \vac &= 1\otimes1 \in V, \\
  T &= DU(T_0) \otimes \Id_{\mathbb{C}} \in \End(V)_{\zero}, \\
  \mathcal{F} &= \left\{\pi(a^j(z)) = \sum_{n \in \mathbb{Z}}\pi(a^j_{(n)})z^{-n - 1} \mid j \in J\right\}.
\end{align*}

\begin{theorem}
  \label{thr:19}
  With the notation above, $\mathcal{F}$ consists of fields and $(V, \vac, T, \mathcal{F})$ is a pre-vertex superalgebra.
\end{theorem}

\begin{proof}
  First, we prove that $\pi(a^j(z))$ is a field for all $j \in J$.
  We do this by induction on $s$ in $v = a^{j_1}_{(n_1)}\dots a^{j_s}_{(n_s)}\vac$ where $s \in \mathbb{N}$, $n_1, \dots, n_s \in \mathbb{Z}_-$ and $j_1, \dots, j_s \in J$.
  By \eqref{eq:16}, these elements form a spanning set for $V$.
  For $s = 0$, we have $v = \vac$ and
  \begin{equation*}
    \pi(a^j(z))\vac = \sum_{n \in \mathbb{Z}} a^j_{(n)}\vac z^{-n - 1} = \sum_{n \in \mathbb{Z}_-} a^j_{(n)}\vac z^{-n - 1} \in V((z)).
  \end{equation*}
  The last equality is true because $a_{(n)}\vac = 0$ for $n \in \mathbb{N}$.
  Now we proceed by proving the induction step:
  \begin{align}
    \nonumber
    \pi(a^j(z))v &= \sum_{n \in \mathbb{Z}}a^j_{(n)}a^{j_1}_{(n_1)}\dots a^{j_s}_{(n_s)}\vac z^{-n - 1} \\
    \label{eq:14}
    &= \sum_{n \in \mathbb{Z}} [a^j_{(n)}, a^{j_1}_{(n_1)}]a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac z^{-n - 1} \pm \sum_{n \in \mathbb{Z}}a^{j_1}_{(n_1)}a^j_{(n)}a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac z^{-n - 1}.
  \end{align}
  By the induction hypothesis, the second sum in \eqref{eq:14} is in $V((z))$, so we only need to show that the first sum is also in $V((z))$.
  By \eqref{eq:4},
  \begin{equation}
    \label{eq:15}
    [a^j_{(n)}, a^{j_1}_{(n_1)}] = \sum_{k \in \mathbb{N}}\binom{n}{k}(a^j(z)_{(k)}a^{j_1}(z))_{(n + n_1 - k)}.
  \end{equation}
  By the regularity property, we know that $a^j(z)_{(k)}a^{j_1}(z) \in \mathbb{C}[\partial_z]\mathfrak{F}$, thus we can assume that
  \begin{equation*}
    a^j(z)_{(k)}a^{j_1}(z) = \sum_{l \in J}f^k_l(\partial_z)a^l(z),
  \end{equation*}
  for some polynomials $f^k_l$.
  Since $(a^j(z), a^{j_1}(z))$ is a local pair, there exists $N \in \mathbb{N}$ such that $a^j(z)_{(k)}a^{j_1}(z) = 0$ for $k \ge N$.
  This allows us to rewrite \eqref{eq:15} as
  \begin{equation*}
    [a^j_{(n)}, a^{j_1}_{(n_1)}] = \sum_{0 \le k \le N}\binom{n}{k}\left(\sum_{l \in J}f^k_l(\partial_z)a^l(z)\right)_{(n + n_1 - k)}.
  \end{equation*}
  Therefore, we can rewrite the first sum in \eqref{eq:14} as
  \begin{equation*}
    \sum_{0 \le k \le N}\sum_{n \in \mathbb{Z}}\binom{n}{k}\left(\sum_{l \in J}f^k_l(\partial_z)a^l(z)\right)_{(n + n_1 - k)}a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac z^{-n - 1}.
  \end{equation*}
  By the induction hypothesis, for each $k$,
  \begin{equation*}
    \sum_{n \in \mathbb{Z}}\binom{n}{k}\left(\sum_{l \in J}f^k_l(\partial_z)a^l(z)\right)_{(n + n_1 - k)}a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac z^{-n - 1} \in V((z)).
  \end{equation*}
  Finally, the first sum in \eqref{eq:14} is also in $V((z))$.

  We now verify the four axioms of a pre-vertex superalgebra:
  \begin{enumerate}
  \item $T\vac = DU(T_0) \otimes \Id_{\mathbb{C}}(1\otimes1) = DU(T_0)(1)\otimes1 = 0\otimes1 = 0$.
  \item Recall that $T$ is an even endomorphism.
    For $j \in J$,
    \begin{equation*}
      [T, \pi(a^j(z))] = \left[T, \sum_{n \in \mathbb{Z}}\pi(a^j_{(n)})z^{-n - 1}\right] = \sum_{n \in \mathbb{Z}}[T, \pi(a^j_{(n)})]z^{-n - 1} = \sum_{n \in \mathbb{Z}}T\pi(a^j_{(n)}) - \pi(a^j_{(n)})T.
    \end{equation*}
    For $x \in U(\mathfrak{g})$,
    \begin{align*}
      T\pi(a^j_{(n)})(x\otimes1) &= T(a^j_{(n)}x\otimes1) \\
      &= DU(T_0)(a^j_{(n)}x)\otimes1 \\
      &= (T_0(a^j_{(n)})x + a^j_{(n)}T_0(x))\otimes1 \\
      &= (-na^j_{(n - 1)}x + a^j_{(n)}T_0(x))\otimes1 \\
      &= -na^j_{(n - 1)}(x\otimes1) + \pi(a^j_{(n)})T(x\otimes 1).
    \end{align*}
    The last two equalities imply that for $j \in J$, $[T, \pi(a^j(z))] = \partial_z\pi(a^j(z))$.
  \item Note that for $i, j \in J$ and $N \in \mathbb{N}$,
    \begin{equation*}
      (z - w)^N[\pi(a^i(z)), \pi(a^j(z))] = (z - w)^N\pi([a^i(z), a^j(z)]) = \pi((z - w)^N[a^i(z), a^j(z)]).
    \end{equation*}
  \item This was already done. \qedhere
  \end{enumerate}
\end{proof}

By \Cref{thr:19} and the Extension theorem, $V$ is a vertex superalgebra, denoted by $V(\mathfrak{g}, \mathfrak{F}, T_0)$, and by the PBW theorem, it is explicitly given by
\begin{equation}
  \label{eq:16}
  V = \vspan\{a^{j_1}_{(-n_1 - 1)}\dots a^{j_s}_{(-n_s - 1)}\vac \mid s, n_1, \dots, n_s \in \mathbb{N}, j_1, \dots, j_s \in J\}
\end{equation}
which means $V$ is strongly generated by $\{a^j_{(-1)}\vac\}_{j \in J}$.

\begin{remark}
  \label{rmk:14}
  The PBW theorem for Lie superalgebras is actually more precise than \eqref{eq:16}.
  Let $\le$ be a total order on $J$.
  Then
  \begin{equation*}
    \begin{split}
      V = \vspan\{a^{j_1}_{(-n_1 - 1)}\dots a^{j_s}_{(-n_s - 1)}\vac &\mid s, n_1, \dots, n_s \in \mathbb{N}, j_1, \dots, j_s \in J\text{ and for } k = 1, \dots, s - 1, \\
      &\quad \text{if }a^{j_k}_{(n_k)}, a^{j_{k + 1}}_{(n_{k + 1})} \in V_{\one},\text{ then }j_k < j_{k + 1}\}.
    \end{split}
  \end{equation*}
\end{remark}

\begin{remark}
  \label{rmk:15}
  We have constructed a functor
  \begin{align*}
    VA: \{\text{regular formal distribution Lie superalgebra}\} &\to \{\text{vertex superalgebras}\}, \\
    (\mathfrak{g}, \mathfrak{F}, T_0) &\mapsto V(\mathfrak{g}, \mathfrak{F}, T_0).
  \end{align*}
  By \Cref{rmk:7}, we could've constructed a functor (see \cite[Theorem 2.15]{li_vertex_2004})
  \begin{align*}
    VA: \{\text{Lie conformal superalgebras}\} &\to \{\text{vertex superalgebras}\}, \\
    \mathcal{R} &\mapsto VA(\mathcal{R}).
  \end{align*}
\end{remark}

Usually we need to quotient the vertex superalgebras obtained this way.
Let $(\mathfrak{g}, \mathfrak{F}, T_0)$ be a regular formal distribution Lie superalgebra and $\lambda: \mathfrak{h} \to \mathbb{C}$ a linear functional where $\mathfrak{h}$ is a subalgebra of $\mathfrak{g}_+$ with $\mathfrak{h} \subseteq \ker(T_0)$.
Denote by $I^{\lambda}$ the $\mathfrak{g}$-submodule of $V(\mathfrak{g}, \mathfrak{F}, T_0)$ generated by the vectors $(a - \lambda(a))\vac$ for $a \in \mathfrak{h}$.
For $a \in \mathfrak{h}$ and $x \in U(\mathfrak{g})$,
\begin{align*}
  T(x(a - \lambda(a))\vac) &= DU(T_0)(x(a - \lambda(a)))\otimes1 \\
  &= (DU(T_0)(x)(a - \lambda(a)) + xDU(T_0)(a - \lambda(a)))\otimes1 \\
  &= DU(T_0)(x)(a - \lambda(a))\otimes1 \\
  &= DU(T_0)(x)(a - \lambda(a))\vac.
\end{align*}
Thus, $I^{\lambda}$ is $T$-invariant.
By \Cref{thr:19}, $\{a^j_{(-1)}\vac\}_{j \in J}$ strongly generates $V$ and from this, we see that $I^{\lambda}$ is a left ideal.
By \Cref{rmk:13}, $I^{\lambda}$ is an ideal of $V(\mathfrak{g}, \mathfrak{F}, T_0)$.
Taking the quotient, we get a vertex superalgebra denoted by
\begin{equation*}
  V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0) = V(\mathfrak{g}, \mathfrak{F}, T_0)/I^{\lambda}.
\end{equation*}

Let $\mathbb{C}_{\lambda}$ be the representation of $\mathfrak{g}_- \oplus \mathfrak{h}$ on which $\mathfrak{g}_-$ acts as $0$ and $a$ acts as $\lambda(a)$ for $a \in \mathfrak{h}$.
Using the universal property of the induced representation, we find a $\mathfrak{g}$-module homomorphism $\Ind^{\mathfrak{g}}_{\mathfrak{g}_-}(\mathbb{C}) \to \Ind^{\mathfrak{g}}_{\mathfrak{g}_- \oplus \mathfrak{h}}(\mathbb{C}_{\lambda})$.
By the universal property of the quotient, we find a homomorphism of $\mathfrak{g}$-modules $f: V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0) \to \Ind^{\mathfrak{g}}_{\mathfrak{g}_- \oplus \mathfrak{h}}(\mathbb{C}_{\lambda})$ such that the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    {\Ind^{\mathfrak{g}}_{\mathfrak{g}_-}(\mathbb{C})} \arrow[rd] \arrow[r] & {V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)} \arrow[d, "f"] \\
    & \Ind^{\mathfrak{g}}_{\mathfrak{g}_- \oplus \mathfrak{h}}(\mathbb{C}_{\lambda})
  \end{tikzcd}
\end{equation*}
Using again the universal property of the induced representation we find a homomorphism $g: \Ind^{\mathfrak{g}}_{\mathfrak{g}_-}(\mathbb{C}) \to V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)$.
We can verify that $f$ and $g$ are inverses of each other.
Therefore, it is better to think of $V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)$ as being $\Ind^{\mathfrak{g}}_{\mathfrak{g}_- \oplus \mathfrak{h}}(\mathbb{C}_{\lambda}) = U(\mathfrak{g}) \otimes_{U(\mathfrak{g}_- \oplus \mathfrak{h})} \mathbb{C}$.
We now use this construction to obtain several important examples of vertex superalgebras.

\begin{remark}
  \label{rmk:16}
  The vertex superalgebra $V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)$ comes equipped with a vertex superalgebra homomorphism $\pi: V(\mathfrak{g}, \mathfrak{F}, T_0) \to V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)$ that satisfies $\pi(a\vac) = \lambda(a)\vac$ for all $a \in \mathfrak{h}$ and is universal with this property, i.e.\ if $f: V(\mathfrak{g}, \mathfrak{F}, T_0) \to W$ is a vertex superalgebra homomorphism such that $f(a\vac) = \lambda(a)\vac$ for $a \in \mathfrak{h}$, then there exist a unique vertex superalgebra homomorphism $\bar{f}: V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0) \to W$ such that the following diagram commutes
  \begin{equation*}
    \begin{tikzcd}
      {V(\mathfrak{g}, \mathfrak{F}, T_0)} \arrow[rd, "f"] \arrow[r, "\pi"] & {V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)} \arrow[d, "\bar{f}"] \\
      & W
    \end{tikzcd}
  \end{equation*}
\end{remark}

\begin{example}[\emph{Universal Virasoro vertex algebra} with central charge $c$]
  \label{exa:5}
  Pick $c \in \mathbb{C}$.
  Take $(\Vir, \{L(z), C\}, \ad(L_{-1}))$ as the regular formal distribution Lie superalgebra as constructed in \Cref{exa:1} and $\lambda: \mathbb{C}C \to \mathbb{C}, \lambda(C) = c$ as the linear functional.
  The resulting vertex algebra is the Universal Virasoro vertex algebra with central charge $c$, denoted by $\Vir^c$.

  A \emph{partition} (of $n \in \mathbb{N}$) is a sequence $\lambda = [\lambda_1, \dots, \lambda_m]$ such that $\lambda_i \in \mathbb{Z}_+$ for $i = 1, \dots, m$, $\lambda_1 \ge \dots \ge \lambda_m$ (and $\lambda_1 + \dots + \lambda_m = n$).
  We also consider the \emph{empty partition} $\emptyset$ which is the unique partition of $0$.
  By \Cref{rmk:14}, for any $c \in \mathbb{C}$, a basis of $\Vir^c$ is given by
  \begin{equation*}
    \{L_{-\lambda_1}\dots L_{-\lambda_m}\vac \mid [\lambda_1, \dots, \lambda_m]\text{ is a partition with }\lambda_m \ge 2\}.
  \end{equation*}
  When we deal with conformal vertex superalgebras, we will explain why this vertex algebra called is universal.
\end{example}

\begin{example}[\emph{Universal affine vertex superalgebra of level $k$}]
  \label{exa:6}
  Pick $k \in \mathbb{C}$.
  Take $(\hat{\mathfrak{g}}, \{a(z) \mid a \in \mathfrak{g}\} \cup \{K\}, -\partial_t)$ as the regular formal distribution Lie superalgebra as constructed in \Cref{exa:2} and $\lambda: \mathbb{C}K \to \mathbb{C}, \lambda(K) = k$ as the linear functional.
  The resulting vertex superalgebra is the Universal affine vertex superalgebra of level $k$, denoted by $V^k(\mathfrak{g})$.
\end{example}

\begin{example}[\emph{Fermionic vertex superalgebra}]
  \label{exa:7}
  Take $(\widehat{V}, \{a(z) \mid a \in V\} \cup \{K\}, -\partial_t)$ as the regular formal distribution Lie superalgebra as constructed in \Cref{exa:3} and $\lambda: \mathbb{C}K \to \mathbb{C}, \lambda(K) = 1$ as the linear functional.
  The resulting vertex superalgebra is the fermionic vertex superalgebra, denoted by $F(V)$.
\end{example}

Let $V$ be a vertex superalgebra.
We can naturally endow $V$ with the structure of a Lie conformal superalgebra by taking $\partial = T$ and defining the following $\lambda$-bracket on $V$
\begin{align*}
  [\bullet_{\lambda}\bullet]: V \times V &\to V[\lambda], \\
  [a_{\lambda}b] &= F^{\lambda}(a(z)b) = \sum_{j \in \mathbb{N}}(a_{(j)}b)\frac{\lambda^j}{j!}.
\end{align*}
To verify the Lie conformal superalgebra axioms we do the following:
Set $\mathcal{G}=\{Y(a,z)\mid a \in V\}$.
Then $\mathcal{G}\subseteq \mathcal{F}(V)$ is a Lie conformal superalgebra and the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    V \times V \arrow[d, "{[\bullet_{\lambda}\bullet]_V}"] \arrow[r, "Y \times Y"] & \mathcal{G} \times \mathcal{G} \arrow[d, "{[\bullet_{\lambda}\bullet]_{\mathcal{G}}}"] \\
    {V[\lambda]} \arrow[r, "{Y[\lambda]}"] & {\mathcal{G}[\lambda]}
  \end{tikzcd}
\end{equation*}
As $Y: V \to \mathcal{F}(V)$ is injective, we obtain that $V$ itself is a Lie conformal superalgebra.
We have constructed a functor
\begin{align*}
  LCA: \{\text{Vertex superalgebras}\} &\to \{\text{Lie conformal superalgebras}\}, \\
  V &\mapsto (V, T, [\bullet_{\lambda}\bullet]).
\end{align*}

\begin{remark}
  \label{rmk:17}
  Recall the functor $VA$ constructed in \Cref{rmk:15}.
  We could prove that $(VA, LCA)$ is an adjoint pair of functors, i.e.\ that for a vertex superalgebra $V$ and a Lie conformal superalgebra $\mathcal{R}$, we have a natural isomorphism
  \begin{equation*}
    \Hom(VA(\mathcal{R}), V) \cong \Hom(\mathcal{R}, LCA(V)).
  \end{equation*}
\end{remark}

\subsection{Graded and conformal vertex superalgebras}
\label{sec:grad-conf-vert}

Let $V$ be a vertex superalgebra.
A \emph{Hamiltonian operator} of $V$ is a diagonalizable operator $H \in \End(V)$ such that
\begin{equation}
  \label{eq:17}
  [H, Y(a, z)] = z\partial_zY(a, z) + Y(Ha, z) \quad \text{for }a \in V.
\end{equation}
A vertex superalgebra with a Hamiltonian operator is called \emph{graded}.
The \emph{grading} of $V$ is the eigenspace decomposition of $H$
\begin{equation*}
  V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta},
\end{equation*}
where
\begin{equation*}
  V_{\Delta} = \ker(H - \Delta\Id_V) \quad \text{for }\Delta \in \mathbb{C}.
\end{equation*}
If $a$ is an eigenvector of $H$, it is called \emph{homogeneous}, its eigenvalue is called the \emph{conformal weight} of $a$ and it is denoted by $\Delta_a$.
Condition \eqref{eq:17} is equivalent to
\begin{equation}
  \label{eq:18}
  [H, a_{(n)}] = -(n + 1)a_{(n)} + (Ha)_{(n)} \quad \text{for }a \in V\text{ and }n \in \mathbb{Z}
\end{equation}
and to
\begin{equation}
  \label{eq:19}
  [H, a_{(n)}] = (\Delta_a - n - 1)a_{(n)} \quad \text{for }a \in V\text{ homogeneous and }n \in \mathbb{Z} - \Delta_a.
\end{equation}

For $a \in V$ homogeneous with conformal weight $\Delta_a$, we write, as was done with eigendistributions, $Y(a, z) = \sum_{n \in \mathbb{Z} - \Delta_a}a_nz^{-n - \Delta_a}$ which is equivalent to
\begin{equation*}
  a_{(n)} = a_{n - \Delta_a + 1} \quad \text{for }n \in \mathbb{Z}.
\end{equation*}
With this notation, \eqref{eq:19} is equivalent to
\begin{equation*}
  [H, a_n] = -na_n \quad \text{for }a \in V\text{ homogeneous and }n \in \mathbb{Z} - \Delta_a.
\end{equation*}

\begin{remark}
  \label{rmk:18}
  When a formula involves $\Delta_a$ it is assumed that $a$ is an eigenvector of $H$ with eigenvalue $\Delta_a$ and the formula is extended to arbitrary $a$ by linearity.
\end{remark}

\begin{theorem}[{\cite[\S4.9]{kac_vertex_1998}}]
  \label{thr:20}
  Let $V$ be a vertex superalgebra with a Hamiltonian $H$ and grading $V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta}$.
  Then:
  \begin{enumerate}
  \item $H\vac = 0$ which means that $\Delta_{\vac} = 0$;
  \item $[H, T] = T$;
  \item $[T, a_n] = (-n - \Delta_a + 1)a_{n - 1}$ for $a \in V$ homogeneous and $n \in \mathbb{Z} - \Delta_a$;
  \item $a_nV_{\Delta} \subseteq V_{\Delta - n}$ for $a \in V$ homogeneous, $\Delta \in \mathbb{C}$ and $n \in \mathbb{Z} - \Delta_a$;
  \item $TV_\Delta \subseteq V_{\Delta + 1}$ or, equivalently, $\Delta_{Ta} = \Delta_a + 1$ for homogeneous $a \in V$;
  \item $\Delta_{a_{(n)}b} = \Delta_a + \Delta_b - n - 1$ for $a, b \in V$ homogeneous and $n \in \mathbb{Z}$.
  \end{enumerate}
\end{theorem}

A $\mathbb{Z}$, $\mathbb{N}$ or $\frac{1}{m}\mathbb{N}$-graded vertex superalgebra $V$ ($m \in \mathbb{Z}_+$) is a graded vertex superalgebra $V$ such that $V_{\Delta} = 0$ for $\Delta \notin \mathbb{Z}$, $\mathbb{N}$ or $\frac{1}{m}\mathbb{N}$, respectively.

Homomorphisms of graded vertex superalgebras are assumed to respect the gradings, i.e.\ if $f: V \to W$ is a homomorphism of graded vertex superalgebras, then $f\circ H^V = H^W\circ f$ where $H^V$ is the Hamiltonian of $V$ and $H^W$ is the Hamiltonian of $W$.

Let $V$ be a vertex superalgebra.
A \emph{conformal vector} of central charge $c \in \mathbb{C}$ of $V$ is a vector $\omega \in V$ such that $Y(\omega, z) = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2}$ satisfies:
\begin{enumerate}
\item $Y(\omega, z)$ is a Virasoro formal distribution with central charge $C = c\Id_V$;
\item $L_{-1} = T$;
\item $L_0$ is diagonalizable.
\end{enumerate}

A \emph{conformal vertex superalgebra} (of central charge $c$) is a vertex superalgebra $V$ together with a conformal vector $\omega$ (of central charge $c$).

\begin{remark}
  \label{rmk:19}
  Because of property (ii), a conformal vector $\omega$ is necessarily even.
  Note that $\omega_{(n)} = L_{n - 1}$ for $n \in \mathbb{Z}$.
\end{remark}

\begin{theorem}
  \label{thr:21}
  If $\omega$ is a conformal vector of a vertex superalgebra $V$, then $L_0$ is a Hamiltonian of $V$ and for $a \in V$, $Y(a, z)$ is an eigendistribution of conformal weight $\Delta_a$ with respect to $Y(\omega, z)$ if and only if $a$ is homogeneous of conformal weight $\Delta_a$.
  Moreover, $\omega$ has conformal weight $2$.
\end{theorem}

\begin{proof}
  By \Cref{thr:16}(iii) and \Cref{thr:16}(v), for $a \in V$ homogeneous and $n \in \mathbb{Z}$,
  \begin{align*}
    [L_0, a_{(n)}] &= [\omega_{(1)}, a_{(n)}] \\
    &= \sum_{j \in \mathbb{N}}\binom{1}{j}(\omega_{(j)}a)_{(1 + n - j)} \\
    &= (\omega_{(0)}a)_{(n + 1)} + (\omega_{(1)}a)_{(n)} \\
    &= (Ta)_{(n + 1)} + (L_0a)_{(n)} \\
    &= -(n + 1)a_{(n)} + (L_0a)_{(n)}.
  \end{align*}
  By \eqref{eq:18}, this is equivalent to $L_0$ being a Hamiltonian for $V$.

  By the $n$-product identity for vertex superalgebras and \Cref{thr:16}(iii), for $a \in V$,
  \begin{align*}
    [Y(\omega, z)_{\lambda}Y(a, z)] &= \sum_{j \in \mathbb{N}}\frac{Y(\omega, z)_{(j)}Y(a, z)}{j!}\lambda^j \\
    &= \sum_{j \in \mathbb{N}}\frac{Y(\omega_{(j)}a, z)}{j!}\lambda^j \\
    &= Y(Ta, z) + Y(L_0a, z)\lambda + O(\lambda^2) \\
    &= \partial_zY(a, z) + Y(L_0a, z)\lambda + O(\lambda^2).
  \end{align*}
  Because $Y: V \to \mathcal{F}(V)$ is injective, this implies that
  \begin{equation*}
    [Y(\omega, z)_{\lambda}Y(a, z)] = \partial_zY(a, z) + \Delta_aY(a, z)\lambda + O(\lambda^2)\text{ if and only if }L_0a = \Delta_aa.
  \end{equation*}
  As $Y(\omega, z)$ has conformal weight $2$ with respect to itself, $\omega$ has conformal weight $2$.
\end{proof}

\begin{remark}
  \label{rmk:20}
  A conformal vertex superalgebra can have many different conformal vectors, see \cite[Example 2.5.9]{frenkel_vertex_2001}
\end{remark}

\begin{example}
  \label{exa:8}
  It is straightforward to verify that for any $c \in \mathbb{C}$, $\Vir^c$ is a conformal vertex algebra with conformal vector $\omega = L_{-2}\vac$.
\end{example}

\begin{example}[\emph{Sugawara construction} {\cite[Theorem 5.7]{kac_vertex_1998}}]
  \label{exa:9}
  Recall the universal affine vertex superalgebra of level $k$ of \Cref{exa:6} and assume that $\mathfrak{g}$ is simple and finite dimensional.
  Let $(a_i)_{i \in I}, (a^i)_{i \in I}$ be dual bases of $(\bullet| \bullet)$, which means $(a_i| a^j) = \delta_{ij}$ for $i, j \in I$.
  Denote by $c_{\mathfrak{g}} = \sum_ia^ia_i \in U(\mathfrak{g})$ the universal Casimir element of $\mathfrak{g}$.
  Let $2h^{\wedge}$ be the eigenvalue of $\ad(c_{\mathfrak{g}}) \in \End(\mathfrak{g})$ in the adjoint representation, i.e.\ $\ad(c_{\mathfrak{g}}) = \sum_i\ad(a^i)\ad(a_i) = 2h^{\wedge}\Id_V$.
  Assume $k \neq -h^\wedge$.
  Set
  \begin{equation*}
    \omega = \frac{1}{2(k + h^\wedge)}\sum_ia^i_{(-1)}a_{i(-1)}\vac \in V^k(\mathfrak{g}).
  \end{equation*}
  Then $\omega$ is a conformal vector with central charge $\frac{k\sdim(\mathfrak{g})}{k + h^{\wedge}}$ and for $a \in \mathfrak{g}$, $a(z)$ is a primary eigendistribution of weight $1$.
\end{example}

\begin{example}[{\cite[Proposition 4.10]{kac_vertex_1998}}]
  \label{exa:10}
  Recall the fermionic vertex superalgebra of \Cref{exa:7}.
  Let $(a_i)_{i \in I}$ and $(a^i)_{i \in I}$ be a pair of dual bases of $V$, i.e.\ $\langle a_i, a^j\rangle = \delta_{ij}$ for $i, j \in I$.
  Set
  \begin{equation*}
    \omega = \frac{1}{2}\sum_{i \in I}a^i_{(-2)}a_{i(-1)}\vac \in F(V).
  \end{equation*}
  Then $\omega$ is a conformal vector with central charge $-\frac{1}{2}\sdim(V)$ and all fields $a(z)$ where $a \in V$ are primary of conformal weight $1/2$.
\end{example}

A \emph{conformal vertex superalgebra homomorphism} $(V, \omega) \to (V', \omega')$ is a homomorphism of vertex superalgebras such that $\omega \mapsto \omega'$.

\begin{theorem}[Universal property of $\Vir^c$]
  \label{thr:22}
  Let $V$ be a conformal vertex superalgebra with conformal vector $\omega$ of central charge $c$.
  There exists a unique homomorphism of conformal vertex superalgebras $\Vir^c \to V$.
\end{theorem}

\begin{proof}
  Let $\Vir$ also denote the Virasoro Lie conformal algebra.
  Because $V$ is conformal, the map
  \begin{align*}
    g: \Vir &\to LCA(V), \\
    g(L) &= \omega, \\
    g(C) &= c\vac
  \end{align*}
  gives a homomorphism of Lie conformal superalgebras.
  By \Cref{rmk:17}, we obtain a homomorphism
  \begin{align*}
    f: VA(\Vir) &\to V, \\
    f(L_{-2}\vac) &= \omega, \\
    f(C\vac) &= c\vac.
  \end{align*}
  Using \Cref{rmk:16} with $\Vir^c$, we obtain our desired homomorphism of vertex superalgebras $\bar{f}: \Vir^c \to V$ such that $\bar{f}(L_{-2}\vac) = \omega$.
  As $\{L_{-2}\vac\}$ strongly generates $\Vir^c$ and a homomorphism of conformal vertex superalgebras is required to send $L_{-2}\vac$ to $\omega$, $\bar{f}$ is the only homomorphism of conformal vertex superalgebras $\Vir^c \to V$.

  Alternatively, we could use \Cref{thr:25} ahead to obtain a state-field correspondence $f: \Vir^c \to \mathcal{F}(V)$.
  Actually, the image of $f$ is contained in the image of the state-field correspondence $Y^V: V \to \mathcal{F}(V)$.
  Because $Y^V$ is injective, we can simply define $\bar{f} = (Y^V)^{-1}\circ f$.
\end{proof}

We recall some basic facts about diagonalizable operators.

\begin{lemma}[{\cite[\S6.2]{hoffman_linear_1971}}]
  \label{lmm:8}
  Let $V$ be a vector space, $H \in \End(V)$ and for $\Delta \in \mathbb{C}$, set $V_{\Delta} = \ker(H - \Delta\Id_V)$.
  Then the family of vector spaces $(V_{\Delta})_{\Delta \in \mathbb{C}}$ is linearly independent.
\end{lemma}

\begin{lemma}[{\cite[Corollary 1.1]{kac_bombay_2013}}]
  \label{lmm:9}
  Let $V$ be a vector space (not necessarily a vertex superalgebra) and $H \in \End(V)$ a diagonalizable operator with eigenspace decomposition $V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta}$.
  Let $U$ be a $H$-invariant subspace of $V$, this means $H(U) \subseteq U$.
  Then $U$ is graded:
  \begin{equation*}
    U = \sum_{\Delta \in \mathbb{C}}U \cap V_{\Delta}.
  \end{equation*}
\end{lemma}

An ideal $I$ of a graded vertex superalgebra $V$ is called \emph{graded} if $H(I) \subseteq I$ or, equivalently, $I = \bigoplus_{\Delta \in \mathbb{C}}I \cap V_{\Delta}$ (see \Cref{lmm:9}).

\begin{lemma}
  \label{lmm:10}
  Let $V$ be a graded vertex superalgebra with grading $V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta}$ such that $V_0 = \mathbb{C}\vac$.
  Then $V$ has a unique maximal proper graded ideal $I_{\max}$ and $V/I_{\max}$ is the unique simple graded quotient of $V$, this means that for a proper graded ideal $I$ of $V$, $V/I$ is simple if and only if $I = I_{\max}$.
\end{lemma}

\begin{proof}
  All proper ideals of $V$ do not contain $\vac$ because an ideal containing $\vac$ is all of $V$.
  Let $I_{\max}$ be the sum of all graded proper ideals $I$.
  Then $I_{\max}$ is a graded ideal of $V$ and $I_{\max} \neq V$ because $\vac \notin I_{\max}$.
  Therefore, $I_{\max}$ is the unique maximal proper graded ideal of $V$.
\end{proof}

\begin{lemma}
  \label{lmm:11}
  In a conformal vertex superalgebra $V$ such that $V_0 = \mathbb{C}\vac$, all ideals are graded and there is a unique maximal proper ideal $I_{\max}$ and a unique simple quotient $V/I_{\max}$.
\end{lemma}

\begin{proof}
  Let $\omega$ be the conformal vector of $V$ and let $I$ be an ideal of $V$.
  As $\omega_{(1)}(I) \subseteq I$, $I$ is a graded ideal.
  The result follows from \Cref{lmm:10}.
\end{proof}

The conformal vertex algebra $\Vir^c$ satisfies $\Vir^c_0 = \mathbb{C}\vac$.
Denote by $\Vir_c$ the unique simple quotient and call it the \emph{simple Virasoro vertex algebra} with central charge $c$.
Let $p, q \ge 2$ be relatively prime integers and set
\begin{equation*}
  c_{p, q} = 1 - \frac{6(p - q)^2}{pq}.
\end{equation*}

\begin{theorem}[{\cite{gorelik_simplicity_2007}}]
  \label{thr:23}
  The following are equivalent:
  \begin{enumerate}
  \item $\Vir^c$ is not simple (i.e. $\Vir^c \neq \Vir_c$);
  \item $c$ is of the form $c_{p, q}$ for some $p, q \ge 2$ relatively prime integers.
  \end{enumerate}
  Moreover, the maximal ideal of $\Vir^{c_{p, q}}$ is generated by a singular vector of conformal weight $(p - 1)(q - 1)$ (see \Cref{sec:high-weight-repr} ahead for the definition of singular vector).
\end{theorem}

In this thesis, we mainly deal with the \emph{Ising model} $\Vir_{3, 4} = \Vir_{c_{3, 4}} = \Vir_{1/2}$ and its irreducible modules.
By \Cref{thr:23}, its maximal ideal is generated by the singular vector
\begin{equation}
  \label{eq:20}
  a_{3, 4} = (L_{-2}^3 + \tfrac{93}{64}L_{-3}^2 - \tfrac{27}{16}L_{-6} - \tfrac{33}{8}L_{-4}L_{-2})\vac
\end{equation}
of conformal weight $(3 - 1)(4 - 1) = 6$.

\subsection{Modules over vertex superalgebras}
\label{sec:modules-over-vertex}

Let $V$ be a vertex superalgebra.
A \emph{module} over $V$, $V$-module or \emph{representation} of $V$ is a vector superspace $M$ together with a linear parity preserving map
\begin{align*}
  Y^M(\bullet, z): V &\to \mathcal{F}(M), \\
  a &\mapsto Y^M(a, z) = \sum_{n \in \mathbb{Z}}a^M_{(n)}z^{-n - 1}
\end{align*}
satisfying:
\begin{enumerate}
\item $Y(\vac, z) = \Id_M$;
\item (Borcherds identity) For $a, b \in V$, $u \in M$ and $m, n, k \in \mathbb{Z}$,
  \begin{equation*}
      \sum_{j \in \mathbb{N}}(-1)^j\binom{n}{j}\left(a^M_{(m + n - j)}(b^M_{(k + j)}u) - (-1)^np(a, b)b^M_{(n + k - j)}(a^M_{(m + j)}u)\right) = \sum_{j \in \mathbb{N}}\binom{m}{j}(a_{(n + j)}b)^M_{(m + k - j)}u.
  \end{equation*}
\end{enumerate}
The vertex superalgebra $V$ is clearly a $V$-module and is called the \emph{adjoint representation} of $V$.
A \emph{submodule} of $M$ is a subspace $U$ of $M$ such that $Y^M(a, z)u \in U((x))$ for $a \in V$ and $u \in U$, i.e.\ $a^M_{(n)}u \in U$ for $n \in \mathbb{Z}$.
The \emph{quotient module} $M/U$ is defined in the usual way.
A module whose only submodules are $0$ and itself is called \emph{simple} or \emph{irreducible}.
Most of the theorems about vertex superalgebras and their proofs carry over to modules over vertex superalgebras (cf.\ \Cref{thr:16}) as the following theorem shows.

\begin{theorem}
  \label{thr:24}
  Let $V$ be a vertex superalgebra, $Y^M: V \to \mathcal{F}(M)$ a $V$-module, $a, b \in V$, $u \in M$ and $m, n \in \mathbb{Z}$.
  Then:
  \begin{enumerate}
  \item $(\vac)^M_{(n)} = \delta_{n, -1}\Id_M$;
  \item $Y^M(Ta, z) = \partial_zY^M(a, z)$ or, equivalently, $(Ta)^M_{(n)} = -na^M_{(n - 1)}$;
  \item All fields $\{Y^M(a, z)\}_{a \in V}$ are mutually local;
  \item \emph{($n$-product identity)} $Y^M(a, z)_{(n)}Y^M(b, z) = Y^M(a_{(n)}b, z)$;
  \item $[a^M_{(m)}, b^M_{(n)}] = \sum_{j \in \mathbb{N}}(a_{(j)}b)^M_{(m + n - j)}$;
  \item $e^{Tw}Y^M(a, z)e^{-Tw} = i_{z, w}Y^M(a, z + w)$;
  \item \emph{(Borcherds identity)}
    \begin{equation*}
      \begin{split}
        &i_{z, w}(z - w)^nY^M(a, z)Y^M(b, w)u - p(a, b)i_{w, z}(z - w)^nY^M(b, w)Y^M(a, z)u = \\
        &\sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}Y^M(a_{(n + j)}b, w)u;
      \end{split}
    \end{equation*}
  \item $(a_{(n)}b)^M_{(m)}u = \sum_{j \in \mathbb{N}}(-1)^j\binom{n}{j}(a^M_{(n - j)}b^M_{(m + j)}u - (-1)^np(a, b)b^M_{(n + m - j)}a^M_{(j)}u)$.
  \end{enumerate}
\end{theorem}

\begin{remark}
  \label{rmk:21}
  A $V$-module is equivalently a vector superspace $M$ with a linear parity preserving map $Y^M: V \to \mathcal{F}(M)$ such that (i), (v) and (viii) in \Cref{thr:24} hold.
\end{remark}

\begin{remark}
  \label{rmk:22}
  In contrast to vertex superalgebras, the map $Y^M: V \to \mathcal{F}(M)$ is in general not injective for a module $M$ over a vertex superalgebra $V$.
\end{remark}

We define homomorphisms of $V$-modules in the natural way.
We obtain the category $V$-Mod of $V$-modules which is abelian.

Let $V$ be a vertex superalgebra and let $M$ be a $V$-module.
We say  $T^M \in \End(M)$ is a \emph{differential} of $M$ if
\begin{equation*}
  [T^M, a^M_{(n)}] = -na^M_{(n - 1)} \quad \text{for }a \in V\text{ and }n \in \mathbb{Z}
\end{equation*}
or, equivalently,
\begin{equation*}
  [T^M, Y^M(a, z)] = Y^M(Ta, z) \quad \text{for }a \in V.
\end{equation*}
A \emph{differential} $V$-module is a $V$-module equipped with a differential.

Let $(\mathfrak{g}, \mathfrak{F}, T_0)$ be a regular formal distribution Lie superalgebra with $\mathfrak{F} = \{a^j(z)\}_{j \in J}$.
A \emph{smooth} $(\mathfrak{g}, \mathfrak{F}, T_0)$-module is a $\mathfrak{g}$-module $M$ such for $j \in J$ and $u \in M$, $a^j(z)u \in M((z))$.
Let $\lambda: \mathfrak{h} \to \mathbb{C}$ be a linear functional where $\mathfrak{h}$ is a subalgebra of $\mathfrak{g}_+$ with $\mathfrak{h} \subseteq \ker(T_0)$.
We say $\mathfrak{h}$ acts as $\lambda$ if for $h \in \mathfrak{h}$ and $u \in M$, $hu = \lambda(h)u$.

\begin{theorem}[{\cite[Theorem 2.15]{li_vertex_2004}}]
  \label{thr:25}
  Let $(\mathfrak{g}, \mathfrak{F}, T_0)$ be a regular formal distribution Lie superalgebra with $\mathfrak{F} = \{a^j(z)\}_{j \in J}$.
  Given a smooth $(\mathfrak{g}, \mathfrak{F}, T_0)$-module $M$, there is a unique module structure $Y^M: V(\mathfrak{g}, \mathfrak{F}, T_0) \to \mathcal{F}(M)$ such that for $j \in J$ and $u \in M$, $Y^M(a^j_{(-1)}\vac, z)u = a^j(z)u$.
  Let $\lambda: \mathfrak{h} \to \mathbb{C}$ be a linear functional where $\mathfrak{h}$ is a subalgebra of $\mathfrak{g}_+$ with $\mathfrak{h} \subseteq \ker(T_0)$.
  Given a smooth $(\mathfrak{g}, \mathfrak{F}, T_0)$-module $M$ where $h$ acts as $\lambda$, there is a unique module structure $Y^M: V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0) \to \mathcal{F}(M)$ such that for $j \in J$ and $u \in M$, $Y^M(a^j_{(-1)}\vac, z)u = a^j(z)u$.
\end{theorem}

\begin{remark}
  \label{rmk:23}
  We can define in a natural way the categories $\{\text{smooth }(\mathfrak{g}, \mathfrak{F}, T_0)\text{-modules}\}$ and $\{\text{smooth }(\mathfrak{g}, \mathfrak{F}, T_0)\text{-modules where }\mathfrak{h}\text{ acts as }\lambda\}$.
  \Cref{thr:25} constructs a pair of functors
  \begin{align*}
    \{\text{smooth }(\mathfrak{g}, \mathfrak{F}, T_0)\text{-modules}\} &\to V(\mathfrak{g}, \mathfrak{F}, T_0)\text{-Mod}, \\
    \{\text{smooth }(\mathfrak{g}, \mathfrak{F}, T_0)\text{-modules where }\mathfrak{h}\text{ acts as }\lambda\} &\to V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)\text{-Mod}.
  \end{align*}
  which are actually isomorphisms.
\end{remark}

Let $M$ be a module over a graded vertex superalgebra $V$ with Hamiltonian operator $H$.
A \emph{Hamiltonian operator} of $M$ is a diagonalizable operator $H^M \in \End(M)$ such that
\begin{equation*}
  [H^M, Y^M(a, z)] = z\partial_zY^M(a, z) + Y^M(Ha, z) \quad \text{for }a \in V.
\end{equation*}
A $V$-module together with a Hamiltonian operator is called \emph{graded}.
The \emph{grading} of $M$ is the eigenspace decomposition of $H^M$
\begin{equation*}
  M = \bigoplus_{\Delta \in \mathbb{C}}M_{\Delta},
\end{equation*}
where
\begin{equation*}
  M_{\Delta} = \{u \in M \mid H^Mu = \Delta u\}.
\end{equation*}
As always, we usually write $Y^M(a, z) = \sum_{n \in \mathbb{Z} - \Delta_a}a^M_nz^{-n - \Delta_a}$ for $a \in V$ homogeneous with conformal weight $\Delta_a$.

\begin{theorem}
  \label{thr:26}
  Let $V$ be a graded vertex superalgebra with Hamiltonian $H$ and $M$ a graded $V$-module with Hamiltonian $H^M$.
  Then:
  \begin{enumerate}
  \item $a^M_nM_{\Delta} \subseteq M_{\Delta - n}$ for $a \in V$ homogeneous and $n \in \mathbb{Z} - \Delta_a$;
  \item $\Delta_{a^M_{(n)}u} = \Delta_a + \Delta_u - n - 1$ for homogeneous $a \in V$, $u \in M$ and $n \in \mathbb{Z}$;
  \item \emph{(Graded Borcherds identity)}
    For $a, b \in V$, $u \in M$, $m \in \mathbb{Z} - \Delta_a$, $k \in \mathbb{Z}- \Delta_b$ and $n \in \mathbb{Z}$,
    \begin{equation*}
      \sum_{j \in \mathbb{N}}(-1)^j\binom{n}{j}(a^M_{m + n - j}(b^M_{k + j - n}u) - (-1)^np(a, b)b^M_{k - j}(a^M_{m + j}u)) = \sum_{j \in \mathbb{N}}\binom{m + \Delta_a - 1}{j}(a_{(n + j)}b)^M_{m + k}u.
    \end{equation*}
  \end{enumerate}
\end{theorem}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item The proof of \Cref{thr:20} also works here.
  \item The graded Borcherds identity is simply a change of notation in the usual Borcherds identity. \qedhere
  \end{enumerate}
\end{proof}

\begin{theorem}[{\cite[Proposition 4.1.5 and (4.1.18)]{lepowsky_introduction_2004}}]
  \label{thr:27}
  Let $V$ be a conformal vertex algebra of central charge $c$ with conformal vector $\omega$ and $M$ a $V$-module.
  Write $Y^M(\omega, z) = \sum_{n \in \mathbb{Z}}L^M_nz^{-n - 2}$.
  For $a \in V$ and $m, n \in \mathbb{Z}$,
  \begin{align*}
    [L^M_{-1}, Y^M(a, z)] &= Y^M(L_{-1}a, z) = \partial_zY^M(a, z), \\
    [L^M_m, L^M_n] &= (m - n)L^M_{m + n} + \delta_{m, -n}\frac{m^3 - m}{12}c\Id_M, \\
    [L^M_0, Y^M(a, z)] &= z\partial_zY^M(a, z) + Y^M(L_0a, z).
  \end{align*}
  In particular, $M$ is a differential $V$-module with $L_{-1}^M $ as differential and $M$ is a smooth $\Vir$-module with central charge $c$ (see \Cref{sec:high-weight-repr}).
  If $L^M_0$ is diagonalizable, then $M$ is graded by $L_0^M$ and
  \begin{align*}
    [L_0^M, L_{-1}^M] &= L_{-1}^M, \\
    L^M_{-1}M_{\Delta} &\subseteq M_{\Delta + 1} \quad \text{for }\Delta \in \mathbb{C}.
  \end{align*}
\end{theorem}

\begin{remark}
  \label{rmk:24}
  \Cref{thr:27} is analogous to \Cref{thr:20} with $L_{-1}^M$ in place of $T$ and $L_0^M$ in place of $H$.
\end{remark}

Let $V$ be a conformal vertex superalgebra with conformal vector $\omega$.
It is better to use the notation $(V, \omega)$ for now because of \Cref{rmk:20}.
By \Cref{thr:27}, the following definition makes sense: a $(V, \omega)$-module is a $V$-module $M$ such that $L^M_0$ is diagonalizable where we write $Y^M(\omega, z) = \sum_{n \in \mathbb{Z}}L^M_nz^{-n - 2}$.
In particular, $M$ is a differential module with differential $L^M_{-1}$ and graded by $L^M_0$.
A $(V, \omega)$-module $M$ is called a \emph{positive energy representation} of $(V, \omega)$ if $M = \bigoplus_{n \in \mathbb{N}}M_{h + n}$ for some $h \in \mathbb{C}$.
The subspace $M_h$ is called the \emph{top degree component} of $M$.
A positive energy representation $M$ of $(V, \omega)$ is called \emph{ordinary} if for $n \in \mathbb{N}$, $\dim(M_{h + n}) < \infty$.
For an ordinary representation $M$, the \emph{character} of $M$ is defined as
\begin{equation*}
  \ch_M(q) = \sum_{n \in \mathbb{N}}\dim(M_{h + n})q^{h + n} \in q^h\mathbb{C}[[q]].
\end{equation*}

Let $V$ be a vertex superalgebra.
An \emph{admissible} $V$-module is a $V$-module $M$ together with a gradation $M = \bigoplus_{n \in \mathbb{N}}M(n)$ such that
\begin{equation*}
  a_{(n)}M(m) \subseteq M(m + \Delta_a - n - 1) \quad \text{for }a \in V, n \in \mathbb{Z}\text{ and }m \in \mathbb{N}.
\end{equation*}
The subspace $M(0)$ is called the \emph{top degree component} of $M$.

A \emph{homomorphism of admissible $V$-modules} is a homomorphism of modules that respects gradation.

\begin{example}
  \label{exa:11}
  Let $V$ be a highest weight representation of $\Vir$ with highest weight $(c, h)$ (see \Cref{sec:high-weight-repr} for the definition) and highest weight vector $v$.
  Then $V$ is a smooth $\Vir$-module with central charge $c$.
  Note that $L_0$ is diagonalizable.
  By \Cref{thr:25} and \Cref{thr:27}, $V$ is a graded $\Vir^c$-module.
  Set $V(n) = V_{h + n}$ for $n \in \mathbb{N}$.
  By \Cref{thr:26}(ii), $V = \bigoplus_{n \in \mathbb{N}}V(n)$ is an admissible $\Vir^c$-module with top degree component $\mathbb{C}v$.
  Furthermore, $V$ is an ordinary representation of $\Vir^c$.
\end{example}

\subsection{Lie algebras associated to vertex algebras}
\label{sec:lie-algebr-assoc}

\begin{lemma}
  \label{lmm:12}
  For a vertex algebra $V$, $V/TV$ is a Lie algebra with bracket
  \begin{equation*}
    [a + TV, b + TV] = a_{(0)}b + TV \quad \text{for }a, b \in V.
  \end{equation*}
\end{lemma}

\begin{proof}
  The skewsymmetry of the bracket follows from skewsymmetry of vertex algebras.
  The Jacobi identity follows from \Cref{thr:16}(x) with $m = n = 0$.
\end{proof}

\begin{lemma}
  \label{lmm:13}
  Let $V$ be a vertex algebra and $(R, \partial)$ a differential algebra.
  Then
  \begin{equation*}
    \Lie(V, R) = (V \otimes R)/(T\otimes\Id_R + \Id_V\otimes\partial)(V \otimes R)
  \end{equation*}
  is a Lie algebra with bracket
  \begin{equation*}
    [a\otimes r, b\otimes s] = \sum_{j \in \mathbb{N}}a_{(j)}b\otimes\left(\frac{\partial^jr}{j!}\right)s \quad \text{for }a, b \in V\text{ and }r, s \in R.
  \end{equation*}
\end{lemma}

\begin{proof}
  Since $R$ is a commutative vertex algebra, $V \otimes R$ is a vertex algebra with translation operator $T\otimes\Id_R + \Id_V\otimes\partial$.
  The assertion follows by applying \Cref{lmm:13} to the vertex algebra $V \otimes R$.
\end{proof}

The \emph{Borcherds Lie algebra} associated with a vertex algebra $V$ is the Lie algebra
\begin{equation*}
  \Lie(V) = \Lie(V, \mathbb{C}[t, t^{-1}]),
\end{equation*}
where $\mathbb{C}[t, t^{-1}]$ is viewed as a differential algebra with the derivation $\partial_t$.
For $a \in V$ and $n \in \mathbb{Z}$, let $a_{\{n\}}$ be the class of $a\otimes t^n \in V \otimes \mathbb{C}[t, t^{-1}]$.
By definition, we have
\begin{equation}
  \label{eq:21}
  [a_{\{m\}}, b_{\{n\}}] = \sum_{j \in \mathbb{N}}\binom{m}{j}(a_{(j)}b)_{\{m + n - j\}}\quad \text{for }a, b \in V\text{ and }m, n \in \mathbb{Z}.
\end{equation}
Therefore, we have constructed a functor
\begin{equation*}
  \Lie: \{\text{Vertex algebras}\} \to \{\text{Lie algebras}\}.
\end{equation*}

\begin{lemma}
  \label{lmm:14}
  Any $V$-module $M$ is a $\Lie(V)$-module by setting $a_{\{n\}} \mapsto a^M_{(n)}$ for $a \in V$ and $n \in \mathbb{Z}$.
\end{lemma}

\begin{proof}
  First, this map is well defined because of \Cref{thr:24}(ii).
  It is a Lie algebra homomorphism because of \Cref{thr:24}(viii).
\end{proof}

Therefore, we have constructed a functor
\begin{equation*}
  V\text{-Mod} \to \Lie(V)\text{-Mod}.
\end{equation*}

Assume now that $V$ is $\mathbb{Z}$-graded with Hamiltonian $H$.
Then $\Lie(V)$ is a graded Lie algebra by defining $H \in \End(\Lie(V))$ as
\begin{equation*}
  H(a_{\{n\}}) = -(n + 1)a_{\{n\}} + (Ha)_{\{n\}} \quad \text{for }a \in V\text{ and }n \in \mathbb{Z}.
\end{equation*}
This operator is diagonalizable because for $a$ homogeneous and $n \in \mathbb{Z}$, $H(a_{\{n\}}) = (\Delta_a - n - 1)a_{\{n\}}$.
This means that
\begin{equation*}
  \Delta_{a_{\{n\}}} = \Delta_a - n - 1\quad \text{for }a \in V\text{ homogeneous and }n \in \mathbb{Z}.
\end{equation*}
We have a grading
\begin{equation*}
  \Lie(V) = \bigoplus_{n \in \mathbb{Z}}\Lie(V)_n
\end{equation*}
and a triangular decomposition
\begin{equation*}
  \Lie(V) = \Lie(V)_+ \oplus \Lie(V)_0 \oplus \Lie(V)_-,
\end{equation*}
where
\begin{align*}
  \Lie(V)_+ &= \bigoplus_{n > 0}\Lie(V)_n, \\
  \Lie(V)_- &= \bigoplus_{n < 0}\Lie(V)_n.
\end{align*}

\begin{remark}
  \label{rmk:25}
  Note that $(\Lie(V), \{\sum_{n \in \mathbb{Z}}a_{\{n\}}z^{-n - 1}\}_{a \in V}, T)$ is a regular formal distribution Lie algebra.
  I haven't found any use of this, though.
\end{remark}

Note that $\Lie(V)_0$ is spanned by elements of the form $a_{\{\Delta_a - 1\}}$ for $a \in V$ homogeneous and it forms a Lie subalgebra of $\Lie(V)$.
By \eqref{eq:21} and \Cref{thr:20}(vi), the bracket in $\Lie(V)_0$ is given by
\begin{equation}
  \label{eq:22}
  [a_{\{\Delta_a - 1\}}, b_{\{\Delta_b - 1\}}] = \sum_{j \in \mathbb{N}}\binom{\Delta_a - 1}{j}(a_{(j)}b)_{\{\Delta_{a_{(j)}b} - 1\}}\quad \text{for }a, b \in V.
\end{equation}

Consider the surjective linear map
\begin{align*}
  V &\to \Lie(V)_0 \\
  a &\mapsto a_{\{\Delta_a - 1\}}
\end{align*}
whose kernel is $(T + H)V$.
By \eqref{eq:22}, we are led to define
\begin{equation*}
  \Lie_0(V) = V/(T + H)V,
\end{equation*}
whose bracket is given by
\begin{equation*}
  [a + (T + H)V, b + (T + H)V] = \sum_{j \in \mathbb{N}}\binom{\Delta_a - 1}{j}a_{(j)}b + (T + H)V \quad \text{for }a, b \in V.
\end{equation*}
From what we have done, there is a natural Lie algebra isomorphism
\begin{align*}
  \Lie_0(V) &\xrightarrow{\sim} \Lie(V)_0 \\
  a + (T + H)V &\mapsto a_{\{\Delta_a - 1\}}
\end{align*}
and we have another functor
\begin{equation*}
  \Lie_0: \{\text{$\mathbb{Z}$-graded Vertex algebras}\} \to \{\text{Lie algebras}\}.
\end{equation*}

\section{Highest weight representations of the Virasoro Lie algebra}
\label{sec:high-weight-repr}

In this section, we start by reviewing some well-known facts about forms on complex vector spaces.
Then we consider highest weight representations of the Virasoro Lie algebra with particular interest on the Verma modules $M(c, h)$ and the irreducible representations $L(c, h)$.
Afterwards, we construct a contravariant form on an arbitrary highest weight representation.
Next, we present Kac determinant formula which allows us to determine $L(c, h)$ explicitly by determining the generating singular vectors of the maximal subrepresentation of $M(c, h)$.
Most of the results of this section are in \cite{kac_bombay_2013} or \cite{astashkevich_structure_1997}.
The book \cite{iohara_representation_2011} also presents most of the results shown in this section and it's very comprehensive.

\subsection{Unitary and contravariant representations of Lie algebras}
\label{sec:unit-contr-repr}

We start by reviewing some basic facts about forms on vector spaces.

Let $V$ be a vector space.
A (\emph{sesquilinear}) \emph{form} on $V$ is a function
\begin{align*}
  \langle \bullet| \bullet\rangle: V \times V &\to \mathbb{C}, \\
  (u, v) &\mapsto \langle u| v\rangle
\end{align*}
such that for $u, v, w \in V$ and $t \in \mathbb{C}$:
\begin{enumerate}
\item $\langle tu + v| w\rangle = \overline{t}\langle u| w\rangle + \langle v| w\rangle$;
\item $\langle u| tv + w\rangle = t\langle u| v\rangle + \langle u| w\rangle$.
\end{enumerate}
All forms are assumed to be sesquilinear.

An \emph{Hermitian} form on $V$ is a form $\langle \bullet| \bullet\rangle$ satisfying
\begin{equation*}
  \langle u| v\rangle = \overline{\langle v| u\rangle} \quad \text{for }u, v \in V.
\end{equation*}

Let $S \subseteq V$ be a subset of a vector space $V$ equipped with a form $\langle \bullet| \bullet\rangle$.
Define the \emph{orthogonal complement} of $S$ as the subspace
\begin{equation*}
  S^{\perp} = \{v \in V \mid \text{for }u \in S, \langle u| v\rangle = 0\}.
\end{equation*}

A form $\langle \bullet| \bullet\rangle$ on $V$ is called \emph{nondegenerate} if $V^{\perp} = 0$ and it is called \emph{positive-definite} if it is Hermitian and
\begin{equation*}
  \langle v| v\rangle > 0 \quad \text{for }v \in V \text{ with }v \neq 0.
\end{equation*}
An \emph{inner product space} is a vector space together with a positive-definite form.

\begin{lemma}[{\cite[\S8.2 Theorem 5]{hoffman_linear_1971}}]
  \label{lmm:15}
  Let $V$ be an inner product space and $W$ a finite dimensional subspace of $V$.
  Then $W \oplus W^{\perp} = V$.
\end{lemma}

Let $V$ be a  vector space.
We say a map $\omega: V \to V$ is \emph{antilinear} if for $u, v \in V$ and $t \in \mathbb{C}$:
\begin{align*}
  \omega(u + v) &= \omega(u) + \omega(v), \\
  \omega(tu) &= \overline{t}\omega(u).
\end{align*}
Let $\mathfrak{g}$ be a Lie algebra.
We say a map $\omega: \mathfrak{g} \to \mathfrak{g}$ is an antilinear \emph{anti-involution} if $\omega$ is antilinear and for $a, b \in \mathfrak{g}$:
\begin{align*}
  \omega([a, b]) &= [\omega(b), \omega(a)], \\
  \omega(\omega(a)) &= a.
\end{align*}
Note that this means we can extend $\omega$ to the universal enveloping algebra $U(\mathfrak{g})$ of $\mathfrak{g}$ obtaining a map $\omega: U(\mathfrak{g}) \to U(\mathfrak{g})$ that is still an antilinear anti-involution, i.e.\ for $a, b \in U(\mathfrak{g})$:
\begin{align*}
  \omega(ab) &= \omega(b)\omega(a), \\
  \omega(\omega(a)) &= a.
\end{align*}

We shall be mostly interested in the Virasoro Lie algebra $\Vir$ which has the following antilinear anti-involution
\begin{align*}
  \omega: \Vir &\to \Vir, \\
  \omega(L_n) &= L_{-n} \quad \text{for }n \in \mathbb{Z}, \\
  \omega(C) &= C,
\end{align*}
which is extended by antilinearity.

Let $\mathfrak{g}$ be a Lie algebra with an antilinear anti-involution $\omega: \mathfrak{g} \to \mathfrak{g}$ and $V$ a $\mathfrak{g}$-module with an Hermitian form $\langle \bullet| \bullet\rangle$.
We say $\langle \bullet| \bullet\rangle$ is \emph{contravariant} if
\begin{equation*}
  \langle au| v\rangle = \langle u| \omega(a)v\rangle \quad \text{for }a \in \mathfrak{g}\text{ and }u, v \in V.
\end{equation*}
We further say that this representation is \emph{unitary} if in addition, it is positive-definite.

\subsection{Verma modules}
\label{sec:verma-modules}

Let $V$ be a $\Vir$-module.
We say $V$ is \emph{smooth} if $L(z) = \sum_{n \in \mathbb{Z}}L_{n}z^{-n - 2} \in \End(V)[[z^{\pm 1}]]$ is a field.
We say $V$ is \emph{of central charge} $c \in \mathbb{C}$ if the central element $C$ acts as multiplication by $c$.

A \emph{highest weight representation} of $\Vir$ is a $\Vir$-module $V$ which has a nonzero vector $v$ such that there exists complex numbers $c, h \in \mathbb{C}$ such that:
\begin{enumerate}
  \item $Cv = cv$;
  \item $L_0v = hv$;
  \item $V = \vspan\{L_{-i_k}\dots L_{-i_1}v \mid i_k \ge \dots \ge i_1 > 0\}$.
\end{enumerate}
The numbers $c$ and $h$ are uniquely determined and the pair $(c, h)$ is called the \emph{highest weight} of $V$.
The vector $v$ is not uniquely determined and can be replaced by any nonzero scalar multiple of it and is called a \emph{highest weight vector} of $V$.

For $\Delta \in \mathbb{C}$, set $V_{\Delta} = \ker(L_0 - \Delta\Id_V)$.
We observe that all vectors of the form $L_{-i_k}\dots L_{-i_1}v$ with $i_k \ge \dots \ge i_1 > 0$ and a fixed value of $j = i_1 + \dots + i_k$ belong to $V_{h + j}$.
By axiom (iii), $V = \sum_{j \in \mathbb{N}}V_{h + j}$ and by \Cref{lmm:8}, this is in fact a direct sum:
\begin{equation}
  \label{eq:23}
  V = \bigoplus_{j \in \mathbb{N}}V_{h + j}.
\end{equation}
By axiom (ii),
\begin{equation*}
  V_h = \mathbb{C}v.
\end{equation*}
Note that
\begin{equation*}
  L_nV_{h + j}\subseteq V_{h + j - n} \quad \text{for }n \in \mathbb{Z}\text{ and }j \in \mathbb{N}.
\end{equation*}
In particular, we have
\begin{equation}
  \label{eq:24}
  L_nv = 0 \quad \text{for }n \in \mathbb{Z}_+.
\end{equation}

For $j \in \mathbb{N}$, let $p(j)$ denote the number of partitions of $n$.
It is clear that
\begin{equation}
  \label{eq:25}
  \dim(V_{h + j}) \le p(j) \quad \text{for }j \in \mathbb{N}.
\end{equation}
with equality if and only if all vectors of the form $L_{-i_k}\dots L_{-i_1}v$ with $i_k \ge \dots \ge i_1 > 0$ and $j = i_1 + \dots + i_k$ are linearly independent.
By axiom (i), $C$ acts on $V$ as multiplication by $c$ because it commutes with every $L_n$ for $n \in \mathbb{Z}$.
Thus, a highest weight representation of $\Vir$ with highest weight $(c, h)$ is necessarily smooth and of central charge $c$.

\begin{lemma}
  \label{lmm:16}
  Let $V$ be a highest weight representation of $\Vir$ with highest weight $(c, h)$, highest weight vector $v$ and grading $V = \bigoplus_{j \in \mathbb{N}}V_{h + j}$.
  Then:
  \begin{enumerate}
  \item Any subrepresentation $U$ of $V$ is graded
    \begin{equation*}
      U = \bigoplus_{j \in \mathbb{N}}U \cap V_{h + j};
    \end{equation*}
  \item $V$ is indecomposable, i.e.\ we can't find nontrivial subrepresentations $U, W$ such that
    \begin{equation*}
      V = U \oplus W;
    \end{equation*}
  \item $V$ has a unique maximal proper subrepresentation $J_{\max}$ and $V/J_{\max}$ is the unique irreducible quotient of $V$ and it is also a highest weight representation with highest weight $(c, h)$.
  \end{enumerate}
\end{lemma}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item This is \Cref{lmm:9} with $H = L_0$.
  \item Assume we find such a decomposition.
    Both $U$ and $W$ are graded subrepresentations and therefore we must have either $v \in U$ or $v \in W$ which implies either $U = V$ or $W = V$.
  \item Just take $J_{\max}$ as the sum of all proper subrepresentations of $V$. \qedhere
  \end{enumerate}
\end{proof}

Let $V$ be a highest weight representation of $\Vir$ with highest weight $(c, h)$.
The \emph{character} of $V$, denoted by $\ch_V(q)$, is formal power series given by
\begin{equation*}
  \ch_V(q) = \sum_{j \in \mathbb{N}}\dim(V_{h + j})q^{h + j} \in q^h\mathbb{C}[[q]].
\end{equation*}
The character of $V$ satisfies the inequality
\begin{equation*}
  \ch_V(q) \le \frac{q^h}{\prod_{j \in \mathbb{N}}(1 - q^j)}.
\end{equation*}

A \emph{Verma representation} is a highest weight representation of $\Vir$ in which all vectors of the form $L_{-i_k}\dots L_{-i_1}v$ with $i_k \ge \dots \ge i_1 > 0$ are linearly independent.

Since all vectors of the form $L_{-i_k}\dots L_{-i_1}v$ with $i_k \ge \dots \ge i_1 > 0$ in a Verma representation $V$ with highest weight $(c, h)$ are linearly independent, it follows that they form a basis of $V$ and that there is a homomorphism from $V$ to any other highest weight representation of $\Vir$ with the same highest weight $(c, h)$ mapping a highest weight vector to a highest weight vector.
In particular, for any pair $(c, h)$ of complex numbers, there is at most one Verma representation having $(c, h)$ as its highest weight.
We now show we do have a Verma representation for each pair $(c, h)$ of complex numbers using standard Lie algebra techniques.
Set $\Vir_{\ge 0} = \bigoplus_{n \in \mathbb{N}}\mathbb{C}L_n$.
Consider the subalgebra $\Vir_{\ge 0} \oplus \mathbb{C}C$ of $\Vir$ acting on $\mathbb{C}$ as follows:
\begin{align*}
  L_n1 &= 0 \quad \text{for }n \in \mathbb{Z}_+, \\
  L_01 &= h, \\
  C1 &= c.
\end{align*}
Then
\begin{equation*}
  M(c, h) = \Ind^{\Vir}_{\Vir_{\ge 0} \oplus \mathbb{C}C}(\mathbb{C}) = U(\Vir) \otimes_{U(\Vir_{\ge 0} \oplus \mathbb{C}C)} \mathbb{C}
\end{equation*}
is a $\Vir$-module where $\Vir$ acts by left multiplication.

For a partition $\lambda = [\lambda_1, \dots, \lambda_m]$, define $L_{\lambda} = L_{-\lambda_1}\dots L_{-\lambda_m} \in U(\Vir)$.
By the PBW theorem, the set
\begin{equation*}
  \{L_{\lambda}|c,h\rangle \mid \lambda\text{ is a partition}\}
\end{equation*}
is a vector space basis of $M(c, h)$.
Therefore, $M(c, h)$ is a Verma representation of $\Vir$ with highest weight $(c, h)$ and highest weight vector $|c, h\rangle = 1\otimes1$.
We usually simplify $|c, h\rangle$ to just $|h\rangle$ when $c$ is understood.
By \eqref{eq:25}, the character of a Verma representation is given by
\begin{equation*}
  \ch_{M(c, h)}(q) = \frac{q^h}{\prod_{j \in \mathbb{N}}(1 - q^j)}.
\end{equation*}

Any other highest weight representation $V$ with highest weight $(c, h)$ is a quotient of $M(c, h)$, just map $v$ to a highest weight vector of $V$, the resulting homomorphism is surjective and $V$ is isomorphic to $M(c, h)$ quotiented by the kernel of this homomorphism.

By \Cref{lmm:16}(iii), $M(c, h)$ has a unique maximal subrepresentation $J(c, h)$.
The quotient
\begin{equation*}
  L(c, h) = M(c, h)/J(c, h)
\end{equation*}
is an irreducible highest weight representation with highest weight $(c, h)$.
Actually, this is the unique irreducible highest weight representation with highest weight $(c, h)$ because if $V$ is such a representation, then $V$ is isomorphic to $M(c, h)/U$ for some subrepresentation $U$ of $M(c, h)$ which is maximal, then $U = J(c, h)$.
We wish to determine when is $L(c, h)$ equal to $M(c, h)$.

A vector $u$ in $\Vir$-module is called \emph{singular} if it is nonzero and
\begin{equation*}
  L_nu = 0 \quad \text{for }n \in \mathbb{Z}_+.
\end{equation*}

\begin{lemma}
  \label{lmm:17}
  Let $V$ be a $\Vir$-module.
  If $u \in V$ is nonzero and $L_1u = L_2u = 0$ then $u$ is a singular vector.
\end{lemma}

\begin{proof}
  The condition $L_1u = L_2u = 0$ implies, using induction, that $L_nu = 0$ for $n \ge 3$.
\end{proof}

\begin{remark}
  \label{rmk:26}
  By \eqref{eq:24}, a highest weight vector is singular.
  By \eqref{eq:23}, we can  write a singular vector $u$ as $u = \sum_{j \in \mathbb{N}}u_j$, where $u_j \in V_{h + j}$.
  Then all the nonzero vectors $u_j$ are also singular vectors.
  Therefore, we can focus on homogeneous singular vectors.
\end{remark}

\begin{theorem}
  \label{thr:28}
  Let $V$ be a highest weight representation of $\Vir$ with a contravariant form $\langle \bullet| \bullet\rangle$.
  Then all eigenspaces of $L_0$ are pairwise orthogonal.
  Let $U$ be a subrepresentation of $V$.
  Then $U^{\perp}$ is a subrepresentation of $V$.
  Moreover, if $\langle \bullet| \bullet\rangle$ is unitary, then $U \oplus U^{\perp} = V$.
\end{theorem}

\begin{proof}
  Let $(c, h)$ be the highest weight of $V$ and let $v$ be a highest weight vector in $V$.
  We have the decomposition $V = \bigoplus_{j \in \mathbb{N}}V_{h + j}$.
  First, we note that if $j_1 \neq j_2$, then $\langle V_{h + j_1}| V_{h + j_2}\rangle = 0$.
  This is because if $u \in V_{h + j_1}$ and $w \in V_{h + j_2}$, then
  \begin{equation*}
    (\overline{h} + j_1)\langle u| w\rangle = \langle L_0u| w\rangle = \langle u| L_0w\rangle = (h + j_2)\langle u| w\rangle,
  \end{equation*}
  which implies $(h - \overline{h} + j_2 - j_1)\langle u| w\rangle = 0$ and $\langle u| w\rangle = 0$.
  We know $\langle U| U^{\perp}\rangle = 0$ and $L_jU \subseteq U$ for $j \in \mathbb{Z}$.
  Then $0 = \langle L_jU| U^{\perp}\rangle = \langle U| L_{-j}U^{\perp}\rangle$, which implies $L_jU^{\perp} \subseteq U^{\perp}$ for $j \in \mathbb{Z}$, so $U^{\perp}$ is a subrepresentation of $V$.
  By \Cref{lmm:16},
  \begin{equation*}
     U^{\perp} = \bigoplus_{j \in \mathbb{N}}U^{\perp} \cap V_{h + j} = \bigoplus_{j \in \mathbb{N}}(U \cap V_{h + j})^{\perp|V_{h + j}},
  \end{equation*}
  where $(U \cap V_{h + j})^{\perp|V_{h + j}}$ denotes the orthogonal subspace of $U \cap V_{h + j}$ in $V_{h + j}$.
  If $\langle \bullet| \bullet\rangle$ is unitary, then by \Cref{lmm:15}, $U \cap V_{h + j} \oplus (U \cap V_{h + j})^{\perp|V_{h + j}} = V_{h + j}$ for $j \in \mathbb{N}$ because all the vector spaces $V_{h + j}$ are finite dimensional.
  It is now clear that $U \oplus U^{\perp} = V$.
\end{proof}

\begin{corollary}
  \label{crl:2}
  A highest weight representation $V$ with a unitary form is irreducible.
\end{corollary}

\begin{proof}
  Let $U$ be a subrepresentation of $V$.
  By \Cref{thr:28}, $U^{\perp}$ is a subrepresentation of $V$ and $U \oplus U^{\perp} = V$.
  By \Cref{lmm:16}(ii), either $U = V$ or $U = 0$.
  We conclude that $V$ is irreducible.
\end{proof}

\subsection{Kac determinant formula and singular vectors}
\label{sec:kac-dete-form}

Let $V$ be a highest weight representation with highest weight $(c, h)$ and pick a highest weight vector $v$.
We wish to define a contravariant form $\langle \bullet| \bullet\rangle$ on $V$ such that $\langle v| v\rangle = 1$.
We now show we don't have much choice.
Since $V_h = \mathbb{C}v$, it makes sense to define for $u \in V$, its \emph{expectation value} $\langle u\rangle$ as the coefficient of $v$ with respect to the direct sum $V = \bigoplus_{j \in \mathbb{N}}V_{h + j}$, i.e.\ as the unique $t \in \mathbb{C}$ such that $u - tv \in \bigoplus_{j \in \mathbb{Z}_+}V_{h + j}$.
Consider $L_{\lambda} \in U(\Vir)$ for a partition $\lambda$ and $u \in V$.
By contravariance, we must have $\langle L_{\lambda}v| u\rangle = \langle v| \omega(L_{\lambda})u\rangle$.
But $\langle v| \omega(L_{\lambda})u\rangle = \langle \omega(L_{\lambda})u\rangle$ because all eigenspaces of $L_0$ are pairwise orthogonal by \Cref{thr:28}.
Therefore, if $\langle \bullet| \bullet\rangle$ is a contravariant Hermitian nonzero form on $V$ such that $\langle v| v\rangle = 1$, we are forced to have
\begin{equation}
  \label{eq:26}
  \langle L_{\lambda}v| u\rangle = \langle \omega(L_{\lambda})u\rangle \quad \text{for a partition }\lambda\text{ and }u \in V.
\end{equation}

Contravariance of $\langle \bullet| \bullet\rangle$ and \eqref{eq:26} imposes conditions on the highest weight $(c, h)$.
Let $a \in U(\Vir)$.
Then
\begin{equation*}
  \overline{\langle av\rangle} = \overline{\langle \omega(\omega(a))v\rangle} = \overline{\langle \omega(a)v| v\rangle} = \langle v| \omega(a)v\rangle = \langle av| v\rangle = \langle \omega(a)v\rangle.
\end{equation*}
Taking $a = C$ and $a = L_0$, we obtain $c, h \in \mathbb{R}$.

Note, however, that initially we cannot define the form using \eqref{eq:26} for a general highest weight representation because there may be linear dependences between terms of the form $L_{\lambda}v$ for a partition $\lambda$, so we may ask if it is well defined in the first place.
That is only possible for $M(c, h)$ and later we will see that is also possible for any highest weight representation.

\begin{theorem}[{\cite[Proposition 3.4]{kac_bombay_2013}}]
  \label{thr:29}
  Let $M(c, h)$ be the Verma representation of $\Vir$ with highest weight $(c, h)$ where $c, h \in \mathbb{R}$.
  Pick a highest weight vector $v$ and define the form $\langle \bullet| \bullet\rangle$ on $M(c, h)$ using equation \eqref{eq:26}.
  Then:
  \begin{enumerate}
  \item $\langle \bullet| \bullet\rangle$ is a contravariant Hermitian form on $M(c, h)$ such that $\langle v| v\rangle = 1$;
  \item The eigenspaces of $L_0$ are pairwise orthogonal;
  \item $M(c, h)^{\perp} = J(c, h)$;
  \item Every highest weight representation $V$ of $\Vir$ with highest weight $(c, h)$ and highest weight vector $v'$ carries a contravariant form such that $\langle v'| v'\rangle = 1$.
    This form on $V$ is defined by \eqref{eq:26} with $v'$ in place of $v$ and satisfies properties \emph{(i)--(iii)} of this Theorem.
    In particular, for $L(c, h)$, this form is nondegenerate;
  \item Let $V$ be a highest weight representation with highest weight vector $v$.
    There is a unique contravariant form $\langle \bullet| \bullet\rangle$ on $V$ such that $\langle v| v\rangle = 1$ and is defined by equation \eqref{eq:26}.
    If we pick other highest weight vector, the resulting contravariant form is the previously defined form times a positive constant.
  \end{enumerate}
\end{theorem}

Let $V$ be a highest weight representation with highest weight $(c, h)$ where $c, h \in \mathbb{R}$ and pick a highest weight vector $v$.
Let $\langle \bullet| \bullet\rangle$ be the contravariant form on $V$ defined by \eqref{eq:26}.
We say $V$ is \emph{unitary} if this form is unitary.
By \Cref{thr:29}, this is independent of the choice of the highest weight vector $v$ and there is essentially one form.
By \Cref{crl:2}, a unitary highest weight representation is necessarily irreducible, therefore it is of the form $L(c, h)$ for some real numbers $c, h \in \mathbb{R}$.

We wish to study when is $L(c, h)$ unitary.
A simple necessary condition is given by the next theorem.

\begin{theorem}
  \label{thr:30}
  If $L(c, h)$ is unitary then $c \ge 0$ and $h \ge 0$.
\end{theorem}

\begin{proof}
  Pick a highest weight vector $v$ and assume $\langle v| v\rangle = 1$.
  A necessary condition for unitarity is that
  \begin{equation*}
    c_n = \langle L_{-n}v| L_{-n}v\rangle > 0 \quad \text{for }n \in \mathbb{N}.
  \end{equation*}
  But contravariance and the commutation rules of Virasoro show that
  \begin{equation}
    \label{eq:27}
    c_n = 2nh + c(n^3 - n)/12.
  \end{equation}
  Putting $n = 1$ we get $c_1 = 2h$ so that we must have $h \ge 0$.
  Moreover, \eqref{eq:27} shows that $c_n$ is dominated by $cn^3$ for large $n$, so that $c \ge 0$ is also necessary.
\end{proof}

Let $M(c, h)$ be the Verma representation with highest weight $(c, h)$.
For $n \in \mathbb{N}$, the subspace $M(c, h)_{h + n}$ is finite dimensional.
Therefore, we can consider the determinant $\det_n(c, h)$ of the contravariant Hermitian form $\langle \bullet| \bullet\rangle$ restricted to $M(c, h)_{h + n}$.
This is well defined up to a nonzero constant.

\begin{theorem}
  \label{thr:31}
  The Verma representation $M(c, h)$ is irreducible if and only if for $n \in \mathbb{Z}_+$, $\det_n(c, h) \neq 0$.
\end{theorem}

\begin{proof}
  By \Cref{thr:29}, $M(c, h)$ is irreducible if and only if $M(c, h)^{\perp} = 0$.
  By \Cref{thr:28}, $M(c, h)^{\perp} = \bigoplus_{j \in \mathbb{N}}M(c, h)^{\perp} \cap M(c, h)_{h + j} = \bigoplus_{j \in \mathbb{N}}M(c, h)_{h + j}^{\perp}$.
  Therefore, $M(c, h)$ is irreducible if and only if for $j \in \mathbb{N}$, $M(c, h)_{h + j}^{\perp} = 0$ which is equivalent to for $n \in \mathbb{Z}_+$, $\det_n(c, h) \neq 0$.
\end{proof}

Thus, to determine when $M(c, h)$ is irreducible, it is worthwhile to study the number $\det_n(c, h)$ for $n \in \mathbb{N}$.
Fortunately, there is a formula for this.

\begin{theorem}[Kac determinant formula {\cite[Theorem 4.2]{iohara_representation_2011}}]
  \label{thr:32}
  For $n \in \mathbb{N}$,
  \begin{equation*}
    \textstyle\det_n(c, h) = \displaystyle\text{constant}\cdot \prod_{\substack{k, l \in \mathbb{Z}_+ \\ k \ge l \\ 1 \le kl \le n}} \phi_{k, l}(c, h)^{p(n - kl)},
  \end{equation*}
  where
  \begin{equation*}
    \phi_{k, l}(c, h)=
    \begin{cases}
      (h + \frac{(k^2 - 1)(c - 13)}{24} + \frac{kl - 1}{2})(h + \frac{(l^2 - 1)(c - 13)}{24} + \frac{kl - 1}{2}) + \frac{(k^2 - l^2)^2}{16} &\text{if }k \neq l;\\
      h + \frac{(k^2 - 1)(c - 13)}{24} + \frac{k^2 - 1}{2} &\text{if }k = l.
    \end{cases}
  \end{equation*}
\end{theorem}

\begin{remark}
  \label{rmk:27}
  Using Kac determinant formula, it is possible to prove that $L(1/2, h)$ unitary implies $h = 0$, $1/2$ or $1/16$ (see \cite[\S3]{kac_bombay_2013}).
  This is one of the reasons we study $L(1/2, 1/2)$ and $L(1/2, 1/16)$ in this thesis.
\end{remark}

We will need to find the maximal submodules of $M(1/2, 1/2)$ and $M(1/2, 1/16)$ explicitly.
Kac determinant formula also helps with this, allowing us to compute $J(c, h)$ for rational numbers $c$ and $h$.

It turns out $J(c, h)$ is generated by at most two singular vectors which can be computed explicitly for isolated cases.
It is always possible to write (nonuniquely)
\begin{equation*}
  c = \frac{(3r + 2s)(3s + 2r)}{rs}, h = \frac{(r + s)^2 - t^2}{4rs}
\end{equation*}
for some $r, s \in \mathbb{C} \setminus \{0\}$ and $t \in \mathbb{C}$.
Then
\begin{equation*}
  \phi_{k, l}(c, h) =
  \begin{cases}
    \frac{(rk + sl + t)(sk + rl + t)(rk + sl - t)(sk + rl - t)}{rs} &\text{if }k \neq l;\\
    \frac{(rk + sk + t)(rk + sk - t)}{4rs} &\text{if }k = l.
  \end{cases}
\end{equation*}

Therefore, to find singular vectors in $M(c, h)$, we have to study integral solutions to the linear equation $rk + sl + t = 0$.
This line is real if and only if $c \le 1$ or $c \ge 25$.
Let $l_{c, h}$ denote the solutions to this linear equation.

\begin{theorem}[{\cite{astashkevich_structure_1997}}]
  \label{thr:33}
  Let $c$ and $h$ be real numbers such that $c \le 1$ or $c \ge 25$.
  The integral points (the points in $\mathbb{Z}^2$) of $l_{c, h}$ determine the maximal subrepresentation of $M(c, h)$ completely according to the following three cases:
  \begin{description}[leftmargin = !]
  \item[Case I] The line $l_{c, h}$ contains no integral points.
    In this case $J(c, h) = 0$.
  \item[Case II] The line $l_{c, h}$ contains exactly one integral point $(k, l)$.
    We have three subcases:
    \begin{description}[leftmargin = !]
    \item [Subcase II$_+$] The product $kl > 0$.
      Let $u$ be a singular vector in $M_{c, h + kl}$.
      Then $J(c, h) = U(\Vir)\{u\}$.
    \item[Subcase II$_0$] The product $kl = 0$.
      In this subcase, $J(c, h) = 0$.
    \item[Subcase II$_-$] The product $kl < 0$.
      In this subcase, $J(c, h) = 0$.
    \end{description}
  \item[Case III] The line $l_{c, h}$ contains infinitely many integral points.
    Let $(k_1, l_1), (k_2, l_2), \dots$ be all integral points on the line $l_{c, h}$ up to equivalence relation $(k, l)\sim(k', l')$ if and only if $kl = k'l'$ and such that $kl > 0$.
    We ordered them in such a way that $k_il_i < k_{i + 1}l_{i + 1}$ for $i \in \mathbb{Z}_+$.
    We have two subcases:
    \begin{description}[leftmargin = !]
    \item[Subcase $c\le 1$] We have three subsubcases:
      \begin{description}[leftmargin = !]
      \item [Subsubcase III$^{00}_-$] Line $l_{c, h}$ intersects both axes at integral points.
        Let $u$ be a singular vector in $M_{c, h + k_1l_1}$.
        Then $J(c, h) = U(\Vir)\{u\}$.
      \item[Subsubcase III$^0_-$] Line $l_{c, h}$ intersects only one axis at integral point.
        Let $u$ be a singular vector in $M_{c, h + k_1l_1}$.
        Then $J(c, h) = U(\Vir)\{u\}$.
      \item[Subsubcase III$_-$] Line $l_{c, h}$ intersects both axes at nonintegral points.
        Let $u$ and $w$ be singular vectors in $M_{c, h + k_1l_1}$ and $M_{c, h + k_2l_2}$, respectively.
        Then $J(c, h) = U(\Vir)\{u, w\}$.
      \end{description}
    \item[Subcase $c\ge 25$] We have three subsubcases:
      \begin{description}[leftmargin = !]
      \item[Subsubcase III$^{00}_+$] Line $l_{c, h}$ intersects both axes at integral points.
        Let $u$ be a singular vector in $M_{c, h + k_1l_1}$.
        Then $J(c, h) = U(\Vir)\{u\}$.
      \item[Subsubcase III$^0_+$] Line $l_{c, h}$ intersects only one axis at integral point.
        Let $u$ be a singular vector in $M_{c, h + k_1l_1}$.
        Then $J(c, h) = U(\Vir)\{u\}$.
      \item[Subsubcase III$_+$] Line $l_{c, h}$ intersects both axes at nonintegral points.
        Let $u$ and $w$ be singular vectors in $M_{c, h + k_1l_1}$ and $M_{c, h + k_2l_2}$, respectively.
        Then $J(c, h) = U(\Vir)\{u, w\}$.
      \end{description}
    \end{description}
  \end{description}
\end{theorem}

\begin{remark}
  \label{rmk:28}
  \Cref{thr:32} gives us an algorithm to find $J(c, h)$ for a given highest weight $(c, h)$ with $c, h$ rational numbers.
  We merely need to find the levels at which the singular vectors that generate $J(c, h)$ lie and then by \Cref{lmm:17}, we have to solve the linear equations $L_1u = L_2 u = 0$ assuming $u$ lies in the right level to obtain our desired singular vector.
\end{remark}

\begin{remark}
  \label{rmk:29}
  For $c \in \mathbb{C}$, $\Vir^c = M(c, 0)/U(\Vir)\{L_{-1}\vac\}$ and $\Vir_c = L(c, 0)$ because by \Cref{rmk:23}, the ideals of $\Vir^c$ are in bijection with the submodules of $M(c, 0)/U(\Vir)\{L_{-1}\vac\}$.
  If $c = c_{p, q}$ for some $p, q \ge 2$ relatively prime integers, then the singular vector of $\Vir^c$ can be computed by solving the equation $L_1u = L_2u = 0$ for $u \in \Vir^c_{(p - 1)(q - 1)}$ (see \Cref{thr:23} and \Cref{lmm:17})
\end{remark}

One of the objectives of this thesis is to find a monomial basis of $L(1/2, 1/2)$ and $L(1/2, 1/16)$ similar to what was done for the Ising model $\Vir_{3, 4} = L(1/2, 0)$ in \cite{andrews_singular_2022}.
The modules $L(1/2, 1/2)$ and $L(1/2, 1/1/16)$ are not vertex algebras but they are modules (vertex algebra modules) over both $\Vir^{1/2}$ and $\Vir_{3, 4}$, as we will see later.

\begin{remark}
  \label{rmk:30}
  The irreducible highest weight representations $L(1/2, 1/2)$ and $L(1/2, 1/16)$ can be constructed explicitly as the even or odd part of some induced representations without using Verma representations and passing to the quotient as was done here (cf.\ \cite[\S3]{kac_bombay_2013}).
  Moreover, $L(1/2, 1/2)$ is isomorphic to $F_{\one}$ where $F = F(\mathbb{C}a)$ is the fermionic vertex algebra associated to a purely odd one dimensional superspace $\mathbb{C}a$ with an antisupersymmetric form defined by $\langle a| a\rangle = 1$ (cf.\ \Cref{exa:10}).
\end{remark}

\section{Modules over the simple Virasoro vertex algebras}
\label{sec:modules-over-simple}

In this section, the objective is to study the irreducible modules over $\Vir^c$ and $\Vir_c$.
To do that, we first study the Zhu algebra $\Zhu(V)$ of a $\mathbb{Z}$-graded vertex algebra $V$.
This naturally leads to a functor $\Omega: \{\text{admissible $V$-modules}\} \to \Zhu(V)\text{-mod}$.
Next, we construct an inverse $L: \Zhu(V)\text{-Mod} \to \{\text{admissible $V$-modules}\}$ of the functor $\Omega$ using the associated Lie algebras of a vertex algebra constructed in \Cref{sec:lie-algebr-assoc}.
We end this section by describing the irreducible modules over $\Vir^c$ and $\Vir_c$ explicitly in terms of representations $L(c, h)$ for certain values of $h$.
The Zhu algebra was introduced by Yongchang Zhu in his famous paper \cite{zhu_modular_1996}.
We mostly follow \cite{de_sole_finite_2006} and \cite{dong_twisted_1998} which have a more general and modern presentation.

\subsection{The Zhu algebra}
\label{sec:zhu-algebra-1}

Let $V$ be a $\mathbb{Z}$-graded vertex algebra with Hamiltonian $H$ and let $M = \bigoplus_{n \in \mathbb{N}}M(n)$ be an admissible $V$-module (we are not assuming $M$ graded).
We see that
\begin{equation}
  \label{eq:28}
  \begin{split}
    a^M_{0}M(m) &\subseteq M(m) \quad \text{for }m \in \mathbb{N}, \\
    a^M_{n}M(m) &= 0 \quad \text{for }m \in \mathbb{N}\text{ and }n \in \mathbb{Z}_+.
  \end{split}
\end{equation}

We are thus lead to consider the linear map
\begin{align*}
  \pi_M: V &\to \End(M(0)), \\
  \pi_M(a) &= a^M_{0}|_{M(0)}.
\end{align*}

Set $m = 1$ and $n = k = -1$ in the graded Borcherds identity, where $a, b \in V$ and $u \in M_0$.
The right hand side becomes
\begin{equation*}
  \sum_{j \in \mathbb{N}}\binom{\Delta_a}{j}(a_{(j - 1)}b)^M_0u.
\end{equation*}
By \eqref{eq:28}, the left hand side becomes $a^M_0(b^M_0u)$.
Therefore, we are led to define the following (nonassociative) operation on $V$
\begin{equation*}
  a*b = \sum_{j \in \mathbb{N}}\binom{\Delta_a}{j}a_{(j - 1)}b.
\end{equation*}
We have just seen that $\pi_M$ is a representation of $(V, *)$, i.e.\
\begin{equation}
  \label{eq:29}
  \pi_M(a)\pi_M(b) = \pi_M(a*b) \quad \text{for }a, b \in V.
\end{equation}

\begin{theorem}[{\cite[\S2]{de_sole_finite_2006} or \cite{dong_twisted_1998}}]
  \label{thr:34}
  With the notation above, we have:
  \begin{enumerate}
  \item $\vac$ is a unit for $*$;
  \item $J(V) = ((T + H)V)*V$ is a two sided ideal of the algebra $(V, *)$;
  \item $(a*b)*c - a*(b*c) \in J(V)$ for $a, b, c \in V$;
  \item $(T + H)V \subseteq J(V) \subseteq \ker(\pi_M)$;
  \item $a*b - b*a = \sum_{j \in \mathbb{N}}\binom{\Delta_a - 1}{j}a_{(j)}b$ for $a, b \in V$.
  \end{enumerate}
\end{theorem}

By \Cref{thr:34}(i)--(iii), we define the associative unital algebra
\begin{equation*}
  \Zhu(V) = V/J(V)
\end{equation*}
called the \emph{Zhu algebra} of $V$.
The unit of $\Zhu(V)$ is $\vac + J(V)$.

By \eqref{eq:29}, for a $\mathbb{Z}$-graded vertex algebra $V$, we have defined a restriction functor:
\begin{align*}
  \Omega: \{\text{admissible $V$-modules}\} &\to \Zhu(V)\text{-Mod}, \\
  M &\mapsto \Omega(M) = M(0).
\end{align*}

\subsection{The inverse of the restriction functor}
\label{sec:inverse-restr-funct}

By \Cref{thr:34}(iv)--(v), we have a natural Lie algebra epimorphism $\Lie_0(V) \twoheadrightarrow [\Zhu(V)]$.
Moreover, we know that $\Lie_0(V)$ is isomorphic to $\Lie(V)_0$.
Therefore, we have a well-defined epimorphism
\begin{align*}
  \Lie(V)_0 &\twoheadrightarrow [\Zhu(V)], \\
  a_{\{\Delta_a - 1\}} &\mapsto a + J(V).
\end{align*}

Let $U$ be a $\Zhu(V)$-module.
Note that $U$ is a fortiori a $[\Zhu(V)]$-module and by the epimorphism above, it is a $\Lie(V)_0$-module.
Let $\Lie(V)_-$ act trivially on $U$ and set
\begin{equation*}
  M(U) = \Ind^{\Lie(V)}_{\Lie(V)_- \oplus \Lie(V)_0}(U) = U(\Lie(V)) \otimes_{U(\Lie(V)_- \oplus \Lie(V)_0)} U.
\end{equation*}
Give $U$ degree $0$ and extend the gradation of $\Lie(V)$ to $M(U)$.
Then $M(U)$ becomes $\mathbb{N}$-graded with $M(U)(0) = U$.
We are tempted to define $Y^{M(U)}(a, z) = \sum_{n \in \mathbb{Z}}a_{\{n\}}z^{-n - 1}$ for $a \in V$ but that doesn't necessarily satisfy the Borcherds identity.

\begin{theorem}[{\cite[\S2]{de_sole_finite_2006} or \cite{dong_twisted_1998}}]
  \label{thr:35}
  The $\mathbb{N}$-graded $\Lie(V)$-module $M(U)$ has a unique maximal graded $\Lie(V)$-submodule $J$ with the property that $J \cap U = 0$.
  Then $L(U) = M(U)/J$ is an admissible $V$-module satisfying $\Omega(L(U)) \cong U$.
  Therefore, we have defined a functor
  \begin{equation*}
  L: \Zhu(V)\text{\emph{-Mod}} \to \{\text{\emph{admissible }$V$\emph{-modules}}\}
  \end{equation*}
  such that $\Omega \circ L$ is naturally isomorphic to the identity functor.
\end{theorem}

The functors $\Omega$ and $L$ are not yet equivalences but they are close to be.
We call an admissible $V$-module $M = \bigoplus_{n \in \mathbb{N}}M(n)$ \emph{almost irreducible} if $M(0)$ generates $M$ and $M$ contains no graded submodules intersecting $M(0)$ trivially.

\begin{theorem}[{\cite[\S2]{de_sole_finite_2006} or \cite{dong_twisted_1998}}]
  \label{thr:36}
  Let $V$ be a $\mathbb{Z}$-graded vertex algebra.
  The functors $\Omega$ and $L$ establish an equivalence between the category of almost irreducible admissible $V$-modules and the category of $\Zhu(V)$-modules.
  In particular, these functors establish a bijective correspondence between irreducible admissible $V$-modules and irreducible $\Zhu(V)$-modules.
\end{theorem}

\begin{remark}
  \label{rmk:31}
  The functor $L$ plays well with vertex algebra homomorphism.
  To elaborate a bit more, let $f: V \to W$ be a homomorphism of vertex algebras.
  We naturally define the functors $\circ f: W\text{-Mod} \to V\text{-Mod}$ and $\circ \Zhu(f): \Zhu(W)\text{-Mod} \to \Zhu(V)\text{-Mod}$.
  Then the following diagram of functors commute
  \begin{equation*}
    \begin{tikzcd}
      \Zhu(W)\text{-Mod} \arrow[r, "L_V"] \arrow[d, "\circ \Zhu(f)"] & \{\text{almost irreducible admissible $W$-modules}\} \arrow[d, "\circ f"] \\
      \Zhu(V)\text{-Mod} \arrow[r, "L_W"]                           & \{\text{almost irreducible admissible $V$-modules}\}
    \end{tikzcd}
  \end{equation*}
\end{remark}

\subsection{Modules over the Virasoro vertex algebras}
\label{sec:modul-over-viras}

We wish to determine all irreducible modules over both $\Vir^c$ and $\Vir_c$.
This is why we studied the Zhu algebra.
We start with $\Vir^c$ which is easier.

\begin{theorem}[{\cite{wang_rationality_1993}}]
  \label{thr:37}
  For $c \in \mathbb{C}$, we have the following isomorphism of algebras
  \begin{align*}
    \Zhu(\Vir^c) &\xrightarrow{\sim} \mathbb{C}[x], \\
    L_{-2}\vac + J(\Vir^c) &\mapsto x.
  \end{align*}
\end{theorem}

\begin{theorem}
  \label{thr:38}
  For $c \in \mathbb{C}$, the simple modules of $\Vir^c$ are $L(c, h)$ for $h \in \mathbb{C}$.
\end{theorem}

\begin{proof}
  The irreducible modules of $\mathbb{C}[x]$ are $\mathbb{C}_h = \mathbb{C}$ for $h \in \mathbb{C}$, where $x$ acts by multiplication by $h$.
  By \Cref{thr:36} and \Cref{thr:37}, the simple modules of $\Vir^c$ are $L(\mathbb{C}_h)$ for $h \in \mathbb{C}$.
  By \Cref{thr:27}, for $h \in \mathbb{C}$, $L(\mathbb{C}_h)$ is a smooth $\Vir$-module with central charge $c$.
  Also, $L_0 = (L_{-2}\vac)^{L(\mathbb{C}_h)}_{(1)}$ acts as multiplication by $h$ on $\mathbb{C}_h$ and $L(\mathbb{C}_h)$ is generated by $\mathbb{C}_h$.
  Therefore, $L(\mathbb{C}_h)$ is an irreducible highest weight representation, i.e.\ $L(\mathbb{C}_h) = L(c, h)$.
\end{proof}

Now we move onto $\Vir_c$.
If $c$ is not of the form $c_{p, q}$ for some $p, q \ge 2$ relatively prime integers, then $\Vir_c = \Vir^c$ and we already solved the problem.

\begin{theorem}[{\cite{wang_rationality_1993}}]
  \label{thr:39}
  Set $c = c_{p, q}$ for some $p, q \ge 2$ relatively prime integers.
  We have the following isomorphism of algebras
  \begin{align*}
    \Zhu(\Vir_c) &\xrightarrow{\sim} \mathbb{C}[x]/(G_{p, q}(x)), \\
    L_{-2}\vac + J(\Vir_c) &\mapsto x + (G_{p, q}(x)),
  \end{align*}
  where $G_{p ,q}(x)^2 = \prod_{m = 1}^{p - 1}\prod_{n = 1}^{q - 1}(x - h_{m, n})$ and $h_{m, n} \in \mathbb{C}$ is defined by
  \begin{equation}
    \label{eq:30}
    h_{m, n} = \frac{(np - mq)^2 - (p - q)^2}{4pq}.
  \end{equation}
\end{theorem}

\begin{theorem}
  \label{thr:40}
  Set $c = c_{p, q}$ for some $p, q \ge 2$ relatively prime integers.
  Then the simple modules of $\Vir_c$ are $L(c, h_{m, n})$ for integers $m, n$ such that $0 < m < p$ and $0 < n < q$.
  Let $Y^{L(c, h_{m, n})}_{\Vir^c}: \Vir^c \to \mathcal{F}(L(c, h_{m, n}))$ be the state-field correspondence of $L(c, h)$ as a module over $\Vir^c$ and let $Y^{L(c, h_{m, n})}_{\Vir_c}: \Vir_c \to \mathcal{F}(L(c, h_{m, n}))$ be the state-field correspondence of $L(c, h)$ as a module over $\Vir_c$.
  Then the following diagram commutes
  \begin{equation*}
    \begin{tikzcd}
      \Vir^c \arrow[r] \arrow[rd, "{Y^{L(c, h_{m, n})}_{\Vir^c}}"'] & {\Vir_c} \arrow[d, "{Y^{L(c, h_{m, n})}_{\Vir_c}}"] \\
      & {\mathcal{F}(L(c, h_{m, n}))}
    \end{tikzcd}
  \end{equation*}
  where the horizontal arrow is the quotient map.
\end{theorem}

\begin{proof}
  The irreducible modules of $\mathbb{C}[x]/(G_{p, q}(x))$ are $\mathbb{C}_{h_{m, n}} = \mathbb{C}$ for integers $m, n$ such that $0 < m < p$ and $0 < n < q$, where $x + (G_{p, q}(x))$ acts by multiplication by $h_{m, n}$.
  We conclude from \Cref{thr:38} that the $\Vir_c$-module corresponding to $\mathbb{C}_{h_{m, n}}$ is $L(c, h_{m, n})$ and the commutativity of the diagram follows from \Cref{rmk:31}.
\end{proof}

\begin{remark}
  \label{rmk:32}
  It follows from \Cref{thr:40} that the irreducible modules of the Ising module $\Vir_{3, 4}$ are $\Vir_{3, 4} = L(1/2, 0)$, $L(1/2, 1/2)$ and $L(1/2, 1/16)$.
\end{remark}

\begin{theorem}
  \label{thr:41}
  Set $c = c_{p, q}$ for some $p, q \ge 2$ relatively prime integers and consider the real number $h_{m, n}$ for integers $m, n$ such that $0 < m < p$ and $0 < n < q$ as defined in \eqref{eq:30}.
  Then the maximal subrepresentation $J(c, h_{m, n})$ of $M(c, h_{m, n})$ is generated by two singular vectors $u$ and $w$ in $M(c, h_{m, n})_{h_{m, n} + mn}$ and $M(c, h_{m, n})_{h_{m, n} + (p - m)(q - n)}$, respectively.
\end{theorem}

\begin{proof}
  Solving the equations
  \begin{equation*}
    c = \frac{(3r + 2s)(3s + 2r)}{rs}, h = \frac{(r + s)^2 - t^2}{4rs}
  \end{equation*}
  for $r, s \in \mathbb{C} \setminus \{0\}$ and $t \in \mathbb{C}$, we obtain
  \begin{equation*}
    r = p, s = -q, t = (np - mq)^2.
  \end{equation*}
  The solutions $(k, l)$ of the linear equation $pk - ql + (np - mq)^2 = 0$ are
  \begin{equation}
    \label{eq:31}
    \{(n + qj, m + pj) \mid j \in \mathbb{Z}\}.
  \end{equation}
  We are in Subsubcase III$_-$ of \Cref{thr:33} and we see that the first two elements of the solutions in \eqref{eq:31} are $(n, m)$ and $(n - q, m - p)$ (not necessarily in that order), so we are done.
\end{proof}

\section{Vertex Poisson superalgebras and filtrations of vertex algebras}
\label{sec:vert-poiss-supera}

In this section we review the theory of filtrations for vertex algebras.
We can consider either the Li filtration $(F_pV)_{p \in \mathbb{Z}}$ or the standard filtration $(G^pV)_{p \in \mathbb{Z}}$.
Both of these filtrations lead to a vertex Poisson algebra, namely $\gr_F(V)$ and $\gr^G(V)$, as was shown by Haisheng Li in \cite{li_abelianizing_2005} and \cite{li_vertex_2004}.
In \cite{arakawa_remark_2012}, it was shown by Arakawa that the resulting vertex Poisson algebra is the same.
Then we introduce the Li filtration $(F_pM)_{p \in \mathbb{Z}}$ and the standard filtration $(G^pM)_{p \in \mathbb{Z}}$ for modules which wasn't done in \cite{li_vertex_2004}.
This leads to modules $\gr_F(M)$ and $\gr^G(M)$ that are again isomorphic.

\subsection{Vertex Lie superalgebras and their modules}
\label{sec:vert-lie-supera}

Let $V$ be a vector space.
Given a formal distribution $f(x_1, \dots, x_n) \in V[[x_1^{\pm 1}, \dots, x_n^{\pm 1}]]$, we can write it as
\begin{equation*}
  f(x_1, \dots, x_n) = \sum_{m_1, \dots, m_n \in \mathbb{Z}}f_{(m_1, \dots, m_n)}x_1^{-m_1 - 1}\dots x_n^{-m_n - 1}.
\end{equation*}
We set
\begin{equation*}
  \Sing f(x_1, \dots, x_n) = \sum_{m_1, \dots, m_n \in \mathbb{N}}f_{(m_1, \dots, m_n)}x_1^{-m_1 - 1}\dots x_n^{-m_n - 1}.
\end{equation*}

A \emph{vertex Lie superalgebra} is the data $(V, T, Y_-)$ where $V$ is a vector superspace, $Y_-: V \to \mathcal{F}(V)$ is a linear parity preserving map such that $Y_-(a, z) = \Sing(Y_-(a, z))$ (i.e.\ $Y_-: V \to \Hom(V, z^{-1}V[z^{-1}])$) for $a \in V$ and $T \in \End(V)$.
The data must satisfy the following axioms for $a, b \in V$:
\begin{enumerate}
\item $Y_-(Ta, z) = \partial_zY_-(a, z)$;
\item $Y_-(a, z)b = \Sing(p(a, b)(e^{Tz}Y_-(b, -z)a))$;
\item $[Y_-(a, z), Y_-(b, w)] = \Sing(\sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}Y_-(a_{(j)}b, w))$ where $Y_-(a, z) = \sum_{n \in \mathbb{N}}a_{(n)}z^{-n - 1}$, $a_{(n)} \in \End(V)$.
\end{enumerate}

\begin{remark}
  \label{rmk:33}
  Axiom (i) of vertex Lie superalgebras implies that $T \in \End(V)_{\zero}$.
\end{remark}

Concepts like homomorphism, vertex Lie subalgebras and ideals are defined in the usual way.
We obtain the category of vertex Lie superalgebras.

Let $V$ be vertex Lie superalgebra.
We can make $V$ into a $C[\partial]$-module by declaring $\partial = T$.
Then axioms (i) and (ii) are the respective axioms of Lie conformal superalgebras given in \Cref{sec:lie-conf-super}.
Take $a, b \in V$.
Since
\begin{equation*}
  \sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}Y_-(a_{(j)}b, w) = \sum_{m, n \in \mathbb{Z}}\left(\sum_{\substack{j, k \in \mathbb{N} \\ j + k = m + n}}\binom{m}{j}(a_{(j)}b)_{(k)}\right)z^{-m - 1}w^{-n - 1},
\end{equation*}
we have
\begin{equation*}
  \Sing\left(\sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}Y_-(a_{(j)}b, w)\right) = \sum_{m, n \in \mathbb{N}}\sum_{j = 0}^m\binom{m}{j}(a_{(j)}b)_{(m + n - j)}z^{-m - 1}w^{-n - 1}.
\end{equation*}
On the other hand,
\begin{equation*}
  [Y_-(a, z), Y_-(b, w)] = \sum_{m, n \in \mathbb{N}}[a_{(m)}, b_{(n)}]z^{-m - 1}w^{-n - 1}.
\end{equation*}
Therefore, axiom (iii) of vertex Lie superalgebras is equivalent to
\begin{equation*}
  [a_{(m)}, b_{(n)}] = \sum_{j = 0}^m\binom{m}{j}(a_{(j)}b)_{(m + n - j)} \quad \text{for }a, b \in V\text{ and }m, n \in \mathbb{Z}.
\end{equation*}
This is just axiom (iii) of Lie conformal superalgebras.
Thus, the category of vertex Lie superalgebras and the category of Lie conformal superalgebras are isomorphic.
So we have three equivalent concepts: vertex Lie superalgebras, Lie conformal superalgebras and regular formal distribution Lie superalgebras.

\begin{theorem}
  \label{thr:42}
  Let $V$ be a vertex Lie superalgebra.
  For $a, b \in V$ and $m, j \in \mathbb{N}$:
  \begin{enumerate}
  \item $[T, Y_-(a, z)] = Y_-(Ta, z) = \partial_zY_-(a, z)$;
  \item $(a_{(j)}b)_{(m)} = \sum_{k = 0}^j\binom{j}{k}(-1)^k[a_{(j - k)},b_{(m + k)}]$.
  \end{enumerate}
\end{theorem}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item This is \Cref{prp:4}.
  \item This is \Cref{thr:10}. \qedhere
  \end{enumerate}
\end{proof}

Let $V$ be a vertex Lie superalgebra.
A \emph{Hamiltonian operator} of $V$ is a diagonalizable operator $H \in \End(V)$ such that
\begin{equation*}
  [H, Y_-(a, z)] = z\partial_zY_-(a, z) + Y_-(Ha, z) \quad \text{for }a \in V.
\end{equation*}
A vertex Lie superalgebra with a Hamiltonian operator is called \emph{graded}.
The \emph{grading} of $V$ is the eigenspace decomposition of $H$:
\begin{equation*}
  V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta}.
\end{equation*}

A \emph{module} over a vertex Lie superalgebra $V$ is a vector superspace $M$ together with a linear parity preserving map $Y^M_-: V \to \Hom(M, z^{-1}M[z^{-1}])$, written as $Y^M_-(a, z) = \sum_{n \in \mathbb{N}}a^M_{(n)}z^{-n - 1}$, $a^M_{(n)} \in \End(M)$, such that for $a, b \in V$ and $m, n \in \mathbb{N}$:
\begin{enumerate}
\item $(Ta)^M_{(n)} = -na^M_{(n - 1)}$;
\item $[a^M_{(m)}, b^M_{(n)}] = \sum_{j = 0}^m\binom{m}{j}(a_{(j)}b)^M_{(m + n - j)}$.
\end{enumerate}
Concepts like homomorphisms and vertex Lie submodules are defined in the usual way.
Given a vertex Lie superalgebra $V$, we obtain the abelian category $V$-Mod of modules over $V$.

Let $M$ be a module over a graded vertex Lie superalgebra $V$ with Hamiltonian operator $H$.
A \emph{Hamiltonian operator} of $M$ is a diagonalizable operator $H^M \in \End(M)$ such that
\begin{equation*}
  [H^M, Y^M_-(a, z)] = z\partial_zY^M_-(a, z) + Y^M_-(Ha, z) \quad \text{for }a \in V.
\end{equation*}
A $V$-module together with a Hamiltonian operator is called \emph{graded}.
The \emph{grading} of $M$ is the eigenspace decomposition of $H^M$
\begin{equation*}
  M = \bigoplus_{\Delta \in \mathbb{C}}M_{\Delta}.
\end{equation*}

Let $V$ be a vertex Lie superalgebra and $M$ a $V$-module.
We say $T^M \in \End(M)$ is a \emph{differential} of $M$ if
\begin{equation*}
  [T^M, Y^M_-(a, z)] = Y^M_-(Ta, z) \quad \text{for }a \in V.
\end{equation*}
A \emph{differential} $V$-module is a module equipped with a differential.

\subsection{Vertex Poisson algebras and their modules}
\label{sec:vert-poiss-algeb}

A \emph{vertex Poisson algebra} the data $(V, T, Y_-)$ such that:
\begin{enumerate}
\item $(V, T)$ is a differential commutative associative algebra with unit $1$;
\item $(V, T, Y_-)$ is a vertex Lie algebra;
\item The left Leibniz rule holds
  \begin{equation*}
    Y_-(a, z)(bc) = (Y_-(a, z)b)c + b(Y_-(a, z)c) \quad \text{for }a, b, c \in V.
  \end{equation*}
\end{enumerate}
The left Leibniz rule implies that $a_{(n)} \in \Der(A)$ for $a \in A$ and $n \in \mathbb{N}$.
Therefore, we have
\begin{equation*}
  Y_-(a, z) \in z^{-1}(\Der(A))[[z^{-1}]] \quad \text{for }a \in A.
\end{equation*}
In particular, $a_{(n)}1 = 0$ for $a \in A$ and $n \in \mathbb{N}$.
Therefore,
\begin{equation*}
  Y_-(a, z)1 = 0 \quad \text{for }a \in A.
\end{equation*}
By skewsymmetry,
\begin{equation*}
  Y_-(1, z) = 0.
\end{equation*}

Let $V$ and $W$ be vertex Poisson algebras.
A \emph{vertex Poisson algebra homomorphism} $f: V \to W$ is simultaneously a differential algebra and a vertex Lie algebra homomorphism.
We obtain the category of vertex Poisson algebras.

A \emph{module} over a vertex Poisson algebra $(V, T, Y_-)$ is a module $(M, Y^M_-)$ for $V$ as a vertex Lie algebra and a module over $V$ as a commutative associative algebra such that
\begin{equation*}
  a^M_{(n)}(bu) = (a_{(n)}b)u + b(a^U_{(n)}u) \quad \text{for }a, b \in V, u \in M\text{ and }n \in \mathbb{N}.
\end{equation*}
Concepts like homomorphisms and vertex Poisson submodules are defined in the usual way.
Given a vertex Poisson algebra $V$, we obtain the abelian category $V$-Mod of modules over $V$.

\subsection{Filtrations of vertex algebras}
\label{sec:filtr-vert-algebr}

Let $V$ be a vertex algebra and $(a^i)_{i \in I}$ a family of strong generators of $V$.
For $p \in \mathbb{Z}$, set
\begin{equation*}
  F_pV = \vspan\{a^{i_1}_{(-n_1 - 1)}\dots a^{i_s}_{(-n_s - 1)}\vac \mid s, n_1, \dots, n_s \in \mathbb{N}, i_1, \dots, i_s \in I, n_1 + \dots + n_s \ge p\}.
\end{equation*}

\begin{proposition}[{\cite{li_abelianizing_2005}}]
  \label{prp:9}
  The filtration $(F_pV)_{p \in \mathbb{Z}}$ satisfies:
  \begin{enumerate}
  \item $F_pV = V$ for $p \le 0$;
  \item $\vac \in F_0V \supseteq F_1V \supseteq \dots$;
  \item $TF_pV \subseteq F_{p + 1}V$ for $p \in \mathbb{Z}$;
  \item $a_{(n)}F_qV \subseteq F_{p + q - n - 1}V$ for $p, q \in \mathbb{Z}$, $a \in F_pV$ and $n \in \mathbb{Z}$;
  \item $a_{(n)}F_qV \subseteq F_{p + q - n}V$ for $p, q \in \mathbb{Z}$, $a \in F_pV$ and $n \in \mathbb{N}$.
  \end{enumerate}
\end{proposition}

Let
\begin{equation*}
  \gr_F(V) = \bigoplus_{p \in \mathbb{N}}F_pV/F_{p + 1}V
\end{equation*}
be the associated graded vector space.
By \cite{li_abelianizing_2005}, the vector space $\gr_F(V)$ is a vertex Poisson algebra with operations given as follows: for $p, q \in \mathbb{N}$, $a \in F_pV$ and $b \in F_qV$, set
\begin{align*}
  \sigma_p(a)\sigma_q(b) &= \sigma_{p + q}(a_{(-1)}b), \\
  T\sigma_p(a) &= \sigma_{p + 1}(Ta), \\
  Y_-(\sigma_p(a), z)\sigma_q(b) &= \sum_{n \in \mathbb{N}}\sigma_{p + q - n}(a_{(n)}b)z^{-n - 1},
\end{align*}
where $\sigma_p: F_pV \to \gr_F(V)$ is the \emph{principal symbol map} which is the composition of the natural maps $F_pV \to F_pV/F_{p + 1}V$ and $F_pV/F_{p+1}V \to \gr_F(V)$.
The unit is $\sigma^0(\vac)$.
The filtration $(F_pV)_{p \in \mathbb{Z}}$ is called the \emph{Li filtration} of $V$.

\begin{lemma}[{\cite[Lemma 2.9]{li_abelianizing_2005}}]
  \label{lmm:18}
  Let $V$ be a vertex algebra.
  Then
  \begin{equation*}
    F_pV = \vspan\{a_{(-i - 1)}b \mid a \in V, i \in \mathbb{Z}_+, b \in F_{p - i}V\} \quad \text{for }p \in \mathbb{Z}_+.
  \end{equation*}
\end{lemma}

By \Cref{lmm:18}, the Li filtration depends only on $V$ and not on the choice of the strong generators.
If $V$ is graded by a Hamiltonian $H$ with grading $V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta}$, then $H(F_pV) \subseteq F_pV$ because in that case, for $p \in \mathbb{Z}$,
\begin{equation*}
F_pV = \vspan \{a^1_{(-n_1 - 1)}\dots a^s_{(-n_s - 1)}\vac \mid s, n_1, \dots, n_s \in \mathbb{N}, a^i \in V\text{ homogeneous}, n_1 + \dots + n_s \ge p\}.
\end{equation*}

Therefore, we can define an operator $H \in \End(\gr_F(V))$ as $H(\sigma_p(a)) = \sigma_p(Ha)$ for $p \in \mathbb{N}$ and $a \in F_pV$.
For $p \in \mathbb{Z}$ and $\Delta \in \mathbb{C}$, define $F_pV_{\Delta} = F_pV \cap V_{\Delta}$.
Since $H(F_pV) \subseteq F_pV$ for $p \in \mathbb{Z}$, \Cref{lmm:9} implies that
\begin{equation*}
  F_pV = \bigoplus_{\Delta \in \mathbb{C}}F_pV_{\Delta} \quad \text{for }p \in \mathbb{Z}.
\end{equation*}
For $\Delta \in \mathbb{C}$, define $\gr_F(V)_{\Delta} = \bigoplus_{p \in \mathbb{N}}\sigma_p(F_pV_{\Delta})$.
Then $Ha = \Delta a$ for $a \in \gr_F(V)_{\Delta}$.
The family of subspaces $(\gr_F(V)_{\Delta})_{\Delta \in \mathbb{C}}$ satisfy $\gr_F(V) = \bigoplus_{\Delta \in \mathbb{C}} \gr_F(V)_{\Delta}$.
Therefore, the operator $H \in \End(\gr_F(V))$ is diagonalizable with $\gr_F(V)_{\Delta} = \ker(H - \Delta\Id_{\gr_F(V)})$.
In fact, more is true.

\begin{theorem}
  \label{thr:43}
  This diagonalizable operator $H$ is a Hamiltonian for $\gr_F(V)$.
\end{theorem}

\begin{proof}
  For $p, q \in \mathbb{N}$, $a \in F_pV$ and $b \in F_qV$,
  \begin{align*}
    [H, Y_-(\sigma_p(a), z)]\sigma_q(b) &= \sum_{n \in \mathbb{N}}\sigma_{p + q - n}([H, a_{(n)}]b)z^{-n - 1} \\
    &= \sum_{n \in \mathbb{N}}\sigma_{p + q - n}((-(n + 1)a_{(n)} + (Ha)_{(n)})b)z^{-n - 1} \\
    &= (z\partial_zY_-(\sigma_p(a), z) + Y_-(\sigma_p(Ha), z))\sigma_q(b). \qedhere
  \end{align*}
\end{proof}

We have the natural vector space isomorphisms
\begin{equation*}
  \sigma_p(F_pV_{\Delta}) \cong F_pV_{\Delta}/F_{p + 1}V_{\Delta} \quad \text{for }p \in \mathbb{Z}\text{ and }\Delta \in \mathbb{C}
\end{equation*}
and the double gradation
\begin{equation}
  \label{eq:32}
  \gr_F(V) = \bigoplus_{\substack{p \in \mathbb{N} \\ \Delta \in \mathbb{C}}}\sigma_p(F_pV_{\Delta}).
\end{equation}
By \eqref{eq:32}, when $\dim(V_{\Delta}) < \infty$ for $\Delta \in \mathbb{C}$, it is natural to define the \emph{refined character of $V$ with respect to the Li filtration} as
\begin{equation*}
  \ch_{\gr_F(V)}(t, q) = \sum_{\substack{p \in \mathbb{N} \\ \Delta \in \mathbb{C}}}\dim(\sigma_p(F_pV_{\Delta}))t^pq^{\Delta}.
\end{equation*}

If $f: V \to W$ is a homomorphism of vertex algebras, then
\begin{align*}
  \gr_F(f): \gr_F(V) &\to \gr_F(W), \\
  \sigma^V_p(a) &\mapsto \sigma^W_p(f(a)) \quad \text{for }p \in \mathbb{N}\text{ and }a \in F_pV,
\end{align*}
defines a homomorphism of vertex Poisson algebras.
If $V$ and $W$ are graded, then we require that $f$ respects the gradings of $V$ and $W$ and this implies that $\gr_F(f)$ also respects the gradings of $\gr_F(V)$ and $\gr_F(W)$.
Therefore, we obtain a functor
\begin{equation*}
  \gr_F: \{\text{(graded) vertex algebras}\} \to \{\text{(graded) vertex Poisson algebras}\}.
\end{equation*}

Assume that $V$ is an $\mathbb{N}$-graded vertex algebra with Hamiltonian $H$.
Let $(a^i)_{i \in I}$ be a family of homogeneous strong generators of $V$.
For $p \in \mathbb{Z}$, set
\begin{equation*}
  G^pV = \vspan\{a^{i_1}_{(-n_1 - 1)}\dots a^{i_s}_{(-n_s - 1)}\vac \mid s, n_1, \dots, n_s \in \mathbb{N}, i_1, \dots, i_s \in I, \Delta_{a^{i_1}} + \dots + \Delta_{a^{i_s}} \le p\}.
\end{equation*}

\begin{proposition}[{\cite{li_vertex_2004}}]
  \label{prp:10}
  The filtration $(G^pV)_{p \in \mathbb{Z}}$ satisfies:
  \begin{enumerate}
  \item $G^pV = 0$ for $p < 0$;
  \item $\vac \in G^0V \subseteq G^1V \subseteq \dots$;
  \item $V_n \subseteq G^nV$ for $n \in \mathbb{Z}$;
  \item $V = \bigcup_{p \in \mathbb{N}}G^pV$;
  \item $a_{(n)}G^qV \subseteq G^{p + q}V$ for $p, q \in \mathbb{Z}$, $a \in G^pV$ and $n \in \mathbb{Z}$;
  \item $a_{(n)}G^qV \subseteq G^{p + q - 1}V$ for $p, q \in \mathbb{Z}$, $a \in G^pV$ and $n \in \mathbb{N}$;
  \item $H(G^pV) \subseteq G^pV$ and $TG^pV \subseteq G^pV$ for $p \in \mathbb{Z}$.
  \end{enumerate}
\end{proposition}

Let
\begin{equation*}
  \gr^G(V) = \bigoplus_{p \in \mathbb{N}}G^pV/G^{p - 1}V
\end{equation*}
be the associated graded vector space.
By \cite{li_vertex_2004}, the vector space $\gr^G(V)$ a vertex Poisson algebra with operations given as follows: for $p, q \in \mathbb{N}$, $a \in G^pV$ and $b \in G^qV$, set
\begin{align*}
  \alpha^p(a)\alpha^q(b) &= \alpha^{p + q}(a_{(-1)}b), \\
  T\alpha^p(a) &= \alpha^p(Ta), \\
  Y_-(\alpha^p(a), z)\alpha^q(b) &= \sum_{n \in \mathbb{N}}\alpha^{p + q - 1}(a_{(n)}b)z^{-n - 1},
\end{align*}
where $\alpha^p: G^pV \to \gr^G(V)$ is the \emph{principal symbol map}.
The unit is $\alpha^0(\vac)$.
The filtration $(G^pV)_{p \in \mathbb{Z}}$ is called the \emph{standard filtration} of $V$.
By \Cref{prp:11} ahead, the standard filtration does not depend on the choice of the strong generators of $V$.

By \Cref{prp:10}(vii), we can define an operator $H \in \End(\gr^G(V))$ as $H(\alpha^p(a)) = \alpha^p(Ha)$ for $p \in \mathbb{Z}$ and $a \in G^pV$.
For $p \in \mathbb{Z}$ and $n \in \mathbb{N}$, define $G^pV_n = G^pV \cap V_n$.

Since $H(G^pV) \subseteq G^pV$ for $p \in \mathbb{Z}$, \Cref{lmm:9} implies that
\begin{equation*}
  G^pV = \bigoplus_{n \in \mathbb{N}}G^pV_n \quad \text{for }p \in \mathbb{Z}.
\end{equation*}
For $n \in \mathbb{N}$, define $\gr^G(V)_n = \bigoplus_{p \in \mathbb{N}}\alpha^p(G^pV_n)$.
Then $Ha = na$ for $a \in \gr^G(V)_n$.
The family of subspaces $(\gr^G(V)_n)_{n \in \mathbb{N}}$ satisfy $\gr^G(V) = \bigoplus_{n \in \mathbb{N}}\gr^G(V)_n$.
Therefore, the operator $H \in \End(\gr^G(V))$ is diagonalizable with $\gr^G(V)_n = \ker(H - n\Id_{\gr^G(V)})$.
In fact, more is true.

\begin{theorem}
  \label{thr:44}
  This diagonalizable operator $H$ is a Hamiltonian for $\gr^G(V)$.
\end{theorem}

\begin{proof}
  The proof of \Cref{thr:43} also works here.
\end{proof}

We have the natural vector space isomorphisms
\begin{equation*}
  \alpha^p(G^pV_n) \cong G^pV_n/G^{p - 1}V_n \quad \text{for }p \in \mathbb{Z}\text{ and }n \in \mathbb{N}
\end{equation*}
and the double gradation
\begin{equation}
  \label{eq:33}
  \gr^G(V) =\bigoplus_{p, n \in \mathbb{N}}\alpha^p(G^pV_n).
\end{equation}
By \eqref{eq:33}, when $\dim(V_n) < \infty$ for $n \in \mathbb{N}$, it is natural to define the \emph{refined character of $V$ with respect to the standard filtration} as
\begin{equation*}
  \ch_{\gr^G(V)}(t, q) = \sum_{p, n \in \mathbb{N}}\dim(\alpha^p(G^pV_n))t^pq^n.
\end{equation*}

If $f: V \to W$ is a homomorphism of $\mathbb{N}$-graded vertex algebras, then
\begin{align*}
  \gr^G(f): \gr^G(V) &\to \gr^G(W), \\
  \alpha_V^p(a) &\mapsto \alpha_W^p(f(a)) \quad \text{for }p \in \mathbb{N}\text{ and }a \in G^pV,
\end{align*}
defines a homomorphism of vertex Poisson algebras.
Therefore, we obtain a functor
\begin{equation*}
  \gr^G: \{\text{$\mathbb{N}$-graded vertex algebras}\} \to \{\text{$\mathbb{N}$-graded vertex Poisson algebras}\}.
\end{equation*}

\begin{proposition}[{\cite[Proposition 2.6.1]{arakawa_remark_2012}}]
  \label{prp:11}
  Let $V$ be an $\mathbb{N}$-graded vertex algebra.
  Then the Li filtration and standard filtration satisfy
  \begin{equation*}
    F_pV_n = G^{n - p}V_n \quad \text{for }p, n \in \mathbb{N}.
  \end{equation*}
  An explicit isomorphism $\gr_F(V) \xrightarrow{\sim} \gr^G(V)$ of vertex Poisson algebras is defined by extending linearly the isomorphisms of vector spaces given by
  \begin{align*}
    \sigma_p(F_pV_n) &\xrightarrow{\sim} \alpha^{n - p}(G^{n - p}V_n), \\
    \sigma_p(a) &\mapsto \alpha^{n - p}(a),
  \end{align*}
  where $p, n \in \mathbb{N}$ and $a \in F_pV_n$.
\end{proposition}

\begin{remark}
  \label{rmk:34}
  In \cite{arakawa_remark_2012}, it is suggested in a footnote that it is possible to consider more general $\tfrac{1}{r_0}\mathbb{N}$-graded vertex algebras instead of $\mathbb{N}$-graded vertex algebras.
  However, I don't think that is possible.
  For example, if $V = \Vir^{1/2}$ (which is the case we are interested here), then $V$ is $\tfrac{1}{2}\mathbb{N}$-graded.
  According to the definition of $\gr^G(V)$ given in \cite{arakawa_remark_2012}, we should have $\gr^G(V) = \bigoplus_{p \in \tfrac{1}{2}\mathbb{N}}G_pV/G_{p - 1}V = G_0V/G_{-1}V \oplus G_{1/2}V/G_{-1/2}V \oplus \dots = \mathbb{C}\vac \oplus \mathbb{C}\vac \oplus \dots$, which means ``the vacuum is doubled''.
  I don't think that is intended and also the proof of \cite[Proposition 2.6.1]{arakawa_remark_2012} does not work for $\tfrac{1}{r_0}\mathbb{N}$-graded vertex algebras.
  But I do think the hypothesis $V_0 = \mathbb{C}\vac$ can be removed, just as Arakawa wrote.
\end{remark}

\begin{theorem}
  \label{thr:45}
  Let $V$ be an $\mathbb{N}$-graded vertex algebra with $\dim(V_n) < \infty$ for $n \in \mathbb{N}$.
  The refined characters of $V$ are related as follows:
  \begin{enumerate}
  \item $\ch_V(q) = \ch_{\gr_F(V)}(q) = \ch_{\gr^G(V)}(q) = \ch_{\gr_F(V)}(1, q) = \ch_{\gr^G(V)}(1, q)$;
  \item $\ch_{\gr^G(V)}(t^{-1}, tq) = \ch_{\gr_F(V)}(t, q)$.
  \end{enumerate}
\end{theorem}

\begin{proof}
  See the proof of \Cref{prp:15} ahead.
\end{proof}

\begin{example}[$\gr^G(\Vir^c)$]
  \label{exa:12}
  Pick any $c \in \mathbb{C}$.
  Define the subalgebra $\Vir_{\le -2} = \bigoplus_{n \le -2}L_{n}$ of $\Vir$.
  By the PBW theorem, a basis of $U(\Vir_{\le -2})^s$ (see \Cref{sec:almost-comm-algebr} for the definition of $U(\Vir_{\le -2})^s$) is given by
  \begin{equation*}
    \{L_{\lambda} \mid t \le s\text{ and }[\lambda_1, \dots, \lambda_t]\text{ is a partition with }\lambda_t \ge 2\}.
  \end{equation*}
  Recall that $\Delta_{L_{-2}\vac} = 2$.
  From the definition of the standard filtration and \Cref{exa:5}, we see that for $s \in \mathbb{Z}$, $G^{2s}\Vir^c = G^{2s + 1}\Vir^c \cong U(\Vir_{\le -2})^s$.
  This implies that the quotients $G^{2s}\Vir^c/G^{2s + 1}\Vir^c$ are $0$ for $s \in \mathbb{N}$.
  Therefore, we have a vector space isomorphism
  \begin{align*}
    \gr^G(\Vir^c) &\xrightarrow{\sim} \gr(U(\Vir_{\le -2})), \\
    \alpha^{2s}(L_{\lambda}\vac) &\mapsto \gamma^s(L_{\lambda}) \quad \text{for }s \in \mathbb{N}\text{ and }\lambda = [\lambda_1, \dots, \lambda_s]\text{ a partition with }\lambda_s \ge 2.
  \end{align*}
  We now show this is an algebra homomorphism.
  We need to show that for $s, t \in \mathbb{N}$ and partitions $[\lambda_1, \dots, \lambda_s], [\eta_1, \dots, \eta_t]$ with $\lambda_s, \eta_t \ge 2$,
  \begin{equation*}
    \alpha^{2s}(L_{\lambda}\vac)\alpha^{2t}(L_{\eta}\vac) \mapsto \gamma^{s + t}(L_{\lambda}L_{\eta}),
  \end{equation*}
  which is equivalent to
  \begin{equation*}
    \alpha^{2s + 2t}((L_{\lambda}\vac)_{(-1)}(L_{\eta}\vac)) \mapsto \gamma^{s + t}(L_{\lambda}L_{\eta}).
  \end{equation*}
  Therefore, we have to show that
  \begin{equation}
    \label{eq:34}
    (L_{\lambda}\vac)_{(-1)}(L_{\eta}\vac) = (L_{\lambda}L_{\eta})\vac + a \quad \text{for some }a \in G^{2s - 1}\Vir^c.
  \end{equation}

  If $s = 0$ or $s = 1$, \eqref{eq:34} is clear.
  Assume $s \ge 2$.
  By \Cref{crl:1},
  \begin{align*}
    (L_\lambda\vac)_{(-1)}(L_{\eta}\vac) &= \left(\frac{:\partial_z^{\lambda_1 - 2}L(z)\dots\partial_z^{\lambda_s - 2}L(z):}{(\lambda_1 - 2)!\dots(\lambda_s - 2)!} \right)_{(-1)}(L_{\eta}\vac) \\
    &= \frac{(:\partial_z^{\lambda_1 - 2}L(z)\dots\partial_z^{\lambda_s - 2}L(z):)_{(-1)}(L_{\eta}\vac)}{(\lambda_1 - 2)!\dots(\lambda_s - 2)!},
  \end{align*}
  where $L(z) = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2} \in \mathcal{F}(\Vir^c)$.
  Now we use \Cref{lmm:3} with $V = \Vir^c$, $a^k(z) = \partial^{\lambda_k - 2}L(z)$ for $k = 1, \dots, s$ and $b = L_{\eta}\vac$.
  First, note that for $k = 1, \dots, s$,
  \begin{align*}
    a^k(z) &= \partial_z^{\lambda_k - 2}L(z) \\
    &= \sum_{n \in \mathbb{Z}}(-n - 2)\dots(-n - 2 - (\lambda_k - 3))L_nz^{-n - 2 - (\lambda_k - 2)} \\
    &= \sum_{n \in \mathbb{Z}}(-n + \lambda_k - 3)\dots(-n)L_{n + 1 - \lambda_k}z^{-n - 1},
  \end{align*}
  which says that
  \begin{equation*}
    a^k_{(n)} = (-n + \lambda_k - 3)\dots(-n)L_{n + 1 - \lambda_k} \quad \text{for }k = 1, \dots, s\text{ and }n \in \mathbb{Z}.
  \end{equation*}

  Note that each expression $R^{-1, k}_{n_1, \dots, n_{s - 1}}L_{\eta}\vac$ in \Cref{lmm:3} (where we omitted the fields $a^k(z)$ from the notation) is the sum of elements of the form
  \begin{equation*}
    \text{scalar}\cdot L_{\eta_1}\dots L_{\eta_s}(L_{\eta}\vac),
  \end{equation*}
  where $\eta_k \in \mathbb{Z}$ for $k = 1, \dots, s$.
  Furthermore, note that if $\eta_k \ge -1$ for some $k = 1, \dots, s$, then $L_{\eta_1}\dots L_{\eta_s}(L_{\eta}\vac) \in G^{2s - 1}\Vir^c$.
  Now we study these expressions $R^{-1, k}_{n_1, \dots, n_{s - 1}}L_{\eta}\vac$ by considering the elements that appear in the sum defining it.
  We consider several disjoint cases:
  \begin{enumerate}
  \item $k > 0$.
    If $n_{i_1} \ge \lambda_{i_1} - 2$ then $n_{i_1} + 1 - \lambda_{i_1} \ge -1$, so we get
    \begin{equation*}
      a^{j_1}_{(-n_{j_1} - 1)}\dots a^{j_{s - 1 - k}}_{(-n_{j_{s - 1 - k}} - 1)}a^s_{(l - k - \sum_{r = 1}^kn_{i_r} + \sum_{r = 1}^{s - 1 - k}n_{j_r})}a^{i_k}_{(n_{i_k})}\dots a^{i_1}_{(n_{i_1})}L_{\eta}\vac \in G^{2s - 1}\Vir^c.
    \end{equation*}
    If $n_{i_1} \le \lambda_{i_1} - 3$, then $a^{i_1}(z)_{(n_{i_1})}L_{\eta}\vac = 0$ because $(-n + \lambda_k - 3)\dots(-n) = 0$, so we get
    \begin{equation*}
      a^{j_1}_{(-n_{j_1} - 1)}\dots a^{j_{s - 1 - k}}_{(-n_{j_{s - 1 - k}} - 1)}a^s_{(l - k - \sum_{r = 1}^kn_{i_r} + \sum_{r = 1}^{s - 1 - k}n_{j_r})}a^{i_k}_{(n_{i_k})}\dots a^{i_1}_{(n_{i_1})}L_{\eta}\vac = 0.
    \end{equation*}
    Therefore, we obtain
    \begin{equation*}
      R^{-1, k}_{n_1, \dots, n_{s - 1}}L_{\eta}\vac \in G^{2s - 1}\Vir^c.
    \end{equation*}
  \item $k = 0$ and there exists some $j = 1, \dots, s - 1$ such that $n_j > 0$.
    In this case, we get
    \begin{equation*}
      R^{-1, 0}_{n_1, \dots, n_{s - 1}}L_{\eta}\vac = a^1_{(-n_1 - 1)}\dots a^{s - 1}_{(-n_{s - 1} - 1)}a^s_{(-1 + \sum_{r = 1}^{s - 1}n_r)}L_{\eta}\vac \in G^{2s - 1}\Vir^c
    \end{equation*}
    because we can repeat the reasoning of (i) with $-1 + \sum_{r = 1}^{s - 1}n_r$ instead of $n_{i_1}$.
  \item $k = 0$ and $n_1 = \dots = n_{s - 1} = 0$.
    In this case, we get
    \begin{equation*}
      R^{-1, 0}_{0, \dots, 0} = a^1_{(-1)}\dots a^{s - 1}_{(-1)}a^s_{(-1)} L_{\eta}\vac = (\lambda_1 - 2)!\dots(\lambda_s - 2)!L_{\lambda} L_{\eta}\vac.
    \end{equation*}
  \end{enumerate}
  From these three cases we obtain \eqref{eq:34}.

  We conclude that we have an algebra isomorphism $\gr^G(\Vir^c) \xrightarrow{\sim} \gr(U(\Vir_{\le -2}))$.
  Composing this with the inverse of the isomorphism $S(\mathfrak{g}) \to \gr(U(\Vir_{\le -2}))$ in \Cref{sec:almost-comm-algebr} and taking $(L_n)_{n \le -2}$ as the basis of $\Vir_{\le -2}$, we obtain the following isomorphism of commutative associative algebras with unit
  \begin{align*}
  \gr^G(\Vir^c) &\xrightarrow{\sim} \mathbb{C}[L_{-2}, L_{-3}, \dots], \\
  \alpha^{2s}(L_{-n_1 - 2}\dots L_{-n_s - 2}\vac) &\mapsto L_{-n_1 - 2}\dots L_{-n_s - 2} \quad \text{for }s, n_1, \dots, n_s \in \mathbb{N}.
  \end{align*}
  In particular, the isomorphism does not depend on $c$.

  The endomorphism $T \in \End(\mathbb{C}[L_{-2}, L_{-3}, \dots])$ is given by $T(L_{-n}) = (n - 1)L_{-n - 1}$ for $n \ge 2$ which is extended to a derivation.

  The Poisson structure on $\gr^G(\Vir^c)$ is trivial (i.e.\ the map $Y_-$ is zero) because for $s \in \mathbb{Z}$, $G^{2s}\Vir^c = G^{2s + 1}\Vir^c$.
\end{example}

\subsection{Filtrations of modules over vertex algebras}
\label{sec:filtr-modul-over}

Let $V$ be a vertex algebra, $(a^i)_{i \in I}$ a family of strong generators of $V$ and let $M$ be a $V$-module.
For $p \in \mathbb{Z}$, set
\begin{equation*}
  F_pM = \vspan \{a^{i_1M}_{(-n_1 - 1)}\dots a^{i_sM}_{(-n_s - 1)}u \mid s, n_1, \dots, n_s \in \mathbb{N}, i_1, \dots, i_s \in I, u \in M, n_1 + \dots + n_s \ge p\}.
\end{equation*}

\begin{proposition}[{\cite{li_abelianizing_2005}}]
  \label{prp:12}
  The filtration $(F_pM)_{p \in \mathbb{Z}}$ satisfies:
  \begin{enumerate}
  \item $M = F_pM$ for $p \le 0$;
  \item $F_0M \supseteq F_1M \supseteq \dots$;
  \item $a_{(n)}F_qM \subseteq F_{p + q - n - 1}M$ for $p, q \in \mathbb{Z}$, $a \in F_pV$ and $n \in \mathbb{Z}$;
  \item $a_{(n)}F_qM \subseteq F_{p + q - n}M$ for $p, q \in \mathbb{Z}$, $a \in F_pV$ and $n \in \mathbb{N}$.
  \end{enumerate}
\end{proposition}

Let
\begin{equation*}
  \gr_F(M) = \bigoplus_{p \in \mathbb{N}}F_pM/F_{p + 1}M
\end{equation*}
be the associated graded vector space.
The vector space $\gr_F(M)$ is a module over the $\gr_F(V)$ with operations given as follows: for $p, q \in \mathbb{N}$, $a \in F_pV$ and $u \in F_pM$, set
\begin{align*}
  \sigma_p(a)\sigma^M_q(u) &= \sigma^M_{p + q}(a^M_{(-1)}u), \\
  Y^M_-(\sigma_p(a), z)\sigma^M_q(u) &= \sum_{n \in \mathbb{N}}\sigma^M_{p + q - n}(a^M_{(n)}u)z^{-n - 1},
\end{align*}
where $\sigma^M_p: F_pM \to \gr_F(M)$ is the principal symbol map.
The filtration $(F_pM)_{p \in \mathbb{Z}}$ is called the Li filtration of $M$.

Note that if $V$ were conformal with conformal vector $\omega$, then we don't always have the property $L_{-1}^MF_pM \subseteq F_{p + 1}M$ for $p \in \mathbb{Z}$, where $Y(\omega, z) = \sum_{n \in \mathbb{Z}}L^M_nz^{-n - 2}$.
For example, for $V = \Vir^{1/2}$, $M = M(1/2, 1/2)$ and $\vachalf \in F_0M$, we have $L_{-1}\vachalf \notin F_1M$.

\begin{remark}
  \label{rmk:35}
  The observation above makes \cite[Lemma 3.1.2]{arakawa_remark_2012} incorrect because the expression $\sigma_{p - 1}(\omega_{(0)}m)$ that is written there (that should be $\sigma_{p + 1}(\omega_{(0)}m)$ but it still doesn't work) is not well defined.
  I couldn't fix this problem and I don't think it is possible to define a differential on $\gr_F(M)$ in a meaningful way.
  We won't need that differential in this thesis, though.
\end{remark}

\begin{lemma}[{\cite[Lemma 2.9]{li_abelianizing_2005}}]
  \label{lmm:19}
  Let $V$ be a vertex algebra and let $M$ be a $V$-module.
  Then
  \begin{equation*}
    F_pM = \vspan\{a^M_{(-i - 1)}u \mid a \in V, i \in \mathbb{Z}_+, u \in F_{p - i}M\} \quad \text{for }p \in \mathbb{Z}_+.
  \end{equation*}
\end{lemma}

By \Cref{lmm:19}, the Li filtration depends only on $M$ and not on the choice of the strong generators of $V$.
If $V$ is graded by a Hamiltonian $H$ and $M$ is graded by a Hamiltonian $H^M$, then $H^M(F_pM) \subseteq F_pM$ because in that case, for $p \in \mathbb{Z}$,
\begin{equation*}
  \begin{split}
    F_pM = \vspan \{a^1_{(-n_1 - 1)}\dots a^s_{(-n_s - 1)}u &\mid s, n_1, \dots, n_s \in \mathbb{N}, a^i \in V\text{ homogeneous},\\
    &\quad u \in M\text{ homogeneous}, n_1 + \dots + n_s \ge p\}.
  \end{split}
\end{equation*}

Therefore, we can define an operator $H^M \in \End(\gr_F(M))$ as $H^M(\sigma^M_p(u)) = \sigma^M_p(Hu)$ for $p \in \mathbb{N}$ and $u \in F_pM$.
For $p \in \mathbb{Z}$ and $\Delta \in \mathbb{C}$, define $F_pM_{\Delta} = F_pM \cap M_{\Delta}$.
Since $H^M(F_pM) \subseteq F_pM$ for $p \in \mathbb{Z}$, \Cref{lmm:9} implies that
\begin{equation*}
  F_pM = \bigoplus_{\Delta \in \mathbb{C}}F_pM_{\Delta} \quad \text{for }p \in \mathbb{Z}.
\end{equation*}
For $\Delta \in \mathbb{C}$, define $\gr_F(M)_{\Delta} = \bigoplus_{p \in \mathbb{N}}\sigma^M_p(F_pM_{\Delta})$.
Then $H^Mu = \Delta u$ for $u \in \gr_F(M)_{\Delta}$.
The family of subspaces $(\gr_F(M)_{\Delta})_{\Delta \in \mathbb{C}}$ satisfy $\gr_F(M) = \bigoplus_{\Delta \in \mathbb{C}}\gr_F(M)_{\Delta}$.
Therefore, the operator $H^M \in \End(\gr_F(M))$ is diagonalizable with grading $\gr_F(M)_{\Delta} = \ker(H^M - \Delta\Id_{\gr_F(M)})$.
In fact, more is true.

\begin{theorem}
  \label{thr:46}
  This diagonalizable operator $H^M$ is a Hamiltonian for $\gr_F(M)$.
\end{theorem}

\begin{proof}
  The proof of \Cref{thr:43} also works here.
\end{proof}

We have the natural vector space isomorphisms
\begin{equation*}
  \sigma^M_p(F_pM_{\Delta}) \cong F_pM_{\Delta}/F_{p + 1}M_{\Delta} \quad \text{for }p \in \mathbb{Z}\text{ and }\Delta \in \mathbb{C}
\end{equation*}
and the double gradation
\begin{equation}
  \label{eq:35}
  \gr_F(M) =\bigoplus_{\substack{p \in \mathbb{N} \\ \Delta \in \mathbb{C}}}\sigma_p(F_pM_{\Delta}).
\end{equation}
By \eqref{eq:35}, when $\dim(M)_{\Delta} < \infty$ for $\Delta \in \mathbb{C}$, it is natural to define refined series of $M$ with respect to the Li filtration as
\begin{equation*}
  \ch_{\gr_F(M)}(t, q) = \sum_{\substack{p \in \mathbb{N} \\ \Delta \in \mathbb{C}}}\dim(\sigma_p(F_pM_{\Delta}))t^pq^{\Delta}.
\end{equation*}

If $f: M_1 \to M_2$ is a homomorphism of $V$-modules, then
\begin{align*}
  \gr_F(f): \gr_F(M_1) &\to \gr_F(M_2), \\
  \sigma^{M_1}_p(u_1) &\mapsto \sigma^{M_2}_p(f(u_1)) \quad \text{for }p \in \mathbb{N}\text{ and }u_1 \in F_pM_1,
\end{align*}
defines a homomorphism of $\gr_F(V)$-modules.
If $M_1$ and $M_2$ are graded, then we require that $f$ respects the gradings of $M_1$ and $M_2$ and this implies that $\gr_F(f)$ also respects the gradings of $\gr_F(M_1)$ and $\gr_F(M_2)$.
Therefore, we obtain a functor
\begin{equation*}
  \gr_F: \{\text{(graded) $V$-modules}\} \to \{\text{(graded) $\gr_F(V)$-modules}\}.
\end{equation*}

Now we introduce a definition not given by Li in \cite{li_vertex_2004}.
Let $V$ be an $\mathbb{N}$-graded conformal vertex algebra with conformal vector $\omega$, $(a^i)_{i \in I}$ a family of homogeneous strong generators of $V$ and let $M$ be a $h + \mathbb{N}$-graded $(V, \omega)$-module.
This means $M$ is a $V$-module with $L_0^M$ diagonalizable whose eigenvalues are in the set $h + \mathbb{N}$ for some $h \in \mathbb{C}$.
Set $M_\Delta = \ker(L^M_0 - \Delta\Id_M)$ for $\Delta \in \mathbb{C}$ so we have $M = \bigoplus_{n \in \mathbb{N}}M_{h + n}$.
For $p \in \mathbb{Z}$, set

\begin{equation*}
  \begin{split}
    G^pM = \vspan\{a^{i_1M}_{(-n_1 - 1)}\dots a^{i_sM}_{(-n_s - 1)}u &\mid s, n_1, \dots, n_s \in \mathbb{N}, i_1, \dots, i_s \in I, u \in M_{\Delta_u} \text{ and }\\
    &\quad \Delta_{a^{i_1}} + \dots + \Delta_{a^{i_s}} + \Delta_u - h \le p\}.
  \end{split}
\end{equation*}

\begin{proposition}
  \label{prp:13}
  The filtration $(G^pM)_{p \in \mathbb{Z}}$ satisfies:
  \begin{enumerate}
  \item $G^pM = 0$ for $p < 0$;
  \item $G^0M \subseteq G^1M \subseteq \dots$;
  \item $M_{h + n} \subseteq G^nM$ for $n \in \mathbb{Z}$;
  \item $M = \bigcup_{p \in \mathbb{N}}G^pM$;
  \item $a^M_{(n)}G^qM \subseteq G^{p + q}M$ for $p, q \in \mathbb{Z}$, $a \in G^pV$ and $n \in \mathbb{Z}$;
  \item $a^M_{(n)}G^qM \subseteq G^{p + q - 1}M$ for $p, q \in \mathbb{Z}$, $a \in G^pV$ and $n \in \mathbb{N}$;
  \item $L^M_0G^pM \subseteq G^pM$ and $L^M_{-1}G^pM \subseteq G^{p + 1}M$ for $p \in \mathbb{Z}$.
  \end{enumerate}
\end{proposition}

\begin{proof}
  The proofs in \cite{li_vertex_2004} also work here but there is an additional $\pm h$ hanging around.
\end{proof}

\begin{remark}
  \label{rmk:36}
  Note that we don't have the property $L_{-1}^MG^pM \subseteq G^pM$ as in the case of vertex algebras.
\end{remark}

Let
\begin{equation*}
  \gr^G(M) = \bigoplus_{p \in \mathbb{N}}G^pM/G^{p - 1}M
\end{equation*}
be the associated graded vector space.
The vector space $\gr^G(M)$ a module over $\gr^G(V)$ with operations given as follows: for $p, q \in \mathbb{N}$, $a \in G^pV$ and $u \in G^qM$, set
\begin{align*}
  \alpha^p(a)\alpha_M^q(u) &= \alpha_M^{p + q}(a^M_{(-1)}u), \\
  Y^M_-(\alpha^p(a), z)\alpha_M^q(u) &= \sum_{n \in \mathbb{N}}\alpha_M^{p + q - 1}(a^M_{(n)}u)z^{-n - 1},
\end{align*}
where $\alpha_M^p: G^pM \to \gr^G(M)$ is the principal symbol map.
The filtration $(G^pM)_{p \in \mathbb{Z}}$ is called the standard filtration of $M$.
By \Cref{prp:14} ahead, the standard filtration does not depend on the choice of the strong generators of $V$.

By \Cref{prp:10}(vii), we can define an operator $H^M \in \End(\gr^G(M))$ as $H^M(\alpha_M^p(u)) = \alpha_M^p(L^M_0u)$ for $p \in \mathbb{Z}$ and $u \in G^pM$.
For $p \in \mathbb{Z}$ and $n \in \mathbb{N}$, define $G^pM_{h + n} = G^pV \cap M_{h + n}$.

Since $L_0^M(G^pM) \subseteq G^pM$ for $p \in \mathbb{Z}$, \Cref{lmm:9} implies that
\begin{equation*}
  G^pM = \bigoplus_{n \in \mathbb{N}}G^pM_{h + n} \quad \text{for }p \in \mathbb{Z}.
\end{equation*}
For $n \in \mathbb{N}$, define $\gr^G(M)_{h + n} = \bigoplus_{p \in \mathbb{N}}\alpha_M^p(G^pM_{h + n})$.
Then $H^Mu = (h + n)u$ for $u \in \gr^G(M)_{h + n}$.
The family of subspaces $(\gr^G(M)_{h + n})_{n \in \mathbb{N}}$ satisfy $\gr^G(M) = \bigoplus_{n \in \mathbb{N}} \gr^G(M)_{h + n}$.
Therefore, the operator $H^M \in \End(\gr^G(M))$ is diagonalizable with $\gr^G(M)_{h + n} = \ker(H - (h + n)\Id_{\gr^G(M)})$.
In fact, more is true.

\begin{theorem}
  \label{thr:47}
  This diagonalizable operator $H^M$ is a Hamiltonian for $\gr^G(M)$.
\end{theorem}

\begin{proof}
  The proof of \Cref{thr:43} also works here.
\end{proof}

We have the natural vector space isomorphisms
\begin{equation*}
  \alpha_M^p(G^pM_{h + n}) \cong G^pM_{h + n}/G^{p - 1}M_{h + n} \quad \text{for }p \in \mathbb{Z}\text{ and }n \in \mathbb{N}
\end{equation*}
and the double gradation
\begin{equation}
  \label{eq:36}
  \gr^G(M) = \bigoplus_{p, n \in \mathbb{N}}\alpha_M^p(G^pM_{h + n}).
\end{equation}
By \eqref{eq:36}, when $M$ is ordinary (which means $\dim(M_{h + n}) < \infty$ for $n \in \mathbb{N}$), it is natural to define refined series of $M$ with respect to the standard filtration as
\begin{equation*}
  \ch_{\gr^G(M)}(t, q) = \sum_{p, n \in \mathbb{N}}\dim(\alpha_m^p(G^pM_{h + n}))t^pq^{h + n}.
\end{equation*}

If $f: M_1 \to M_2$ is a homomorphism of $h + \mathbb{N}$-graded $(V, \omega)$-modules, then
\begin{align*}
  \gr^G(f): \gr^G(M_1) &\to \gr^G(M_2), \\
  \alpha^p_{M_1}(u_1) &\mapsto \alpha^p_{M_2}(f(u_1)) \quad \text{for }p \in \mathbb{N}\text{ and }u_1 \in G^pM_1,
\end{align*}
defines a homomorphism of $h + \mathbb{N}$-graded $\gr^G(V)$-modules.
Therefore, we obtain a functor
\begin{equation*}
  \gr^G: \{\text{$h + \mathbb{N}$-graded $(V, \omega)$-modules}\} \to \{\text{$h + \mathbb{N}$-graded $\gr^G(V)$-modules}\}.
\end{equation*}

\begin{proposition}
  \label{prp:14}
  Let $(V, \omega)$ be an $\mathbb{N}$-graded conformal vertex algebra and let $M$ be a $h + \mathbb{N}$-graded $(V, \omega)$-module.
  Then the Li filtration and standard filtration satisfy
  \begin{equation*}
    F_pM_{h + n} = G^{n - p}M_{h + n} \quad \text{for }p, n \in \mathbb{N}.
  \end{equation*}
  An explicit isomorphism $\gr_F(M) \xrightarrow{\sim} \gr^G(M)$ of modules is defined by extending linearly the isomorphisms of vector spaces given by
  \begin{align*}
    \sigma^M_p(F_pM_{h + n}) &\xrightarrow{\sim} \alpha^{n - p}_M(G^{n - p}M_{h + n}), \\
    \sigma^M_p(u) &\mapsto \alpha^{n - p}_M(u),
  \end{align*}
  where $p, n \in \mathbb{N}$ and $u \in F_pM_{h + n}$.
\end{proposition}

\begin{proof}
  We recall three facts:
  \begin{enumerate}[label = (\alph*)]
  \item $G^nM \supseteq M_{h + n}$ for $n \in \mathbb{N}$;
  \item $\Delta_{a^M_{(n)}u} = \Delta_a + \Delta_u - n - 1$ for homogeneous $a \in V$, $u \in M$ and $n \in \mathbb{Z}$;
  \item $F_pM_{h + n} = \vspan\{a^{i_1M}_{(-n_1 - 1)}u \mid i_1 \in I, n_1 \in \mathbb{Z}_+\text{ and }u \in F_{p - n_1}M_{\Delta_u}\text{ with }\Delta_{a^{i_1}} + \Delta_u + n_1 = h + n\}$ for any $p \in \mathbb{Z}_+$ and $n \in \mathbb{N}$.
  \end{enumerate}
  First, we prove the inclusion $F_pM_{h + n} \subseteq G^{n - p}M_{h + n}$ for $p, n \in \mathbb{N}$.
  We do this by induction on $p \in \mathbb{N}$.
  The base case $p = 0$ is true by property (a) above.
  Now assume $p \ge 1$ and $F_qM_{h + n} \subseteq G^{n - q}M_{h + n}$ for $q < p$ and $n \in \mathbb{N}$.
  Pick an element $a^{i_1M}_{(-n_1 - 1)}u$ from the spanning set of $F_pM_{h + n}$ in (c) above, with $i_1 \in I$, $n_1 \in \mathbb{Z}_+$ and $u \in F_{p - n_1}M_{\Delta_u}$.
  We know that $u \in G^{\Delta_u - h - p + n_1}M_{\Delta_u}$ by the induction hypothesis and also $a \in V_{\Delta_{a^{i_1}}} \subseteq G^{\Delta_{a^{i_1}}}V$.
  Therefore, by \Cref{prp:13}(v), $a^{i_1M}_{(-n_1 - 1)}u \in G^{\Delta_{a^{i_1}} + \Delta_u - h - p + n_1}M = G^{n - p}M$.

  Now we prove the inclusion $G^{n - p}M_{h + n} \subseteq F_pM_{h + n}$.
  Pick an element $a^{i_1M}_{(-n_1 - 1)}\dots a^{i_sM}_{(-n_s - 1)}u$ from the spanning set of $G^{n - p}M_{h + n}$, where $u \in M_{\Delta_u}, s, n_1, \dots, n_s \in \mathbb{N}, i_1, \dots, i_s \in I\text{ and }\Delta_{a^{i_1}} + \dots + \Delta_{a^{i_s}} + \Delta_u - h \le n - p$.
  We must have $\Delta_{a^{i_1}} + \dots + \Delta_{a^{i_s}} + \Delta_u + n_1 + \dots + n_s = h + n$ by property (b) above.
  Therefore $p \le n_1 + \dots + n_s$, so we get $a^{i_1M}_{(-n_1 - 1)}\dots a^{i_sM}_{(-n_s - 1)}u \in F_pM$ straight from the definition of $F_pM$.

  We verify that we obtain an isomorphism $\gr_F(M) \xrightarrow{\sim} \gr^G(M)$ directly from the definitions (cf.\ \Cref{prp:11}).
\end{proof}

\Cref{prp:14} translates into an identity of the refined characters of $\gr_F(M)$ and $\gr^G(M)$ as the following proposition shows.

\begin{proposition}
  \label{prp:15}
  Let $(V, \omega)$ be an $\mathbb{N}$-graded conformal vertex algebra and let $M$ be a $h + \mathbb{N}$-graded $(V, \omega)$-module.
  Then:
  \begin{enumerate}
  \item $\ch_M(q) = \ch_{\gr_F(M)}(q) = \ch_{\gr^G(M)}(q) = \ch_{\gr_F(M)}(1, q) = \ch_{\gr^G(M)}(1, q)$;
  \item $\ch_{\gr^G(M)}(t^{-1}, tq) = t^h\ch_{\gr_F(M)}(t, q)$.
  \end{enumerate}
\end{proposition}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item This is clear from the properties and definition of the filtrations.
  \item This follows from \Cref{prp:14} and replacing $p$ by $n - p$ in the following computation
    \begin{align*}
    \ch_{\gr^G(M)}(t^{-1}, tq) &= \sum_{p, n \in \mathbb{N}}\dim(\alpha^p_M(G^pM_{h + n}))t^{-p}(tq)^{h + n} \\
    &= \sum_{p, n \in \mathbb{N}}\dim(\alpha^p_M(G^pM_{h + n}))t^{h + n - p}q^{h + n} \\
    &= \sum_{p, n \in \mathbb{N}}\dim(\alpha^{n - p}_M(G^{n - p}M_{h + n}))t^{h + p}q^{h + n} \\
    &= t^h\ch_{\gr_F(M)}(t, q). \qedhere
    \end{align*}
  \end{enumerate}
\end{proof}

\begin{example}[$\gr^G(M(c, h))$]
  \label{exa:13}
  Pick $c, h \in \mathbb{C}$.
  By \Cref{thr:25}, the Verma module $M(c, h)$ is a module over $\Vir^c$ as a vertex algebra.
  From \Cref{exa:12}, $\gr^G(\Vir^c)$ is isomorphic to $\mathbb{C}[L_{-2}, L_{-3}, \dots]$.
  In a similar way, we can prove that $\gr^G(M(c, h))$ is a free $\gr^G(\Vir^c)$-module
  \begin{equation*}
    \gr^G(M(c, h)) = \bigoplus_{k \in \mathbb{N}}\gr^G(\Vir^c)L_{-1}^k.
  \end{equation*}
  More precisely, the isomorphism is given by
  \begin{align*}
    \gr^G(M(c, h)) &\xrightarrow{\sim} \bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k, \\
    \alpha_{M(c, h)}^{2s + k}(L_{-n_1 - 2}^{M(c, h)}\dots L_{-n_s - 2}^{M(c, h)}(L_{-1}^{M(c, h)})^k|c, h\rangle) &\mapsto L_{-n_1 - 2}\dots L_{-n_s - 2}L_{-1}^k,
  \end{align*}
  where $s, k, n_1, \dots, n_s \in \mathbb{N}$.
\end{example}

\begin{remark}
  \label{rmk:37}
  That $+k$ in the isomorphism above is what makes this filtration different from the PBW filtration (see \Cref{sec:almost-comm-algebr}) where all $L_n$ for $n \le -1$ have the same length.
  On the other hand, with the standard filtration $L_{-1}$ has length equal to $1$ while $L_{-2}$, $L_{-3}, \dots$ have length equal to $2$.
\end{remark}

\begin{remark}
  \label{rmk:38}
  We could've done the theory of standard filtrations of modules for admissible modules over $\mathbb{N}$-graded vertex algebras (or maybe even over admissible $\mathbb{Z}$-graded vertex algebras like it is done in \cite{li_vertex_2004}).
  However, if we do it like that, the characters wouldn't have good meanings because one can always shift the gradation in admissible modules and also the term $q^h$ is lost.
\end{remark}

\section{PBW basis of $L(1/2, 1/2)$ and its refined character}
\label{sec:pbw-basis-l12}

In this section, our objective is to determine a monomial basis of $L(1/2, 1/2)$ explicitly and a formula for the refined character of $\gr^G(L(1/2, 1/2))$ with respect to the standard filtration introduced in \Cref{sec:filtr-modul-over}.
We present a family of series in two variables $f_{a, b, c, d}(t, q)$, where $a, b, c, d \in \mathbb{N}$ are the parameters, which are Nahm sums for the same matrix $\left(\begin{smallmatrix} 8 & 3 \\ 3 & 2 \end{smallmatrix}\right)$ (cf.\ \cite{Nahm2007}) when we set $t = 1$.
These series satisfy some recursive relations which will help us to prove series identities.
Then we find a formula for the refined character of $\gr^G(L(1/2, 1/2))$ using these series and the recursive relations they satisfy.
The arguments are elementary and combinatorial but lengthy.
We recover the series obtained in \cite[Theorem 4]{andrews_singular_2022} when we set $t = 1$, as expected.
In the explicit monomial basis of \Cref{thr:4}, there are ordinary and exceptional partitions.
The ordinary partitions are handled by the theory of $\Vir_{1/2}$-modules done in \Cref{sec:modul-over-viras}.
The exceptional partitions are handled with computer software.
As we can see, the arguments are similar to those in \cite{andrews_singular_2022} but there are some differences like the use of the Zhu algebra here but not in \cite{andrews_singular_2022}.
Finally, we give formal proofs of the theorems in \Cref{sec:introduction} about $L(1/2, 1/2)$.

\subsection{Conventions and notation}
\label{sec:conventions-notation}

Throughout this section, $V$ will always denote the vertex algebra $\Vir^{1/2}$.
From now on, some indexes or subindexes of modules will not be written, so for example, $\alpha^p_M$ simplifies to $\alpha^p$.
Set
\begin{align*}
  M &= M(1/2, 1/2), \\
  L &= L(1/2, 1/2), \\
  W &= J(1/2, 1/2).
\end{align*}

Then $M$ and $L$ are $V$-modules and by definition, $L = M/W$.
By \Cref{thr:41},
\begin{equation}
  \label{eq:37}
  W = U(\Vir)\{u_2, u_3\},
\end{equation}
where
\begin{align*}
  u_2 &= (L_{-1}^2 - \tfrac{4}{3}L_{-2})\vachalf, \\
  u_3 &= (L_{-1}^3 - 3L_{-2}L_{-1} + \tfrac{3}{4}L_{-3})\vachalf
\end{align*}
are the generating singular vectors.

We have a natural epimorphism of $V$-modules:
\begin{align*}
  \pi: M &\twoheadrightarrow L, \\
  \pi(u) &= u + W.
\end{align*}

Applying the functor $\gr^G$ we obtain a epimorphism of modules over $\gr^G(V)$
\begin{equation*}
  \gr^G(\pi): \gr^G(M) \twoheadrightarrow \gr^G(L)
\end{equation*}
and this produces a natural isomorphism of modules over $\gr^G(V)$
\begin{equation*}
  \gr^G(M)/K \xrightarrow{\sim} \gr^G(L),
\end{equation*}
where
\begin{equation}
  \label{eq:38}
  K = \ker(\gr^G(\pi)).
\end{equation}

The isomorphism in \Cref{exa:13} justify the following definitions.
For a partition $\lambda = [\lambda_1, \dots, \lambda_m, 1, \dots, 1]$ with exactly $n$ ones, define $u_{\lambda} \in \bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k$ by setting
\begin{equation*}
  u_{\lambda} = L_{-\lambda_1}\dots L_{-\lambda_m}L_{-1}^n,
\end{equation*}
where $L_{-1}^n$ is the $n$-th element of the canonical basis.
Define the \emph{length} of $\lambda$ as
\begin{equation*}
  \len(\lambda) = 2m + n
\end{equation*}
and the \emph{weight} of $\lambda$ as
\begin{equation*}
  \Delta(\lambda) = \lambda_1 + \dots + \lambda_m + n.
\end{equation*}
Therefore, for a partition $\lambda$ we have
\begin{equation*}
  L_{\lambda}\vachalf \in G^{\len(\lambda)}M_{1/2 + \Delta(\lambda)}.
\end{equation*}
For a partition $\lambda = [\lambda_1, \dots, \lambda_m]$ with $\lambda_m \ge 2$, define $p_{\lambda} \in \mathbb{C}[L_{-2}, L_{-3}, \dots]$ by setting
\begin{equation*}
  p_{\lambda} = L_{-\lambda_1}\dots L_{-\lambda_m}.
\end{equation*}

From the epimorphism of $V$-modules $\pi: M \twoheadrightarrow L$, we deduce the following four isomorphisms which are going to be used frequently implicitly.

\begin{proposition}
  \label{prp:16}
  We have four (conformal) weight-preserving vector space isomorphisms
  \begin{align*}
    M &\xrightarrow{\sim} \gr^G(M), \\
    L_{\lambda}\vachalf &\mapsto \alpha^{\len(\lambda)}(L_{\lambda}\vachalf), \\
    \gr^G(M) &\xrightarrow{\sim} \bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k, \\
    \alpha^{\len(\lambda)}(L_{\lambda}\vachalf) &\mapsto u_{\lambda}, \\
    L &\xrightarrow{\sim} \gr^G(L), \\
    L_{\lambda}(\vachalf + W) &\mapsto \alpha^{\len(\lambda)}(L_{\lambda}(\vachalf + W)), \\
    \gr^G(L) &\xrightarrow{\sim} \gr^G(M)/K, \\
    \alpha^{\len(\lambda)}(L_{\lambda}(\vachalf + W)) &\mapsto \alpha^{\len(\lambda)}(L_{\lambda}\vachalf) + K,
  \end{align*}
  where $\lambda$ is a partition.
\end{proposition}

In this thesis, we will deal with polynomial algebras written as $\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]$ and free modules of the form $\bigoplus_{n \le N}\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]L_{-1}^n$ for some $N \in \mathbb{N}$.
We will always use the degree reverse lexicographical ordering with $L_{-2} > L_{-3} > \dots > L_{-N}$ and TOP (term over position) with $L_{-1}^0 < L_{-1}^1 < \dots < L_{-1}^N$.
We can extend the definition of $\lm$ (leading monomial) as follows: for any element $u \in \bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k$, pick $N$ large enough so that $u \in \bigoplus_{n \le N}\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]L_{-1}^n$.
Then define $\lm(u)$ as the leading monomial in $\bigoplus_{n \le N}\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]L_{-1}^n$ which is naturally a subset of $\bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k$.
This doesn't depend on the choice of $N$.
For example, $\lm(L_{-2} - \frac{3}{4}L_{-1}^2) = L_{-2}$.

When working with $q$-series, the following notation is useful.
The \emph{$q$-Pochhammer symbol} is $(q)_n = \prod_{j = 1}^n(1 - q^j) \in \mathbb{C}[[q]]$ for $n \in \mathbb{N}$.
The recursive proofs of the series identities in \cite{andrews_singular_2022} suggest the following definition: for $a, b, c, d \in \mathbb{N}$, define
\begin{equation*}
  f_{a, b, c, d}(t, q) = \sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2 + d}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2 + ak_1 + bk_2 + c}}{(q)_{k_1}(q)_{k_2}} \in \mathbb{C}[[t, q]].
\end{equation*}
The following lemma will be very useful to verify series identities.

\begin{lemma}
  \label{lmm:20}
  The series $f_{a, b, c, d}(t, q)$ satisfies:
  \begin{enumerate}
  \item $t^mq^nf_{a, b, c, d}(t, q) = f_{a, b, c + n, d + m}(t, q)$ for $m, n \in \mathbb{N}$;
  \item $f_{a, b, c, d}(tq^n, q) = f_{a + 4n, b + 2n, c + dn, d}(t, q)$ for $n \in \frac{1}{2}\mathbb{N}$ and $d \in 2\mathbb{N}$;
  \item $f_{a, b, c, d}(t, q) - f_{a + n, b, c, d}(t, q) = \sum_{k = 0}^{n - 1}f_{a + 8 + k, b + 3, a + c + 4 + k, d + 4}(t, q)$ for $n \in \mathbb{Z}_+$;
  \item $f_{a, b, c, d}(t, q) - f_{a, b + n, c, d}(t, q) = \sum_{k = 0}^{n - 1}f_{a + 3, b + 2 + k, b + c + 1 + k, d + 2}(t, q)$ for $n \in \mathbb{Z}_+$.
  \end{enumerate}
\end{lemma}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item Clear.
  \item Clear.
  \item The key step is replacing $k_1$ by $k_1 + 1$ in the following computation
    \begin{align*}
      f_{a, b, c, d}(t, q) - f_{a + n, b, c, d}(t, q) &= \sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2 + d}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2 + ak_1 + bk_2 + c}}{(q)_{k_1}(q)_{k_2}}(1 - q^{nk_1}) \\
      &= \sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2 + d}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2 + ak_1 + bk_2 + c}}{(q)_{k_1}(q)_{k_2}}(1 - q^{k_1})\sum_{k = 0}^{n - 1}q^{kk_1} \\
      &= \sum_{k = 0}^{n - 1}\sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2 + d}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2 + (a + k)k_1 + bk_2 + c}}{(q)_{k_1}(q)_{k_2}}(1 - q^{k_1}) \\
      &= \sum_{k = 0}^{n - 1}\sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2 + d + 4}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2 + (a + 8 + k)k_1 + (b + 3)k_2 + a + c + 4 + k}}{(q)_{k_1}(q)_{k_2}} \\
      &= \sum_{k = 0}^{n - 1}f_{a + 8 + k, b + 3, a + c + 4 + k, d + 4}(t, q).
    \end{align*}
  \item Same trick as (iii) but now with $k_2$. \qedhere
  \end{enumerate}
\end{proof}

\subsection{A combinatorial argument}
\label{sec:comb-argum}

A partition $\lambda = [\lambda_1, \dots, \lambda_m]$ \emph{contains} a partition $\eta = [\eta_1, \dots, \eta_n]$, written as $\eta \subseteq \lambda$, if $m \ge n$ and there exists $i \in \mathbb{Z}_+$ such that $1 \le i \le m - n + 1$ and $[\lambda_i, \lambda_{i + 1}, \dots, \lambda_{i + n - 1}] = \eta$.

Define
\begin{equation*}
  p(t, q) = \sum_{\lambda \in P}t^{\len(\lambda)}q^{\Delta(\lambda)} \in \mathbb{C}[[t, q]],
\end{equation*}
where $P$ is the set of partitions that don't contain any partition in $R$ as defined in \Cref{sec:introduction}, i.e.\
\begin{equation*}
  P = \{\lambda \mid \text{for }\eta \in R, \lambda \nsupseteq \eta\}.
\end{equation*}
We call the last eight partitions of $R$ \emph{exceptional partitions} and the others involving $r$ are called \emph{ordinary partitions}.
For $m, n \in \mathbb{N}$, set
\begin{align*}
  P(n) &= \{\lambda \in P \mid \Delta(\lambda) = n\}, \\
  p(q) &= \sum_{n \in \mathbb{N}}|P(n)|q^n \in \mathbb{C}[[q]], \\
  P(n, m) &= \{\lambda \in P \mid \len(\lambda) = m\text{ and }\Delta(\lambda) = n\}.
\end{align*}
Therefore, we have
\begin{align*}
  p(t, q) &= \sum_{m, n \in \mathbb{N}}|P(n, m)|t^mq^n, \\
  p(1, q) &= p(q).
\end{align*}
We wish to find an expression for $p(t, q)$ as a sum of series $f_{a, b, c, d}(t, q)$ for some tuples $(a, b, c, d)$.

We now define subsets of $P$ which will help in finding an expression for $p(t, q)$.
Set
\begin{align*}
  P_{>2} &= \{[\lambda_1, \dots, \lambda_m] \in P \mid \lambda_m > 2\text{ or }\lambda = \emptyset\}, \\
  P_2 &= \{[\lambda_1, \dots, \lambda_m] \in P \mid \lambda_m = 2\}
\end{align*}
and both $p_{>2}(t, q)$ and $P_{>2}(n, m)$ are defined like $p(t, q)$ and $P(n, m)$ were defined.
We similarly define objects like $P_{>6, 5, 3}$, $P_{6, 5, 3}$, $p_{>6, 5, 3}(t, q)$, $p_{6, 5, 3}(t, q)$, $P_{>6, 5, 3}(n, m)$ and $P_{6, 5, 3}(n, m)$.
It turns $P$ is made out of the these ``smaller'' objects and we can find recurrence relations between them to find our desired formula for $p(t, q)$.

\begin{lemma}
  \label{lmm:21}
  The formal power series $p_{>2}(t, q)$ is given by
  \begin{equation*}
    p_{>2}(t, q) = f_{3, 2, 0, 0}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  Consider the disjoint union
  \begin{equation*}
    P_{>2} = P_{4, 3} \cup P_{6, 5, 3} \cup P_{>6, 5, 3} \cup P_{>5, 3} \cup P_{4, 4} \cup P_{5, 4} \cup P_{>5, 4} \cup P_{>4}
  \end{equation*}
  from which we get the formula
  \begin{equation*}
    \begin{split}
      p_{>2}(t, q) &= p_{4, 3}(t, q) + p_{6, 5, 3}(t, q) + p_{>6, 5, 3}(t, q) + p_{>5, 3}(t, q) + p_{4, 4}(t, q) + p_{5, 4}(t, q) + p_{>5, 4}(t, q) \\
      &\quad + p_{>4}(t, q).
    \end{split}
  \end{equation*}
  These subseries must satisfy the following recurrences with initial conditions:
  \begin{align*}
    p_{>4}(t, q) &= p_{4, 4}(tq^{1/2}, q) + p_{5, 4}(tq^{1/2}, q) + p_{>5, 4}(tq^{1/2}, q) + p_{>4}(tq^{1/2}, q), &p_{>4}(0, 0) &= 1, \\
    p_{>5, 4}(t, q) &= p_{6, 5, 3}(tq^{1/2}, q) + p_{>6, 5, 3}(tq^{1/2}, q) + p_{>5, 3}(tq^{1/2}, q), &p_{>5, 4}(0, 0) &= 0, \\
    p_{5, 4}(t, q) &= p_{4, 3}(tq^{1/2}, q), &p_{5, 4}(0, 0) &= 0, \\
    p_{4, 4}(t, q) &= t^2q^{3}p_{>6, 5, 3}(tq^{2/2}, q) + t^2q^3p_{>5, 3}(tq^{2/2}, q), &p_{4, 4}(0, 0) &= 0, \\
    p_{>5, 3}(t, q) &= t^2q^3p_{>4}(tq^{1/2}, q), &p_{>5, 3}(0, 0) &= 0, \\
    p_{>6, 5, 3}(t, q) &= t^2q^3p_{>5, 4}(tq^{1/2}, q), &p_{>6, 5, 3}(0, 0) &= 0, \\
    p_{6, 5, 3}(t, q) &= t^2q^3p_{5, 4}(tq^{1/2}, q), &p_{6, 5, 3}(0, 0) &= 0, \\
    p_{4, 3}(t, q) &= t^2q^3p_{4, 4}(tq^{1/2}, q) + t^2q^2p_{>5, 4}(tq^{1/2}, q), &p_{4, 3}(0, 0) &= 0.
  \end{align*}
  The solution to these equations is unique if it exists and we can verify using \Cref{lmm:20} that
  \begin{align*}
    p_{>4}(t, q) &= f_{6, 4, 0, 0}(t, q), \\
    p_{>5, 4}(t, q) &= f_{9, 5, 4, 2}(t, q), \\
    p_{5, 4}(t, q) &= f_{13, 6, 9, 4}(t, q), \\
    p_{4, 4}(t, q) &= f_{12, 6, 8, 4}(t, q), \\
    p_{>5, 3}(t, q) &= f_{8, 5, 3, 2}(t, q), \\
    p_{>6, 5, 3}(t, q) &= f_{11, 6, 8, 4}(t, q), \\
    p_{6, 5, 3}(t, q) &= f_{15, 7, 14, 6}(t, q), \\
    p_{4, 3}(t, q) &= f_{11, 5, 7, 4}(t, q),
  \end{align*}
  is a solution to these equations.
  We derive the formula $p_{>2}(t, q) = f_{3, 2, 0, 0}(t, q)$ again from \Cref{lmm:20}.

  The recurrences follow from the following eight bijections for $m, n \in \mathbb{N}$:
  \begin{align*}
    P_{>4}(n, 2m) &\xrightarrow{\sim} P_{4, 4}(n - m, 2m) \cup P_{5, 4}(n - m, 2m) \cup P_{>5, 4}(n - m, 2m) \cup P_{>4}(n - m, 2m), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4, 4] &\text{if }[\lambda_{m - 1}, \lambda_m] = [5, 5]; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 5, 4] &\text{if }[\lambda_{m - 1}, \lambda_m] = [6, 5]; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 1} - 1, 4] &\text{if }[\lambda_m] = [5]\text{ and }\lambda_{m - 1} > 6; \\
                [\lambda_1 - 1, \dots, \lambda_m - 1] &\text{if }\lambda_m > 5,
              \end{cases}
  \end{align*}
  which can be verified directly from the definition of $P$ as we now show.
  Note that the operation on $\lambda$ is always ``subtract 1 from each entry of $\lambda$''.
  For example, a partition $[\lambda_1, \dots, \lambda_m] \in P_{>4}(n, m)$ satisfies exactly one of the following four conditions:
  \begin{equation*}
    [\lambda_{m - 1}, \lambda_m] = [5, 5], [\lambda_{m - 1}, \lambda_m] = [6, 5], [\lambda_m] = [5]\text{ and }\lambda_{m - 1} > 6, \lambda_m > 5.
  \end{equation*}
  Say $\lambda$ satisfies $[\lambda_{m - 1}, \lambda_m] = [5, 5]$.
  Then $[\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4, 4]$ belongs to $P$ because: it can't contain some ordinary partition (otherwise $\lambda$ would contain some ordinary partition) and we can verify case by case that it can't contain some exceptional partition.
  Actually, we have $[\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4, 4] \in P_{4, 4}(n - m, 2m)$ as we easily see, so we get the first part of our bijection.
  The other parts follow a similar reasoning and an explicit inverse of this function can be written if desired.
  We also note that $[5] \mapsto [4]$ and $\emptyset \mapsto \emptyset$ in this bijection.
  Now we verify that this bijection implies our first recurrence.
  One key step is replacing $n$ by $n - m$ in the following computation
  \begin{align*}
    &p_{4, 4}(tq^{1/2}, q) + p_{5, 4}(tq^{1/2}, q) + p_{>5, 4}(tq^{1/2}, q) + p_{>4}(tq^{1/2}, q) \\
    &= \sum_{m, n \in \mathbb{N}}(|P_{4, 4}(n, m)| + |P_{5, 4}(n, m)| + |P_{>5, 4}(n, m)| + |P_{>4}(n, m)|)(tq^{1/2})^mq^n \\
    &= \sum_{m, n \in \mathbb{N}}(|P_{4, 4}(n, 2m)| + |P_{5, 4}(n, 2m)| + |P_{>5, 4}(n, 2m)| + |P_{>4}(n, 2m)|)(tq^{1/2})^{2m}q^n \\
    &= \sum_{m, n \in \mathbb{N}}(|P_{4, 4}(n - m, 2m)| + |P_{5, 4}(n - m, 2m)| + |P_{>5, 4}(n - m, 2m)| + |P_{>4}(n - m, 2m)|)t^{2m}q^n \\
    &= \sum_{m, n \in \mathbb{N}}|P_{>4}(n, 2m)|t^{2m}q^n \\
    &= p_{>4}(t, q).
  \end{align*}

  In the next bijections, we do something similar.
  In some cases the operation on $\lambda$ is ``subtract 2 from each entry of $\lambda$'' and sometimes we need to change the tail of the result after doing this operation to get something in $P$.
  The next two lemmas also employ very similar arguments.
  \begin{align*}
    P_{>5, 4}(n, 2m) &\xrightarrow{\sim} P_{6, 5, 3}(n - m, 2m) \cup P_{>6, 5, 3}(n - m, 2m) \cup P_{>5, 3}(n - m, 2m), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 6, 5, 3] &\text{if }[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [7, 6, 4]; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 5, 3] &\text{if }[\lambda_{m - 1}, \lambda_m] = [6, 4]\text{ and }\lambda_{m - 2} > 7; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 1} - 1, 3] &\text{if }[\lambda_m] = [4]\text{ and }\lambda_{m - 1} > 6,
              \end{cases}
  \end{align*}
  \begin{align*}
    P_{5, 4}(n, 2m) &\xrightarrow{\sim} P_{4, 3}(n - m, 2m), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4, 3],
  \end{align*}
  \begin{align*}
    P_{4, 4}(n, 2m) &\xrightarrow{\sim} P_{>6, 5, 3}(n - 2m - 1, 2(m - 1)) \cup P_{>5, 3}(n - 2m - 1, 2(m - 1)), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 2, \dots, \lambda_{m - 3} - 2, 5, 3] &\text{if }[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [7, 4, 4]; \\
                [\lambda_1 - 2, \dots, \lambda_{m - 2} - 2, 3] &\text{if }[\lambda_{m - 1}, \lambda_m] = [4, 4]\text{ and }\lambda_{m - 2} > 7,
              \end{cases}
  \end{align*}
  \begin{align*}
    P_{>5, 3}(n, 2m) &\xrightarrow{\sim} P_{>4}(n - m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 1} - 1],
  \end{align*}
  \begin{align*}
    P_{>6, 5, 3}(n, 2m) &\xrightarrow{\sim} P_{>5, 4}(n - m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4],
  \end{align*}
  \begin{align*}
    P_{6, 5, 3}(n, 2m) &\xrightarrow{\sim} P_{5, 4}(n - m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 5, 4],
  \end{align*}
  \begin{align*}
    P_{4, 3}(n, 2m) &\xrightarrow{\sim} P_{4, 4}(n - m - 2, 2(m - 1)) \cup P_{>5, 4}(n - m - 1, 2(m - 1)), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 4, 4] &\text{if }[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [6, 4, 3]; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4] &\text{if }[\lambda_{m - 1}, \lambda_m] = [4, 3]\text{ and }\lambda_{m - 2} > 6. \qedhere
              \end{cases}
  \end{align*}
\end{proof}

\begin{lemma}
  \label{lmm:22}
  The formal power series $p_{>2, 1}(t, q)$ is given by
  \begin{equation*}
    p_{>2, 1}(t, q) = f_{5, 2, 1, 1}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  Consider the disjoint union
  \begin{equation*}
    P_{>2, 1} = P_{5, 3, 1} \cup P_{>5, 3, 1} \cup P_{5, 4, 1} \cup P_{>5, 4, 1} \cup P_{>4, 1}.
  \end{equation*}
  We have bijections
  \begin{align*}
    P_{>4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{>5, 4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>5, 4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{5, 4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{5, 4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{>5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>6, 5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  from which, together with the proof of \Cref{lmm:21}, we get
  \begin{align*}
    p_{>4, 1}(t, q) &= tqp_{>4}(t, q) = f_{6, 4, 1, 1}(t, q), \\
    p_{>5, 4, 1}(t, q) &= tqp_{>5, 4}(t, q) = f_{9, 5, 5, 3}(t, q), \\
    p_{5, 4, 1}(t, q) &= tqp_{5, 4}(t, q) = f_{13, 6, 10, 5}(t, q), \\
    p_{>5, 3, 1}(t, q) &= tqp_{>5, 3}(t, q) = f_{8, 5, 4, 3}(t, q), \\
    p_{5, 3, 1}(t, q) &= tqp_{>6, 5, 3}(t, q) = f_{11, 6, 9, 5}(t, q).
  \end{align*}
  The formula for $p_{>2, 1}(t, q)$ then follows from \Cref{lmm:20}.
\end{proof}

\begin{lemma}
  \label{lmm:23}
  The formal power series $p_{>2, 1, 1}(t, q)$ is given by
  \begin{equation*}
    p_{>3, 1, 1}(t, q) = f_{6, 3, 2, 2}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  Consider the disjoint union
  \begin{equation*}
    P_{>3, 1, 1} = P_{4, 1, 1} \cup P_{>4, 1, 1}.
  \end{equation*}
  We have bijections
  \begin{align*}
    P_{>4, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>4, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  \begin{align*}
    P_{4, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>5, 4, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  from which, together with the proof of \Cref{lmm:22}, we get
  \begin{align*}
    p_{>4, 1, 1}(t, q) &= tqp_{>4, 1}(t, q) = f_{6, 4, 2, 2}(t, q), \\
    p_{4, 1, 1}(t, q) &= tqp_{>5, 4, 1}(t, q) = f_{9, 5, 6, 4}(t, q).
  \end{align*}
  The formula for $p_{>3, 1, 1}(t, q)$ then follows from \Cref{lmm:20}.
\end{proof}

\begin{lemma}
  \label{lmm:24}
  The formal power series $p(t, q)$ is given by
  \begin{equation*}
    p(t, q) = f_{3, 2, 0, 0}(t, q) + f_{5, 2, 1, 1}(t, q) + f_{6, 3, 2, 2}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  This follows from the disjoint union
  \begin{equation*}
    P = P_{>2} \cup P_{>2, 1} \cup P_{>3, 1, 1}
  \end{equation*}
  together with \Cref{lmm:21}, \Cref{lmm:22} and \Cref{lmm:23}.
\end{proof}

\begin{lemma}
  \label{lmm:25}
  The formal power series $p(q)$ satisfies
  \begin{equation*}
    \ch_{L}(q) = q^{1/2}p(q).
  \end{equation*}
\end{lemma}

\begin{proof}
  This follows from \Cref{lmm:24} by setting $t = 1$ and \cite[Theorem 4]{andrews_singular_2022} together with \Cref{lmm:20}.
\end{proof}

\subsection{Computing leading monomials}
\label{sec:comp-lead-monom}

We recall that we have defined $V = \Vir^{1/2}$, $M = M(1/2, 1/2)$ and $L = L(1/2, 1/2)$.

\begin{lemma}
  \label{lmm:26}
  Let $\lambda = [\lambda_1, \dots, \lambda_s]$ be a partition with $\lambda_s \ge 2$ or $\lambda = \emptyset$ and consider $M$ as a module over $V$.
  Then
  \begin{equation*}
    (L_{\lambda}\vac)_{(-1)}\vachalf = L_{\lambda}\vachalf + u \quad \text{for some }u \in G^{2s - 1}M.
  \end{equation*}
\end{lemma}

\begin{proof}
  The isomorphism $\gr^G(V) \xrightarrow{\sim} \mathbb{C}[L_{-2}, L_{-3}, \dots]$ maps $L_{\lambda}\vac$ to $p_{\lambda}$.
  The isomorphism $\gr^G(M) \xrightarrow{\sim} \bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k$ maps $\vachalf$ to $L_{-1}^0$ and $L_{\lambda}\vachalf$ to $u_{\lambda}$.
  The equality $p_{\lambda}\cdot L_{-1}^0 = u_{\lambda}$ in $\gr^G(M)$ translates to the equality $(L_{\lambda}\vac)_{(-1)}\vachalf = L_{\lambda}\vachalf + u$ in $M$, for some $u \in G^{2s - 1}M$.
\end{proof}

We know $\gr^G(M)$ is a free module over $\gr^G(V)$
\begin{equation*}
  \gr^G(M) = \bigoplus_{k \in \mathbb{N}}\gr^G(V)L_{-1}^k.
\end{equation*}
For $k \in \mathbb{N}$, call
\begin{equation*}
  \iota_k: \gr^G(V) \to \gr^G(M)
\end{equation*}
the insertion of $\gr^G(V)$ into the $k$-th component.

\begin{lemma}
  \label{lmm:27}
  Let $a \in G^pV$ for some $p \in \mathbb{N}$.
  Then $a_{(-1)}\vachalf \in G^pM$ and
  \begin{equation*}
    \iota_0(\alpha^p(a)) = \alpha^p(a_{(-1)}\vachalf).
  \end{equation*}
\end{lemma}

\begin{proof}
  Follows immediately from \Cref{lmm:26}.
\end{proof}

We have a natural quotient map
\begin{align*}
  \pi_0: V &\twoheadrightarrow \Vir_{3, 4}, \\
  \pi_0(a) &= a + U(\Vir)\{a_{3, 4}\},
\end{align*}
where $a_{3, 4}$ is the singular vector of $V$ that generates its maximal subrepresentation as in \cite{andrews_singular_2022} and \eqref{eq:20}.
Applying the functor $\gr^G$ we obtain a epimorphism of $\mathbb{N}$-graded vertex Poisson algebras
\begin{equation*}
  \gr^G(\pi_0): \gr^G(V) \twoheadrightarrow \gr^G(\Vir_{3, 4}).
\end{equation*}
Set $I = \ker(\gr^G(\pi_0))$ following the notation of \cite{andrews_singular_2022} and recall the definition of $K$ given in \eqref{eq:38}.

\begin{lemma}
  \label{lmm:28}
  We have the inclusion
  \begin{equation*}
    \iota_0(I) \subseteq K.
  \end{equation*}
\end{lemma}

\begin{proof}
  By \Cref{thr:40}, the following diagram commutes
  \begin{equation*}
    \begin{tikzcd}
      V \arrow[r, "\pi_0"] \arrow[rd, "{Y^L_{V}}"'] & {\Vir_{3, 4}} \arrow[d, "{Y^L_{\Vir_{3, 4}}}"] \\
      & {\mathcal{F}(L)}
    \end{tikzcd}
  \end{equation*}
  The commutativity of this diagram implies the following statement
  \begin{equation*}
    \text{for }a \in U(\Vir)\{a_{3, 4}\}, u \in M\text{ and }n \in \mathbb{Z}, a_{(n)}u \in W,
  \end{equation*}
  where $W$ is defined in \eqref{eq:37}.
  We use this statement in the following simplified form
  \begin{equation}
    \label{eq:39}
    \text{for }a \in U(\Vir)\{a_{3, 4}\}, a_{(-1)}\vachalf \in W.
  \end{equation}

  Note that
  \begin{equation*}
    I = \sum_{p \in \mathbb{N}}\alpha^p(U(\Vir)\{a_{3, 4}\} \cap G^pV).
  \end{equation*}
  Similarly, we have a formula for $K$
  \begin{equation*}
    K = \sum_{p \in \mathbb{N}}\alpha^p(W \cap G^pM).
  \end{equation*}
  Let $\alpha^p(a) \in I$ with $a \in U(\Vir)\{a_{3, 4}\} \cap G^pV$.
  By \Cref{lmm:27} and \eqref{eq:39}, $a_{(-1)}\vachalf \in W \cap G^pM$ and also $\iota_0(\alpha^p(a)) = \alpha^p(a_{(-1)}\vachalf) \in K$, finishing the proof.
\end{proof}

We need to compute all leading monomials of elements of $K$.
To do this, we need to order the PBW basis of $U(\Vir_{\le -1}) = \vspan\{L_{\lambda} \mid \lambda\text{ is a partition}\}$ first by length, then by degree reverse lexicographic order and finally by position.
Formally, for any partitions $\lambda$ and $\eta$, define
\begin{equation*}
  L_{\lambda} \le L_{\eta}\text{ if and only if }
  \begin{cases}
    \len(\lambda) < \len(\eta)\text{ or } \\
    \len(\lambda) = \len(\eta)\text{ and }u_{\lambda} \le u_{\eta}.
  \end{cases}
\end{equation*}
For $x \in U(\Vir_{\le -1})$ with $x \neq 0$, we may write
\begin{equation*}
  x = c_1L_{\lambda_1} + c_2L_{\lambda_2} + \dots + c_rL_{\lambda_r},
\end{equation*}
where for $1 \le i \le r$, $0 \neq c_i \in \mathbb{C}$ and $L_{\lambda_1} > L_{\lambda_2} > \dots > L_{\lambda_r}$.
We define the \emph{leading monomial} of $x$ as $\lm(x) = L_{\lambda_1}$.
We set $\lm(0) = 0$.
We extend the definition of $\lm$ from $U(\Vir_{\le -1})$ to $V$ and $M$ by considering the isomorphisms of vector spaces: $U(\Vir_{\le -2}) \xrightarrow{\sim} V, L_{\lambda} \mapsto L_{\lambda}\vac$ and $U(\Vir_{\le -1}) \xrightarrow{\sim} M, L_{\lambda} \mapsto L_{\lambda}\vachalf$, where $\lambda$ is a partition and $U(\Vir_{\le -2}) = \{L_{\lambda} \mid \lambda = [\lambda_1, \dots, \lambda_m]\text{ satisfies }\lambda_m \ge 2\}$.
For example, we have $(L_{-1}^4 - 3L_{-3}L_{-1} - 6L_{-4})\vachalf \in W$ and $\lm((L_{-1}^4 - 3L_{-3}L_{-1} - 6L_{-4})\vachalf) = L_{-1}^4\vachalf$.
If we were using only the degree reverse lexicographical order with TOP, then we would get $L_{-3}L_{-1}\vachalf$ as leading monomial and we don't want that.

\begin{remark}
  \label{rmk:39}
  The definition of the order in the PBW basis of $U(\Vir_{\le -1})$ was made to make the following statements true:
  \begin{enumerate}
  \item For $\lambda$ a partition and $a \in V$, if $\lm(a) = L_{\lambda}\vac$, then $\lm(\alpha^{\len(\lambda)}(a)) = p_{\lambda}$.
  \item For $\lambda$ a partition and $u \in M$, if $\lm(u) = L_{\lambda}\vachalf$, then $\lm(\alpha^{\len(\lambda)}(u)) = u_{\lambda}$.
  \end{enumerate}
\end{remark}

A basis of $\gr^G(M)_{1/2 + n}$ is given by $\{L_{\lambda}\vachalf \mid \Delta(\lambda) = n\}$ and has $p(n)$ elements.
For $n \in \mathbb{N}$, compute the matrix $A_n$ with $p(n - 2) + p(n - 3)$ rows and $p(n)$ columns which is given by stacking the matrix $A^{m_3}_n$ below the matrix $A^{m_2}_n$ where $A^{m_k}_n$ is the matrix given by
\begin{equation*}
  A^{m_k}_n(i, j) = \text{coefficient of }L_{\lambda_j}\vachalf\text{ in }L_{\lambda_i}u_k,
\end{equation*}
for $1 \le i \le p(n - k)$, $1 \le j \le p(n)$ and $k = 2, 3$, where $\lambda_1, \dots, \lambda_{p(n)}$ are the partitions of $n$ ordered in such a way that $L_{\lambda_1} > L_{\lambda_2} > \dots > L_{\lambda_{p(n)}}$.
Now transform $A_n$ into row reduced echelon form obtaining a matrix $A^W_n$ which has an unknown number of rows and $p(n)$ columns.
For each pivot $\lambda$ of $A^W_n$, let $u^W_{\lambda}$ be the element of $\gr^G(M)$ corresponding to the row which has $L_{\lambda}\vachalf$ as pivot.
In other words, $u^W_{\lambda} = L_{\lambda}\vachalf + \text{(lower order terms)}$.
Set $u^K_{\lambda} = \alpha^{\len(\lambda)}(u^W_{\lambda})$ for each pivot $\lambda$ of $A^W_n$.

\begin{remark}
  \label{rmk:40}
  By construction and \Cref{rmk:39}, for each pivot $\lambda$ of $A^W_n$, we have $u^W_{\lambda} \in W$, $u^K_{\lambda} \in K$ and $\lm(u^K_{\lambda}) = u_{\lambda}$.
\end{remark}

For example, when $n = 4$, the partitions are ordered in the following way
  \begin{equation*}
    [[2, 2], [2, 1, 1], [1, 1, 1, 1], [3, 1], [4]],
  \end{equation*}
  the matrix $A^W_4$ is given by
  \begin{equation*}
    A^W_4=
    \begin{pmatrix}
      1 & 0 & 0 & -\frac{3}{16} & -\frac{15}{8} \\
      0 & 1 & 0 & -\frac{1}{4} & -\frac{5}{2} \\
      0 & 0 & 1 & -3 & -6
    \end{pmatrix}
  \end{equation*}
  and the pivots are $[2, 2]$, $[2, 1, 1]$ and $[1, 1, 1, 1]$.
  Therefore,
  \begin{align*}
    u^W_{[2, 2]} &= (L_{[2, 2]} - \tfrac{3}{16}L_{[3, 1]} - \tfrac{15}{8}L_{[4]})\vachalf, &u^K_{[2, 2]} &= L_{-2}L_{-2}, \\
    u^W_{[2, 1, 1]} &= (L_{[2, 1, 1]} - \tfrac{1}{4}L_{[3, 1]} - \tfrac{5}{2}L_{[4]})\vachalf, &u^K_{[2, 1, 1]} &= L_{-2}L_{-1}^2, \\
    u^W_{[1, 1, 1, 1]} &= (L_{[1, 1, 1, 1]} - 3L_{[3, 1]} - 6L_{[4]})\vachalf, &u^K_{[1, 1, 1, 1]} &= L_{-1}^4.
  \end{align*}

The partitions $[2]$, $[1, 1, 1]$, $[3, 1, 1]$, $[3, 3]$, $[4, 3, 1]$, $[4, 4, 1]$, $[5, 4, 1, 1]$ and $[6, 5, 3, 1]$ are pivots of the matrices $A^W_2, A^W_3$, $A^W_5$, $A^W_6$, $A^W_8$, $A^W_9$, $A^W_{11}$ and $A^W_{15}$ respectively, see \cite[ising-modules.ipynb]{sagemath2}.
Set
\begin{equation*}
  K' = (u^K_{[2]}, u^K_{[1, 1, 1]}, u^K_{[3, 1, 1]}, u^K_{[3, 3]}, u^K_{[4, 3, 1]}, u^K_{[4, 4, 1]}, u^K_{[5, 4, 1, 1]}, u^K_{[6, 5, 3, 1]}, \iota_0(I))_{\psn},
\end{equation*}
where $\psn$ denotes the Poisson submodule generated by the given subset.
By \Cref{lmm:28}, \Cref{rmk:40} and the fact that $K$ is a vertex Poisson submodule (not just a submodule), we have
\begin{equation*}
K' \subseteq K.
\end{equation*}

Let us consider the Poisson structure of $\gr^G(M)$ as a module over $\gr^G(V)$.
We have
\begin{align*}
  (L_{-2})_{(0)}(u_{\lambda}) &= \alpha^2(\omega)_{(0)}\alpha^{\len(\lambda)}(L_{\lambda}\vachalf) \\
  &= \alpha^{\len(\lambda) + 1}(L_{-1}L_{\lambda}\vachalf) \\
  &= u_{[\lambda, 1]},
\end{align*}
where $\lambda$ is any partition and $[\lambda, 1]$ denotes the partition $\lambda$ with a $1$ appended at the end.

\begin{remark}
  \label{rmk:41}
  While the Poisson structure of $\gr^G(V)$ is trivial (i.e.\ is zero), the Poisson structure of $\gr^G(M)$ is not.
  In fact, if $u \in \gr^G(M)$ and $\lambda$ is a partition, then
  \begin{equation*}
    \lm(u) = u_{\lambda}\text{ implies }\lm((L_{-2})_{(0)}(u)) = u_{[\lambda, 1]}.
  \end{equation*}
\end{remark}

Let $\overline{R}$ be the set of partitions containing some partition of $R$, i.e.
\begin{equation*}
  \overline{R} = \{\lambda \mid \text{there is some partition }\eta \in R\text{ such that }\lambda \supseteq \eta\}.
\end{equation*}

\begin{lemma}
  \label{lmm:29}
  For $\lambda \in \overline{R}$, there exists $u \in K'$ such that $\lm(u) = u_{\lambda}$.
\end{lemma}

\begin{proof}
  By the definition of $K'$, we know that for any $\lambda \in R$ there exists $u \in K'$ such that $\lm(u) = u_{\lambda}$.
  Now assume $\lambda \in \overline{R}$, which means there is $\eta \in R$ such that $\lambda \supseteq \eta$.
  Therefore, $\lambda$ is obtained from $\eta$ by adding some integers greater than or equal to two and adding $k$ ones.
  Pick $v \in K'$ such that $\lm(v) = u_{\eta}$ and some power product $p_{\tau} \in \mathbb{C}[L_{-2}, L_{-3}, \dots]$, for some partition $\tau$, such that $\lm((L_{-2})^k_{(0)}(p_{\tau}v)) = u_{\lambda}$ (this can be done because of \Cref{rmk:41} and the fact that $\lm$ is multiplicative).
  Thus, we set $u = (L_{-2})^k_{(0)}(p_{\tau}v) \in K'$ to get $\lm(u) = u_{\lambda}$.
  For example, take $\lambda = [3, 2, 1, 1] \in \overline{R}$, $\eta = [2] \in R$.
  In this case, $v = L_{-2}- 3/4L_{-1}^2 \in K'$ is such that $\lm(v) = u_{[2]}$ and we take $u = L_{-3}L_{-2}L_{-1}^2 - 3/4L_{-3}L_{-1}^4 \in K'$.
\end{proof}

\begin{remark}
  \label{rmk:42}
  For any partitions $\lambda$ and $\eta$ with the same number of ones, if $\lambda \supseteq \eta$, then $u_{\eta} \mid u_{\lambda}$.
  The converse is not true.
  For example, $u_{[4, 2]} \mid u_{[4, 3, 2]}$ but $[4, 3, 2] \nsupseteq [4, 2]$.
  However, if $\eta = [\eta_1, \dots, \eta_m, 1, \dots, 1]$ with $\eta_m \ge 2$ and $\eta_1 - \eta_m \le 1$ then $\lambda \supseteq \eta$ if and only if $u_{\eta} \mid u_{\lambda}$ provided $\lambda$ and $\eta$ have the same number of ones.
\end{remark}

The following lemma says our set of partitions $R$ is special.
If $R$ were $\{[4, 2]\}$, for example, the following lemma wouldn't be true.

\begin{lemma}
  \label{lmm:30}
  There is an alternative description for $P$,
  \begin{equation*}
    P = \{\lambda \mid \text{for }\eta \in \overline{R}, u_{\eta} \nmid u_{\lambda}\}.
  \end{equation*}
\end{lemma}

\begin{proof}
  We have to prove the following equality
  \begin{equation*}
    \{\lambda \mid \text{for }\eta \in R, \lambda \nsupseteq \eta\} = \{\lambda \mid \text{for }\eta \in \overline{R}, u_{\eta} \nmid u_{\lambda}\}.
  \end{equation*}

  First we prove the inclusion $(\supseteq)$.
  Assume $\lambda$ belongs to the right set and $\lambda \supseteq \eta$ for some $\eta \in R$.
  Then $\lambda$ has $k$ more ones than $\eta$ for some $k \in \mathbb{N}$.
  By \Cref{rmk:42}, $u_{[\eta, 1, \dots, 1]} \mid u_{\lambda}$ where we added $k$ ones to $\eta$, a contradiction.
  Therefore, $\lambda \nsupseteq \eta$ for all $\eta \in R$ which means $\lambda$ belongs to the left set.

  Now we prove the inclusion $(\subseteq)$.
  Assume $\lambda$ belongs to the left set.
  Then $\lambda$ has $0$, $1$ or $2$ ones.
  Assume $\lambda$ has $0$ ones.
  It is enough to prove that for $\eta \in R$ with $0$ ones, $u_{\eta} \nmid u_{\lambda}$.
  By \Cref{rmk:42}, if $\eta$ is equal to $[2]$, $[3, 3]$, $[r, r, r]$, $[r + 1, r, r]$ or $[r + 1, r + 1, r]$ for some $r \ge 3$, then $u_{\eta} \nmid u_{\lambda}$.
  Assume $\eta = [r + 2, r + 1, r]$ for some $r \ge 3$ and $u_{\eta} \mid u_{\lambda}$.
  Then $\lambda$ contains $[r + 2, r + 1, \dots, r + 1, r]$ where $r + 1$ appears $k \ge 1$ times.
  If $k \ge 2$, then $\lambda$ contains $[r + 1, r + 1, r]$ which is not possible.
  If $k = 1$, then $\lambda$ contains $[r + 2, r + 1, r]$ which is not possible.
  Therefore, we can't have $u_{\eta} \mid u_{\lambda}$.
  Continuing this way we obtain that $u_{\eta} \nmid u_{\lambda}$ for $\eta \in R$ with $0$ ones.
  The same argument can be made when $\lambda$ has $1$ or $2$ ones.
  Therefore, $\lambda$ belongs to the right set.
\end{proof}

\subsection{Proofs of the main theorems}
\label{sec:proofs-main-theorems}

\begin{proof}[Proof of \Cref{thr:4}]
  Since we can't apply Gr\"{o}bner basis theory directly on the free module $\bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k$, we need to truncate somehow.
  Keep in mind the isomorphisms given in \Cref{prp:16}.
  For $N \in \mathbb{N}$, define
  \begin{align*}
    \gr^G(M)_{\le 1/2 + N} &= \sum_{n \le N}\gr^G(M)_{1/2 + n}, \\
    \gr^G(L)_{\le 1/2 + N} &= \sum_{n \le N}\gr^G(L)_{1/2 + n}.
  \end{align*}
  Note that $\gr^G(M)_{\le 1/2 + N}$ is a vector subspace of the free module
  \begin{equation*}
    F_N = \bigoplus_{n \le N}\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]L_{-1}^n
  \end{equation*}
  with base ring $\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]$ because a basis of $\gr^G(M)_{\le 1/2 + N}$ is given by elements of the form $u_{\lambda}$ with all the elements of $\lambda$ being less than $N$ and with $\lambda$ having at most $N$ ones.
  We note that $K \cap F_N$ is a submodule of $F_N$ for $N \in \mathbb{N}$.

  For $N \in \mathbb{N}$, we have natural vector space isomorphisms
  \begin{equation}
    \label{eq:40}
    \frac{F_N}{K \cap F_N} \supseteq \frac{\gr^G(M)_{\le 1/2 + N}}{K \cap F_N} \xrightarrow{\sim} \frac{\gr^G(M)_{\le 1/2 + N}}{K \cap \gr^G(M)_{\le 1/2 + N}} \xrightarrow{\sim} \gr^G(L)_{1/2 + N}.
  \end{equation}
  Therefore, if we find a basis of each vector space $\gr^G(M)_{\le 1/2 + N}/K \cap F_N \subseteq F_N/K \cap F_N$ such that each basis is contained in the next one when considering the isomorphism \eqref{eq:40}, we get a basis of $\gr^G(L)$ by taking the union of these bases because $\bigcup_{N \in \mathbb{N}}\gr^G(L)_{\le 1/2 + N} = \gr^G(L)$.

  Let $G_N$ be a Gr\"{o}bner basis of $K \cap F_N$.
  Define
  \begin{equation*}
    B_N = \{u_{\lambda} \mid \Delta(\lambda) \le N\text{ and for }u \in G_N, \lm(u) \nmid u_{\lambda}\}.
  \end{equation*}
  By \cite[Proposition 3.6.4]{adams_introduction_1994},
  \begin{equation}
    \label{eq:41}
    \{u_{\lambda} + K \cap F_N \mid u_{\lambda} \in B_N\}
  \end{equation}
  is a vector space basis of $\gr^G(M)_{\le 1/2 + N}/K \cap F_N$.
  Therefore, by \Cref{lmm:25}, isomorphism \eqref{eq:40} and the isomorphism between $\gr^G(L)_{1/2 + n}$ and $L_{1/2 + n}$ of \Cref{prp:16}, we have
  \begin{equation*}
    |B_N| = \sum_{n \le N}\dim(\gr^G(L)_{1/2 + n}) = \sum_{n \le N}\dim(L_{1/2 + n}) = \sum_{n \le N}|P(n)|.
  \end{equation*}

  Define
  \begin{equation*}
    \overline{B_N} = \{u_{\lambda} \mid \Delta(\lambda) \le N\text{ and for }\eta \in \overline{R}, u_{\eta} \nmid u_{\lambda}\}.
  \end{equation*}
  By \Cref{lmm:30}, we also have
  \begin{equation*}
    \overline{B_N} = \{u_{\lambda} \mid \Delta(\lambda) \le N\text{ and }\lambda \in P\}.
  \end{equation*}
  From the definition of $P(n)$, we see that
  \begin{equation*}
    |\overline{B_N}| = \sum_{n \le N}|P(n)|.
  \end{equation*}

  On the other hand, we have $B_N \subseteq \overline{B_N}$ because if $u_{\lambda} \in B_N$ and $\eta \in \overline{R}$, then we have $u_{\eta} \nmid u_{\lambda}$ because if we had $u_{\eta} \mid u_{\lambda}$, then by \Cref{lmm:29}, there would exist $u \in K' \cap F_N \subseteq K \cap F_N$ such that $\lm(u) = u_{\eta}$, then by the definition of Gr\"{o}bner basis, there would exist $v \in G_N$ such that $\lm(v) \mid \lm(u)$, implying $\lm(v) \mid u_{\lambda}$, a contradiction.
  As both $B_N$ and $\overline{B_N}$ are finite sets and $|B_N| = |\overline{B_N}|$, we get $B_N = \overline{B_N}$.
  We see that the family of bases given by \eqref{eq:41} satisfy the property that one basis is contained in the next one and this concludes the proof of \Cref{thr:4}.
\end{proof}

\begin{proof}[Proof of \Cref{thr:3}]
  Note that the basis of \Cref{thr:4} is also a basis of $\gr^G(L)$ under the isomorphism between $\gr^G(L)$ and $L$ of \Cref{prp:16}.
  For $\lambda \in P$, we have
  \begin{equation*}
    \alpha^{\len(\lambda)}(L_{\lambda}(\vachalf + W)) \in \alpha^{\len(\lambda)}(G^{\len(\lambda)}L_{1/2 + \Delta(\lambda)}).
  \end{equation*}
  Thus, when calculating the refined character of $\gr^G(L)$, $\Delta(\lambda)$ is summed with $1/2$.
  Therefore, $\ch_{\gr^G(L)}(t, q) = q^{1/2}p(t, q)$ and together with \Cref{lmm:24}, we conclude the proof of \Cref{thr:3}.
\end{proof}

\begin{corollary}
  \label{crl:3}
  We have the equality
  \begin{equation*}
    K' = K.
  \end{equation*}
\end{corollary}

\begin{proof}
  This proof is a copy of the proof of \Cref{thr:3}.
  We know $K' \subseteq K$.

  Let $N \in \mathbb{N}$ and let $G'_N$ be a Gr\"{o}bner basis of $K' \cap F_N$ considered as a submodule of $F_N$.
  Like in the proof of \Cref{thr:3}, set
  \begin{equation*}
    B'_N = \{u_{\lambda} \mid \Delta(\lambda) \le N\text{ and for }u \in G'_N, \lm(u) \nmid u_{\lambda}\}.
  \end{equation*}
  By \cite[Proposition 3.6.4]{adams_introduction_1994},
  \begin{equation*}
    |B'_N| = \dim\left(\frac{\gr^G(M)_{\le 1/2 + N}}{K' \cap F_N}\right) = \dim\left(\frac{\gr^G(M)_{\le 1/2 + N}}{K' \cap \gr^G(M)_{\le 1/2 + N}}\right).
  \end{equation*}

  We can do the same argument as in the start of the last paragraph of the proof of \Cref{thr:3} and conclude that $B'_N \subseteq \overline{B_N}$, where $\overline{B_N}$ is the defined in the same way.
  But $B_N = \overline{B_N}$ and
  \begin{equation*}
    |B_N| = \dim\left(\frac{\gr^G(M)_{\le 1/2 + N}}{K \cap \gr^G(M)_{\le 1/2 + N}}\right).
  \end{equation*}
  Therefore, $|B'_N| \le |B_N|$ which implies
  \begin{equation*}
    \dim(K' \cap \gr^G(M)_{\le 1/2 + N}) \ge \dim(K \cap \gr^G(M)_{\le 1/2 + N}) \ge \dim(K' \cap \gr^G(M)_{\le 1/2 + N}).
  \end{equation*}
  Then $K' \cap \gr^G(M)_{\le 1/2 + N} = K \cap \gr^G(M)_{\le 1/2 + N}$ for $N \in \mathbb{N}$.
  Taking the union of these subspaces, we get $K' = K$.
\end{proof}

\appendix
\section{Almost commutative algebras}
\label{sec:almost-comm-algebr}

Let $A$ be an associative (not necessarily commutative) algebra with a unit $1$ and a filtration $(A^p)_{p \in \mathbb{Z}}$ such that:
\begin{enumerate}
\item $A^p = 0$ for $p < 0$;
\item $1 \in A^0$;
\item $A^0 \subseteq A^1 \subseteq \dots$;
\item $A^pA^q \subseteq A^{p + q}$ for $p, q \in \mathbb{Z}$.
\end{enumerate}
Let
\begin{equation*}
  \gr(A) = \bigoplus_{p \in \mathbb{N}}A^p/A^{p - 1}
\end{equation*}
be the associated graded vector space.
The vector space $\gr(A)$ is an associative algebra with unit and multiplication given as follows: for $p, q \in \mathbb{N}$, $a \in A^p$ and $b \in A^p$, set
\begin{equation*}
  \gamma^p(a)\gamma^q(b) = \gamma^{p + q}(ab),
\end{equation*}
where $\gamma^p: A^p \to \gr(A)$  is the \emph{principal symbol map} which is the composition of the natural maps $A^p \to A^p/A^{p - 1}$ and $A^p/A^{p - 1} \to \gr(A)$.
The unit of $\gr(A)$ is $\gamma^0(1)$.

We say $A$ is \emph{almost commutative} if the filtration $(A^p)_{p \in \mathbb{Z}}$ satisfies the following condition: for $p, q \in \mathbb{Z}$, if $a \in A^p$ and $b \in A^q$, then $ab - ba \in A^{p + q - 1}$.
If $A$ is almost commutative, then $\gr(A)$ is commutative.

Let $\mathfrak{g}$ be a Lie algebra and let $U(\mathfrak{g})$ be its universal enveloping algebra.
The \emph{PBW filtration} $(U(\mathfrak{g})^p)_{p \in \mathbb{Z}}$ is given by
\begin{equation*}
  U(\mathfrak{g})^p = \vspan\{x_1x_2\dots x_s \mid s \le p, x_1, \dots, x_s \in \mathfrak{g}\} \quad \text{for }p \in \mathbb{Z}.
\end{equation*}
This filtration clearly satisfy axioms (i)--(iii) above.
Furthermore, $U(\mathfrak{g})^1 = \mathfrak{g}$.
By \cite[Lemma 2.1.5]{dixmier_enveloping_1996}, $U(\mathfrak{g})$ is almost commutative, so $\gr(U(\mathfrak{g}))$ is commutative.
Let $S(\mathfrak{g})$ denote the symmetric algebra of $\mathfrak{g}$.
We have two natural inclusions of $\mathfrak{g}$: $\mathfrak{g} \to U(\mathfrak{g})$ and $\mathfrak{g} \to S(\mathfrak{g})$.
By the universal property of $S(\mathfrak{g})$, there is a homomorphism of commutative algebras $S(\mathfrak{g}) \to \gr(U(\mathfrak{g}))$ such that $1 \mapsto 1$ and the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    \mathfrak{g} \arrow[r] \arrow[rd] & S(\mathfrak{g}) \arrow[d] \\
    & \gr(U(\mathfrak{g}))
  \end{tikzcd}
\end{equation*}
By \cite[Proposition 2.3.6]{dixmier_enveloping_1996}, the homomorphism $S(\mathfrak{g}) \to \gr(U(\mathfrak{g}))$ is in fact an isomorphism.
If $(x_i)_{i \in I}$ is a basis of $\mathfrak{g}$, then $S(\mathfrak{g})$ is isomorphic to the polynomial algebra $\mathbb{C}[(x_i)_{i \in I}]$.
We have described $\gr(U(\mathfrak{g}))$ explicitly.

\section{An explicit description of $K$}
\label{sec:an-expl-descr}

In \cite[ising-modules.ipynb]{sagemath2}, I wrote a SageMath program to compute $u^W_{\lambda}$ for all partitions $\lambda$ (if $\lambda$ is not a pivot, it returns $0$).
From the output, we obtain
\begin{align*}
  u^K_{[2]} &= L_{-2} - \tfrac{3}{4}L_{-1}^2, \\
  u^K_{[1, 1, 1]} &= L_{-1}^3, \\
  u^K_{[3, 1, 1]} &= L_{-3}L_{-1}^2, \\
  u^K_{[3, 3]} &= L_{-3}L_{-3} + \tfrac{1}{3}L_{-4}L_{-1}^2, \\
  u^K_{[4, 3, 1]} &= L_{-4}L_{-3}L_{-1}, \\
  u^K_{[4, 4, 1]} &= L_{-4}L_{-4}L_{-1} + \tfrac{9}{8}L_{-5}L_{-3}L_{-1}, \\
  u^K_{[5, 4, 1, 1]} &= L_{-5}L_{-4}L_{-1}^2, \\
  u^K_{[6, 5, 3, 1]} &= L_{-6}L_{-5}L_{-3}L_{-1}.
\end{align*}

However, it turns out $u^K_{[5, 4, 1, 1]}$ and $u^K_{[6, 5, 3, 1]}$ are redundant, as can be seen from \cite[m11-m15.ipynb]{sagemath2}.
From \cite[Theorem 2]{andrews_singular_2022}, we obtain the following explicit expression for $K$:
\begin{equation*}
  K = (u^K_{[2]}, u^K_{[1, 1, 1]}, u^K_{[3, 1, 1]}, u^K_{[3, 3]}, u^K_{[4, 3, 1]}, u^K_{[4, 4, 1]}, \iota_0((a, b)_{\partial}))_{\psn},
\end{equation*}
where
\begin{align*}
  a = L_{-2}^3, b = L_{-2}L_{-3}L_{-4} + \tfrac{1}{6}L_{-5}L_{-2}^2.
\end{align*}

\numberwithin{theorem}{section}

\section{The case $L(1/2, 1/16)$}
\label{sec:case-l12-116}

We can do the same analysis we did for $L(1/2, 1/2)$ but with $L(1/2, 1/16)$ instead.
The arguments are the same but the computations are, of course, different.
These computations will be shown now.

Recall the definitions of $P^{1/16}$ and $R^{1/16}$ given in \Cref{sec:introduction}.
For the definition of the series $p^{1/16}(t, q)$, the set $P^{1/16}(n, m)$ and other related notation, see \Cref{sec:comb-argum}.

The maximal subrepresentation of $M(1/2, 1/16)$ is generated by the singular vectors
\begin{align*}
  u_2 &= (L_{-2} - \tfrac{4}{3} L_{-1}^2)\vacsixteen, \\
  u_4 &= (L_{-2}L_{-2} - \tfrac{600}{49}L_{-2}L_{-1}^2 + \tfrac{144}{49}L_{-1}^4 + \tfrac{264}{49}L_{-3}L_{-1} - \tfrac{36}{49}L_{-4})\vacsixteen.
\end{align*}

\begin{lemma}
  \label{lmm:31}
  The formal power series $p^{1/16}_{>2}(t, q)$ is given by
  \begin{equation*}
    p^{1/16}_{>2}(t, q) = f_{2, 2, 0, 0}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}[Sketch of proof]
  The superscript $1/16$ is omitted in this proof.
  Consider the disjoint union
  \begin{equation*}
    P_{>2} = P_{3, 3} \cup P_{6, 4, 3} \cup P_{>6, 4, 3} \cup P_{6, 5, 3} \cup P_{8, 7, 5, 3} \cup P_{>8, 7, 5, 3} \cup P_{>7, 5, 3} \cup P_{>5, 3} \cup P_{4, 4} \cup P_{5, 4} \cup P_{>5, 4} \cup P_{>4}.
  \end{equation*}
  These subseries must satisfy the following recurrences with initial conditions:
  \begin{align*}
    p_{>4}(t, q) &= p_{4, 4}(tq^{1/2}, q) + p_{5, 4}(tq^{1/2}, q) + p_{>5, 4}(tq^{1/2}, q) + p_{>4}(tq^{1/2}, q), &p_{>4}(0, 0) &= 1, \\
    p_{>5, 4}(t, q) &= p_{6, 5, 3}(tq^{1/2}, q) + p_{8, 7, 5, 3}(tq^{1/2}, q) + p_{>8, 7, 5, 3}(tq^{1/2}, q) \\
    &\quad + p_{>7, 5, 3}(tq^{1/2}, q) + p_{>5, 3}(tq^{1/2}, q), &p_{>5, 4}(0, 0) &= 0, \\
    p_{5, 4}(t, q) &= p_{6, 4, 3}(tq^{1/2}, q) + p_{>6, 4, 3}(tq^{1/2}, q), &p_{5, 4}(0, 0) &= 0, \\
    p_{4, 4}(t, q) &= p_{3, 3}(tq^{1/2}, q), &p_{4, 4}(0, 0) &= 0, \\
    p_{>5, 3}(t, q) &= t^2q^3p_{>4}(tq^{1/2}, q), &p_{>5, 3}(0, 0) &= 0, \\
    p_{>7, 5, 3}(t, q) &= t^2q^3p_{>5, 3}(tq^{2/2}, q), &p_{>7, 5, 3}(0, 0) &= 0,
  \end{align*}
  \begin{align*}
    p_{>8, 7, 5, 3}(t, q) &= t^2q^4p_{>6, 4, 3}(tq^{2/2}, q), &p_{>8, 7, 5, 3}(0, 0) &= 0, \\
    p_{8, 7, 5, 3}(t, q) &= t^2q^3p_{6, 5, 3}(tq^{2/2}, q), &p_{8, 7, 5, 3}(0, 0) &= 0, \\
    p_{6, 5, 3}(t, q) &= t^2q^3p_{5, 4}(tq^{1/2}, q), &p_{6, 5, 3}(0, 0) &= 0, \\
    p_{>6, 4, 3}(t, q) &= t^2q^2p_{>5, 4}(tq^{1/2}, q), &p_{>6, 4, 3}(0, 0) &= 0, \\
    p_{6, 4, 3}(t, q) &= t^2q^3p_{4, 4}(tq^{1/2}, q), &p_{6, 4, 3}(0, 0) &= 0, \\
    p_{3, 3}(t, q) &= t^2q^3p_{>6, 4, 3}(tq^{1/2}, q) + t^2q^2p_{>5, 3}(tq^{1/2}, q), &p_{3, 3}(0, 0) &= 0.
  \end{align*}
  The solution to these equations is unique if it exists and we can verify using \Cref{lmm:20} that
  \begin{align*}
    p_{>4}(t, q) &= f_{6, 4, 0, 0}(t, q), \\
    p_{>5, 4}(t, q) &= f_{9, 5, 4, 2}(t, q), \\
    p_{5, 4}(t, q) &= f_{13, 6, 9, 4}(t, q), \\
    p_{4, 4}(t, q) &= f_{12, 6, 8, 4}(t, q), \\
    p_{>5, 3}(t, q) &= f_{8, 5, 3, 2}(t, q), \\
    p_{>7, 5, 3}(t, q) &= f_{12, 7, 8, 4}(t, q), \\
    p_{>8, 7, 5, 3}(t, q) &= f_{15, 8, 15, 6}(t, q), \\
    p_{8, 7, 5, 3}(t, q) &= f_{19, 9, 23, 8}(t, q), \\
    p_{6, 5, 3}(t, q) &= f_{15, 7, 14, 6}(t, q), \\
    p_{>6, 4, 3}(t, q) &= f_{11, 6, 7, 4}(t, q), \\
    p_{6, 4, 3}(t, q) &= f_{14, 7, 13, 6}(t, q), \\
    p_{3, 3}(t, q) &= f_{10, 5, 6, 4}(t, q),
  \end{align*}
  is a solution to these equations.
  We derive the formula $p_{>2}(t, q) = f_{2, 2, 0, 0}(t, q)$ again from \Cref{lmm:20}.

  The recurrences follow from the following twelve bijections for $m, n \in \mathbb{N}$:
  \begin{align*}
    P_{>4}(n, 2m) &\xrightarrow{\sim} P_{4, 4}(n - m, 2m) \cup P_{5, 4}(n - m, 2m) \cup P_{>5, 4}(n - m, 2m) \cup P_{>4}(n - m, 2m), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4, 4] &\text{if }[\lambda_{m - 1}, \lambda_m] = [5, 5]; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 5, 4] &\text{if }[\lambda_{m - 1}, \lambda_m] = [6, 5]; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 1} - 1, 4] &\text{if }[\lambda_m] = [5]\text{ and }\lambda_{m - 1} > 6; \\
                [\lambda_1 - 1, \dots, \lambda_m - 1] &\text{if }\lambda_m > 5,
              \end{cases}
  \end{align*}
  \begin{align*}
    P_{>5, 4}(n, 2m) &\xrightarrow{\sim} P_{6, 5, 3}(n - m, 2m) \cup P_{8, 7, 5, 3}(n - m, 2m) \cup P_{>8, 7, 5, 3}(n - m, 2m) \\
    &\quad \cup P_{>7, 5, 3}(n - m, 2m) \cup P_{>5, 3}(n - m, 2m), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 6, 5, 3] &\text{if }[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [7, 6, 4]; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 4} - 1, 8, 7, 5, 3] &\text{if }[\lambda_{m - 3}, \lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [9, 8, 6, 4]; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 7, 5, 3] &\text{if }[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [8, 6, 4]\text{ and }\lambda_{m - 3} > 9; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 5, 3] &\text{if }[\lambda_{m - 1}, \lambda_m] = [6, 4]\text{ and }\lambda_{m - 2} > 8; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 1} -1, 3] &\text{if }[\lambda_m] = [4]\text{ and }\lambda_{m - 1} > 6,
              \end{cases}
  \end{align*}
  \begin{align*}
    P_{5, 4}(n, 2m) &\xrightarrow{\sim} P_{6, 4, 3}(n - m, 2m) \cup P_{>6, 4, 3}(n - m, 2m), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 6, 4, 3] &\text{if }[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [7, 5, 4]; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4, 3] &\text{if }[\lambda_{m - 1}, \lambda_m] = [5, 4]\text{ and }\lambda_{m - 2} > 7,
              \end{cases}
  \end{align*}
  \begin{align*}
    P_{4, 4}(n, 2m) &\xrightarrow{\sim} P_{3, 3}(n - m, 2m), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 3, 3],
  \end{align*}
  \begin{align*}
    P_{>5, 3}(n, 2m) &\xrightarrow{\sim} P_{>4}(n - m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 1} - 1],
  \end{align*}
  \begin{align*}
    P_{>7, 5, 3}(n, 2m) &\xrightarrow{\sim} P_{>5, 3}(n - 2m - 1, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 2, \dots, \lambda_{m - 1} - 2, 3],
  \end{align*}
  \begin{align*}
    P_{>8, 7, 5, 3}(n, 2m) &\xrightarrow{\sim} P_{>6, 4, 3}(n - 2m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 2, \dots, \lambda_{m - 3} - 2, 4, 3],
  \end{align*}
  \begin{align*}
    P_{8, 7, 5, 3}(n, 2m) &\xrightarrow{\sim} P_{6, 5, 3}(n - 2m - 1, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 2, \dots, \lambda_{m - 4} - 2, 6, 5, 3],
  \end{align*}
  \begin{align*}
    P_{6, 5, 3}(n, 2m) &\xrightarrow{\sim} P_{5, 4}(n - m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 5, 4],
  \end{align*}
  \begin{align*}
    P_{>6, 4, 3}(n, 2m) &\xrightarrow{\sim} P_{>5, 4}(n - m - 1, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4],
  \end{align*}
  \begin{align*}
    P_{6, 4, 3}(n, 2m) &\xrightarrow{\sim} P_{4, 4}(n - m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 4, 4],
  \end{align*}
  \begin{align*}
    P_{3, 3}(n, 2m) &\xrightarrow{\sim} P_{>6, 4, 3}(n - m - 2, 2(m - 1)) \cup P_{>5, 3}(n - m - 1, 2(m - 1)), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 4, 3] &\text{if }[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [6, 3, 3]; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 3] &\text{if }[\lambda_{m - 1}, \lambda_m] = [3, 3]\text{ and }\lambda_{m - 2} > 6. \qedhere
              \end{cases}
  \end{align*}
\end{proof}

\begin{lemma}
  \label{lmm:32}
  The formal power series $p^{1/16}_{>2, 1}(t, q)$ is given by
  \begin{equation*}
    p^{1/16}_{>2, 1}(t, q) = f_{4, 2, 1, 1}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  The superscript $1/16$ is omitted in this proof.
  Consider the disjoint union
  \begin{equation*}
    P_{>2, 1} = P_{6, 5, 3, 1} \cup P_{8, 7, 5, 3, 1} \cup P_{>8, 7, 5, 3, 1} \cup P_{>7, 5, 3, 1} \cup P_{>5, 3, 1} \cup P_{4, 4, 1} \cup P_{5, 4, 1} \cup P_{>5, 4, 1} \cup P_{>4, 1}.
  \end{equation*}
  We have bijections
  \begin{align*}
    P_{>4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{>5, 4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>5, 4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{5, 4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{5, 4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{4, 4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{4, 4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{>5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{>7, 5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>7, 5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{>8, 7, 5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>8, 7, 5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{8, 7, 5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{8, 7, 5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{6, 5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{6, 5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  from which, together with the proof of \Cref{lmm:31}, we get
  \begin{align*}
    p_{>4, 1}(t, q) &= tqp_{>4}(t, q) = f_{6, 4, 1, 1}(t, q), \\
    p_{>5, 4, 1}(t, q) &= tqp_{>5, 4}(t, q) = f_{9, 5, 5, 3}(t, q), \\
    p_{5, 4, 1}(t, q) &= tqp_{5, 4}(t, q) = f_{13, 6, 10, 5}(t, q), \\
    p_{4, 4, 1}(t, q) &= tqp_{4, 4}(t, q) = f_{12, 6, 9, 5}(t, q), \\
    p_{>5, 3, 1}(t, q) &= tqp_{>5, 3}(t, q) = f_{8, 5, 4, 3}(t, q), \\
    p_{>7, 5, 3, 1}(t, q) &= tqp_{>7, 5, 3}(t, q) = f_{12, 7, 9, 5}(t, q), \\
    p_{>8, 7, 5, 3, 1}(t, q) &= tqp_{>8, 7, 5, 3}(t, q) = f_{15, 8, 16, 7}(t, q), \\
    p_{8, 7, 5, 3, 1}(t, q) &= tqp_{8, 7, 5, 3}(t, q) = f_{19, 9, 24, 9}(t, q), \\
    p_{6, 5, 3, 1}(t, q) &= tqp_{6, 5, 3}(t, q) = f_{15, 7, 15, 7}(t, q).
  \end{align*}
  The formula for $p_{>2, 1}(t, q)$ then follows from \Cref{lmm:20}.
\end{proof}

\begin{lemma}
  \label{lmm:33}
  The formal power series $p^{1/16}_{>2, 1, 1}(t, q)$ is given by
  \begin{equation*}
    p^{1/16}_{>2, 1, 1}(t, q) = f_{9, 4, 5, 4}(t, q) + f_{5, 3, 2, 2}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  The superscript $1/16$ is omitted in this proof.
  Consider the disjoint union
  \begin{equation*}
    P_{>2, 1, 1} = P_{7, 5, 3, 1, 1} \cup P_{>7, 5, 3, 1, 1} \cup P_{>5, 3, 1, 1} \cup P_{5, 4, 1, 1} \cup P_{>5, 4, 1, 1} \cup P_{>4, 1, 1}.
  \end{equation*}
  We have bijections
  \begin{align*}
    P_{>4, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>4, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  \begin{align*}
    P_{>5, 4, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>5, 4, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  \begin{align*}
    P_{5, 4, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{5, 4, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  \begin{align*}
    P_{>5, 3, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>5, 4, 1}(n, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_{m - 1}, 4, 1],
  \end{align*}
  \begin{align*}
    P_{>7, 5, 3, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>7, 5, 3, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  \begin{align*}
    P_{7, 5, 3, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>8, 7, 5, 3, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  from which, together with the proof of \Cref{lmm:32}, we get
  \begin{align*}
    p_{>4, 1, 1}(t, q) &= tqp_{>4, 1}(t, q) = f_{6, 4, 2, 2}(t, q), \\
    p_{>5, 4, 1, 1}(t, q) &= tqp_{>5, 4, 1}(t, q) = f_{9, 5, 6, 4}(t, q), \\
    p_{5, 4, 1, 1}(t, q) &= tqp_{5, 4, 1}(t, q) = f_{13, 6, 11, 6}(t, q), \\
    p_{>5, 3, 1, 1}(t, q) &= tp_{>5, 4, 1}(t, q) = f_{9, 5, 5, 4}(t, q), \\
    p_{>7, 5, 3, 1, 1}(t, q) &= tqp_{>7, 5, 3, 1}(t, q) = f_{12, 7, 10, 6}(t, q), \\
    p_{7, 5, 3, 1, 1}(t, q) &= tqp_{>8, 7, 5, 3, 1}(t, q) = f_{15, 8, 17, 8}(t, q).
  \end{align*}
  The formula for $p_{>2, 1, 1}(t, q)$ then follows from \Cref{lmm:20}.
\end{proof}

\begin{lemma}
  \label{lmm:34}
  The formal power series $p^{1/16}_{>3, 1, 1, 1}(t, q)$ is given by
  \begin{equation*}
    p^{1/16}_{>3, 1, 1, 1}(t, q) = f_{7, 3, 3, 3}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  The superscript $1/16$ is omitted in this proof.
  Consider the disjoint union
  \begin{equation*}
    P_{>3, 1, 1, 1} = P_{4, 1, 1, 1} \cup P_{>4, 1, 1, 1}.
  \end{equation*}
  We have bijections
  \begin{align*}
    P_{>4, 1, 1, 1}(n, 2m + 3) &\xrightarrow{\sim} P_{>4, 3}(n, 2m + 2), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 3],
  \end{align*}
  \begin{align*}
    P_{4, 1, 1, 1}(n, 2m + 3) &\xrightarrow{\sim} P_{3, 3}(n - 1, 2m + 2), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_{m - 1}, 3, 3],
  \end{align*}
  from which, together with the proof of \Cref{lmm:31} and \Cref{lmm:20}, we get
  \begin{align*}
    p_{>4, 1, 1, 1}(t, q) &= tp_{>4, 3}(t, q) \\
    &= t(p_{6, 5, 3}(t, q) + p_{8, 7, 5, 3}(t, q) + p_{>8, 7, 5, 3}(t, q) + p_{>7, 5, 3}(t, q) + p_{>5, 3}(t, q)) \\
    &= tf_{7, 4, 3, 2}(t, q) \\
    &= f_{7, 4, 3, 3}(t, q), \\
    p_{4, 1, 1, 1}(t, q) &= tqp_{3, 3}(t, q) = f_{10, 5, 7, 5}(t, q).
  \end{align*}
  The formula for $p_{>3, 1, 1, 1}(t, q)$ then follows from \Cref{lmm:20}.
\end{proof}

\begin{lemma}
  \label{lmm:35}
  The formal power series $p^{1/16}(t, q)$ is given by
  \begin{equation*}
    p^{1/16}(t, q) = f_{1, 1, 0, 0}(t, q) + f_{4, 2, 1, 1}(t, q) + f_{7, 3, 3, 3}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  This follows from the disjoint union
  \begin{equation*}
    P^{1/16} = P^{1/16}_{>2} \cup P^{1/16}_{>2, 1} \cup P^{1/16}_{>2, 1, 1} \cup P^{1/16}_{>3, 1, 1, 1}
  \end{equation*}
  together with \Cref{lmm:31}, \Cref{lmm:32}, \Cref{lmm:33}, \Cref{lmm:34} and \Cref{lmm:20}.
\end{proof}

The partitions $[2]$, $[1, 1, 1, 1]$, $[3, 1, 1, 1]$, $[3, 3, 1]$, $[4, 3, 1]$, $[4, 4, 1, 1]$, $[5, 4, 1, 1, 1]$, $[5, 5, 1, 1, 1]$, $[6, 5, 3, 1, 1]$, $[6, 6, 3, 1, 1]$, $[7, 6, 4, 1, 1, 1]$ and $[8, 7, 5, 3, 1, 1]$ are pivots of the matrices $A^W_2$, $A^W_4$, $A^W_6$, $A^W_7$, $A^W_8$, $A^W_{10}$, $A^W_{12}$, $A^W_{13}$, $A^W_{16}$, $A^W_{17}$, $A^W_{20}$ and $A^W_{25}$ respectively, see \cite[ising-modules-1-16.ipynb]{sagemath2}.

\bibliographystyle{alpha}
\bibliography{ising-modules.bib}

\end{document}