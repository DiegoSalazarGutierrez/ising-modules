\documentclass[a4paper, 12pt, reqno]{amsart}

\usepackage{amssymb}
\usepackage[backref = page]{hyperref}
\usepackage[margin = 0.75in]{geometry}
\usepackage[shortlabels]{enumitem}
\usepackage{tikz-cd}
\usepackage[nameinlink]{cleveref}
\usepackage{stmaryrd}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}

\crefformat{section}{\S#2#1#3}
\crefformat{subsection}{\S#2#1#3}

\setenumerate[0]{label = \normalfont(\roman*)}

\DeclareMathOperator{\Vir}{Vir}
\DeclareMathOperator{\Id}{Id}
\DeclareMathOperator{\gr}{gr}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\ch}{ch}
\DeclareMathOperator{\lm}{lm}
\DeclareMathOperator{\vspan}{span}
\DeclareMathOperator{\Ind}{Ind}
\DeclareMathOperator{\len}{len}
\DeclareMathOperator{\psn}{psn}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\res}{res}
\DeclareMathOperator{\vac}{|0\rangle}
\DeclareMathOperator{\vachalf}{|1/2\rangle}
\DeclareMathOperator{\vacsixteen}{|1/16\rangle}
\DeclareMathOperator{\zero}{\overline{0}}
\DeclareMathOperator{\one}{\overline{1}}
\DeclareMathOperator{\Der}{Der}
\DeclareMathOperator{\Lie}{Lie}
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\Cur}{Cur}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\fs}{fs}
\DeclareMathOperator{\tc}{tc}
\DeclareMathOperator{\sdim}{sdim}
\DeclareMathOperator{\sing}{sing}
\DeclareMathOperator{\Zhu}{Zhu}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\For}{For}
\DeclareMathOperator{\Supp}{Supp}
\DeclareMathOperator{\inc}{inc}
\DeclareMathOperator{\Alg}{Alg}
\DeclareMathOperator{\Algf}{Alg^f}
\DeclareMathOperator{\DAlg}{DAlg}
\DeclareMathOperator{\Gen}{Gen}

\renewcommand*{\backref}[1]{}
\renewcommand*{\backrefalt}[4]{%
  \ifcase #1 (Not cited.)%
  \or        (Cited on page~#2.)%
  \else      (Cited on pages~#2.)%
  \fi}

\begin{document}

\setcounter{section}{-1}

\begin{abstract}
  To every $h + \mathbb{N}$-graded module $M$ over an $\mathbb{N}$-graded conformal vertex algebra $V$, we associate an increasing filtration $(G^pM)_{p \in \mathbb{Z}}$, which is compatible with the filtrations introduced by Haisheng Li.
  The associated graded vector space $\gr^G(M)$ is naturally a module over the vertex Poisson algebra $\gr^G(V)$.
  We study $\gr^G(M)$ for the three irreducible modules over the Ising model $\Vir_{3, 4}$, namely $\Vir_{3, 4} = L(1/2, 0)$, $L(1/2, 1/2)$ and $L(1/2, 1/16)$.
  We obtain an explicit PBW basis of each of these modules and a formula for their refined characters, which are related to Nahm sums for the matrix $\left(\begin{smallmatrix} 8 & 3 \\ 3 & 2 \end{smallmatrix}\right)$. \\
  \smallskip
  \noindent \textbf{Keywords.} Vertex algebras, Ising model, Nahm sums, quantum algebra, combinatorics.
\end{abstract}

\title{PBW bases of irreducible Ising modules}
\author{Diego Salazar}
\address{Instituto de Matemática Pura e Aplicada, Rio de Janeiro, RJ, Brazil}
\email{diego.salazar@impa.br}
\date{\today}
\maketitle

\vspace{-1em}
\tableofcontents

\section{Introduction}
\label{sec:introduction}

Modules over the Virasoro Lie algebra, Kac-Moody Lie algebras, vertex algebras, and other related noncommutative algebraic objects are often equipped with natural filtrations, whose associated graded spaces bear interesting structures, such as differential structures, Poisson structures, etc.
The prototype of this situation is, of course, the PBW theorem, one formulation of which is that for a Lie algebra $\mathfrak{g}$, the associated graded space $\gr(U(\mathfrak{g}))$ of the universal enveloping algebra $U(\mathfrak{g})$ with respect to the usual PBW filtration is naturally isomorphic to the symmetric algebra $S(\mathfrak{g})$, i.e., it is a polynomial algebra.

A similar notion in the context of vertex operator algebras has garnered increasing interest in recent years.
For a vertex operator algebra $V$, there is a natural epimorphism $JR_V \twoheadrightarrow \gr_F(V)$ between the jet algebra of the Zhu $C_2$-algebra $R_V$ of $V$ and the associated graded space $\gr_F(V)$ of $V$ with respect to the Li filtration.
If this is an isomorphism, we say $V$ is classically free.
The property of classical freedom, and its failure, are related to problems in representation theory such as monomial bases of irreducible representations and combinatorial interpretations of classical number theoretic identities like the Rogers-Ramanujan identity.

The Ising model $\Vir_{3, 4}$ is a vertex operator algebra that turns out not to be classically free, as illustrated in \cite{andrews_singular_2022}.
However, it is still possible to find a monomial basis of $\Vir_{3, 4}$.
In this thesis, we continue the work of Andrews, Van Ekeren and Heluani by studying the irreducible modules over $\Vir_{3, 4}$, their associated graded spaces and their PBW bases.
As it turns out, we have to use a modified version of the PBW filtration when considering modules over $\Vir_{3, 4}$.

A vertex superalgebra can be thought of as a vector superspace $V$ together with a distinguished element $\vac \in V_{\zero}$, called vacuum vector, and $\mathbb{Z}$-many bilinear products
\begin{align*}
  \bullet_{(n)}\bullet: V \times V &\to V, \\
  (a, b) &\mapsto a_{(n)}b,
\end{align*}
called $n$-products, such that the generating function
\begin{align*}
  [\bullet_{\lambda}\bullet]: V \times V &\to V[\lambda], \\
  [a_{\lambda}b] &= \sum_{n \in \mathbb{N}}(a_{(n)}b)\frac{\lambda^n}{n!},
\end{align*}
called $\lambda$-bracket, satisfies the axioms of a Lie conformal superalgebra, which is very similar to a Lie superalgebra, together with quasicommutativity, quasiassociativity and the noncommutative Wick formula.
However, a more compact way to define vertex superalgebras is to gather all $n$-products into a single generating function
\begin{align*}
  Y(\bullet, z): V &\to \End(V)[[z^{\pm 1}]], \\
  a &\mapsto Y(a, z) = \sum_{n \in \mathbb{Z}}a_{(n)}z^{-n - 1}
\end{align*}
satisfying the vacuum axiom, the translation covariance axiom and the locality axiom.
Another, even shorter, way to describe vertex algebras is to require the vacuum axiom and the Borcherds identity.
The equivalence of these definitions is explained in \cite[\S1]{de_sole_finite_2006}.

A common way to create vertex superalgebras is to start from regular formal distribution Lie superalgebras $(\mathfrak{g}, \mathfrak{F}, T)$, which are just Lie superalgebras $\mathfrak{g}$ together with a family of $\mathfrak{g}$-valued formal distributions $\mathfrak{F}$ generating $\mathfrak{g}$ and a derivation $T$.
Then, we can construct the associated vertex algebra $V(\mathfrak{g}, \mathfrak{F}, T)$.
As we can see, vertex superalgebras are closely related to traditional Lie superalgebras.

We now introduce the universal Virasoro vertex algebra $\Vir^c$, where $c \in \mathbb{C}$.
The Virasoro Lie algebra, denoted by $\Vir$, is the Lie algebra given by
\begin{equation*}
  \Vir = \bigoplus_{n \in \mathbb{Z}}\mathbb{C}L_n \oplus \mathbb{C}C.
\end{equation*}
These elements satisfy the following commutation relations:
\begin{equation*}
  \begin{split}
    [L_m, L_n] &= (m - n)L_{m + n} + \delta_{m, -n}\frac{m^3 - m}{12}C \quad \text{for $m, n \in \mathbb{Z}$}, \\
    [\Vir, C] &= 0.
  \end{split}
\end{equation*}
We have an important $\Vir$-valued formal distribution
\begin{equation*}
  L(z) = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2},
\end{equation*}
and we can verify that $(\Vir, \{L(z), C\}, \ad(L_{-1}))$ is a regular formal distribution Lie algebra.
A certain quotient of the associated vertex algebra is the universal Virasoro vertex algebra of central charge $c$, which we describe now.
First, we make the subalgebra $\Vir_{\ge -1} \oplus \mathbb{C}C$ act on $\mathbb{C}$ as follows:
\begin{equation*}
  \text{$L_n1 = 0$ for $n \ge -1$ and $C1 = c$}.
\end{equation*}
It turns out that $\Vir^c$ is an induced $\Vir$-module given by
\begin{equation*}
  \Vir^c = \Ind^{\Vir}_{\Vir_{\ge -1} \oplus \mathbb{C}C}(\mathbb{C}) = U(\Vir) \otimes_{U(\Vir_{\ge -1} \oplus \mathbb{C}C)} \mathbb{C}.
\end{equation*}
By the PBW theorem, a basis of $\Vir^c$, also known as PBW basis, is given by
\begin{equation*}
  \{L_{-i_k}\dots L_{-i_1}\vac \mid i_k \ge \dots \ge i_1 \ge 2\}.
\end{equation*}

The vertex algebra $\Vir^c$ has a unique maximal proper ideal, and the quotient $\Vir_c$ is the simple Virasoro vertex algebra of central charge $c$.
For a generic value of $c \in \mathbb{C}$, $\Vir^c = \Vir_c$, i.e., $\Vir^c$ is already simple.
The smallest case in which this does not happen (other than the one dimensional vertex algebra $\mathbb{C}\vac$) is the Ising model $\Vir_{3, 4} = \Vir_{1/2}$.
A natural question to ask is: Can an explicit PBW basis of $\Vir_{3, 4}$ be obtained?
This is achieved in \cite{andrews_singular_2022}.

A module over a vertex superalgebra $V$ can be defined as a vector superspace $M$ together with a linear and parity preserving map $Y^M: V \to \End(M)[[z^{\pm 1}]]$ satisfying the vacuum axiom and the Borcherds identity.
When $V$ is given by a formal distribution Lie superalgebra, modules over $V$ are just smooth modules over the underlying Lie superalgebra.
We often assume that a $V$-module $M$ has a grading $\bigoplus_{n \in \mathbb{N}}M(n)$, which is compatible with the $n$-products in $V$.
Such modules are called admissible.

Some of the most common examples of vertex superalgebras encountered in the literature are:
\begin{enumerate}
\item The commutative vertex algebras, which are just differential commutative associative algebras with unit;
\item For $c \in \mathbb{C}$, the universal Virasoro vertex algebra $\Vir^c$ and the simple Virasoro vertex algebra $\Vir_c$;
\item For a Lie superalgebra $\mathfrak{g}$ with a supersymmetric bilinear form, the universal affine vertex superalgebra $V^k(\mathfrak{g})$ of level $k \in \mathbb{C}$;
\item For a superspace $V$ with an antisupersymmetric bilinear form, the fermionic vertex superalgebra $F(V)$;
\item For a lattice $L$ of finite rank equipped with a positive-definite symmetric bilinear form, the lattice vertex algebra $V_L$;
\item The Moonshine module vertex algebra $V^{\natural}$, whose automorphism group is the Monster sporadic group and started the study of vertex algebras.
\end{enumerate}
In this thesis, we will consider examples (i)--(iv).
The Moonshine module is perhaps the most amazing example of a vertex algebra.
However, the Virasoro vertex algebras are foundational in the sense that most vertex algebras $V$ are required to be conformal, which means there is a distinguished vector $\omega \in V$ satisfying the Virasoro commutation relations.
Even more, we usually require vertex algebras to be $\mathbb{Z}$-graded lower truncated or $\mathbb{N}$-graded.
Thus, we define vertex operator algebras as $\mathbb{Z}$-graded lower truncated conformal vertex algebras, and this is often the object of study, not general vertex algebras.

Vertex algebras are often assumed to be $C_2$-cofinite, which means $R_V$ is finite dimensional, and rational, which means any admissible module is completely reducible.
Rational vertex operator algebras have finitely many isomorphism classes of irreducible admissible modules, while $C_2$-cofinite vertex operator algebras have well-behaved modules.

Given a $\mathbb{Z}$-graded vertex algebra $V$, the Zhu algebra $\Zhu(V)$ is an associative algebra with unit that describes the irreducible admissible $V$-modules by doing the following: given an irreducible admissible $V$-module $M$, the space of lowest weight vectors $M(0)$ is a $\Zhu(V)$-module.
It turns out that it is possible to reverse this process, i.e., start with an irreducible $\Zhu(V)$-module and end up with an irreducible admissible $V$-module.

In this thesis, we focus on the Ising model $\Vir_{3, 4}$, which is conformal, $\mathbb{N}$-graded, $C_2$-cofinite and rational.
The irreducible modules over $\Vir_{3, 4}$, called Ising modules, are $\Vir_{3, 4} = L(1/2, 0)$, $L(1/2, 1/2)$ and $L(1/2, 1/16)$, which are irreducible highest weight representations of the Virasoro Lie algebra.
To describe a PBW basis of Ising modules, we study filtrations of vertex algebras and their modules.
These filtrations will yield a vertex Poisson algebra, in the case of vertex algebras, and a module over a vertex Poisson algebra, in the case of modules over vertex algebras.
Thus, the situation is similar to that of Lie algebras: we start with a Lie algebra $\mathfrak{g}$, we make its universal enveloping algebra $U(\mathfrak{g})$, we consider the PBW filtration of $U(\mathfrak{g})$, and the resulting associated algebra $\gr(U(\mathfrak{g}))$ is canonically isomorphic to the polynomial algebra $S(\mathfrak{g})$ (see \Cref{sec:almost-comm-algebr}).

In \cite{li_vertex_2004}, Li introduced an increasing filtration $(G^pV)_{p \in \mathbb{Z}}$ on an arbitrary $\mathbb{N}$-graded vertex algebra $V$.
The associated graded space $\gr^G(V)$ with respect to this increasing filtration then carries the structure of an $\mathbb{N}$-graded vertex Poisson algebra.

Then in \cite{li_abelianizing_2005}, Li introduced a decreasing filtration $(F_pV)_{p \in \mathbb{Z}}$ on an arbitrary vertex algebra $V$, not necessarily $\mathbb{N}$-graded.
The associated graded space $\gr_F(V)$ with respect to this decreasing filtration again carries the structure of a vertex Poisson algebra.
Li also introduced a decreasing filtration $(F_pM)_{p \in \mathbb{Z}}$ for modules $M$ over a vertex algebra $V$ and showed that the associated graded space $\gr_F(M)$ is a module over the vertex Poisson algebra $\gr_F(V)$.

In summary, Li constructed three functors:
\begin{align*}
  \gr^G: \{\text{$\mathbb{N}$-graded vertex algebras}\} &\to \{\text{$\mathbb{N}$-graded vertex Poisson algebras}\}, \\
  \gr_F: \{\text{vertex algebras}\} &\to \{\text{vertex Poisson algebras}\}, \\
  \gr_F: \{\text{$V$-modules}\} &\to \{\text{$\gr_F(V)$-modules}\}.
\end{align*}

Then Arakawa showed in \cite[Proposition 2.6.1]{arakawa_remark_2012} that when $V$ is $\mathbb{N}$-graded, $\gr_F(V)$ and $\gr^G(V)$ are isomorphic as vertex Poisson algebras.

In this thesis, we define an increasing filtration $(G^pM)_{p \in \mathbb{Z}}$ for $h + \mathbb{N}$-graded modules $M$ over an $\mathbb{N}$-graded conformal vertex algebra $(V, \omega)$.
We construct a functor
\begin{equation*}
  \gr^G: \{\text{$h + \mathbb{N}$-graded $(V, \omega)$-modules}\} \to \{\text{$h + \mathbb{N}$-graded $\gr^G(V)$-modules}\}.
\end{equation*}
Parallel to what was done in \cite{arakawa_remark_2012}, we show that $\gr_F(M)$ and $\gr^G(M)$ are isomorphic as modules.
However, for our purposes, the filtration $(G^pM)_{p \in \mathbb{Z}}$ is better suited.

In \cite{andrews_singular_2022}, two theorems about the Virasoro minimal model $\Vir_{3, 4}$ are proved.

\begin{theorem}
  \label{thr:1}
  The refined character of $\gr^G(\Vir_{3, 4})$ is given by
  \begin{equation*}
    \ch_{\gr^G(\Vir_{3, 4})}(t, q) = \sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2}}{(q)_{k_1}(q)_{k_2}}(1 - q^{k_1} + q^{k_1 + k_2}).
  \end{equation*}
\end{theorem}

Let $R^0$ be the following set of partitions
\begin{align*}
  &[r, r, r], [r + 1, r, r], [r + 1, r + 1, r], [r + 2, r + 1, r], [r + 2, r + 2, r], &(r \ge 2) \\
  &[r + 2, r, r], &(r \ge 3) \\
  &[r + 3, r + 3, r, r], [r + 4, r + 3, r, r],  [r + 4, r + 3, r + 1, r], [r + 4, r + 4, r + 1, r], &(r \ge 2) \\
  &[r + 6, r + 5, r + 3, r + 1, r], &(r \ge 2) \\
  &[5, 4, 2, 2], [7, 6, 4, 2, 2], [7, 7, 4, 2, 2], [9, 8, 6, 4, 2, 2].
\end{align*}
Let $P^0$ be the set of partitions $\lambda = [\lambda_1, \dots, \lambda_m]$ with $\lambda_m \ge 2$ that do not contain any partition in $R^0$.

\begin{theorem}
  \label{thr:2}
  The set
  \begin{equation*}
    \{L_{-\lambda_1}L_{-\lambda_2}\dots L_{-\lambda_m}\vac \mid \lambda = [\lambda_1, \dots, \lambda_m] \in P^0\}
  \end{equation*}
  is a vector space basis of $\Vir_{3, 4}$.
\end{theorem}

In this thesis, we prove two similar results about $L(1/2, 1/2)$ and $L(1/2, 1/16)$.

\begin{theorem}
  \label{thr:3}
  The refined character of $\gr^G(L(1/2, 1/2))$ is given by
  \begin{equation*}
    \ch_{\gr^G(L(1/2, 1/2))}(t, q) = q^{1/2}\left(\sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2}}{(q)_{k_1}(q)_{k_2}}(q^{3k_1 + 2k_2} + q^{5k_1 + 2k_2 + 1}t + q^{6k_1 + 3k_2 + 2}t^2)\right).
  \end{equation*}
\end{theorem}

Let $R^{1/2}$ be the following set of partitions
\begin{align*}
  &[r, r, r], [r + 1, r, r], [r + 1, r + 1, r], [r + 2, r + 1, r], [r + 2, r + 2, r], &(r \ge 3) \\
  &[r + 2, r, r], &(r \ge 3) \\
  &[r + 3, r + 3, r, r], [r + 4, r + 3, r, r],  [r + 4, r + 3, r + 1, r], [r + 4, r + 4, r + 1, r], &(r \ge 3)\\
  &[r + 6, r + 5, r + 3, r + 1, r], &(r \ge 3) \\
  &[2], [1, 1, 1], [3, 1, 1], [3, 3], [4, 3, 1], [4, 4, 1], [5, 4, 1, 1], [6, 5, 3, 1].
\end{align*}
Let $P^{1/2}$ be the set of partitions that do not contain any partition in $R^{1/2}$.

\begin{theorem}
  \label{thr:4}
  The set
  \begin{equation*}
    \{L_{-\lambda_1}L_{-\lambda_2}\dots L_{-\lambda_m}\vachalf \mid \lambda = [\lambda_1, \dots, \lambda_m] \in P^{1/2}\}
  \end{equation*}
  is a vector space basis of $L(1/2, 1/2)$.
\end{theorem}

Specializing the character formula in \Cref{thr:3} to $t = 1$, we obtain that the character of $L(1/2, 1/2)$ is the sum of three Nahm sums for the same matrix $\left(\begin{smallmatrix} 8 & 3 \\ 3 & 2 \end{smallmatrix}\right)$ (cf.\ \cite{Nahm2007} and \cite{andrews_singular_2022}).
The partitions in $P^0$ also have a combinatorial interpretation, as was noted in \cite{andrews_singular_2022} and \cite{tsuchioka_vertex_2023}.
For example, for $n \in \mathbb{N}$, the number of partitions of $n$ in $P^0$ is the number of partitions of $n$ with parts congruent to $\pm 2$, $\pm 3$, $\pm 4$ and $\pm 5$ modulo $16$.

\begin{theorem}
  \label{thr:5}
  The refined character of $\gr^G(L(1/2, 1/16))$ is given by
  \begin{equation*}
    \ch_{\gr^G(L(1/2, 1/16))}(t, q) = q^{1/16}\left(\sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2}}{(q)_{k_1}(q)_{k_2}}(q^{k_1 + k_2} + q^{4k_1 + 2k_2 + 1}t + q^{7k_1 + 3k_2 + 3}t^3)\right).
  \end{equation*}
  Let $R^{1/16}$ be the following set of partitions
  \begin{align*}
    &[r, r, r], [r + 1, r, r], [r + 1, r + 1, r], [r + 2, r + 1, r], [r + 2, r + 2, r], &(r \ge 3) \\
    &[r + 2, r, r], &(r \ge 3) \\
    &[r + 3, r + 3, r, r], [r + 4, r + 3, r, r],  [r + 4, r + 3, r + 1, r], [r + 4, r + 4, r + 1, r], &(r \ge 3)\\
    &[r + 6, r + 5, r + 3, r + 1, r], &(r \ge 3) \\
    &[2], [1, 1, 1, 1], [3, 1, 1, 1], [3, 3, 1], [4, 3, 1], [4, 4, 1, 1], [5, 4, 1, 1, 1], [5, 5, 1, 1, 1], \\
    &[6, 5, 3, 1, 1], [6, 6, 3, 1, 1], [7, 6, 4, 1, 1, 1], [8, 7, 5, 3, 1, 1].
  \end{align*}
  Let $P^{1/16}$ be the set of partitions that do not contain any partition in $R^{1/16}$.
  The set
  \begin{equation*}
    \{L_{-\lambda_1}L_{-\lambda_2}\dots L_{-\lambda_m}\vacsixteen \mid \lambda = [\lambda_1, \dots, \lambda_m] \in P^{1/16}\}
  \end{equation*}
  is a vector space basis of $L(1/2, 1/16)$.
\end{theorem}

In this thesis, we develop the theory needed to prove the theorems above.
We assume only basic knowledge about algebra, commutative algebra, Lie algebras and algebraic geometry.
Mathematical terms are typeset with \emph{italics} when they are officially defined.

This thesis is organized as follows.
In \Cref{sec:vert-supera-their}, we introduce the notion of vertex superalgebras and their modules while trying to compile several results.
In \Cref{sec:high-weight-repr}, we review the theory of representations of the Virasoro Lie algebra with the objective of describing explicitly the maximal proper subrepresentations of Verma modules.
In \Cref{sec:modules-over-simple}, we quickly review the theory of the Zhu algebra.
In \Cref{sec:vert-poiss-algeb}, the theory of filtrations of vertex algebras and their modules started by Haisheng Li is presented, we introduce the standard filtration for modules, and we prove it is compatible with the definitions already given by Li.
Then, we introduce the Zhu $C_2$-algebra and derive consequences of the $C_2$-cofiniteness condition.
In \Cref{sec:pbw-basis-l12}, we carry out the computations needed to obtain the PBW basis of $L(1/2, 1/2)$ and its refined character.
We also prove \Cref{thr:3} and \Cref{thr:4}.
In the appendices, we recall some results about almost commutative algebras, Poisson algebras and Jet algebras, we show the SageMath \cite{sagemath} program used to compute the exceptional partitions appearing in $R^{1/2}$, and we briefly consider the case $L(1/2, 1/16)$.
The software systems Mathematica \cite{Mathematica} and Singular \cite{Singular} were also very useful to verify the series identities and compute Gröbner bases.

I would like to thank my advisor Reimundo Heluani and Instituto de Matemática Pura e Aplicada (IMPA) for their support.
Jethro Van Ekeren made some valuable suggestions as well.
The author is partially supported by PhD scholarship 155672/2019-3 from Conselho Nacional de Desenvolvimento Científico e Tecnológico (CNPq).

\numberwithin{theorem}{subsection}

\section{Vertex superalgebras and their modules}
\label{sec:vert-supera-their}

In this section, we first review formal calculus and Lie conformal superalgebras in a purely algebraic way, meaning convergence of series is never considered.
Next, we study the Virasoro Lie conformal algebra, the Current Lie conformal superalgebra and the fermionic Lie conformal superalgebra.
Afterward, we specialize the theory of formal calculus to $\End(V)$-valued series, where $V$ is a vector space.
This leads to the concept of fields over vector spaces.
Then, the concept of vertex superalgebra is introduced.
It is shown how to construct a vertex superalgebra from a Lie conformal superalgebra.
Later, we introduce Hamiltonians and conformal vectors of vertex superalgebras, which lead to graded and conformal vertex superalgebras, respectively.
Next, modules over vertex superalgebras are introduced with emphasis on admissible modules.
Finally, we construct a couple of functors from the category of vertex algebras to the category of Lie algebras.

\subsection{Formal calculus}
\label{sec:formal-calculus}

All vector spaces and all algebras are over $\mathbb{C}$, the field of complex numbers, unless otherwise stated.
The set of natural numbers $\{0, 1, \dots\}$ is denoted by $\mathbb{N}$, the set of integers is denoted by $\mathbb{Z}$, the set of positive integers $\{1, 2, \dots\}$ is denoted by $\mathbb{Z}_+$, and the set of negative integers $\{-1, -2, \dots\}$ is denoted by $\mathbb{Z}_-$.

The vector space of \emph{formal distributions in $n \in \mathbb{N}$ variables}, denoted by $\mathbb{C}[[x_1^{\pm 1}, \dots, x_n^{\pm 1}]]$, is the set of functions $f: \mathbb{Z}^n \to \mathbb{C}$, written as $f(x_1, \dots, x_n) = \sum_{m_1, \dots, m_n \in \mathbb{Z}}f_{m_1, \dots, m_n}x_1^{m_1}\dots x_n^{m_n}$, with the natural operations of addition and multiplication by a scalar.
The field of \emph{rational functions in $n$ variables}, denoted by $\mathbb{C}(x_1, \dots, x_n)$, is the field of fractions $\Frac(\mathbb{C}[x_1, \dots, x_n])$.
The field of \emph{formal Laurent series}, denoted by $\mathbb{C}((x))$, is the subalgebra of elements $f(x) \in \mathbb{C}[[x^{\pm 1}]]$ such that there is $N \in \mathbb{Z}$ with $f_n = 0$ for $n \le N$.
We also have $\mathbb{C}((x)) = \Frac(\mathbb{C}[[x]])$.
The field of \emph{joint Laurent series in $n$ variables}, denoted by $\mathbb{C}((x_1, \dots, x_n))$, is $\Frac(\mathbb{C}[[x_1, \dots, x_n]])$.
If $V$ is a vector space, we similarly define $V[[x_1^{\pm 1}, \dots, x_n^{\pm 1}]]$ and $V((x))$, but in this case, $V((x))$ is only a vector space.

Let $V$ be a vector space.
The \emph{Fourier expansion of a formal distribution $a(z) \in V[[z^{\pm 1}]]$}, written as $a(z) = \sum_{n \in \mathbb{Z}}a_nz^n$, is conventionally written in the theory of vertex superalgebras as
\begin{equation*}
  a(z) = \sum_{n \in \mathbb{Z}}a_{(n)}z^{-n - 1},
\end{equation*}
where
\begin{equation*}
  a_{(n)} = a_{-n - 1}.
\end{equation*}
The \emph{residue of a formal distribution $a(z) \in V[[z^{\pm 1}]]$} is defined as
\begin{equation*}
  \res_z(a(z)) = a_{(0)} = a_{-1}.
\end{equation*}

If $P \in \mathbb{C}[[z_1^{\pm 1}, \dots, z_n^{\pm 1}]]$ and $Q \in \mathbb{C}[[w_1^{\pm 1}, \dots, w_m^{\pm 1}]]$, then $PQ \in \mathbb{C}[[z_1^{\pm 1}, \dots z_n^{\pm 1}, w_1^{\pm 1}, \dots, w_m^{\pm 1}]]$ is defined in the natural way.
However, if both $P$ and $Q$ belong to $\mathbb{C}[[z_1^{\pm 1}, \dots, z_n^{\pm 1}]]$, we may encounter difficulties because infinite sums may appear.

An important formal distribution in two variables $z$ and $w$ is the \emph{formal delta distribution}, which is defined by
\begin{equation*}
  \delta(z, w) = \sum_{n \in \mathbb{Z}}z^nw^{-n - 1} \in \mathbb{C}[[z^{\pm 1}, w^{\pm 1}]].
\end{equation*}

The \emph{expansion in the domain} $|z| > |w|$ is the field homomorphism $i_{z, w}: \mathbb{C}((z, w)) \to \mathbb{C}((z))((w))$ such that the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    {\mathbb{C}[[z, w]]} \arrow[rd, "\inc"', hook] \arrow[r, "\inc", hook] & {\mathbb{C}((z, w))} \arrow[d, "{i_{z, w}}"] \\
    & \mathbb{C}((z))((w))
  \end{tikzcd}
\end{equation*}
where $\inc$ denotes a natural inclusion.
Similarly, the expansion in the domain $|w| > |z|$ is the field homomorphism $i_{w, z}: \mathbb{C}((z, w)) \to \mathbb{C}((w))((z))$ such that the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    {\mathbb{C}[[z, w]]} \arrow[rd, "\inc"', hook] \arrow[r, "\inc", hook] & {\mathbb{C}((z, w))} \arrow[d, "{i_{w, z}}"] \\
    & \mathbb{C}((w))((z))
  \end{tikzcd}
\end{equation*}

The diagram
\begin{equation*}
  \begin{tikzcd}
    & {\mathbb{C}((z, w))} \arrow[ld, "{i_{z, w}}"'] \arrow[rd, "{i_{w, z}}"] &\\
    \mathbb{C}((z))((w)) \arrow[rd, "\inc"', hook] && \mathbb{C}((w))((z)) \arrow[ld, "\inc", hook] \\
    & {\mathbb{C}[[z^{\pm 1}, w^{\pm 1}]]} &
  \end{tikzcd}
\end{equation*}
does not commute.
In fact, the formal delta distribution can be expressed as
\begin{equation*}
  \delta(z, w) = i_{z, w}\left(\frac{1}{z - w}\right) - i_{w, z}\left(\frac{1}{z - w}\right),
\end{equation*}
where we consider $i_{z, w}(\frac{1}{z - w})$ and $i_{w, z}(\frac{1}{z - w})$ as elements of $\mathbb{C}[[z^{\pm 1}, w^{\pm 1}]]$.
From now on, we will consider $i_{z, w}$ and $i_{w, z}$ as mapped into $\mathbb{C}[[z^{\pm 1}, w^{\pm 1}]]$.

Let $V$ be a vector space.
A formal distribution $a(z, w) \in V[[z^{\pm 1}, w^{\pm 1}]]$ is \emph{local} if there is $N \in \mathbb{N}$ such that
\begin{equation*}
  (z - w)^Na(z, w)=0.
\end{equation*}
For example, the formal delta distribution $\delta(z, w)$ is local with $(z - w)\delta(z, w) = 0$.

\begin{theorem}[{\cite[Proposition 2.2]{kac_vertex_1998}}]
  \label{thr:6}
  Let $a(z, w) \in V[[z^{\pm 1}, w^{\pm 1}]]$ be a local formal distribution.
  Then $a(z, w)$ can be written uniquely as a sum
  \begin{equation*}
    a(z, w) = \sum_{j \in \mathbb{N}}\frac{\partial_w^j\delta(z, w)}{j!}c^j(w),
  \end{equation*}
  where $c^j(w) \in V[[w^{\pm 1}]]$ are formal distributions given by
  \begin{equation*}
    c^j(w) = \res_z((z - w)^ja(z, w)) \quad \text{for $j \in \mathbb{N}$}.
  \end{equation*}
  In addition, the converse is true.
\end{theorem}

Let $V$ be a vector space, and let $a(z) \in V[[z^{\pm 1}]]$ be a formal distribution.
We define
\begin{equation*}
  i_{z, w}a(z + w) = \sum_{n \in \mathbb{Z}} a_ni_{z, w}((z + w)^n).
\end{equation*}

\begin{proposition}[{\cite[Proposition 3.4.1]{nozaradan_introduction_2008}}]
  \label{prp:1}
  For a formal distribution $a(z) \in V[[z^{\pm 1}]]$, the usual Taylor series expansion holds, i.e.,
  \begin{equation*}
    i_{z, w}a(z + w) = \sum_{j \in \mathbb{N}}\frac{\partial^ja(z)}{j!}w^j.
  \end{equation*}
\end{proposition}

We now define the notion of Fourier transform in two cases: in one and two variables.
Let $V$ be a vector space, and let $a(z) \in V[[z^{\pm 1}]]$.
We define the \emph{Fourier transform in one variable of $a(z)$} by
\begin{equation*}
  F^{\lambda}_za(z) = \res_z(e^{\lambda z}a(z)) \in V[[\lambda]].
\end{equation*}

\begin{proposition}[{\cite[Proposition 1.5.2]{nozaradan_introduction_2008}}]
  \label{prp:2}
  The Fourier transform in one variable satisfies the following properties for $a(z) \in V[[z^{\pm 1}]]$:
  \begin{enumerate}
  \item $F^{\lambda}_z\partial_za(z) = -\lambda F^{\lambda}_za(z)$;
  \item $F^{\lambda}_z(e^{zT}a(z)) = F^{\lambda + T}_z(a(z))$, where $T \in \End(V)$ and $a(z) \in V((z))$;
  \item $F^{\lambda}_z(a(-z)) = -F^{-\lambda}_za(z)$;
  \item $F^{\lambda}_z\partial^n_w\delta(z, w) = e^{\lambda w}\lambda^n$.
  \end{enumerate}
\end{proposition}

Now let $a(z, w) \in V[[z^{\pm 1}, w^{\pm 1}]]$.
We define the \emph{Fourier transform in two variables of $a(z, w)$} by
\begin{equation*}
  F^{\lambda}_{z, w}a(z, w) = \res_z(e^{\lambda(z - w)}a(z, w)) \in V[[w^{\pm 1}]][[\lambda]].
\end{equation*}
Expanding the definition of $F^{\lambda}_{z, w}$, we obtain another expression
\begin{equation*}
  F^{\lambda}_{z, w}a(z, w) = \sum_{j \in \mathbb{N}}\frac{\lambda^j}{j!}c^j(w),
\end{equation*}
where
\begin{equation*}
  c^j(w) = \res_z((z - w)^ja(z, w)) \quad \text{for $j \in \mathbb{N}$}.
\end{equation*}

\begin{proposition}[{\cite[Proposition 1.5.4]{nozaradan_introduction_2008}}]
  \label{prp:3}
  The Fourier transform in two variables satisfies the following properties for $a(z, w) \in V[[z^{\pm 1}, w^{\pm 1}]]$:
  \begin{enumerate}
  \item If $a(z, w)$ is local, then $F^{\lambda}_{z, w}a(z, w) \in V[[w^{\pm 1}]][\lambda]$;
  \item $F^{\lambda}_{z, w}\partial_za(z, w) = -\lambda F^{\lambda}_{z, w}a(z, w) = [\partial_w, F^{\lambda}_{z, w}]a(z, w)$;
  \item If $a(z, w)$ is local, then $F^{\lambda}_{z, w}a(w, z) = F^{-\lambda - \partial_w}_{z, w}a(z, w)$, where we set $F^{-\lambda - \partial_w}_{z, w}a(z, w) = F^{\mu}_{z, w}a(z, w)|_{\mu = -\lambda - \partial_w}$.
  \end{enumerate}
\end{proposition}

\begin{remark}
  \label{rmk:1}
  In the theory of vertex superalgebras, one usually has to interpret equations like in \Cref{prp:3}(iii).
\end{remark}

\subsection{Lie conformal superalgebras}
\label{sec:lie-conf-super}

A \emph{vector superspace} is a $\mathbb{Z}_2$-graded vector space $V = V_{\zero} \oplus V_{\one}$, where $\mathbb{Z}_2 = \mathbb{Z}/2\mathbb{Z} = \{\zero, \one\}$, $\zero = 0 + 2\mathbb{Z}$ and $\one = 1 + 2\mathbb{Z}$.
We call $V_{\zero}$ the \emph{even subspace of $V$} and $V_{\one}$ the \emph{odd subspace of $V$}.
Elements of $V_{\zero} \cup V_{\one}$ are called \emph{homogeneous}.
If $V$ is finite dimensional, we define its superdimension by setting $\sdim(V) = \dim(V_{\zero}) - \dim(V_{\one})$.
A \emph{superalgebra} is a $\mathbb{Z}_2$-graded algebra $A = A_{\zero} \oplus A_{\one}$.
This means $A_{\alpha}A_{\beta} \subseteq A_{\alpha + \beta}$ for $\alpha, \beta \in \mathbb{Z}_2$.

We set $(-1)^{\zero} = 1$ and $(-1)^{\one} = -1$.
If $a \in V_{\alpha}$, $a \neq 0$ is homogeneous, we set $p(a) = \alpha$ and call it the \emph{parity of $a$}.
If $a$ and $b$ are homogeneous, we set $p(a, b) = (-1)^{p(a)p(b)}$.
A \emph{Lie superalgebra} is a superalgebra $\mathfrak{g} = \mathfrak{g}_{\zero} \oplus \mathfrak{g}_{\one}$ with a bilinear product $[\bullet, \bullet]: \mathfrak{g} \times \mathfrak{g} \to \mathfrak{g}$ called \emph{Lie superbracket} satisfying the following properties for $a, b, c \in \mathfrak{g}$ homogeneous:
\begin{enumerate}
\item (Graded antisymmetry) $[a, b] = -p(a, b)[b, a]$;
\item (Graded Jacobi identity) $p(a, c)[a, [b, c]] + p(b, a)[b, [c, a]] + p(c, b)[c, [a, b]] = 0$.
\end{enumerate}

In an associative superalgebra $A$, we can define the superbracket of homogeneous elements $a, b \in A$ by
\begin{equation*}
  [a, b] = ab - p(a, b)ba.
\end{equation*}
It can then be extended by linearity to nonhomogeneous elements.
With this superbracket, $A$ becomes a Lie superalgebra called the \emph{underlying Lie superalgebra of $A$}, and it is denoted by $[A]$.

\begin{remark}
  \label{rmk:2}
  The even part $\mathfrak{g}_{\zero}$ of a Lie superalgebra $\mathfrak{g}$ is just a standard Lie algebra.
  However, unlike superspaces and superalgebras, a Lie superalgebra is not always a Lie algebra.
  This is why we prefer the term Lie superalgebra to $\mathbb{Z}_2$-graded Lie algebra.
\end{remark}

\begin{remark}
  \label{rmk:3}
  When a formula involves $p(a)$, it is assumed that $a$ is a homogeneous with parity $p(a)$, and the formula is extended to arbitrary $a$ by linearity.
\end{remark}

Probably the most important example of an associative superalgebra is the \emph{endomorphism superalgebra of a superspace $V$}, denoted by $\End(V)$, with the $\mathbb{Z}_2$-grading given by
\begin{equation*}
  \End(V)_{\alpha} = \{T \in \End(V) \mid \text{for $\beta \in \mathbb{Z}_2, T(V_{\beta}) \subseteq V_{\alpha + \beta}$}\} \quad \text{for $\alpha \in \mathbb{Z}_2$}.
\end{equation*}
We denote $\mathfrak{gl}(V) = [\End(V)]$.

Let $A$ be a not necessarily associative superalgebra.
A \emph{superderivation of $A$} is a homogeneous endomorphism $\partial \in \End(A)$ such that
\begin{equation*}
  \partial(ab) = \partial(a)b + (-1)^{p(\partial)p(a)}b\partial(c) \quad \text{for $a, b \in A$}.
\end{equation*}
The \emph{subspace of superderivations of $A$} is denoted by $\Der(A)$.
A \emph{differential superalgebra} is a superalgebra $A$ together with a superderivation $\partial$ of $A$.
A differential algebra is a differential superalgebra with odd subspace equal to $0$.
A homomorphism $f: (A, \partial_1) \to (A_2, \partial_2)$ of differential superalgebras is a linear and parity preserving map such that $f\circ\partial_1 = \partial_2\circ f$.

We assume $\mathfrak{g}$ is a Lie superalgebra and $\partial$ is a superderivation of $\mathfrak{g}$.
We can form the universal enveloping superalgebra $U(\mathfrak{g})$, which is now an associative superalgebra.
The derivation $\partial: \mathfrak{g} \to \mathfrak{g}$ can be extended uniquely to a derivation $DU(\partial): U(\mathfrak{g}) \to U(\mathfrak{g})$.
We have constructed a functor
\begin{align*}
  DU: \{\text{differential Lie superalgebras}\} &\to \{\text{associative differential superalgebras}\}, \\
  DU(\mathfrak{g}, \partial) &= (U(\mathfrak{g}), DU(\partial)).
\end{align*}

Let $\mathfrak{g}$ be a Lie superalgebra.
We first extend the Lie superbracket on $\mathfrak{g}$ to the Lie superbracket between two $\mathfrak{g}$-valued formal distributions in one variable.
Starting from $a(z) = \sum_{m \in \mathbb{Z}}a_{(m)}z^{-m - 1} \in \mathfrak{g}[[z^{\pm 1}]]$ and $b(w) = \sum_{n \in \mathbb{Z}}b_{(n)}w^{-n - 1} \in \mathfrak{g}[[w^{\pm 1}]]$, we define a new formal distribution in two variables by defining the superbracket
\begin{equation*}
  [a(z), b(w)] = \sum_{m, n \in \mathbb{Z}}[a_{(m)}, b_{(n)}]z^{-m - 1}w^{-n - 1} \in \mathfrak{g}[[z^{\pm 1}, w^{\pm 1}]].
\end{equation*}

Let $\mathfrak{g}$ be a Lie superalgebra.
A pair $(a(z), b(z))$ of $\mathfrak{g}$-valued formal distributions is said \emph{local} if $[a(z), b(w)]$ is local.
By \Cref{thr:6}, this means that
\begin{equation*}
  [a(z), b(w)] = \sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}c^j(w),
\end{equation*}
where $c^j(w) = \res_z((z - w)^j[a(z), b(w)]) \in \mathfrak{g}[[w^{\pm 1}]]$ for $j \in \mathbb{N}$.
Equivalently, we can write this equation as
\begin{equation}
  \label{eq:1}
  [a_{(m)}, b_{(n)}] = \sum_{j \in \mathbb{N}}c^j(w)_{(m + n - j)} \quad \text{for $m, n \in \mathbb{Z}$}.
\end{equation}

\begin{remark}
  \label{rmk:4}
  If $(a(z), b(z))$ is a local pair, then $(\partial_za(z), b(z))$ is also a local pair.
\end{remark}

Let $\mathfrak{g}$ be a Lie superalgebra.
A subset $\mathfrak{F} \subseteq \mathfrak{g}[[z^{\pm 1}]]$ of formal distributions is called a \emph{local family} if all pairs of its elements are local.
Let $a(w)$ and $b(w)$ be two $\mathfrak{g}$-valued formal distributions.
For $j \in \mathbb{N}$, the \emph{$j$-product} is the $\mathbb{C}$-bilinear map defined by
\begin{align}
  \nonumber
  \bullet_{(j)}\bullet: \mathfrak{g}[[w^{\pm 1}]] \times \mathfrak{g}[[w^{\pm 1}]] &\to \mathfrak{g}[[w^{\pm 1}]], \\
  \label{eq:2}
  a(w)_{(j)}b(w) &= \res_z((z - w)^j[a(z), b(w)]).
\end{align}
Expanding the right-hand side, we get
\begin{equation}
  \label{eq:3}
  (a(w)_{(j)}b(w))_{(m)} = \sum_{k = 0}^j\binom{j}{k}(-1)^k[a_{(j - k)}, b_{(m + k)}] \quad \text{for $j \in \mathbb{N}$ and $m \in \mathbb{Z}$}.
\end{equation}
We define $a(w)_{(j)} \in \End(\mathfrak{g}[[w^{\pm 1}]])$ in the natural way.
If $(a(z), b(z))$ is a local pair, then \eqref{eq:1} becomes
\begin{equation}
  \label{eq:4}
  [a_{(m)}, b_{(n)}] = \sum_{j \in \mathbb{N}}\binom{m}{j}(a(w)_{(j)}b(w))_{(m + n - j)} \quad \text{for $m, n \in \mathbb{Z}$}.
\end{equation}
By \Cref{thr:6}, we also have
\begin{equation*}
  [a(z), b(w)] = \sum_{j \in \mathbb{N}}\frac{\partial_w^j\delta(z, w)}{j!}(a(w)_{(j)}b(w)).
\end{equation*}
All these identities led us to define the following new algebraic structure that encodes the relevant information compactly.

Let $\mathfrak{g}$ be a Lie superalgebra.
The \emph{$\lambda$-bracket} is the $\mathbb{C}$-bilinear map given by
\begin{align*}
  [\bullet_{\lambda}\bullet]: \mathfrak{g}[[w^{\pm 1}]] \times \mathfrak{g}[[w^{\pm 1}]] &\to \mathfrak{g}[[w^{\pm 1}]][[\lambda]], \\
  [a(w)_{\lambda}b(w)] &= F^{\lambda}_{z, w}[a(z), b(w)].
\end{align*}
It can easily be shown that the $\lambda$-bracket is related to the $j$-products by
\begin{equation*}
  [a(w)_{\lambda}b(w)] = \sum_{j \in \mathbb{N}}a(w)_{(j)}b(w)\frac{\lambda^j}{j!}.
\end{equation*}
This suggests seeing the $\lambda$-bracket as the generating function of the $j$-products.
It allows us to gather all the $j$-products in one product alone, the price to pay being the additional formal variable $\lambda$.
We note that for a local pair, the sum in the expansion of $[a(w)_{\lambda}b(w)]$ in terms of the $j$-products is finite, i.e., $[a(w)_{\lambda}b(w)] \in \mathfrak{g}[[w^{\pm 1}]][\lambda]$.

\begin{theorem}[{\cite[\S2.3]{nozaradan_introduction_2008}}]
  \label{thr:7}
  The $j$-products and the $\lambda$-bracket satisfy the following properties for $a(w), b(w) \in \mathfrak{g}[[w^{\pm 1}]]$ and $j \in \mathbb{N}$:
  \begin{enumerate}
  \item $(\partial a(w))_{(j)}b = -ja(w)_{(j - 1)}b(w)$;
  \item $a(w)_{(j)}\partial b(w) = \partial(a(w)_{(j)}b(w)) + ja(w)_{(j - 1)}b(w)$;
  \item $\partial(a(w)_{(j)}b(w)) = (\partial a(w))_{(j)}b(w) + a(w)_{(j)}\partial b(w)$;
  \item $[\partial a(w)_{\lambda}b(w)] = -\lambda[a(w)_{\lambda}b(w)]$;
  \item $[a(w)_{\lambda}\partial b(w)] = (\partial + \lambda)[a(w)_{\lambda}b(w)]$;
  \item $\partial[a(w)_{\lambda}b(w)] = [\partial a(w)_{\lambda}b(w)] + [a(w)_{\lambda}\partial b(w)]$.
  \end{enumerate}
\end{theorem}

\begin{remark}
  \label{rmk:5}
  Properties (iii) and (vi) of \Cref{thr:7} tell us that $\partial: \mathfrak{g}[[z^{\pm 1}]] \to \mathfrak{g}[[z^{\pm 1}]]$ acts as a derivation on the $j$-products and the $\lambda$-bracket.
\end{remark}

Let $V$ be a vector superspace.
From now on, all coefficients of a formal distribution are assumed to have the same parity.
Therefore, we can define the \emph{parity of a formal distribution $a(z) \in V[[z^{\pm 1}]]$} as $p(a(z)) = p(a_{(n)})$ for any $n \in \mathbb{Z}$.

\begin{theorem}[{\cite[\S2.3]{nozaradan_introduction_2008}}]
  \label{thr:8}
  The $j$-products and the $\lambda$-bracket satisfy the following properties for $a(w), b(w) \in \mathfrak{g}[[w^{\pm 1}]]$, $p, m \in \mathbb{Z}$ and $j \in \mathbb{N}$:
  \begin{enumerate}
  \item $b(w)_{(j)}a(w) = -p(a(w), b(w))\sum_{l = 0}^{\infty}(-1)^{j + l}\frac{\partial^l(a(w)_{(j + l)}b(w))}{l!}$ if $(a(w), b(w))$ is a local pair;
  \item $[a(w)_{(p)}, b(w)_{(m)}] = \sum_{k = 0}^p\binom{p}{k}(a(w)_{(k)}b(w))_{(p + m - k)}$;
  \item $[b(w)_{\lambda}a(w)] = -p(a(w), b(w))[a(w)_{-\lambda - \partial}b(w)]$ if $(a(w), b(w))$ is a local pair;
  \item $[a(w)_{\lambda}[b(w)_{\mu}c(w)]] = [[a(w)_{\lambda}b(w)]_{\lambda + \mu}c(w)] + p(a(w), b(w))[b(w)_{\mu}[a(w)_{\lambda}c(w)]]$;
  \item $F^{\lambda + \mu}_z[a(z)_{\lambda}b(z)] = [F^{\lambda}_za(z), F^{\mu}_zb(z)]$.
  \end{enumerate}
\end{theorem}

Let $\mathfrak{g}$ be a Lie superalgebra.
A \emph{formal distribution Lie superalgebra} is a pair $(\mathfrak{g}, \mathfrak{F})$, where $\mathfrak{F}$ is a local family of $\mathfrak{g}$-valued formal distributions, denoted by $\{a^j(z) = \sum_{n \in \mathbb{Z}}a^j_{(n)}z^{-n - 1}\}_{j \in J}$, such that the coefficients $\{a^j_{(n)} \mid j \in J, n \in \mathbb{Z}\}$ span the whole $\mathfrak{g}$.
A \emph{regular} formal distribution Lie superalgebra is a triple $(\mathfrak{g}, \mathfrak{F}, T)$ such that:
\begin{enumerate}
\item $(\mathfrak{g}, \mathfrak{F})$ is a formal distribution Lie superalgebra;
\item $\mathbb{C}[\partial_z]\mathfrak{F}$ is closed under all $n$-th products for $n \in \mathbb{N}$;
\item $T \in \Der(\mathfrak{g})$ satisfies
  \begin{equation*}
    T(a^j(z)) = \partial_za^j(z) \quad \text{for $j \in J$},
  \end{equation*}
  which is equivalent to
  \begin{equation}
    \label{eq:5}
    T(a^j_{(n)}) = -na^j_{(n - 1)} \quad \text{for $j \in J$ and $n \in \mathbb{Z}$}.
  \end{equation}
\end{enumerate}

\begin{remark}
  \label{rmk:6}
  We note that \eqref{eq:5} and the fact that $\{a^j_{(n)} \mid j \in J, n \in \mathbb{Z}\}$ spans $\mathfrak{g}$ imply that if such $T$ exists, it is even and unique.
  Thus, we could remove $T$ from the notation, but we will not.
\end{remark}

Let $(\mathfrak{g}, \mathfrak{F})$ be a formal distribution Lie superalgebra.
The \emph{annihilation subalgebra of $(\mathfrak{g}, \mathfrak{F})$} is
\begin{equation*}
  \mathfrak{g}_- = \vspan\{a^j_{(n)} \mid j \in J, n \in \mathbb{N}\},
\end{equation*}
the \emph{creation subalgebra of $(\mathfrak{g}, \mathfrak{F})$} is
\begin{equation*}
  \mathfrak{g}_+ = \vspan\{a^j_{(-n - 1)} \mid j \in J, n \in \mathbb{N}\},
\end{equation*}
and the \emph{polar decomposition of $(\mathfrak{g}, \mathfrak{F})$} is
\begin{equation*}
  \mathfrak{g} = \mathfrak{g}_- \oplus \mathfrak{g}_+.
\end{equation*}

By \Cref{rmk:4}, if $(\mathfrak{g}, \mathfrak{F})$ is a formal distribution Lie superalgebra, then $\mathbb{C}[\partial_z]\mathfrak{F}$ is a local family.
The notions of $j$-products and $\lambda$-bracket were previously defined from $\mathfrak{g}$-valued formal distributions, with $\mathfrak{g}$ being a given Lie superalgebra.
Those products were shown to satisfy several properties, coming either from their definition or from the fact that $\mathfrak{g}$ is a Lie superalgebra.
We now take those properties as axioms of a new algebraic structure, defined intrinsically, without any reference either to $\mathfrak{g}$, nor to formal distributions.
For this reason, we write $\partial$ instead of $\partial_z$ in the following definition.

A $\mathbb{C}[\partial]$-module $\mathcal{R}$ is called a \emph{Lie conformal superalgebra} if it is endowed with a $\mathbb{C}$-bilinear map called \emph{$\lambda$-bracket}
\begin{equation*}
  [\bullet_{\lambda}\bullet]: \mathcal{R} \times \mathcal{R} \to \mathcal{R}[\lambda]
\end{equation*}
satisfying the following properties for $a, b, c \in \mathcal{R}$:
\begin{enumerate}
\item (Sesquilinearity) $[\partial a_{\lambda}b] = -\lambda[a_{\lambda}b]$;
\item (Skewsymmetry) $[b_{\lambda}a] = -p(a, b)[a_{-\lambda - \partial}b]$;
\item (Jacobi identity) $[a_{\lambda}[b_{\mu}c]] = [[a_{\lambda}b]_{\lambda + \mu}c] + p(a, b)[b_{\mu}[a_{\lambda}c]]$.
\end{enumerate}

If we write
\begin{equation*}
  [a_{\lambda}b] = \sum_{j \in \mathbb{N}}(a_{(j)}b)\frac{\lambda^j}{j!},
\end{equation*}
where $a_{(j)} \in \End(\mathcal{R})$, these properties translate in terms of $j$-products as follows:
\begin{enumerate}
\item $(\partial a)_{(j)} = -ja_{(j - 1)}$;
\item $b_{(j)}a = -p(a, b)\sum_{l = 0}^{\infty}(-1)^{j + l}\frac{\partial^l(a_{(j + l)}b)}{l!}$;
\item $[a_{(p)}, b_{(m)}] = \sum_{k = 0}^p\binom{p}{k}(a_{(k)}b)_{(p + m - k)}$.
\end{enumerate}

\begin{proposition}[{\cite[Remark 2.5.3]{nozaradan_introduction_2008}}]
  \label{prp:4}
  Let $\mathcal{R}$ be a Lie conformal superalgebra, and let $a, b \in \mathcal{R}$.
  Then
  \begin{equation*}
    [a_{\lambda}\partial b] = (\partial + \lambda)[a_{\lambda}b]
  \end{equation*}
  or, equivalently,
  \begin{equation*}
    a_{(j)}\partial b = \partial(a_{(j)}b) + ja_{(j - 1)}b \quad \text{for $j \in \mathbb{N}$}.
  \end{equation*}
  In particular, $\partial$ is a derivation of the $\lambda$-bracket.
\end{proposition}

We have previously shown that any regular formal distribution Lie superalgebra $(\mathfrak{g}, \mathfrak{F}, T)$ was given the structure of Lie Conformal superalgebra $\mathcal{R}$, with $\mathcal{R} = \mathbb{C}[\partial_z]\mathfrak{F}$, $\partial = \partial_z$ and $[a(w)_{\lambda}b(w)] = F^{\lambda}_{z, w}([a(z), b(w)])$.
It turns out that the process can be reverted: to any Lie conformal superalgebra, we can associate a regular formal distribution Lie superalgebra.
According to the definition of a formal distribution Lie superalgebra, we first have to define a Lie superalgebra, denoted by $\Lie(\mathcal{R})$, and then associate to it a conformal family $\mathcal{R}$ of $\Lie(\mathcal{R})$-valued formal distributions, whose coefficients span $\Lie(\mathcal{R})$, so that $(\Lie(\mathcal{R}), \mathcal{R})$ is then the expected formal distribution Lie superalgebra.
We proceed in two steps.

We first consider the space $\widetilde{\mathcal{R}} = \mathcal{R}[t, t^{-1}] = \mathcal{R} \otimes \mathbb{C}[t, t^{-1}]$ with $\widetilde{\partial} = \partial\otimes\Id_{\mathbb{C}[t, t^{-1}]} + \Id_{\mathcal{R}}\otimes\partial_t$.
This space is called the \emph{affinization of $\mathcal{R}$}.
Its generating elements can be written $a\otimes t^m$, where $a \in \mathcal{R}$ and $m \in \mathbb{Z}$.
For clarity, we will use the notation $at^m$ for its elements, and we write $\widetilde{\partial} = \partial + \partial_t$.
We define the commutation relation on $\widetilde{\mathcal{R}}$ as
\begin{equation*}
  [at^m, bt^n] = \sum_{j \in \mathbb{N}}\binom{m}{j}(a_{(j)}b)t^{m + n - j} \quad \text{for $a, b \in \mathcal{R}$ and $m, n \in \mathbb{Z}$},
\end{equation*}
which gives $\widetilde{\mathcal{R}}$ the structure of algebra, denoted by $(\widetilde{\mathcal{R}},[\bullet, \bullet])$.

Now the second step.
We have to check that the commutator verifies the antisymmetry and Jacobi identities, considering that the terms $a_{(j)}b$ of the definition of $[\bullet, \bullet]$ satisfy the axioms of a Lie conformal superalgebra.
The latter ones are not sufficient.
Another constraint has to be imposed on elements of $\widetilde{\mathcal{R}}$, namely $\widetilde{\partial}(at^m) = 0$.
The algebraic formulation of the latter condition is as follows: the space $\widetilde{\mathcal{R}}$ has to be quotiented by the subspace $I$ spanned by the elements of the form $\{(\partial a)t^n + nat^{n - 1} \mid n \in \mathbb{Z}\}$.
Using $\widetilde{\partial}$, we can write $I = \widetilde{\partial}\widetilde{\mathcal{R}}$.
This process has two goals: first transferring on $\widetilde{\mathcal{R}}/\widetilde{\partial}\widetilde{\mathcal{R}}$ the structure of algebra of $(\widetilde{\mathcal{R}}, [\bullet, \bullet])$, and then endowing $(\widetilde{\mathcal{R}}/\widetilde{\partial}\widetilde{\mathcal{R}}, [\bullet, \bullet])$ with the structure of Lie superalgebra.
The first goal is not direct because $\widetilde{\partial}\widetilde{\mathcal{R}}$ has to be a two-sided ideal of the algebra $(\widetilde{\mathcal{R}}, [\bullet, \bullet])$, which is the case.

\begin{lemma}[{\cite[Proposition 2.6.1]{nozaradan_introduction_2008}}]
  \label{lmm:1}
  $\widetilde{\partial}\widetilde{\mathcal{R}}$ is a two-sided ideal of the algebra $(\widetilde{\mathcal{R}}, [\bullet, \bullet])$.
\end{lemma}

We define the homomorphism $\phi: \widetilde{\mathcal{R}} \to \widetilde{\mathcal{R}}/\widetilde{\partial}\widetilde{\mathcal{R}}$ as the natural quotient map.
The commutator between two elements of $\widetilde{\partial}\widetilde{\mathcal{R}}$ is defined by
\begin{equation*}
  [\phi(at^m), \phi(bt^n)] = \sum_{j \in \mathbb{N}}\binom{m}{j}\phi((a_{(j)}b)t^{m + n - j}) \quad \text{for $a, b \in \mathcal{R}$ and $m, n \in \mathbb{Z}$}.
\end{equation*}

\begin{proposition}[{\cite[Proposition 2.6.3]{nozaradan_introduction_2008}}]
  \label{prp:5}
  $(\widetilde{\mathcal{R}}/\widetilde{\partial}\widetilde{\mathcal{R}}, [\bullet, \bullet])$ is a Lie superalgebra.
\end{proposition}

We set
\begin{equation*}
  \Lie(\mathcal{R}) = \widetilde{\mathcal{R}}/\widetilde{\partial}\widetilde{\mathcal{R}}.
\end{equation*}
Abusing notation, we define the family $\mathcal{R}$ of $\Lie(\mathcal{R})$-valued formal distributions, whose coefficients span $\Lie(\mathcal{R})$, by
\begin{equation*}
  \mathcal{R} = \left\{\sum_{n \in \mathbb{Z}}\phi(at^n)z^{-n - 1} \mid a \in \mathcal{R}\right\}.
\end{equation*}

\begin{theorem}[{\cite[Proposition 2.6.4]{nozaradan_introduction_2008}}]
  \label{thr:9}
  Let $\mathcal{R}$ be a Lie conformal superalgebra.
  Then $(\Lie(\mathcal{R}), \mathcal{R}, -\partial_t)$ is a regular formal distribution Lie superalgebra.
\end{theorem}

\begin{remark}
  \label{rmk:7}
  We have not defined the category of regular formal distribution Lie superalgebras nor the category of Lie conformal superalgebras.
  But it is clear how they should be, and they are equivalent categories
  \begin{align*}
    \{\text{regular formal distribution Lie superalgebra}\} &\leftrightarrow \{\text{Lie conformal superalgebra}\}, \\
    (\mathfrak{g}, \mathfrak{F}, T) &\mapsto (\mathbb{C}[\partial_z]\mathfrak{F}, F^{\lambda}_{z, w}([\bullet, \bullet])), \\
    (\Lie(\mathcal{R}), \mathcal{R}, -\partial_t) &\mapsfrom \mathcal{R}.
  \end{align*}
\end{remark}

\begin{theorem}
  \label{thr:10}
  Let $\mathcal{R}$ be a Lie conformal superalgebra, let $a, b \in \mathcal{R}$, and let $j, m \in \mathbb{N}$.
  Then
  \begin{equation*}
    (a_{(j)}b)_{(m)} = \sum_{k = 0}^j\binom{j}{k}(-1)^k[a_{(j - k)},b_{(m + k)}].
  \end{equation*}
\end{theorem}

\begin{proof}
  This is just \eqref{eq:3} in the language of Lie conformal superalgebras.
\end{proof}

We now show three examples of regular formal distribution Lie superalgebras and their respective Lie conformal superalgebras.

\begin{example}[\emph{Virasoro Lie conformal algebra}]
  \label{exa:1}
  The \emph{Virasoro Lie algebra}, denoted by $\Vir$, is the Lie algebra given by
  \begin{equation*}
    \Vir = \bigoplus_{n \in \mathbb{Z}}\mathbb{C}L_n \oplus \mathbb{C}C.
  \end{equation*}
  These elements satisfy the following commutation relations:
  \begin{equation}
    \label{eq:6}
    \begin{split}
      [L_m, L_n] &= (m - n)L_{m + n} + \delta_{m, -n}\frac{m^3 - m}{12}C \quad \text{for $m, n \in \mathbb{Z}$}, \\
      [\Vir, C] &= 0.
    \end{split}
  \end{equation}
  We construct a $\Vir$-valued formal distribution by setting
  \begin{equation*}
    \text{$L(z) = \sum_{n \in \mathbb{Z}}L_{(n)}z^{-n - 1}$ with $L_{(n)} = L_{n - 1}$ for $n \in \mathbb{Z}$}.
  \end{equation*}
  We usually write $L(z)$ as
  \begin{equation*}
    L(z) = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2}.
  \end{equation*}
  In terms of formal distributions, the commutation relations become:
  \begin{equation}
    \label{eq:7}
    \begin{split}
      [L(z), L(w)] &= \delta(z, w)\partial_wL(w) + \partial_w\delta(z, w)2L(w) + \partial^3_w\delta(z, w)\frac{C}{12}, \\
      [L(z), C] &= 0,
    \end{split}
  \end{equation}
  where $C$ denotes the constant formal distribution equal to $C \in \Vir$.
  In terms of the $j$-products, the commutation relations become:
  \begin{equation}
    \label{eq:8}
    \begin{split}
      L(z)_{(0)}L(z) &= \partial_zL(z), \\
      L(z)_{(1)}L(z) &= 2L(z), \\
      L(z)_{(3)}L(z) &= \frac{C}{2}, \\
      L(z)_{(j)}L(z) &= 0 \quad \text{for $j \neq 0, 1, 3$}, \\
      L(z)_{(j)}C &= 0 \quad \text{for $j \in \mathbb{N}$}.
    \end{split}
  \end{equation}
  In terms of the $\lambda$-bracket, the commutation relations become:
  \begin{equation}
    \label{eq:9}
    \begin{split}
      [L(z)_{\lambda}L(z)] &= (\partial + 2\lambda)L(z) + \frac{\lambda^3}{12}C, \\
      [L(z)_{\lambda}C] &= 0.
    \end{split}
  \end{equation}
  By \Cref{thr:6}, $\{L(z), C\}$ is a local family.
  Therefore, $(\Vir, \{L(z), C\})$ is a formal distribution Lie algebra.
  Moreover, we can verify directly that $(\Vir, \{L(z), C\}, \ad(L_{-1}))$ is regular.
  We obtain a Lie conformal algebra $\mathcal{R} = \mathbb{C}[\partial]L + \mathbb{C}C$, with $L = L(z)$, $\partial C = 0$ and $\partial = \partial_z$.
  This is actually a direct sum, and we get the Virasoro Lie conformal algebra
  \begin{equation*}
    \Vir = \mathbb{C}[\partial]L \oplus \mathbb{C}C.
  \end{equation*}
\end{example}

\begin{remark}
  \label{rmk:8}
  The notation $L(z) = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2}$ is contradictory with the notation we wrote in \cref{sec:formal-calculus}.
  However, this notation will acquire a meaning when we treat the notion of weight of an eigendistribution.
  In fact, this notation usually simplifies calculations, as we will see later.
\end{remark}

Let $\mathfrak{g}$ be a Lie superalgebra, and let $C \in \mathfrak{g}$.
A \emph{Virasoro formal distribution of central charge $C$} is a $\mathfrak{g}$-valued formal distribution $L(z) \in \mathfrak{g}[[z^{\pm 1}]]$ satisfying \eqref{eq:6} or, equivalently, \eqref{eq:7}, \eqref{eq:8} or \eqref{eq:9}.

\begin{example}[\emph{Current Lie conformal superalgebra}]
  \label{exa:2}
  Let $\mathfrak{g} = \mathfrak{g}_{\zero} \oplus \mathfrak{g}_{\one}$ be a Lie superalgebra.
  A \emph{supersymmetric} bilinear form is a bilinear map $(\bullet| \bullet): \mathfrak{g} \times \mathfrak{g} \to \mathbb{C}$ such that
  \begin{equation*}
    (a| b) = (-1)^{p(a)}(b| a) \quad \text{for $a, b \in \mathfrak{g}$, $a$ homogeneous}.
  \end{equation*}
  Alternatively, we can define a supersymmetric bilinear form as a bilinear form that vanishes on $\mathfrak{g}_{\zero} \oplus \mathfrak{g}_{\one}$ and $\mathfrak{g}_{\one} \oplus \mathfrak{g}_{\zero}$, symmetric on $\mathfrak{g}_{\zero} \oplus \mathfrak{g}_{\zero}$ and antisymmetric on $\mathfrak{g}_{\one} \oplus \mathfrak{g}_{\one}$.
  A bilinear form $(\bullet| \bullet): \mathfrak{g} \times \mathfrak{g} \to \mathbb{C}$ is said \emph{invariant} if
  \begin{equation*}
    ([a, b]| c) = (a| [b, c]) \quad \text{for $a, b, c \in \mathfrak{g}$}.
  \end{equation*}

  Let $\mathfrak{g}$ be a Lie superalgebra endowed with a supersymmetric invariant bilinear form $(\bullet| \bullet)$.
  The associated \emph{loop algebra of $\mathfrak{g}$} is the superalgebra $\tilde{\mathfrak{g}} = \mathfrak{g} \otimes \mathbb{C}[t, t^{-1}] = \mathfrak{g}[t, t^{-1}]$, endowed with the superbracket defined by
  \begin{equation*}
    [a\otimes f(t), b\otimes g(t)] = [a, b]\otimes f(t)g(t) \quad \text{for $a, b \in \mathfrak{g}$ and $f(t), g(t) \in \mathbb{C}[t, t^{-1}]$},
  \end{equation*}
  and with parity given by $p(a\otimes f(t)) = p(a)$.
  This makes $\tilde{\mathfrak{g}}$ into a Lie superalgebra.
  Replacing $a\otimes t^n$ by $at^n$ for brevity, the commutation relations become
  \begin{equation*}
    [at^m, bt^n] = [a, b]t^{m + n} \quad \text{for $a, b \in \mathfrak{g}$ and $m, n \in \mathbb{Z}$}.
  \end{equation*}
  The central extension of the loop algebra is the algebra $\hat{\mathfrak{g}} = \tilde{\mathfrak{g}} \oplus \mathbb{C}K$ with the superbracket defined by:
  \begin{equation*}
    \begin{split}
      [at^m, bt^n] &= [a, b]t^{m + n} + m\delta_{m, -n}(a| b)K \quad \text{for $a, b \in \mathfrak{g}$ and $m, n \in \mathbb{Z}$}, \\
      [\hat{\mathfrak{g}}, K] &= 0,
    \end{split}
  \end{equation*}
  and with parity given by $p(K) = \zero$.
  This makes $\hat{\mathfrak{g}}$ into a Lie superalgebra called the \emph{affinization of $\mathfrak{g}$}.
  If $\mathfrak{g}$ is a finite-dimensional simple Lie superalgebra, then the affinization of $\mathfrak{g}$ leads to a \emph{Kac-Moody affinization}.
  We now construct $\hat{\mathfrak{g}}$-valued formal distributions by setting
  \begin{equation*}
    a(z) = \sum_{n \in \mathbb{Z}}at^nz^{-n - 1} \quad \text{for $a \in \mathfrak{g}$}.
  \end{equation*}
  These formal distributions are called \emph{currents}.
  In terms of currents, the commutation relations become:
  \begin{equation*}
    \begin{split}
      [a(z), b(w)] &= \delta(z, w)[a, b](w) + \partial_w\delta(z, w)K(a| b), \\
      [a(z), K] &= 0.
    \end{split}
  \end{equation*}
  In terms of the $\lambda$-bracket, the commutation relations become:
  \begin{equation*}
    \begin{split}
      [a(z)_{\lambda}b(z)] &= [a(z), b(z)] + (a| b)K\lambda, \\
      [a(z)_{\lambda}K] &= 0.
    \end{split}
  \end{equation*}
  By \Cref{thr:6}, $\{a(z) \mid a \in \mathfrak{g}\} \cup \{K\}$ is a local family.
  Therefore, $(\hat{\mathfrak{g}}, \{a(z) \mid a \in \mathfrak{g}\} \cup \{K\})$ is a formal distribution Lie superalgebra.
  Moreover, we can verify directly that $(\hat{\mathfrak{g}}, \{a(z) \mid a \in \mathfrak{g}\} \cup \{K\}, -\partial_t)$ is regular.
  Similarly to the Virasoro Lie conformal algebra, we obtain the current Lie conformal superalgebra
  \begin{equation*}
    \Cur(\mathfrak{g}) = \mathbb{C}[\partial]\mathfrak{g} \oplus \mathbb{C}K.
  \end{equation*}

  Let $\mathfrak{g}$ be an abelian Lie superalgebra.
  In that case, $\Cur(\mathfrak{g})$ is known as the \emph{conformal algebra of free bosons} associated with the free bosons algebra $\hat{\mathfrak{g}}$, the latter being endowed with the relations $[at^m, bt^n] = m(a| b)\delta_{m, -n}K$.
\end{example}

\begin{example}[\emph{Fermionic Lie conformal superalgebra}]
  \label{exa:3}
  Let $V = V_{\zero} \oplus V_{\one}$ be a superspace.
  A bilinear form $\langle\bullet, \bullet\rangle: V \times V \to \mathbb{C}$ is \emph{antisupersymmetric} if it satisfies the relation
  \begin{equation*}
    \langle a, b\rangle = -(-1)^{p(a)}\langle b, a\rangle \quad \text{for $a, b \in V$, $a$ homogeneous}.
  \end{equation*}
  Alternatively, we can define an antisymmetric bilinear form as a bilinear form that vanishes on $V_{\zero} \oplus V_{\one}$ and $V_{\one} \oplus V_{\zero}$, is antisymmetric on the even part $V_{\zero} \oplus V_{\zero}$ and symmetric on the odd part $V_{\one} \oplus V_{\one}$.

  The \emph{Clifford affinization of $V$} is defined by
  \begin{equation*}
    \widehat{V} = V[t, t^{-1}] \oplus \mathbb{C}K
  \end{equation*}
  with the superbracket defined by:
  \begin{equation*}
    \begin{split}
      [at^m, bt^n] &= \delta_{m, -n - 1}\langle a, b\rangle K \quad \text{for $a, b \in V$ and $m, n \in \mathbb{Z}$}, \\
      [at^m, K] &= 0,
    \end{split}
  \end{equation*}
  and with parity given by $p(at^n) = p(a)$ and $p(K) = \zero$.
  This makes $\widehat{V}$ into a Lie superalgebra.
  We now construct $\widehat{V}$-valued formal distributions by setting
  \begin{equation*}
    a(z) = \sum_{n \in \mathbb{Z}}at^nz^{-n - 1} \quad \text{for $a \in V$}.
  \end{equation*}
  In terms of formal distributions, the commutation relations become:
  \begin{equation*}
    \begin{split}
      [a(z), b(w)] &= \delta(z, w)\langle a, b\rangle K, \\
      [a(z), K] &= 0.
    \end{split}
  \end{equation*}
  In terms of the $\lambda$-bracket, the commutation relations become:
  \begin{equation*}
    \begin{split}
      [a(z)_{\lambda}b(z)] &= \langle a, b\rangle K, \\
      [a(z)_{\lambda}K] &= 0.
    \end{split}
  \end{equation*}
  As before, we obtain a regular formal distribution Lie superalgebra $(\widehat{V}, \{a(z) \mid a \in V\} \cup \{K\}, -\partial_t)$, from which we obtain the fermionic Lie conformal superalgebra
  \begin{equation*}
    F(V) = \mathbb{C}[\partial]V \oplus \mathbb{C}K.
  \end{equation*}
\end{example}

\subsection{Fields over vector spaces}
\label{sec:fields-over-vector}

In this section, we fix a vector superspace $V = V_{\zero} \oplus V_{\one}$, and all formal distributions are $\End(V)$-valued, unless otherwise stated.
Let $a(z)$ be a formal distribution.
We set
\begin{align*}
  a(z)_+ &= \sum_{n \le -1}a_{(n)}z^{-n - 1}, \\
  a(z)_- &= \sum_{n \ge 0}a_{(n)}z^{-n - 1}.
\end{align*}

Let $a(z)$ and $b(z)$ be two formal distributions.
We define the \emph{normal product between $a(z)$ and $b(z)$} as the following formal distribution in two variables
\begin{equation*}
  :a(z)b(w): = a(z)_+b(w) + p(a(z), b(z))b(w)a(z)_-.
\end{equation*}

\begin{theorem}[{\cite[Proposition 3.2.3]{nozaradan_introduction_2008}}]
  \label{thr:11}
  Let $(a(z), b(z))$ be a pair of local formal distributions.
  The following identities are known as the operator product expansion of $a(z)$ and $b(w)$:
  \begin{align*}
    a(z)b(w) &= \sum_{j \in \mathbb{N}}a(w)_{(j)}b(w)i_{z, w}\left(\frac{1}{(z - w)^{j + 1}}\right) + :a(z)b(w):, \\
    p(a, b)b(w)a(z) &= \sum_{j \in \mathbb{N}}a(w)_{(j)}b(w)i_{w, z}\left(\frac{1}{(z - w)^{j + 1}}\right) + :a(z)b(w):.
  \end{align*}
\end{theorem}

A formal distribution $a(z)$ is a \emph{field} if
\begin{equation*}
  a(z)b = \sum_{n \in \mathbb{Z}}a_{(n)}bz^{-n - 1} \in V((z)) \quad \text{for $b \in V$}.
\end{equation*}
The vector space of fields over $V$ is denoted by $\mathcal{F}(V)$.
We note that
\begin{equation*}
  \mathcal{F}(V) = \Hom(V, V((z))).
\end{equation*}
Therefore, we can define a field $a(z)$ by defining $a(z)b \in V((z))$ for $b \in V$.

\begin{proposition}[{\cite[Proposition 3.3.2]{nozaradan_introduction_2008}}]
  \label{prp:6}
  Let $a(z), b(z) \in \mathcal{F}(V)$ be two fields.
  Then $:a(z)b(z): \in \End(V)[[z,z^{-1}]]$ is again a field, where $:a(z)b(z):$ is defined by
  \begin{equation*}
    :a(z)b(z):c = a(z)_+b(z)c + p(a, b)b(z)a(z)_-c \quad \text{for $c \in V$}.
  \end{equation*}
\end{proposition}

We thus defined the notion of \emph{normal ordered product between fields $a(z), b(z) \in \mathcal{F}(V)$}, denoted by $:a(z)b(z):$.
In general, the operation of normal ordered product is neither commutative nor associative.
We follow the convention that the normal ordered product is read from right to left, so that, by definition,
\begin{equation*}
  :a(z)b(z)c(z): = :a(z)(:b(z)c(z):):.
\end{equation*}

\begin{lemma}[{\cite[Proposition 3.3.3]{nozaradan_introduction_2008}}]
  \label{lmm:2}
  Let $a(z)$ and $b(z)$ be two fields.
  Their normal ordered product is written explicitly as
  \begin{equation*}
    :a(z)b(z): = \sum_{j \in \mathbb{Z}}:ab:_{(j)}z^{-j - 1},
  \end{equation*}
  with
  \begin{equation*}
    :ab:_{(j)}c = \sum_{n \le -1}a_{(n)}b_{(j - n - 1)}c + p(a(z), b(z))\sum_{n \ge 0}b_{(j - n - 1)}a_{(n)}c \quad \text{for $c \in V$}.
  \end{equation*}
\end{lemma}

\begin{lemma}
  \label{lmm:3}
  Let $V$ be a purely even vector space.
  We consider $s$ fields $a^1(z), \dots, a^s(z) \in \mathcal{F}(V)$, with $s \ge 2$, and let $b \in V$.
  For $l \in \mathbb{Z}$,
  \begin{equation*}
    :a^1(z)a^2(z)\dots a^s(z):_{(l)}b = \sum_{n_1, \dots, n_{s - 1} \in \mathbb{N}}\sum_{k = 0}^{s - 1}R^{l, k}_{n_1, \dots, n_{s - 1}}(a^1(z), \dots, a^s(z))b,
  \end{equation*}
  where
  \begin{align*}
    &R^{l, k}_{n_1, \dots, n_{s - 1}}(a^1(z), \dots, a^s(z)) = \\
    &\sum_{\substack{1 \le i_1 < \dots < i_k \le s - 1 \\ 1 \le j_1 < \dots < j_{s - 1 - k} \le s - 1 \\ \{i_1, \dots, i_k\} \cup \{j_1, \dots, j_{s - 1 - k}\} = \{1, \dots, s - 1\}}}a^{j_1}_{(-n_{j_1} - 1)}\dots a^{j_{s - 1 - k}}_{(-n_{j_{s - 1 - k}} - 1)}a^s_{(l - k - \sum_{r = 1}^k n_{i_r} + \sum_{r = 1}^{s - 1 - k}n_{j_r})}a^{i_k}_{(n_{i_k})}\dots a^{i_1}_{(n_{i_1})}.
  \end{align*}
\end{lemma}

\begin{proof}
  This follows from \Cref{lmm:2} and induction on $s$.
\end{proof}

We now extend the $j$-products.
For $j \in \mathbb{N}$, we set
\begin{equation}
  \label{eq:10}
  a(w)_{(-1 - j)}b(w) = \frac{:(\partial^j_wa(w))b(w):}{j!}.
\end{equation}

\begin{theorem}[{\cite[Proposition 3.4.3]{nozaradan_introduction_2008}}]
  \label{thr:12}
  The $j$-products \eqref{eq:2} and \eqref{eq:10} are special cases of the following generalized $j$-product defined by
  \begin{equation*}
    a(w)_{(j)}b(w)c = \res_z(i_{z, w}((z - w)^j)a(z)b(w)c - p(a(z), b(z))i_{w, z}((z - w)^j)b(w)a(z)c) \quad \text{for $c \in V$}.
  \end{equation*}
\end{theorem}

The usual properties of $j$-products for $j \in \mathbb{N}$ carry over to the generalized $j$-products.

\begin{proposition}[{\cite[Proposition 3.4.4]{nozaradan_introduction_2008}}]
  \label{prp:7}
  Let $a(z)$ and $b(z)$ be fields.
  For $j \in \mathbb{Z}$:
  \begin{enumerate}
  \item $(\partial_za(z))_{(j)}b(z) = -ja(z)_{(j - 1)}b(z)$;
  \item $\partial_z(a(z)_{(j)}b(z)) = (\partial_za(z))_{(j)}b(z) + a(z)_{(j)}\partial_zb(z)$.
  \end{enumerate}
\end{proposition}

\begin{lemma}[Dong's lemma {\cite[Lemma 3.2]{kac_vertex_1998}}]
  \label{lmm:4}
  If $a(z)$, $b(z)$ and $c(z)$ are pairwise mutually local fields, then $(a(z), b(z)_{(n)}c(z))$ is a local pair of fields as well for $n \in \mathbb{Z}$.
\end{lemma}

Let $L(z)$ be a formal distribution.
An \emph{eigendistribution of weight $\Delta_{a(z)}$ with respect to $L(z)$} is a formal distribution $a(z)$ satisfying
\begin{equation}
  \label{eq:11}
  [L(z)_{\lambda}a(z)] = (\partial + \Delta_{a(z)}\lambda)a(z) + O(\lambda^2),
\end{equation}
where $O(\lambda^2)$ denotes sums of terms of monomials $t\lambda^j$ with $j \ge 2$ and $t \in \mathbb{C}$.
If $L(z)$ is a Virasoro formal distribution, $\Delta_{a(z)}$ is called the \emph{conformal weight}.
Clearly, $a(z)$ is an eigendistribution in the sense that it is an eigenvector of the endomorphism $L_{(1)}$ whose action is defined by $L_{(1)}(b(z)) = L(z)_{(1)}b(z)$.
Indeed, \eqref{eq:11} implies $L(z)_{(1)}a(z) = \Delta_{a(z)}a(z)$.
We note that, by definition, a Virasoro formal distribution $L(z)$ is an eigendistribution of conformal weight $2$ with respect to itself.

\begin{theorem}[{\cite[Proposition 3.7.4]{nozaradan_introduction_2008}}]
  \label{thr:13}
  If $a(z)$ and $b(z)$ have weights $\Delta_{a(z)}$ and $\Delta_{b(z)}$ with an even formal distribution $L(z)$, then $\Delta_{a(z)_{(n)}b(z)} = \Delta_{a(z)} + \Delta_{b(z)} - n - 1$ with respect to $L(z)$.
  In particular, $\Delta_{:a(z)b(z):} = \Delta_{a(z)} + \Delta_{b(z)}$ and $\Delta_{\partial a(z)} = \Delta_{a(z)} + 1$.
\end{theorem}

The expansion of an eigendistribution $a(z)$ of weight $\Delta_{a(z)}$ is often adapted as follows
\begin{equation*}
  a(z) = \sum_{n \in \mathbb{Z} - \Delta_{a(z)}}a_nz^{-n - \Delta_{a(z)}}.
\end{equation*}
This justifies the way we wrote the Virasoro formal distribution when we defined the Virasoro Lie conformal algebra.
By comparison with the usual way of writing $a(z) = \sum_{m \in \mathbb{Z}}a_{(m)}z^{-m - 1}$, we must have
\begin{equation*}
  a_{(m)} = a_{m - \Delta_{a(z)} + 1} \quad \text{for $m \in \mathbb{Z}$}
\end{equation*}
or the other way
\begin{equation*}
  a_n = a_{(n + \Delta_{a(z)} - 1)} \quad \text{for $n \in \mathbb{Z} - \Delta_{a(z)}$}.
\end{equation*}
One of the interesting features of this change of notation is that it reveals the grading of the superbracket.

\begin{proposition}[{\cite[Proposition 3.7.6]{nozaradan_introduction_2008}}]
  \label{prp:8}
  In the new notation, we can write
  \begin{equation*}
    [a_m, b_n] = \sum_{j \in \mathbb{N}}\binom{m + \Delta_{a(z)} - 1}{j}(a_{(j)}b)_{m + n}.
  \end{equation*}
\end{proposition}

An eigendistribution $a(z)$ is called \emph{primary} of conformal weight $\Delta_{a(z)}$ if
\begin{equation*}
  [L(z)_{\lambda}a(z)] = (\partial_z + \Delta_{a(z)}\lambda)a(z),
\end{equation*}
where $L(z)$ is a Virasoro formal distribution.

Let us fix an operator $T \in \End(V)_{\zero}$.
A formal distribution $a(z)$ is called \emph{covariant} with respect to $T$ if
\begin{equation*}
  [T, a(z)] = \partial_za(z).
\end{equation*}

\begin{theorem}[{\cite[Lemma 1]{callegaro_introduction_2017}}]
  \label{thr:14}
  Assume that $\vac \in V_{\zero}$ is such that $T\vac = 0$.
  Then:
  \begin{enumerate}
  \item For any translation covariant field $a(z)$, we have $a(z)\vac \in V[[z]]$.
  \item Let $a(z)$ be a translation covariant field, and we set $a = a_{(-1)}\vac$.
    Then
    \begin{equation*}
      a(z)\vac = e^{Tz}a = \sum_{n = 0}^{\infty}\frac{T^na}{n!}z^n.
    \end{equation*}
  \end{enumerate}
\end{theorem}

Let
\begin{equation*}
  \mathcal{F}_{\tc} = \{a(z) \in \mathcal{F}(V) \mid [T, a(z)] = \partial_za(z)\}
\end{equation*}
be the subspace of translation covariant fields.

\begin{lemma}[{\cite[Lemma 3]{callegaro_introduction_2017}}]
  \label{lmm:5}
  $\mathcal{F}_{\tc}$ contains $\Id_V$, it is $\partial_z$-invariant and is closed under all $n$-products, i.e., $\partial_za(z), a(z)_{(n)}b(z) \in \mathcal{F}_{\tc}$ for $a(z), b(z) \in \mathcal{F}_{\tc}$ and $n \in \mathbb{Z}$.
\end{lemma}

By \Cref{thr:14}(i), we can define a linear map
\begin{align*}
  \fs: \mathcal{F}_{\tc} &\to V, \\
  \fs(a(z)) &= a(z)\vac|_{z = 0}
\end{align*}
called the \emph{field-state correspondence}.

\begin{lemma}[{\cite[Proposition 4.3.2]{nozaradan_introduction_2008}}]
  \label{lmm:6}
  Let $A$ be a linear operator on a linear space $V$.
  The formal differential equation
  \begin{equation*}
    \frac{df(z)}{dz} = Af(z) \quad \text{for $f(z) \in V[[z]]$}
  \end{equation*}
  admits a unique solution, given an initial condition $f(0) = f_0$.
\end{lemma}

\begin{theorem}
  \label{thr:15}
  Let $a(z), b(z) \in \mathcal{F}_{\tc}$, $a = \fs(a(z))$, $b = \fs(b(z))$, and let $n \in \mathbb{Z}$.
  We write $a(z) = \sum_{j \in \mathbb{Z}}a_{(j)}z^{-j - 1}$ and $b(z) = \sum_{j \in \mathbb{Z}}b_{(j)}z^{-j - 1}$.
  Then:
  \begin{enumerate}
  \item $\fs(\Id_V) = \vac$;
  \item $\fs(\partial_za(z)) = Ta$;
  \item \emph{($n$-product identity)} $\fs(a(z)_{(n)}b(z)) = a_{(n)}b$;
  \item $T(a_{(n)}b) = -na_{(n - 1)}b + a_{(n)}Tb$;
  \item $e^{Tw}a(z)e^{-Tw} = i_{z, w}a(z + w)$;
  \item \emph{(Borcherds identity)} If $a(z)$ and $b(z)$ are local, then for $c \in V$,
    \begin{equation*}
      i_{z, w}(z - w)^na(z)b(w)c - p(a, b)i_{w, z}(z - w)^nb(w)a(z)c = \sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}a(w)_{(n + j)}b(w)c;
    \end{equation*}
  \item \emph{(Skewsymmetry)} If $a(z)$ and $b(z)$ are local, then
    \begin{equation*}
      a(z)b = p(a, b)e^{Tz}b(-z)a.
    \end{equation*}
  \end{enumerate}
\end{theorem}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item Clear.
  \item
    \begin{align*}
      \fs(\partial_za(z)) &= [T, a(z)]\vac|_{z = 0} \\
                          &= (Ta(z) - p(a(z), T)a(z)T)\vac|_{z = 0} \\
                          &= Ta.
    \end{align*}
  \item By definition, we have
    \begin{equation*}
      \fs(a(z)_{(n)}b(z)) = a(z)_{(n)}b(z)\vac|_{z = 0},
    \end{equation*}
    and the right-hand side, by \Cref{thr:12}, is equal to
    \begin{equation*}
      \res_w(a(w)b(z)i_{w, z}((w - z)^n)\vac - p(a, b)b(z)a(w)i_{z, w}((w - z)^n)\vac)|_{z = 0}.
    \end{equation*}
    Now, since $a(w)\vac \in V[[w]]$ and $i_{z, w}((w - z)^n)$ has only nonnegative powers of $w$, we have
    \begin{equation*}
      \res_w(b(z)a(w)i_{z, w}((w - z)^n)\vac) = 0.
    \end{equation*}
    For the first term, since $b(z)\vac \in V[[z]]$, we can let $z = 0$ before we calculate the residue, which gives
    \begin{equation*}
      \res_w(a(w)b(z)i_{w, z}((w - z)^n)\vac)|_{z = 0} = \res_w(a(w)bw^n) = a_{(n)}b.
    \end{equation*}
  \item This follows from $[T, a_{(n)}] = -na_{(n - 1)}$, which is equivalent to translation covariance of the field $a(z)$.
  \item We set $b_1(z, w) = i_{z, w}a(z + w)$ and $b_2(z, w) = e^{Tw}a(z)e^{-Tw}$.
    By \Cref{prp:1} and translation covariance:
    \begin{align*}
      \frac{\partial b_1(z, w)}{\partial w} &= \sum_{j \in \mathbb{N}}\frac{\partial^{j + 1}_za(z)}{j!}w^j = \sum_{j \in \mathbb{N}}\frac{\partial^j[T, a(z)]}{j!} = [T, b_1(z, w)], \\
      b_1(z, 0) &= a(z), \\
      \frac{\partial b_1(z, w)}{\partial w} &= Te^{Tw}a(z)e^{-Tw} + e^{Tw}a(z)(-T)e^{-Tw} = [T, b_2(z, w)], \\
      b_2(z, 0) &= a(z).
    \end{align*}
    By \Cref{lmm:6}, $b_1(z, w) = b_2(z, w)$.
  \item The left-hand side of the Borcherds identity is a local formal distribution in $z$ and $w$ applied to $c$.
    Apply \Cref{thr:6} to it to get that it is equal to
    \begin{equation*}
      \sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z,w)}{j!}c^j(w)c,
    \end{equation*}
    where
    \begin{align*}
      c^j(w)c &= (\res_z((z - w)^j(i_{z, w}((z - w)^n)a(z)b(w) - p(a, b)i_{w, z}((z - w)^n)b(w)a(z))))c \\
              &= \res_z((i_{z, w}((z - w)^{n + j})a(z)b(w)c - p(a, b)i_{w, z}((z - w)^{n + j})b(w)a(z)c)) \\
              &= a(w)_{(n + j)}b(w)c.
    \end{align*}
  \item By locality, there is $N \in \mathbb{Z}$ such that
    \begin{equation*}
      (z - w)^Na(z)b(w) = p(a, b)(z - w)^Nb(w)a(z).
    \end{equation*}
    Apply $\vac$ to both sides; by \Cref{thr:14}, we get
    \begin{equation*}
      (z - w)^Na(z)e^{Tw}b = p(a, b)(z - w)^Nb(w)e^{Tz}a.
    \end{equation*}
    We now use (v) and \Cref{prp:1},
    \begin{equation*}
      RHS = p(a, b)(z - w)^Ne^{Tz}e^{-Tz}b(w)e^{Tz}a = p(a, b)(z - w)^Ne^{Tz}i_{w, z}b(w - z)a.
    \end{equation*}
    For $N$ big enough, this is a formal power series in $(z - w)$, so we can set $w = 0$ and get
    \begin{equation*}
      LHS = z^Na(z)b = p(a, b)e^{Tz}z^Nb(-z)a = RHS,
    \end{equation*}
    which proves the desired formula. \qedhere
  \end{enumerate}
\end{proof}

\begin{lemma}
  \label{lmm:7}
  Let $\mathcal{F}' \subseteq \mathcal{F}_{\tc}$ and $a(z) \in \mathcal{F}_{\tc}$.
  We assume that:
  \begin{enumerate}
  \item $\fs(a(z)) = 0$;
  \item $a(z)$ is local with any element in $\mathcal{F}'$;
  \item $\fs(\mathcal{F}') = V$.
  \end{enumerate}
  Then $a(z) = 0$.
\end{lemma}

\begin{proof}
  Let $b(z) \in \mathcal{F}'$.
  By the locality of $a(z)$ and $b(z)$, we have $(z - w)^N[a(z), b(w)] = 0$, for some $N \in \mathbb{N}$.
  Apply $\vac$ to both sides to get
  \begin{equation*}
    (z - w)^Na(z)b(w)\vac = \pm(z - w)^Nb(w)a(z)\vac.
  \end{equation*}
  By the property (i), we have $a_{(-1)}\vac = 0$ and $a(z)$ is translation covariant, hence by \Cref{thr:14}(i), $b(w)\vac \in V[[w]]$, so we can let $w = 0$ and get $z^Na(z)b = 0$, which means $a_{(n)}b = 0$ for any $n \in \mathbb{Z}$.
  This is true for any $b \in V$ by the property (iii).
  So in fact, we have $a(z) = 0$.
\end{proof}

\subsection{Vertex superalgebras}
\label{sec:vertex-superalgebras}

A \emph{vertex superalgebra} is the data consisting of four elements $(V, \vac, T, Y)$ satisfying the following properties:
\begin{enumerate}
\item $V$ is a superspace called the \emph{state space};
\item $\vac \in V_{\zero}$ is called the \emph{vacuum vector};
\item $T \in \End(V)_{\zero}$ is called the \emph{translation operator};
\item $Y: V \to \mathcal{F}(V)$ is a linear and parity preserving map called the \emph{state-field correspondence}, which is commonly written as $Y(a, z) = \sum_{n \in \mathbb{Z}}a_{(n)}z^{-n - 1}$ for $a \in V$.
\end{enumerate}
By parity preserving map we mean that for $a \in V$ homogeneous, $p(a_{(n)}) = p(a)$ for $n \in \mathbb{Z}$.
The operator $Y(a) = Y(a, z) \in \End(V)[[z^{\pm 1}]]$ for $a \in V$ is sometimes called a \emph{vertex operator}.
The data must satisfy the following axioms for $a \in V$:
\begin{enumerate}
\item (Vacuum axiom)
  \begin{align*}
    Y(\vac,z) &= \Id_V, \\
    Y(a, z)\vac &\in V[[z]], \\
    Y(a, z)\vac|_{z = 0} &= a, \\
    T\vac &= 0;
  \end{align*}
\item (Translation covariance) $[T, Y(a, z)] = \partial_zY(a, z)$;
\item (Locality) $\{Y(b, z) \mid b \in V\}$ is a local family of fields.
\end{enumerate}

\begin{remark}
  \label{rmk:9}
  Writing $Y(a, z) = \sum_{n \in \mathbb{Z}}a_{(n)}z^{-n - 1}$ for $a \in V$, the first two vertex superalgebra axioms imply that for $a \in V$:
  \begin{align*}
    \vac_{(n)}a &= \delta_{n, -1}a \quad \text{for $n \in \mathbb{Z}$}, \\
    a_{(n)}\vac &= \delta_{n, -1}a \quad \text{for $n \in \mathbb{N} \cup \{-1\}$}, \\
    [T, a_{(n)}] &= -na_{(n - 1)} \quad \text{for $n \in \mathbb{Z}$}.
  \end{align*}
\end{remark}

A vertex superalgebra with odd subspace equal to $0$ is called a \emph{vertex algebra}.

\begin{remark}
  \label{rmk:10}
  The even part $V_{\zero}$ of a vertex superalgebra $V$ is a vertex algebra.
\end{remark}

\begin{remark}
  \label{rmk:11}
  The translation covariance axiom together with \Cref{thr:14}(ii) permit us to express $T$ by
  \begin{equation}
    \label{eq:12}
    Ta = a_{(-2)}\vac.
  \end{equation}
  As a consequence, the data of the translation operator $T$ is redundant.
  The original definition with $T$ appears to be more natural, though.
\end{remark}

A \emph{vertex superalgebra homomorphism} $f: (V_1, \vac_1, T_1, Y_1) \to (V_2, \vac_2, T_2, Y_2)$ is a linear and parity preserving map $f: V_1 \to V_2$ such that $f(\vac_1) = \vac_2$ and for $a, b \in V_1$,
\begin{equation*}
  f(Y_1(a, z)b) = \sum_{n \in \mathbb{Z}}f(a_{(n)}b)z^{-n - 1} = \sum_{n \in \mathbb{Z}}f(a)_{(n)}f(b)z^{-n - 1} = Y_2(f(a), z)f(b).
\end{equation*}
We obtain the category of vertex superalgebras.

Let $V_1$ and $V_2$ be two vertex algebras.
The tensor product $V_1 \otimes V_2$ is a vertex algebra with the vacuum vector $\vac_{V_1}\otimes\vac_{V_2}$, the translation operator $T_{V_1}\otimes\Id_{V_2} + \Id_{V_1}\otimes T_{V_2}$ and the state-field correspondence $Y(a\otimes b, z) = Y_{V_1}(a, z)\otimes Y_{V_2}(b, z)$ for $a \in V_1$ and $b \in V_2$.

\begin{example}[\emph{Commutative vertex algebras}]
  \label{exa:4}
  A vertex algebra $V$ is called \emph{commutative} if all vertex operators $Y(a, z)$, $a \in V$ commute with each other.

  Suppose we are given a commutative vertex algebra $V$.
  Then for $a, b \in V$,
  \begin{equation*}
    Y(a, z)b = Y(a, z)Y(b, w)\vac|_{w = 0} = Y(b, w)Y(a, z)\vac|_{w = 0}.
  \end{equation*}
  But by the vacuum axiom, the last expression has no negative power of $z$.
  Therefore, $Y(a, z)b \in V[[z]]$ for $a, b \in V$, so $Y(a, z) \in \End(V)[[z]]$ for $a \in V$.
  Conversely, suppose that we are given a vertex algebra $V$ in which $Y(a, z) \in \End(V)[[z]]$ for $a \in V$.
  Observe that if the equality $(z - w)^Nf_1(z, w) = (z - w)^Nf_2(z, w)$ holds for $f_1(z, w), f_2(z, w) \in V[[z, w]]$ and $N \in \mathbb{N}$, then necessarily $f_1(z, w) = f_2(z, w)$.
  Therefore, we obtain that $[Y(a, z), Y(b, w)] = 0$ for $a, b \in V$, so $V$ is commutative.

  Thus, a commutative vertex algebra may be defined as one in which all $Y(a, z)$ belong to $\End(V)[[z]]$.

  We denote by $Y_a$ the endomorphism of a commutative vertex algebra $V$ which is the constant term of $Y(a, z)$ for $a \in V$, and we define a bilinear operation $\circ$ on $V$ by setting $a\circ b = Y_ab$.
  By construction, $Y_aY_b = Y_bY_a$.
  This implies both commutativity and associativity of $\circ$.
  Furthermore, the vacuum vector $\vac$ is a unit, and the operator $T$ is a derivation with respect to this product.
  Thus, we have the structure of a differential commutative associative algebra with unit on $V$.

  Conversely, let $V$ be a differential commutative associative algebra with unit $1$ and derivation $T$.
  Then $V$ becomes a vertex algebra by setting $\vac = 1$ and
  \begin{equation*}
    Y(a, z) = e^{Tz}a \quad \text{for $a \in V$}.
  \end{equation*}
  It is straightforward to check that all the axioms of a commutative vertex algebra are satisfied.

  Therefore, we obtain an isomorphism between the category of differential commutative associative algebras with unit and the category of commutative vertex algebras.
\end{example}

The theory done in \Cref{sec:fields-over-vector} is translated into the language of vertex superalgebras, as the following theorem shows.

\begin{theorem}
  \label{thr:16}
  Let $V$ be a vertex superalgebra.
  For $a, b, c \in V$ and $m, n \in \mathbb{Z}$:
  \begin{enumerate}
  \item $Y: V \to \mathcal{F}(V)$ is injective;
  \item $Y(a, z)\vac \in V[[z]]$ and $Y(a, z)\vac = e^{Tz}a$, so $T^na = n!a_{(-n - 1)}\vac$;
  \item $Y(Ta, z) = \partial_zY(a, z)$ or, equivalently, $(Ta)_{(n)} = -na_{(n - 1)}$;
  \item \emph{($n$-product identity)} $Y(a, z)_{(n)}Y(b, z) = Y(a_{(n)}b, z)$;
  \item $[a_{(m)}, b_{(n)}] = \sum_{j \in \mathbb{N}}\binom{m}{j}(a_{(j)}b)_{(m + n - j)}$;
  \item $T(Y(a, z)b) = Y(Ta, z)b + Y(a, z)Tb$;
  \item $e^{Tw}Y(a, z)e^{-Tw} = i_{z, w}Y(a, z + w)$;
  \item \emph{(Borcherds identity)}
    \begin{equation*}
      i_{z, w}((z - w)^n)Y(a, z)Y(b, w)c - p(a, b)i_{w, z}((z - w)^n)Y(b, w)Y(a, z)c = \sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}Y(a_{(n + j)}b, w)c;
    \end{equation*}
  \item \emph{(Skewsymmetry)} $Y(a, z)b = p(a, b)e^{Tz}Y(b, -z)a$;
  \item $(a_{(m)}b)_{(n)}c = \sum_{j \in \mathbb{N}}(-1)^j\binom{m}{j}(a_{(m - j)}b_{(n + j)}c - (-1)^mp(a, b)b_{(m + n - j)}a_{(j)}c)$.
  \end{enumerate}
\end{theorem}

\begin{theorem}[Original Borcherds identity]
  \label{thr:17}
  Let $V$ be a vertex superalgebra.
  For $a, b, c \in V$ and $m, n, k \in \mathbb{Z}$,
  \begin{equation*}
    \sum_{j \in \mathbb{N}}(-1)^j\binom{n}{j}\left(a_{(m + n - j)}(b_{(k + j)}c) - (-1)^np(a, b)b_{(n + k - j)}(a_{(m + j)}c)\right) = \sum_{j \in \mathbb{N}}\binom{m}{j}(a_{(n + j)}b)_{(m + k - j)}c,
  \end{equation*}
  or, equivalently, for $a, b, c \in \mathbb{Z}$ and $F(z, w) = z^mw^n(z - w)^k$, where $m, n, k \in \mathbb{Z}$,
  \begin{equation*}
    \begin{split}
      &\res_{z - w}(i_{w, z - w}F(z, w)Y(Y(a, z - w)b, w)c) = \\
      &\res_z(i_{z, w}F(z, w)Y(a, z)Y(b, w)c) - \res_z(i_{w, z}F(z, w)Y(b, w)Y(a, z)c).
    \end{split}
  \end{equation*}
\end{theorem}

Let $V$ be a vertex superalgebra.
A \emph{vertex subalgebra of $V$} is a subspace of $W$ of $V$, which contains $\vac$, and such that $Y(a, z)b \in W((z))$ for $a, b \in W$.
Because $Ta = a_{(-2)}\vac$ and $\vac \in W$, this implies that $TW \subseteq W$.
Thus, $(W, \vac, T|_{W}: W \to W, Y|_{W}: W \to \mathcal{F}(W))$ is a vertex superalgebra in its own right.
Let $S \subseteq V$ be a subset.
The \emph{vertex subalgebra generated by $S$} is the smallest vertex subalgebra containing $S$, which is the intersection of all vertex subalgebras containing $S$.
It is denoted by $\langle S \rangle$, and we can prove that
\begin{equation*}
  \langle S \rangle = \vspan\{a^1_{(n_1)}\dots a^s_{(n_s)}\vac \mid s \in \mathbb{N}, a^1, \dots, a^s \in S, n_1, \dots, n_s \in \mathbb{Z}\}.
\end{equation*}
The vertex superalgebra $V$ is \emph{strongly generated by $S \subseteq V$} if
\begin{equation*}
  V = \vspan\{a^1_{(-n_1 - 1)}\dots a^s_{(-n_s - 1)}\vac \mid s, n_1, \dots, n_s \in \mathbb{N}, a^1, \dots, a^s \in S\}.
\end{equation*}

An \emph{ideal of a vertex superalgebra $V$} is a subspace $I$ of $V$ such that $Y(a, z)b \in I((z))$ and $Y(b, z)a \in I((z))$ for $a \in V$ and $b \in I$.
For example, the kernel of a vertex superalgebra homomorphism is an ideal.
A vertex superalgebra is \emph{simple} or \emph{irreducible} if $0$ is the only proper ideal.

\begin{remark}
  \label{rmk:12}
  We note that a right ideal $I$ is automatically $T$-invariant ($TI \subseteq I$) because of \eqref{eq:12}.
  Also, right ideals and $T$-invariant left ideals are automatically two-sided ideals because of skewsymmetry.
  However, to prove that a subspace is an ideal, it is usually easier to check that it is $T$-invariant and a left ideal.
\end{remark}

It follows that for any ideal $I$, $V/I$ inherits a natural \emph{quotient vertex superalgebra} structure $(V/I, \vac + I, T_{V/I}: V/I \to V/I, Y_{V/I}: V/I \to \mathcal{F}(V/I))$.
Let $S \subseteq V$ be a subset.
The \emph{ideal generated by $S$} is the smallest ideal containing $S$, which is the intersection of all ideals containing $S$.
It is denoted by $(S)$, and we can prove that
\begin{equation*}
  (S) = \vspan\{b_{(n)}T^ma \mid b \in V, n \in \mathbb{Z}, m \in \mathbb{N}, a \in S\}.
\end{equation*}

We do not have examples of vertex superalgebras other than the ones coming from differential algebras.
It turns out that it is not an easy task to construct nontrivial vertex superalgebras.
We need a preliminary concept to do that task.
A \emph{pre-vertex superalgebra} is a quadruple $(V, \vac, T, \mathcal{F})$, where $V = V_{\zero} \oplus V_{\one}$ is a vector superspace, $\vac \in V_{\zero}$, $T \in \End(V)_{\zero}$, and $\mathcal{F} = \{a^j(z) = \sum_{n \in \mathbb{Z}}a^j_{(n)}z^{-n - 1}\}_{j \in J}$ is a collection of $\End(V)$-valued fields such that for $j \in J$, all $a^j_{(n)}$ for $n \in \mathbb{Z}$ have the same parity.
The above data satisfies the following axioms:
\begin{enumerate}
\item (Vacuum axiom) $T\vac = 0$;
\item (Translation covariance) $[T, a^j(z)] = \partial_za^j(z)$ for $j \in J$;
\item (Locality) $a^i(z)$ and $a^j(z)$ are mutually local for $i, j \in J$;
\item (Completeness) $\vspan\{a^{j_1}_{(n_1)}\dots a^{j_s}_{(n_s)}\vac \mid s \in \mathbb{N}, j_i \in J, n_i \in \mathbb{Z}\} = V$.
\end{enumerate}

Let $(V, \vac, T, \mathcal{F})$ be a pre-vertex superalgebra.
Define the following subspaces of $\mathcal{F}(V)$:
\begin{align*}
  \mathcal{F}_{\min} &= \vspan\{a^{j_1}(z)_{(n_1)}(a^{j_2}(z)_{(n_2)}\dots(a^{j_s}(z)_{(n_s)}\Id_V)\dots) \mid s \in \mathbb{N}, n_i \in \mathbb{Z}, j_i \in J\}, \\
  \mathcal{F}_{\max} &= \{a(z) \in \mathcal{F}(V) \mid \text{$[T, a(z)] = \partial_za(z)$ and for $j \in J$, $(a(z), a^j(z))$ is a local pair}\}.
\end{align*}
We have inclusions
\begin{equation*}
  \mathcal{F} \subseteq \mathcal{F}_{\min} \subseteq \mathcal{F}_{\max} \subseteq \mathcal{F}_{\tc}.
\end{equation*}
The first inclusion is because for $a(z) \in \mathcal{F}$, $a(z)_{(-1)}\Id_V = a(z) \in \mathcal{F}_{\min}$.
The second inclusion is by \Cref{lmm:5} and Dong's Lemma.
The last inclusion is by definition.

Now we come to a very fundamental theorem, which allows us to construct noncommutative vertex superalgebras and is the backbone of several of our most important examples of vertex superalgebras.

\begin{theorem}[Extension theorem]
  \label{thr:18}
  Let $(V, \vac, T, \mathcal{F})$ be a pre-vertex superalgebra, and let $\mathcal{F}_{\min}, \mathcal{F}_{\max}$ be defined as above.
  Then:
  \begin{enumerate}
  \item $\mathcal{F}_{\min} = \mathcal{F}_{\max}$;
  \item The linear map
    \begin{align*}
      \fs: \mathcal{F}_{\max} &\to V, \\
      \fs(a(z)) &= a(z)\vac|_{z = 0}
    \end{align*}
    is well-defined and bijective, and we denote by $Y: V \to \mathcal{F}(V)$ the inverse map;
  \item $(V, \vac, T, Y)$ is a vertex superalgebra, with $Y: V \to \mathcal{F}(V)$ given explicitly by
    \begin{equation}
      \label{eq:13}
      Y(a^{j_1}_{(n_1)}a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac) = a^{j_1}(z)_{(n_1)}(a^{j_2}(z)_{(n_2)}\dots(a^{j_s}(z)_{(n_s)}\Id_V)\dots)
    \end{equation}
    for $s \in \mathbb{N}$, $j_1, \dots, j_s \in J$ and $n_1, \dots, n_s \in \mathbb{Z}$;
  \item The vertex superalgebra $V$ is generated by $\{a^j_{(-1)}\vac \mid j \in J\}$;
  \item The only vertex superalgebra structure on $V$ with $Y(a^j_{(-1)}\vac, z) = a^j(z)$ for $j \in J$ is the one given by \eqref{eq:13}.
  \end{enumerate}
\end{theorem}

\begin{proof}
  By \Cref{thr:14}, the map $\fs$ is well-defined as was noted already in \Cref{sec:fields-over-vector}.
  By \Cref{thr:15}(i) and \Cref{thr:15}(iii), $\fs|_{\mathcal{F}_{\min}}: \mathcal{F}_{\min} \to V$ is given by
  \begin{equation*}
    \fs|_{\mathcal{F}_{\min}}(a^{j_1}(z)_{(n_1)}(a^{j_2}(z)_{(n_2)}\dots(a^{j_s}(z)_{(n_s)}\Id_V)\dots)) = a^{j_1}_{(n_1)}a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac.
  \end{equation*}
  The completeness axiom of pre-vertex superalgebras implies that $\fs|_{\mathcal{F}_{\min}}$ is surjective.

  The map $\fs: \mathcal{F}_{\max} \to V$ is injective using \Cref{lmm:7} with $\mathcal{F}' = \mathcal{F}_{\min}$.
  Recall the inclusion $\mathcal{F}_{\min} \subseteq \mathcal{F}_{\max}$.
  We know that $\fs|_{\mathcal{F}_{\min}}$ is surjective and $\fs$ is injective, so we can conclude that is in fact bijective and $\mathcal{F}_{\min} = \mathcal{F}_{\max}$.
  This proves (i) and (ii).

  For (iii), we need to show that $Y(a, z)$ is translation covariant for $a \in V$, and that each pair $(Y(a, z), Y(b, w))$ is local for $a, b \in V$.
  Translation covariance comes from \Cref{lmm:5}, and locality comes from Dong's lemma.

  We note that we have $Y(a^j_{(-1)}\vac, z) = a^j(z)$ for $j \in J$.
  Therefore, $(a^j_{(-1)}\vac)_{(n)} = a^j_{(n)}$ for $j \in J$ and $n \in \mathbb{Z}$.
  By the completeness axiom, we get (iv).

  Uniqueness of the vertex superalgebra structure follows from the completeness axiom of pre-vertex superalgebras, the $n$-product identity and the fact that $\vac \mapsto \Id_V$ in any vertex superalgebra homomorphism.
  This finishes (v) and the proof of the theorem.
\end{proof}

\begin{corollary}
  \label{crl:1}
  Let $V$ be a vertex superalgebra, let $s \in \mathbb{N}$, $a^1, \dots, a^s \in V$, and let $n_1, \dots, n_s \in \mathbb{Z}$.
  Then
  \begin{equation*}
    Y(a^1_{(n_1)}a^2_{(n_2)}\dots a^s_{(n_s)}\vac, z) = Y(a^j, z)_{(n_1)}(Y(a^2, z)_{(n_2)}\dots(Y(a^s, z)_{(n_s)}\Id_V)\dots).
  \end{equation*}
  In particular, for $s, n_1, \dots, n_s \in \mathbb{N}$ and $a^1, \dots, a^s \in V$,
  \begin{equation*}
    Y(a^1_{(-n_1 - 1)}\dots a^s_{(-n_s - 1)}\vac, z) = \frac{:\partial^{n_1}_zY(a^1, z)\dots\partial^{n_s}_zY(a^s, z):}{n_1!\dots n_s!}.
  \end{equation*}
  If $V$ is given by a pre-vertex superalgebra $(V, \vac, T, \mathcal{F})$ as in the Extension Theorem, where $\mathcal{F} = \{a^j(z)\}_{j \in J}$, then for $s, n_1, \dots, n_s \in \mathbb{N}$ and $j_1, \dots, j_s \in J$,
  \begin{equation*}
    Y(a^{j_1}_{(-n_1 - 1)}\dots a^{j_s}_{(-n_s - 1)}\vac, z) = \frac{:\partial^{n_1}_za^{j_1}(z)\dots\partial^{n_s}_za^{j_s}(z):}{n_1!\dots n_s!}.
  \end{equation*}
\end{corollary}

Let $(\mathfrak{g}, \mathfrak{F}, T_0)$ be a regular formal distribution Lie superalgebra with $\mathfrak{F} = \{a^j(z)\}_{j \in J}$, and let $\mathfrak{g}_-$ be the annihilation subalgebra.
Since $T_0(\mathfrak{g}_-) \subseteq \mathfrak{g}_-$, $DU(T_0): U(\mathfrak{g}) \to U(\mathfrak{g})$ is a $(U(\mathfrak{g}), U(\mathfrak{g}_-))$-bimodule homomorphism.
We consider the trivial representation $0: \mathfrak{g}_- \to \mathfrak{gl}(\mathbb{C})$, and we define:
\begin{align*}
  V &= \Ind^{\mathfrak{g}}_{\mathfrak{g}_-}(\mathbb{C}) = U(\mathfrak{g}) \otimes_{U(\mathfrak{g}_-)} \mathbb{C}, \\
  \pi &= \Ind^{\mathfrak{g}}_{\mathfrak{g}_-}(0): \mathfrak{g} \to \mathfrak{gl}(V), \\
  \vac &= 1\otimes1 \in V, \\
  T &= DU(T_0)\otimes\Id_{\mathbb{C}} \in \End(V)_{\zero}, \\
  \mathcal{F} &= \left\{\pi(a^j(z)) = \sum_{n \in \mathbb{Z}}\pi(a^j_{(n)})z^{-n - 1} \mid j \in J\right\}.
\end{align*}

\begin{theorem}
  \label{thr:19}
  With the notation above, $\mathcal{F}$ consists of fields, and $(V, \vac, T, \mathcal{F})$ is a pre-vertex superalgebra.
\end{theorem}

\begin{proof}
  First, we prove that $\pi(a^j(z))$ is a field for $j \in J$.
  We do this by induction on $s$ in $v = a^{j_1}_{(n_1)}\dots a^{j_s}_{(n_s)}\vac$, where $s \in \mathbb{N}$, $n_1, \dots, n_s \in \mathbb{Z}_-$ and $j_1, \dots, j_s \in J$.
  By the PBW theorem, these elements form a spanning set of $V$.
  For $s = 0$, we have $v = \vac$ and
  \begin{equation*}
    \pi(a^j(z))\vac = \sum_{n \in \mathbb{Z}}a^j_{(n)}\vac z^{-n - 1} = \sum_{n \in \mathbb{Z}_-}a^j_{(n)}\vac z^{-n - 1} \in V((z)).
  \end{equation*}
  The last equality is true because $a_{(n)}\vac = 0$ for $n \in \mathbb{N}$.
  We now proceed by proving the induction step:
  \begin{align}
    \nonumber
    \pi(a^j(z))v &= \sum_{n \in \mathbb{Z}}a^j_{(n)}a^{j_1}_{(n_1)}\dots a^{j_s}_{(n_s)}\vac z^{-n - 1} \\
    \label{eq:14}
                 &= \sum_{n \in \mathbb{Z}} [a^j_{(n)}, a^{j_1}_{(n_1)}]a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac z^{-n - 1} \pm \sum_{n \in \mathbb{Z}}a^{j_1}_{(n_1)}a^j_{(n)}a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac z^{-n - 1}.
  \end{align}
  By the induction hypothesis, the second sum in \eqref{eq:14} is in $V((z))$, so we only need to show that the first sum is also in $V((z))$.
  By \eqref{eq:4},
  \begin{equation}
    \label{eq:15}
    [a^j_{(n)}, a^{j_1}_{(n_1)}] = \sum_{k \in \mathbb{N}}\binom{n}{k}(a^j(z)_{(k)}a^{j_1}(z))_{(n + n_1 - k)}.
  \end{equation}
  The regularity property implies that $a^j(z)_{(k)}a^{j_1}(z) \in \mathbb{C}[\partial_z]\mathfrak{F}$, thus we can assume that
  \begin{equation*}
    a^j(z)_{(k)}a^{j_1}(z) = \sum_{l \in J}f^k_l(\partial_z)a^l(z),
  \end{equation*}
  for some polynomials $f^k_l$.
  Since $(a^j(z), a^{j_1}(z))$ is a local pair, there exists $N \in \mathbb{N}$ such that $a^j(z)_{(k)}a^{j_1}(z) = 0$ for $k \ge N$.
  This allows us to rewrite \eqref{eq:15} as
  \begin{equation*}
    [a^j_{(n)}, a^{j_1}_{(n_1)}] = \sum_{0 \le k \le N}\binom{n}{k}\left(\sum_{l \in J}f^k_l(\partial_z)a^l(z)\right)_{(n + n_1 - k)}.
  \end{equation*}
  Therefore, we can rewrite the first sum in \eqref{eq:14} as
  \begin{equation*}
    \sum_{0 \le k \le N}\sum_{n \in \mathbb{Z}}\binom{n}{k}\left(\sum_{l \in J}f^k_l(\partial_z)a^l(z)\right)_{(n + n_1 - k)}a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac z^{-n - 1}.
  \end{equation*}
  By the induction hypothesis, for each $k$,
  \begin{equation*}
    \sum_{n \in \mathbb{Z}}\binom{n}{k}\left(\sum_{l \in J}f^k_l(\partial_z)a^l(z)\right)_{(n + n_1 - k)}a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac z^{-n - 1} \in V((z)).
  \end{equation*}
  Finally, the first sum in \eqref{eq:14} is also in $V((z))$.

  We now verify the four axioms of a pre-vertex superalgebra:
  \begin{enumerate}
  \item $T\vac = DU(T_0)\otimes\Id_{\mathbb{C}}(1\otimes1) = DU(T_0)(1)\otimes1 = 0\otimes1 = 0$.
  \item We recall that $T$ is an even endomorphism.
    For $j \in J$,
    \begin{equation*}
      [T, \pi(a^j(z))] = \left[T, \sum_{n \in \mathbb{Z}}\pi(a^j_{(n)})z^{-n - 1}\right] = \sum_{n \in \mathbb{Z}}[T, \pi(a^j_{(n)})]z^{-n - 1} = \sum_{n \in \mathbb{Z}}T\pi(a^j_{(n)}) - \pi(a^j_{(n)})T.
    \end{equation*}
    For $x \in U(\mathfrak{g})$,
    \begin{align*}
      T\pi(a^j_{(n)})(x\otimes1) &= T(a^j_{(n)}x\otimes1) \\
                                 &= DU(T_0)(a^j_{(n)}x)\otimes1 \\
                                 &= (T_0(a^j_{(n)})x + a^j_{(n)}T_0(x))\otimes1 \\
                                 &= (-na^j_{(n - 1)}x + a^j_{(n)}T_0(x))\otimes1 \\
                                 &= -na^j_{(n - 1)}(x\otimes1) + \pi(a^j_{(n)})T(x\otimes 1).
    \end{align*}
    The last two equalities imply that for $j \in J$, $[T, \pi(a^j(z))] = \partial_z\pi(a^j(z))$.
  \item We note that for $i, j \in J$ and $N \in \mathbb{N}$,
    \begin{equation*}
      (z - w)^N[\pi(a^i(z)), \pi(a^j(z))] = (z - w)^N\pi([a^i(z), a^j(z)]) = \pi((z - w)^N[a^i(z), a^j(z)]).
    \end{equation*}
  \item This was already done. \qedhere
  \end{enumerate}
\end{proof}

By \Cref{thr:19} and the Extension theorem, $V$ is a vertex superalgebra, denoted by $V(\mathfrak{g}, \mathfrak{F}, T_0)$, and by the PBW theorem, it is explicitly given by
\begin{equation}
  \label{eq:16}
  V = \vspan\{a^{j_1}_{(-n_1 - 1)}\dots a^{j_s}_{(-n_s - 1)}\vac \mid s, n_1, \dots, n_s \in \mathbb{N}, j_1, \dots, j_s \in J\},
\end{equation}
which means $V$ is strongly generated by $\{a^j_{(-1)}\vac\}_{j \in J}$.

\begin{remark}
  \label{rmk:13}
  The PBW theorem for Lie superalgebras is actually more precise than \eqref{eq:16}.
  Let $\le$ be a total order on $J$.
  Then
  \begin{equation*}
    \begin{split}
      V = \vspan\{a^{j_1}_{(-n_1 - 1)}\dots a^{j_s}_{(-n_s - 1)}\vac &\mid \text{$s, n_1, \dots, n_s \in \mathbb{N}$, $j_1, \dots, j_s \in J$ and for $k = 1, \dots, s - 1$,} \\
                                                                     &\quad \text{if $a^{j_k}_{(n_k)}, a^{j_{k + 1}}_{(n_{k + 1})} \in V_{\one}$, then $j_k < j_{k + 1}$}\}.
    \end{split}
  \end{equation*}
\end{remark}

\begin{remark}
  \label{rmk:14}
  We have constructed a functor
  \begin{align*}
    VA: \{\text{regular formal distribution Lie superalgebras}\} &\to \{\text{vertex superalgebras}\}, \\
    VA(\mathfrak{g}, \mathfrak{F}, T_0) &= V(\mathfrak{g}, \mathfrak{F}, T_0).
  \end{align*}
  By \Cref{rmk:7}, we could have constructed a functor (see \cite[Theorem 2.15]{li_vertex_2004})
  \begin{equation*}
    VA: \{\text{Lie conformal superalgebras}\} \to \{\text{vertex superalgebras}\}.
  \end{equation*}
\end{remark}

Usually, we need to quotient the vertex superalgebras obtained this way.
Let $(\mathfrak{g}, \mathfrak{F}, T_0)$ be a regular formal distribution Lie superalgebra, and let $\lambda: \mathfrak{h} \to \mathbb{C}$ be a linear functional, where $\mathfrak{h}$ is a subalgebra of $\mathfrak{g}_+$ with $\mathfrak{h} \subseteq \ker(T_0)$.
We denote by $I^{\lambda}$ the $\mathfrak{g}$-submodule of $V(\mathfrak{g}, \mathfrak{F}, T_0)$ generated by the vectors $(a - \lambda(a))\vac$ for $a \in \mathfrak{h}$.
For $a \in \mathfrak{h}$ and $x \in U(\mathfrak{g})$,
\begin{align*}
  T(x(a - \lambda(a))\vac) &= DU(T_0)(x(a - \lambda(a)))\otimes1 \\
                           &= (DU(T_0)(x)(a - \lambda(a)) + xDU(T_0)(a - \lambda(a)))\otimes1 \\
                           &= DU(T_0)(x)(a - \lambda(a))\otimes1 \\
                           &= DU(T_0)(x)(a - \lambda(a))\vac.
\end{align*}
Thus, $I^{\lambda}$ is $T$-invariant.
By \Cref{thr:19}, $\{a^j_{(-1)}\vac\}_{j \in J}$ strongly generates $V$, and from this, we see that $I^{\lambda}$ is a left ideal.
By \Cref{rmk:12}, $I^{\lambda}$ is an ideal of $V(\mathfrak{g}, \mathfrak{F}, T_0)$.
Taking the quotient, we get a vertex superalgebra, denoted by
\begin{equation*}
  V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0) = V(\mathfrak{g}, \mathfrak{F}, T_0)/I^{\lambda}.
\end{equation*}

Let $\mathbb{C}_{\lambda}$ be the representation of $\mathfrak{g}_- \oplus \mathfrak{h}$ on which $\mathfrak{g}_-$ acts as $0$ and $a$ acts as $\lambda(a)$ for $a \in \mathfrak{h}$.
Using the universal property of the induced representation, we find a $\mathfrak{g}$-module homomorphism $\Ind^{\mathfrak{g}}_{\mathfrak{g}_-}(\mathbb{C}) \to \Ind^{\mathfrak{g}}_{\mathfrak{g}_- \oplus \mathfrak{h}}(\mathbb{C}_{\lambda})$.
By the universal property of the quotient, we find a $\mathfrak{g}$-module homomorphism $f: V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0) \to \Ind^{\mathfrak{g}}_{\mathfrak{g}_- \oplus \mathfrak{h}}(\mathbb{C}_{\lambda})$ such that the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    {\Ind^{\mathfrak{g}}_{\mathfrak{g}_-}(\mathbb{C})} \arrow[rd] \arrow[r, two heads] & {V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)} \arrow[d, "f"] \\
    & \Ind^{\mathfrak{g}}_{\mathfrak{g}_- \oplus \mathfrak{h}}(\mathbb{C}_{\lambda})
  \end{tikzcd}
\end{equation*}
Using again the universal property of the induced representation, we find a $\mathfrak{g}$-module homomorphism $g: \Ind^{\mathfrak{g}}_{\mathfrak{g}_-}(\mathbb{C}) \to V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)$.
We can verify that $f$ and $g$ are inverses of each other.
Therefore, it is better to think of $V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)$ as being $\Ind^{\mathfrak{g}}_{\mathfrak{g}_- \oplus \mathfrak{h}}(\mathbb{C}_{\lambda}) = U(\mathfrak{g}) \otimes_{U(\mathfrak{g}_- \oplus \mathfrak{h})} \mathbb{C}$.
We now use this construction to obtain several important examples of vertex superalgebras.

\begin{remark}
  \label{rmk:15}
  The vertex superalgebra $V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)$ comes equipped with a vertex superalgebra epimorphism $\pi: V(\mathfrak{g}, \mathfrak{F}, T_0) \twoheadrightarrow V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)$ that satisfies $\pi(a\vac) = \lambda(a)\vac$ for $a \in \mathfrak{h}$ and is universal with this property, i.e., if $f: V(\mathfrak{g}, \mathfrak{F}, T_0) \to W$ is a vertex superalgebra homomorphism such that $f(a\vac) = \lambda(a)\vac$ for $a \in \mathfrak{h}$, then there exist a unique vertex superalgebra homomorphism $\overline{f}: V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0) \to W$ such that the following diagram commutes
  \begin{equation*}
    \begin{tikzcd}
      {V(\mathfrak{g}, \mathfrak{F}, T_0)} \arrow[rd, "f"'] \arrow[r, "\pi", two heads] & {V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)} \arrow[d, "\overline{f}"] \\
      & W
    \end{tikzcd}
  \end{equation*}
\end{remark}

\begin{example}[\emph{Universal Virasoro vertex algebra of central charge $c$}]
  \label{exa:5}
  We pick $c \in \mathbb{C}$.
  We take $(\Vir, \{L(z), C\}, \ad(L_{-1}))$ as the regular formal distribution Lie superalgebra as constructed in \Cref{exa:1} and $\lambda: \mathbb{C}C \to \mathbb{C}, \lambda(C) = c$ as the linear functional.
  The resulting vertex algebra is the universal Virasoro vertex algebra of central charge $c$, denoted by $\Vir^c$.

  A \emph{partition (of $n \in \mathbb{N}$)} is a sequence $\lambda = [\lambda_1, \dots, \lambda_m]$ such that $\lambda_i \in \mathbb{Z}_+$ for $i = 1, \dots, m$, $\lambda_1 \ge \dots \ge \lambda_m$ (and $\lambda_1 + \dots + \lambda_m = n$).
  We also consider the \emph{empty partition} $\emptyset$, which is the unique partition of $0$.
  By \Cref{rmk:13}, for any $c \in \mathbb{C}$, a basis of $\Vir^c$ is given by
  \begin{equation*}
    \{L_{-\lambda_1}\dots L_{-\lambda_m}\vac \mid \text{$[\lambda_1, \dots, \lambda_m]$ is a partition with $\lambda_m \ge 2$}\}.
  \end{equation*}
  When we deal with conformal vertex superalgebras, we will explain why this vertex algebra is called universal.
\end{example}

\begin{example}[\emph{Universal affine vertex superalgebra of level $k$}]
  \label{exa:6}
  We pick $k \in \mathbb{C}$.
  We take $(\hat{\mathfrak{g}}, \{a(z) \mid a \in \mathfrak{g}\} \cup \{K\}, -\partial_t)$ as the regular formal distribution Lie superalgebra as constructed in \Cref{exa:2} and $\lambda: \mathbb{C}K \to \mathbb{C}, \lambda(K) = k$ as the linear functional.
  The resulting vertex superalgebra is the universal affine vertex superalgebra of level $k$, denoted by $V^k(\mathfrak{g})$.
\end{example}

\begin{example}[\emph{Fermionic vertex superalgebra}]
  \label{exa:7}
  We take $(\widehat{V}, \{a(z) \mid a \in V\} \cup \{K\}, -\partial_t)$ as the regular formal distribution Lie superalgebra as constructed in \Cref{exa:3} and $\lambda: \mathbb{C}K \to \mathbb{C}, \lambda(K) = 1$ as the linear functional.
  The resulting vertex superalgebra is the fermionic vertex superalgebra, denoted by $F(V)$.
\end{example}

Let $V$ be a vertex superalgebra.
We can naturally endow $V$ with the structure of a Lie conformal superalgebra by taking $\partial = T$, and by defining the following $\lambda$-bracket
\begin{align*}
  [\bullet_{\lambda}\bullet]: V \times V &\to V[\lambda], \\
  [a_{\lambda}b] &= F^{\lambda}(a(z)b) = \sum_{j \in \mathbb{N}}(a_{(j)}b)\frac{\lambda^j}{j!}.
\end{align*}
To verify the Lie conformal superalgebra axioms, we do the following.
We set $\mathcal{G} = \{Y(a, z) \mid a \in V\}$.
Then $\mathcal{G} \subseteq \mathcal{F}(V)$ is a Lie conformal superalgebra, and the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    V \times V \arrow[d, "{[\bullet_{\lambda}\bullet]_V}"] \arrow[r, "Y \times Y"] & \mathcal{G} \times \mathcal{G} \arrow[d, "{[\bullet_{\lambda}\bullet]_{\mathcal{G}}}"] \\
    {V[\lambda]} \arrow[r, "{Y[\lambda]}"] & {\mathcal{G}[\lambda]}
  \end{tikzcd}
\end{equation*}
As $Y: V \to \mathcal{F}(V)$ is injective, we obtain that $V$ itself is a Lie conformal superalgebra.
We have constructed a functor
\begin{align*}
  LCA: \{\text{Vertex superalgebras}\} &\to \{\text{Lie conformal superalgebras}\}, \\
  LCA(V) &= (V, T, [\bullet_{\lambda}\bullet]).
\end{align*}

\begin{remark}
  \label{rmk:16}
  Recall the functor $VA$ constructed in \Cref{rmk:14}.
  We could prove that $(VA, LCA)$ is an adjoint pair of functors, i.e., that for a vertex superalgebra $V$ and a Lie conformal superalgebra $\mathcal{R}$, we have a natural isomorphism
  \begin{equation*}
    \Hom(VA(\mathcal{R}), V) \cong \Hom(\mathcal{R}, LCA(V)).
  \end{equation*}
\end{remark}

\subsection{Graded and conformal vertex superalgebras}
\label{sec:grad-conf-vert}

Let $V$ be a vertex superalgebra.
A \emph{Hamiltonian operator of $V$} is a diagonalizable operator $H \in \End(V)$ such that
\begin{equation}
  \label{eq:17}
  [H, Y(a, z)] = z\partial_zY(a, z) + Y(Ha, z) \quad \text{for $a \in V$}.
\end{equation}
A vertex superalgebra with a Hamiltonian operator is called \emph{graded}.
The \emph{grading of $V$} is the eigenspace decomposition of $H$
\begin{equation*}
  V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta},
\end{equation*}
where
\begin{equation*}
  V_{\Delta} = \ker(H - \Delta\Id_V) \quad \text{for $\Delta \in \mathbb{C}$}.
\end{equation*}
If $a$ is an eigenvector of $H$, it is called \emph{homogeneous}, its eigenvalue is called the \emph{conformal weight of $a$}, and it is denoted by $\Delta_a$.
Condition \eqref{eq:17} is equivalent to
\begin{equation}
  \label{eq:18}
  [H, a_{(n)}] = -(n + 1)a_{(n)} + (Ha)_{(n)} \quad \text{for $a \in V$ and $n \in \mathbb{Z}$}
\end{equation}
and to
\begin{equation}
  \label{eq:19}
  [H, a_{(n)}] = (\Delta_a - n - 1)a_{(n)} \quad \text{for $a \in V$ homogeneous and $n \in \mathbb{Z}$}.
\end{equation}

For $a \in V$ homogeneous with conformal weight $\Delta_a$, we write, as was done with eigendistributions, $Y(a, z) = \sum_{n \in \mathbb{Z} - \Delta_a}a_nz^{-n - \Delta_a}$, which is equivalent to
\begin{equation}
  \label{eq:20}
  a_{(n)} = a_{n - \Delta_a + 1} \quad \text{for $n \in \mathbb{Z}$}.
\end{equation}
With this notation, \eqref{eq:19} is equivalent to
\begin{equation}
  \label{eq:21}
  [H, a_n] = -na_n \quad \text{for $a \in V$ homogeneous and $n \in \mathbb{Z} - \Delta_a$}.
\end{equation}

\begin{remark}
  \label{rmk:17}
  When a formula involves $\Delta_a$, it is assumed that $a$ is an eigenvector of $H$ with eigenvalue $\Delta_a$, and the formula is extended to arbitrary $a$ by linearity.
  We have two meanings of the word homogeneous, one related to the Hamiltonian, and the other related to the parity.
  The context will clarify the meaning.
\end{remark}

\begin{theorem}[{\cite[\S4.9]{kac_vertex_1998}}]
  \label{thr:20}
  Let $V$ be a graded vertex superalgebra with Hamiltonian $H$ and grading $V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta}$.
  Then:
  \begin{enumerate}
  \item $H\vac = 0$, which means that $\Delta_{\vac} = 0$;
  \item $[H, T] = T$;
  \item $[T, a_n] = (-n - \Delta_a + 1)a_{n - 1}$ for $a \in V$ homogeneous and $n \in \mathbb{Z} - \Delta_a$;
  \item $a_nV_{\Delta} \subseteq V_{\Delta - n}$ for $a \in V$ homogeneous, $\Delta \in \mathbb{C}$ and $n \in \mathbb{Z} - \Delta_a$;
  \item $TV_{\Delta} \subseteq V_{\Delta + 1}$ for $\Delta \in \mathbb{C}$ or, equivalently, $\Delta_{Ta} = \Delta_a + 1$ for $a \in V$ homogeneous;
  \item $\Delta_{a_{(n)}b} = \Delta_a + \Delta_b - n - 1$ for $a, b \in V$ homogeneous and $n \in \mathbb{Z}$.
  \end{enumerate}
\end{theorem}

A $\mathbb{Z}$ or $\mathbb{N}$-graded vertex superalgebra $V$ is a graded vertex superalgebra $V$ such that $V_{\Delta} = 0$ for $\Delta \notin \mathbb{Z}$ or $\mathbb{N}$, respectively.

\emph{Homomorphisms of graded vertex superalgebras} are assumed to respect the gradings, i.e., if $f: V_1 \to V_2$ is a homomorphism of graded vertex superalgebras, then $f\circ H^{V_1} = H^{V_2}\circ f$, where $H^{V_1}$ is the Hamiltonian of $V_1$, and $H^{V_2}$ is the Hamiltonian of $V_2$.

Let $V$ be a vertex superalgebra.
A \emph{conformal vector of central charge $c \in \mathbb{C}$ of $V$} is a vector $\omega \in V$ such that $Y(\omega, z) = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2}$ satisfies:
\begin{enumerate}
\item $Y(\omega, z)$ is a Virasoro formal distribution of central charge $C = c\Id_V$;
\item $L_{-1} = T$;
\item $L_0$ is diagonalizable.
\end{enumerate}

A \emph{conformal vertex superalgebra (of central charge $c$)} is a vertex superalgebra $V$ together with a conformal vector $\omega$ (of central charge $c$).
We denote the conformal superalgebra by $(V, \omega)$ if we want to emphasize the conformal vector.

\begin{remark}
  \label{rmk:18}
  Because of property (ii), a conformal vector $\omega$ is necessarily even.
  We note that
  \begin{equation*}
    \omega_{(n)} = L_{n - 1} \quad \text{for $n \in \mathbb{Z}$}.
  \end{equation*}
  If $(V, \omega)$ is a conformal vertex superalgebra, and $I$ is an ideal of $V$, then $(V/I, \omega + I)$ is a conformal vertex superalgebra of the same central charge.
\end{remark}

\begin{theorem}
  \label{thr:21}
  If $\omega$ is a conformal vector of a vertex superalgebra $V$, then $L_0$ is a Hamiltonian of $V$, and for $a \in V$, $Y(a, z)$ is an eigendistribution of conformal weight $\Delta_a$ with respect to $Y(\omega, z)$ if and only if $a$ is homogeneous of conformal weight $\Delta_a$.
  Moreover, $\omega$ has conformal weight $2$.
\end{theorem}

\begin{proof}
  By \Cref{thr:16}(iii) and \Cref{thr:16}(v), for $a \in V$ and $n \in \mathbb{Z}$,
  \begin{align*}
    [L_0, a_{(n)}] &= [\omega_{(1)}, a_{(n)}] \\
                   &= \sum_{j \in \mathbb{N}}\binom{1}{j}(\omega_{(j)}a)_{(1 + n - j)} \\
                   &= (\omega_{(0)}a)_{(n + 1)} + (\omega_{(1)}a)_{(n)} \\
                   &= (Ta)_{(n + 1)} + (L_0a)_{(n)} \\
                   &= -(n + 1)a_{(n)} + (L_0a)_{(n)}.
  \end{align*}
  By \eqref{eq:18}, this is equivalent to $L_0$ being a Hamiltonian of $V$.

  The $n$-product identity for vertex superalgebras and \Cref{thr:16}(iii) show that for $a \in V$,
  \begin{align*}
    [Y(\omega, z)_{\lambda}Y(a, z)] &= \sum_{j \in \mathbb{N}}\frac{Y(\omega, z)_{(j)}Y(a, z)}{j!}\lambda^j \\
                                    &= \sum_{j \in \mathbb{N}}\frac{Y(\omega_{(j)}a, z)}{j!}\lambda^j \\
                                    &= Y(Ta, z) + Y(L_0a, z)\lambda + O(\lambda^2) \\
                                    &= \partial_zY(a, z) + Y(L_0a, z)\lambda + O(\lambda^2).
  \end{align*}
  Because $Y: V \to \mathcal{F}(V)$ is injective, this implies that
  \begin{equation*}
    \text{$[Y(\omega, z)_{\lambda}Y(a, z)] = \partial_zY(a, z) + \Delta_aY(a, z)\lambda + O(\lambda^2)$ if and only if $L_0a = \Delta_aa$}.
  \end{equation*}
  As $Y(\omega, z)$ has conformal weight $2$ with respect to itself, $\omega$ has conformal weight $2$.
\end{proof}

A \emph{conical} vertex superalgebra is an $\mathbb{N}$-graded vertex superalgebra with $V_0 = \mathbb{C}\vac$.
A \emph{vertex operator superalgebra} is a $\mathbb{Z}$-graded conformal vertex superalgebra such that:
\begin{enumerate}
\item For $n \in \mathbb{Z}$, $\dim(V_n) < \infty$;
\item There is $N \in \mathbb{Z}$ satisfying $V_n = 0$ for $n \le N$.
\end{enumerate}

\begin{remark}
  \label{rmk:19}
  A vertex superalgebra can have many different conformal vectors (see \cite[Example 2.5.9]{frenkel_vertex_2001}).
\end{remark}

\begin{example}
  \label{exa:8}
  It is straightforward to verify that for $c \in \mathbb{C}$, $\Vir^c$ is a conformal vertex algebra of central charge $c$ with conformal vector $\omega = L_{-2}\vac$.
\end{example}

\begin{example}[\emph{Sugawara construction} {\cite[Theorem 5.7]{kac_vertex_1998}}]
  \label{exa:9}
  We recall the universal affine vertex superalgebra of level $k$ of \Cref{exa:6}, and we assume that $\mathfrak{g}$ is simple and finite dimensional.
  Let $(a_i)_{i \in I}, (a^i)_{i \in I}$ be dual bases of $(\bullet| \bullet)$, which means $(a_i| a^j) = \delta_{ij}$ for $i, j \in I$.
  We denote by $c_{\mathfrak{g}} = \sum_{i \in I}a^ia_i \in U(\mathfrak{g})$ the universal Casimir element of $\mathfrak{g}$.
  Let $2h^{\wedge}$ be the eigenvalue of $\ad(c_{\mathfrak{g}}) \in \End(\mathfrak{g})$ in the adjoint representation, i.e., $\ad(c_{\mathfrak{g}}) = \sum_{i \in I}\ad(a^i)\ad(a_i) = 2h^{\wedge}\Id_V$.
  We assume $k \neq -h^{\wedge}$ and set
  \begin{equation*}
    \omega = \frac{1}{2(k + h^{\wedge})}\sum_{i \in I}a^i_{(-1)}a_{i(-1)}\vac \in V^k(\mathfrak{g}).
  \end{equation*}
  Then $\omega$ is a conformal vector of central charge $\frac{k\sdim(\mathfrak{g})}{k + h^{\wedge}}$, and for $a \in \mathfrak{g}$, $a(z)$ is a primary eigendistribution of conformal weight $1$.
\end{example}

\begin{example}[{\cite[Proposition 4.10]{kac_vertex_1998}}]
  \label{exa:10}
  We recall the fermionic vertex superalgebra of \Cref{exa:7}.
  Let $(a_i)_{i \in I}$ and $(a^i)_{i \in I}$ be a pair of dual bases of $V$, i.e., $\langle a_i, a^j\rangle = \delta_{ij}$ for $i, j \in I$.
  We set
  \begin{equation*}
    \omega = \frac{1}{2}\sum_{i \in I}a^i_{(-2)}a_{i(-1)}\vac \in F(V).
  \end{equation*}
  Then $\omega$ is a conformal vector of central charge $-\frac{1}{2}\sdim(V)$, and all fields $a(z)$, where $a \in V$, are primary of conformal weight $1/2$.
\end{example}

A \emph{conformal vertex superalgebra homomorphism} $(V_1, \omega_1) \to (V_2, \omega_2)$ is a homomorphism of vertex superalgebras $V_1 \to V_2$ such that $\omega_1 \mapsto \omega_2$.

\begin{remark}
  \label{rmk:20}
  Because homomorphisms of conformal vertex superalgebras respect the conformal vectors, they automatically respect the gradings as well.
\end{remark}

\begin{theorem}[Universal property of $\Vir^c$]
  \label{thr:22}
  Let $V$ be a conformal vertex superalgebra with conformal vector $\omega$ of central charge $c$.
  There exists a unique homomorphism of conformal vertex superalgebras $(\Vir^c, L_{-2}\vac) \to (V, \omega)$.
\end{theorem}

\begin{proof}
  Let $\Vir$ also denote the Virasoro Lie conformal algebra.
  Because $V$ is conformal, the map
  \begin{align*}
    g: \Vir &\to LCA(V), \\
    g(L) &= \omega, \\
    g(C) &= c\vac
  \end{align*}
  gives a homomorphism of Lie conformal superalgebras.
  By \Cref{rmk:16}, we obtain a homomorphism
  \begin{align*}
    f: VA(\Vir) &\to V, \\
    f(L_{-2}\vac) &= \omega, \\
    f(C\vac) &= c\vac.
  \end{align*}
  Using \Cref{rmk:15} with $\Vir^c$, we obtain our desired homomorphism of vertex superalgebras $\overline{f}: \Vir^c \to V$ such that $\overline{f}(L_{-2}\vac) = \omega$.
  As $\{L_{-2}\vac\}$ strongly generates $\Vir^c$, and a homomorphism of conformal vertex superalgebras is required to send $L_{-2}\vac$ to $\omega$, $\overline{f}$ is the only homomorphism of conformal vertex superalgebras $(\Vir^c, L_{-2}\vac) \to (V, \omega)$.

  Alternatively, we could use \Cref{thr:25} ahead to obtain a state-field correspondence $f: \Vir^c \to \mathcal{F}(V)$.
  Actually, the image of $f$ is contained in the image of the state-field correspondence $Y^V: V \to \mathcal{F}(V)$.
  Because $Y^V$ is injective, we can simply define $\overline{f} = (Y^V)^{-1}\circ f$.
\end{proof}

We recall some basic facts about diagonalizable operators.

\begin{lemma}[{\cite[\S6.2]{hoffman_linear_1971}}]
  \label{lmm:8}
  Let $V$ be a vector space, $H \in \End(V)$, and for $\Delta \in \mathbb{C}$, we set $V_{\Delta} = \ker(H - \Delta\Id_V)$.
  Then the family of subspaces $(V_{\Delta})_{\Delta \in \mathbb{C}}$ is linearly independent.
\end{lemma}

\begin{lemma}[{\cite[Corollary 1.1]{kac_bombay_2013}}]
  \label{lmm:9}
  Let $V$ be a vector space (not necessarily a vertex superalgebra), and let $H \in \End(V)$ be a diagonalizable operator with eigenspace decomposition $V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta}$.
  Let $U$ be an $H$-invariant subspace of $V$, which means $H(U) \subseteq U$.
  Then $U$ is graded, i.e.,
  \begin{equation*}
    U = \sum_{\Delta \in \mathbb{C}}U \cap V_{\Delta}.
  \end{equation*}
\end{lemma}

We can generalize and combine the previous two lemmas as follows.
Let $k$ be a field, let $\mathcal{P} \subseteq k[x]$ be a set of representatives of the irreducible polynomials in $k[x]$ (for example, if $k$ is algebraically closed, then we may take $\mathcal{P} = \{x - \Delta \mid \Delta \in k\}$), let $V$ be a vector space over $k$, and let $H \in \End(V)$.
For $p(x) \in \mathcal{P}$, we define the \emph{generalized eigenspace of $H$ with respect to $p(x)$} as
\begin{equation*}
  V^{\Gen}_{p(x)} = \{a \in V \mid \text{there is $k \in \mathbb{N}$ such that $p(H)^ka = 0$}\}.
\end{equation*}
We also define the subspace
\begin{equation*}
  V^{\Gen} = \sum_{p(x) \in \mathcal{P}}V^{\Gen}_{p(x)}.
\end{equation*}
When $k$ is algebraically closed, we write $V^{\Gen}_{\Delta}$ instead of $V^{\Gen}_{x - \Delta}$ for $\Delta \in k$, and we call that subspace the \emph{generalized eigenspace of $H$ with eigenvalue $\Delta$}.

\begin{lemma}
  \label{lmm:10}
  With notation as above, we have:
  \begin{enumerate}
  \item The family of subspaces $(V^{\Gen}_{p(x)})_{p(x) \in \mathcal{P}}$ is linearly independent;
  \item $H(V^{\Gen}_{p(x)}) \subseteq V^{\Gen}_{p(x)}$ for $p(x) \in \mathcal{P}$ and $H(V^{\Gen}) \subseteq V^{\Gen}$;
  \item If $U$ is an $H$-invariant subspace of $V^{\Gen}$, then $U$ is graded, i.e.,
    \begin{equation*}
      U = \sum_{p(x) \in \mathcal{P}}U \cap V^{\Gen}_{p(x)}.
    \end{equation*}
  \end{enumerate}
\end{lemma}

An ideal $I$ of a graded vertex superalgebra $V$ with Hamiltonian $H$ is called \emph{graded} if it is $H$-invariant or, equivalently, $I = \sum_{\Delta \in \mathbb{C}}I \cap V_{\Delta}$ (see \Cref{lmm:9}).

\begin{lemma}
  \label{lmm:11}
  Let $V$ be a graded vertex superalgebra with grading $V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta}$ such that $V_0 = \mathbb{C}\vac$.
  Then $V$ has a unique maximal proper graded ideal $I_{\max}$ and $V/I_{\max}$ is the unique simple graded quotient of $V$, this means that for a proper graded ideal $I$ of $V$, $V/I$ is simple if and only if $I = I_{\max}$.
\end{lemma}

\begin{proof}
  All proper ideals of $V$ do not contain $\vac$ because an ideal containing $\vac$ is all of $V$.
  Let $I_{\max}$ be the sum of all graded proper ideals $I$.
  Then $I_{\max}$ is a graded ideal of $V$, and $I_{\max} \neq V$ because $\vac \notin I_{\max}$.
  Therefore, $I_{\max}$ is the unique maximal proper graded ideal of $V$.
\end{proof}

\begin{lemma}
  \label{lmm:12}
  In a conformal vertex superalgebra $V$ such that $V_0 = \mathbb{C}\vac$, all ideals are graded, and there is a unique maximal proper ideal $I_{\max}$ and a unique simple quotient $V/I_{\max}$.
\end{lemma}

\begin{proof}
  Let $\omega$ be the conformal vector of $V$, and let $I$ be an ideal of $V$.
  As $L_0(I) = \omega_{(1)}(I) \subseteq I$, $I$ is a graded ideal.
  The result follows from \Cref{lmm:11}.
\end{proof}

The conformal vertex algebra $\Vir^c$ satisfies $\Vir^c_0 = \mathbb{C}\vac$.
We denote by $\Vir_c$ the unique simple quotient, and we call it the \emph{simple Virasoro vertex algebra of central charge $c$}.
Let $p, q \ge 2$ be relatively prime integers, and we set
\begin{equation*}
  c_{p, q} = 1 - \frac{6(p - q)^2}{pq}.
\end{equation*}

Let $V$ be a $\Vir$-module.
We say $V$ is \emph{smooth} if $L(z) = \sum_{n \in \mathbb{Z}}L_{n}z^{-n - 2} \in \End(V)[[z^{\pm 1}]]$ is a field.
We say $V$ is \emph{of central charge $c \in \mathbb{C}$} if the central element $C$ acts as multiplication by $c$.
A vector $u$ in $V$ is called \emph{singular} if it is nonzero and
\begin{equation*}
  L_nu = 0 \quad \text{for $n \in \mathbb{Z}_+$}.
\end{equation*}

\begin{theorem}[{\cite{gorelik_simplicity_2007}}]
  \label{thr:23}
  The following are equivalent:
  \begin{enumerate}
  \item $\Vir^c$ is not simple, i.e., $\Vir^c \neq \Vir_c$;
  \item $c$ is of the form $c_{p, q}$ for some $p, q \ge 2$ relatively prime integers.
  \end{enumerate}
  Moreover, the maximal proper ideal of $\Vir^{c_{p, q}}$ is generated by a singular vector of conformal weight $(p - 1)(q - 1)$, denoted by $a_{p, q}$.
  In the expression
  \begin{equation*}
    a_{p, q} = \sum_{\substack{i_1 \ge \dots \ge i_k \ge 2 \\ i_1 + \dots + i_k = (p - 1)(q - 1)}}c_{i_1\dots i_k}L_{-i_1}\dots L_{-i_k}\vac,
  \end{equation*}
  where $c_{i_1\dots i_k} \in \mathbb{Q}$, the coefficient of $L_{-2}^{(p - 1)(q - 1)/2}$ is nonzero.
\end{theorem}

We assume $p < q$.
For $p = 2$ and $q = 3$, we have $c_{2, 3} = 0$ and $\Vir_0 = \mathbb{C}\vac$ (the one dimensional vertex algebra) because in this case, $\omega = L_{-2}\vac$ is the singular vector generating the maximal proper ideal.
Thus, the smallest case is not very interesting.
The next case is the \emph{Ising model} $\Vir_{3, 4} = \Vir_{c_{3, 4}} = \Vir_{1/2}$.
In this thesis, we study the Ising model and its irreducible admissible modules called \emph{Ising modules}.
By \Cref{thr:23}, the maximal proper ideal of $\Vir_{3, 4}$ is generated by the singular vector
\begin{equation}
  \label{eq:22}
  a_{3, 4} = (L_{-2}^3 + \tfrac{93}{64}L_{-3}^2 - \tfrac{27}{16}L_{-6} - \tfrac{33}{8}L_{-4}L_{-2})\vac
\end{equation}
of conformal weight $(3 - 1)(4 - 1) = 6$ (see \Cref{sec:kac-dete-form} ahead for more details).

\subsection{Modules over vertex superalgebras}
\label{sec:modules-over-vertex}

Let $V$ be a vertex superalgebra.
A \emph{module over $V$}, $V$-module or \emph{representation of $V$} is a vector superspace $M$ together with a linear and parity preserving map
\begin{align*}
  Y^M(\bullet, z): V &\to \mathcal{F}(M), \\
  a &\mapsto Y^M(a, z) = \sum_{n \in \mathbb{Z}}a^M_{(n)}z^{-n - 1}
\end{align*}
satisfying:
\begin{enumerate}
\item $Y(\vac, z) = \Id_M$;
\item (Borcherds identity) For $a, b \in V$, $u \in M$ and $m, n, k \in \mathbb{Z}$,
  \begin{equation*}
    \sum_{j \in \mathbb{N}}(-1)^j\binom{n}{j}\left(a^M_{(m + n - j)}(b^M_{(k + j)}u) - (-1)^np(a, b)b^M_{(n + k - j)}(a^M_{(m + j)}u)\right) = \sum_{j \in \mathbb{N}}\binom{m}{j}(a_{(n + j)}b)^M_{(m + k - j)}u.
  \end{equation*}
\end{enumerate}

\begin{remark}
  \label{rmk:21}
  What we call $V$-modules are sometimes called weak $V$-modules by some authors (for example, in \cite{dong_twisted_1998} and \cite{abe_rationality_2003}).
  Since this is the minimum requirement for a module, I think it is a better idea to just call them modules and add adjectives as we require more assumptions.
\end{remark}

The vertex superalgebra $V$ is clearly a $V$-module, and it is called the \emph{adjoint representation of $V$}.
A \emph{submodule of $M$} is a subspace $N$ of $M$ such that $Y^M(a, z)u \in N((z))$ for $a \in V$ and $u \in N$, i.e., $a^M_{(n)}u \in N$ for $n \in \mathbb{Z}$.
The \emph{quotient module} $M/N$ is defined in the usual way.
A module whose only proper submodule is $0$ is called \emph{simple} or \emph{irreducible}.
Let $T \subseteq M$ be a subset.
The \emph{submodule generated by $T$} is the smallest submodule containing $T$, which is the intersection of all submodules containing $T$.
It is denoted by $(T)$, and we can prove that
\begin{equation*}
  (T) = \vspan\{a^{1M}_{(n_1)}\dots a^{sM}_{(n_s)}u \mid s \in \mathbb{N}, a^1, \dots, a^s \in V, n_1, \dots, n_s \in \mathbb{Z}, u \in T\}.
\end{equation*}
We say \emph{$M$ is strongly generated over $V$ by $T$} if
\begin{equation*}
  M = \vspan\{a^{1M}_{(-n_1 - 1)}\dots a^{sM}_{(-n_s - 1)}u \mid s, n_1, \dots, n_s \in \mathbb{N}, a^1, \dots, a^s \in V, u \in T\}.
\end{equation*}

Most of the theorems about vertex superalgebras and their proofs carry over to modules over vertex superalgebras (cf.\ \Cref{thr:16}), as the following theorem shows.

\begin{theorem}
  \label{thr:24}
  Let $V$ be a vertex superalgebra, and let $Y^M: V \to \mathcal{F}(M)$ be a $V$-module.
  For $a, b \in V$, $u \in M$ and $m, n \in \mathbb{Z}$:
  \begin{enumerate}
  \item $(\vac)^M_{(n)} = \delta_{n, -1}\Id_M$;
  \item $Y^M(Ta, z) = \partial_zY^M(a, z)$ or, equivalently, $(Ta)^M_{(n)} = -na^M_{(n - 1)}$;
  \item All fields $\{Y^M(a, z)\}_{a \in V}$ are mutually local;
  \item \emph{($n$-product identity)} $Y^M(a, z)_{(n)}Y^M(b, z) = Y^M(a_{(n)}b, z)$;
  \item $[a^M_{(m)}, b^M_{(n)}] = \sum_{j \in \mathbb{N}}(a_{(j)}b)^M_{(m + n - j)}$;
  \item $e^{Tw}Y^M(a, z)e^{-Tw} = i_{z, w}Y^M(a, z + w)$;
  \item \emph{(Borcherds identity)}
    \begin{equation*}
      \begin{split}
        &i_{z, w}((z - w)^n)Y^M(a, z)Y^M(b, w)u - p(a, b)i_{w, z}((z - w)^n)Y^M(b, w)Y^M(a, z)u = \\
        &\sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}Y^M(a_{(n + j)}b, w)u;
      \end{split}
    \end{equation*}
  \item $(a_{(n)}b)^M_{(m)}u = \sum_{j \in \mathbb{N}}(-1)^j\binom{n}{j}(a^M_{(n - j)}b^M_{(m + j)}u - (-1)^np(a, b)b^M_{(n + m - j)}a^M_{(j)}u)$.
  \end{enumerate}
\end{theorem}

\begin{remark}
  \label{rmk:22}
  In contrast to vertex superalgebras, the map $Y^M: V \to \mathcal{F}(M)$ is in general not injective for a module $M$ over a vertex superalgebra $V$.
  Moreover, we do not have the property of skewsymmetry for modules.
\end{remark}

Let $V$ be a vertex superalgebra, and let $M_1$, $M_2$ be $V$-modules.
A $V$-module homomorphism $f: M_1 \to M_2$ is a linear and parity preserving map such that for $a \in V$ and $u \in M_1$,
\begin{equation*}
  f(Y^{M_1}(a, z)u) = \sum_{n \in \mathbb{Z}}f(a^{M_1}_{(n)}u)z^{-n - 1} = \sum_{n \in \mathbb{Z}}a^{M_2}_{(n)}f(u)z^{-n - 1} = Y^{M_2}(a, z)f(u).
\end{equation*}
We obtain the category $V$-Mod of $V$-modules, which is abelian.

\begin{proposition}[{\cite[\S3]{dong_twisted_1998}}]
  \label{prp:9}
  Let $V$ be a vertex superalgebra.
  A $V$-module is equivalently a superspace $M$ together with a linear and parity preserving map $Y^M: V \to \mathcal{F}(M)$, written as $Y^M(a, z) = \sum_{n \in \mathbb{Z}}a^M_{(n)}z^{-n - 1}$, such that for $a, b \in V$, $u \in M$ and $m, n \in \mathbb{Z}$:
  \begin{align}
    \label{eq:23}
    (\vac)^M_{(n)} &= \delta_{n, -1}\Id_M, \\
    \label{eq:24}
    [a^M_{(m)}, b^M_{(n)}] &= \sum_{j \in \mathbb{N}}(a_{(j)}b)^M_{(m + n - j)}, \\
    \label{eq:25}
    (a_{(n)}b)^M_{(m)}u &= \sum_{j \in \mathbb{N}}(-1)^j\binom{n}{j}(a^M_{(n - j)}b^M_{(m + j)}u - (-1)^np(a, b)b^M_{(n + m - j)}a^M_{(j)}u).
  \end{align}
\end{proposition}

Let $V$ be a vertex superalgebra, and let $M$ be a $V$-module.
We say  $T^M \in \End(M)$ is a \emph{differential of $M$} if
\begin{equation*}
  [T^M, a^M_{(n)}] = -na^M_{(n - 1)} \quad \text{for $a \in V$ and $n \in \mathbb{Z}$}
\end{equation*}
or, equivalently,
\begin{equation*}
  [T^M, Y^M(a, z)] = Y^M(Ta, z) \quad \text{for $a \in V$}.
\end{equation*}
A \emph{differential} $V$-module is a $V$-module equipped with a differential.

Let $(\mathfrak{g}, \mathfrak{F}, T_0)$ be a regular formal distribution Lie superalgebra with $\mathfrak{F} = \{a^j(z)\}_{j \in J}$.
A \emph{smooth} $(\mathfrak{g}, \mathfrak{F}, T_0)$-module is a $\mathfrak{g}$-module $M$ such for $j \in J$ and $u \in M$, $a^j(z)u \in M((z))$.
Let $\lambda: \mathfrak{h} \to \mathbb{C}$ be a linear functional, where $\mathfrak{h}$ is a subalgebra of $\mathfrak{g}_+$ with $\mathfrak{h} \subseteq \ker(T_0)$.
We say $\mathfrak{h}$ \emph{acts as $\lambda$} if for $h \in \mathfrak{h}$ and $u \in M$, $hu = \lambda(h)u$.

\begin{theorem}[{\cite[Theorem 2.15]{li_vertex_2004}}]
  \label{thr:25}
  Let $(\mathfrak{g}, \mathfrak{F}, T_0)$ be a regular formal distribution Lie superalgebra with $\mathfrak{F} = \{a^j(z)\}_{j \in J}$.
  Given a smooth $(\mathfrak{g}, \mathfrak{F}, T_0)$-module $M$, there is a unique module structure $Y^M: V(\mathfrak{g}, \mathfrak{F}, T_0) \to \mathcal{F}(M)$ such that for $j \in J$ and $u \in M$, $Y^M(a^j_{(-1)}\vac, z)u = a^j(z)u$.
  Let $\lambda: \mathfrak{h} \to \mathbb{C}$ be a linear functional, where $\mathfrak{h}$ is a subalgebra of $\mathfrak{g}_+$ with $\mathfrak{h} \subseteq \ker(T_0)$.
  Given a smooth $(\mathfrak{g}, \mathfrak{F}, T_0)$-module $M$, where $h$ acts as $\lambda$, there is a unique module structure $Y^M: V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0) \to \mathcal{F}(M)$ such that for $j \in J$ and $u \in M$, $Y^M(a^j_{(-1)}\vac, z)u = a^j(z)u$.
\end{theorem}

\begin{remark}
  \label{rmk:23}
  We can define naturally the categories \{smooth $(\mathfrak{g}, \mathfrak{F}, T_0)$-modules\} and \{smooth $(\mathfrak{g}, \mathfrak{F}, T_0)$-modules where $\mathfrak{h}$ acts as $\lambda$\}.
  \Cref{thr:25} constructs a pair of functors:
  \begin{align*}
    \{\text{smooth $(\mathfrak{g}, \mathfrak{F}, T_0)$-modules}\} &\to \text{$V(\mathfrak{g}, \mathfrak{F}, T_0)$-Mod}, \\
    \{\text{smooth $(\mathfrak{g}, \mathfrak{F}, T_0)$-modules where $\mathfrak{h}$ acts as $\lambda$}\} &\to \text{$V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0)$-Mod},
  \end{align*}
  which are actually isomorphisms.
\end{remark}

Let $M$ be a module over a graded vertex superalgebra $V$ with Hamiltonian operator $H$.
A \emph{Hamiltonian operator of $M$} is a diagonalizable operator $H^M \in \End(M)$ such that
\begin{equation}
  \label{eq:26}
  [H^M, Y^M(a, z)] = z\partial_zY^M(a, z) + Y^M(Ha, z) \quad \text{for $a \in V$}.
\end{equation}
A $V$-module together with a Hamiltonian operator is called \emph{graded}.
The \emph{grading of $M$} is the eigenspace decomposition of $H^M$
\begin{equation*}
  M = \bigoplus_{\Delta \in \mathbb{C}}M_{\Delta},
\end{equation*}
where
\begin{equation*}
  M_{\Delta} = \ker(H^M - \Delta\Id_M).
\end{equation*}
If $u$ is an eigenvector of $H^M$, it is called \emph{homogeneous}, its eigenvalue is called the \emph{conformal weight of $u$}, and it is denoted by $\Delta_u$.
Condition \eqref{eq:26} is equivalent to
\begin{equation*}
  [H^M, a^M_{(n)}] = -(n + 1)a^M_{(n)} + (Ha)^M_{(n)} \quad \text{for $a \in V$ and $n \in \mathbb{Z}$}
\end{equation*}
and to
\begin{equation}
  \label{eq:27}
  [H^M, a^M_{(n)}] = (\Delta_a - n - 1)a^M_{(n)} \quad \text{for $a \in V$ homogeneous and $n \in \mathbb{Z}$}.
\end{equation}

We usually write $Y^M(a, z) = \sum_{n \in \mathbb{Z} - \Delta_a}a^M_nz^{-n - \Delta_a}$ when $a \in V$ is homogeneous with conformal weight $\Delta_a$, which is equivalent to
\begin{equation*}
  a^M_{(n)} = a^M_{n - \Delta_a + 1} \quad \text{for $n \in \mathbb{Z}$}.
\end{equation*}
With this notation, \eqref{eq:27} is equivalent to
\begin{equation}
  \label{eq:28}
  [H^M, a^M_n] = -na^M_n \quad \text{for $a \in V$ homogeneous and $n \in \mathbb{Z} - \Delta_a$}.
\end{equation}

\begin{theorem}
  \label{thr:26}
  Let $V$ be a graded vertex superalgebra with Hamiltonian $H$, and let $M$ be a graded $V$-module with Hamiltonian $H^M$.
  Then:
  \begin{enumerate}
  \item $a^M_nM_{\Delta} \subseteq M_{\Delta - n}$ for $a \in V$ homogeneous and $n \in \mathbb{Z} - \Delta_a$;
  \item $\Delta_{a^M_{(n)}u} = \Delta_a + \Delta_u - n - 1$ for $a \in V$ homogeneous, $u \in M$ and $n \in \mathbb{Z}$;
  \item \emph{(Graded Borcherds identity)} For $a, b \in V$, $u \in M$, $m \in \mathbb{Z} - \Delta_a$, $k \in \mathbb{Z}- \Delta_b$ and $n \in \mathbb{Z}$,
    \begin{equation*}
      \sum_{j \in \mathbb{N}}(-1)^j\binom{n}{j}(a^M_{m + n - j}(b^M_{k + j - n}u) - (-1)^np(a, b)b^M_{k - j}(a^M_{m + j}u)) = \sum_{j \in \mathbb{N}}\binom{m + \Delta_a - 1}{j}(a_{(n + j)}b)^M_{m + k}u.
    \end{equation*}
  \end{enumerate}
\end{theorem}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item The proof of \Cref{thr:20}(iv) also works here.
  \item The proof of \Cref{thr:20}(vi) also works here.
  \item The graded Borcherds identity is simply a change of notation in the usual Borcherds identity. \qedhere
  \end{enumerate}
\end{proof}

A \emph{homomorphism of graded modules} over a graded vertex superalgebra is assumed to respect the gradings.

\begin{theorem}[{\cite[Proposition 4.1.5 and (4.1.18)]{lepowsky_introduction_2004}}]
  \label{thr:27}
  Let $V$ be a conformal vertex algebra of central charge $c$ with conformal vector $\omega$, and let $M$ be a $V$-module.
  We write $Y^M(\omega, z) = \sum_{n \in \mathbb{Z}}L^M_nz^{-n - 2}$.
  For $a \in V$ and $m, n \in \mathbb{Z}$:
  \begin{align*}
    [L^M_{-1}, Y^M(a, z)] &= Y^M(L_{-1}a, z) = \partial_zY^M(a, z), \\
    [L^M_m, L^M_n] &= (m - n)L^M_{m + n} + \delta_{m, -n}\frac{m^3 - m}{12}c\Id_M, \\
    [L^M_0, Y^M(a, z)] &= z\partial_zY^M(a, z) + Y^M(L_0a, z).
  \end{align*}
  In particular, $M$ is a differential $V$-module with $L_{-1}^M $ as differential, and $M$ is a smooth $\Vir$-module of central charge $c$.
  If $L^M_0$ is diagonalizable, then $M$ is graded by $L_0^M$ and:
  \begin{align*}
    [L_0^M, L_{-1}^M] &= L_{-1}^M, \\
    L^M_{-1}M_{\Delta} &\subseteq M_{\Delta + 1} \quad \text{for $\Delta \in \mathbb{C}$}.
  \end{align*}
\end{theorem}

\begin{remark}
  \label{rmk:24}
  \Cref{thr:27} is analogous to \Cref{thr:20} with $L_{-1}^M$ in place of $T$ and $L_0^M$ in place of $H$.
\end{remark}

Let $V$ be a conformal vertex algebra with conformal vector $\omega$.
It is better to use the notation $(V, \omega)$ for now because of \Cref{rmk:19}.
By \Cref{thr:27}, the following definition makes sense. A $(V, \omega)$-module is a $V$-module $M$ such that $L^M_0$ is diagonalizable, where we write $Y^M(\omega, z) = \sum_{n \in \mathbb{Z}}L^M_nz^{-n - 2}$.
The $(V, \omega)$-modules form a subcategory of $V$-Mod.
In particular, $M$ is a differential module with differential $L^M_{-1}$ and is graded by $L^M_0$.
A $(V, \omega)$-module $M$ is called a \emph{positive energy representation of $(V, \omega)$} if $M = \bigoplus_{n \in \mathbb{N}}M_{h + n}$ for some $h \in \mathbb{C}$, and in this case, we also say that $M$ is $h + \mathbb{N}$-graded.
The subspace $M_h$ is called a \emph{top degree component of $M$}.
When we require $M_h \neq 0$, the number $h$ and the top degree component are well-defined.

\begin{remark}
  \label{rmk:25}
  Let $(V, \omega)$ be a conformal vertex algebra, and let $M_1$ and $M_2$ be $(V, \omega)$-modules.
  A homomorphism $f: M_1 \to M_2$ automatically respects the gradings of $M_1$ and $M_2$ given by $L_0^{M_1}$ and $L_0^{M_2}$.
\end{remark}

Let $V$ be a $\mathbb{Z}$-graded vertex superalgebra.
An \emph{admissible} $V$-module is a $V$-module $M$ together with a grading $M = \bigoplus_{n \in \mathbb{Z}}M(n)$, such that:
\begin{enumerate}
\item $M(n) = 0$ for $n \in \mathbb{Z}_-$;
\item $a^M_{(n)}M(m) \subseteq M(m + \Delta_a - n - 1)$ for $a \in V$ homogeneous and $m, n \in \mathbb{Z}$ or, equivalently, $a^M_nM(m) \subseteq M(m - n)$ for $a \in V$ homogeneous and $m, n \in \mathbb{Z}$.
\end{enumerate}

Thus, an admissible $V$-module is a pair $(M, \bigoplus_{n \in \mathbb{Z}}M(n))$ satisfying the above conditions, though we often omit the grading from the notation.
If $M \neq 0$, we set $n_0 = \min\{n \in \mathbb{N} \mid M(n) \neq 0\}$.
The subspace $M(n_0)$ is called the \emph{top degree component of $M$}.
The top degree component of the zero module $0$ is $0$.

A \emph{homomorphism of admissible $V$-modules} is a homomorphism of $V$-modules, no condition on the grading is imposed.
We have defined the category of admissible $V$-modules, which is abelian.
Arbitrary direct sums of admissible $V$-modules always exist.
We note that shifting the grading of an admissible $V$-module gives an isomorphic admissible $V$-module, and that submodules of admissible $V$-modules are not necessarily graded.
When $M \neq 0$ is an admissible $V$-module, we can always shift the grading so that $M(0) \neq 0$.

A \emph{simple} or \emph{irreducible} admissible $V$-module is an admissible $V$-module $M$ such that $0$ is the only proper graded submodule of $M$.
We note that we ask for graded submodules, not just submodules, in the definition of irreducible.
An object in the category of admissible $V$-modules is \emph{completely reducible} if it is a direct sum of irreducible admissible $V$-modules.
The completely reducible admissible $V$-modules form a full subcategory of the category of admissible $V$-modules.

Let $V$ be a $\mathbb{Z}$-graded conformal vertex algebra, and let $M$ be a module over $V$.
As usual, we write $Y^M(\omega, z) = \sum_{n \in \mathbb{Z}} L^M_nz^{-n - 2}$.
We consider the endomorphism $L^M_0 \in \End(M)$, which in general is not diagonalizable.
By \Cref{lmm:10}(i), we have a direct sum decomposition
\begin{equation*}
  M^{\Gen} = \bigoplus_{\Delta \in \mathbb{C}}M^{\Gen}_{\Delta}.
\end{equation*}
We define
\begin{equation}
  \label{eq:29}
  \begin{split}
    \Lambda^M &= \{\Delta \in \mathbb{C} \mid \text{$M^{\Gen}_{\Delta} \neq 0$ and for $n \in \mathbb{Z}_+$, $M^{\Gen}_{\Delta - n} = 0$}\}, \\
    M^{\Gen}(n) &=
                  \begin{cases}
                    \bigoplus_{\Delta \in \Lambda^M}M^{\Gen}_{\Delta + n} &\text{if $n \ge 0$}; \\
                    0 &\text{if $n < 0$}.
                  \end{cases}
  \end{split}
\end{equation}
We often consider $V$-modules $M$ satisfying the following condition
\begin{equation}
  \label{eq:30}
  \text{for $\Delta \in \mathbb{C}$, there is $N \in \mathbb{N}$ such that for $n \in \mathbb{N}$ with $n \ge N$, $M^{\Gen}_{\Delta - n} = 0$}.
\end{equation}

\begin{proposition}
  \label{prp:10}
  Let $V$ be a $\mathbb{Z}$-graded conformal vertex algebra, and let $M$ be a module over $V$. Then:
  \begin{enumerate}
  \item If $M$ is admissible with grading $\bigoplus_{n \in \mathbb{Z}}M(n)$ such that for $n \in \mathbb{Z}$, $\dim(M(n)) < \infty$, then $M = M^{\Gen}$;
  \item If $a \in V$ is homogeneous, $n \in \mathbb{Z}$ and $u \in M^{\Gen}_{\Delta}$, then $a^M_nu \in M^{\Gen}_{\Delta - n}$;
  \item $M^{\Gen}$ is a submodule of $M$;
  \item If $M$ satisfies \eqref{eq:30}, then $M^{\Gen}$ is an admissible $V$-module with grading given by \eqref{eq:29};
  \item If $f: M_1 \to M_2$ is a homomorphism of $V$-modules, then $f(M^{\Gen}_{1\Delta}) \subseteq M^{\Gen}_{2\Delta}$ for $\Delta \in \mathbb{C}$ and $f(M^{\Gen}_1) \subseteq M^{\Gen}_2$.
  \end{enumerate}
\end{proposition}

\begin{proof}
  We omit superscripts in this proof.
  \begin{enumerate}
  \item For $n \in \mathbb{Z}$, $L_0(M(n)) \subseteq M(n)$.
    By \cite[\S6.8 Theorem 12]{hoffman_linear_1971}, for $n \in \mathbb{Z}$, $M(n) = M(n)^{\Gen}$, and this implies the assertion.
  \item From the formula $[L_0, a_n] = -na_n$ given in \eqref{eq:28}, we inductively get the formula
    \begin{equation*}
      L_0^ka_n = \sum_{j \in \mathbb{N}}\binom{k}{j}(-n)^ja_nL_j^{k - j} \quad \text{for $k \in \mathbb{N}$}.
    \end{equation*}
    By definition, there is $k \in \mathbb{N}$ such that $(L_0 - \Delta\Id_M)^ku = 0$.
    We now compute
    \begin{align*}
      (L_0 - (\Delta - n)\Id_M)^ka_nu &= \left(\sum_{i = 0}^k\binom{k}{i}L_0^{k - i}(-(\Delta - n))^i\Id_M\right)a_nu \\
                                      &= \sum_{i = 0}^k\binom{k}{i}(-(\Delta - n))^iL_0^{k - i}a_nu \\
                                      &= \sum_{i = 0}^k\binom{k}{i}(-(\Delta - n))^i\sum_{j = 0}^{k - i}\binom{k - i}{j}(-n)^ja_nL_0^{k - i - j}u \\
                                      &= a_n\left(\sum_{i = 0}^k\sum_{j = 0}^{k - i}\frac{k!}{i!j!(k - i - j)!}(-(\Delta - n))^i(-n)^jL_0^{k - i - j}u\right) \\
                                      &= a_n((L_0 - (\Delta - n)\Id_M - n\Id_M)^ku) \\
                                      &= a_n((L_0 - \Delta\Id_M)^ku) \\
                                      &= 0.
    \end{align*}
    This means $a_nu \in M^{\Gen}_{\Delta - n}$.
  \item From (ii), we immediately get that $M^{\Gen}$ is a submodule of $M$.
  \item If this condition is satisfied, then we have $M^{\Gen} = \bigoplus_{n \in \mathbb{Z}}M^{\Gen}(n)$.
    From (ii), we get that this grading makes $M^{\Gen}$ into an admissible $V$-module.
  \item This follows straight from the definitions. \qedhere
  \end{enumerate}
\end{proof}
We have constructed a functor
\begin{align*}
  \Gen: \{\text{$V$-modules satisfying \eqref{eq:30}}\} \to \{\text{admissible $V$-modules}\}.
\end{align*}
For a $\mathbb{Z}$-graded vertex algebra $V$, we have a natural forgetful functor
\begin{equation*}
  \For: \{\text{admissible $V$-modules}\} \to \text{$V$-Mod}.
\end{equation*}

\begin{remark}
  \label{rmk:26}
  We followed \cite{dong_twisted_1998} when we defined admissible modules and their homomorphisms.
  In \cite{zhu_modular_1996}, homomorphisms of admissible modules are required to shift the grading by a fixed integer $k$, i.e., a morphism $f: M_1 \to M_2$ between admissible modules $M_1$ and $M_2$ must satisfy $f(M_1(n)) \subseteq M_2(n + k)$ for $n \in \mathbb{Z}$.
  However, with Zhu's definition, direct sums of admissible modules might not exist.
  For example, if $M \neq 0$ is an admissible module, then we may define the admissible module $M'$, which is equal to $M$ but has grading shifted by $1$.
  Then we run into trouble while defining $M \oplus M'$ because the identity map $M \oplus M \to M \oplus M'$ does not shift the grading by a fixed integer.

  Furthermore, our definition of irreducible admissible $V$-module is not the same as the usual definition of irreducible object in an abelian category.
  As we will see in \Cref{sec:zhu-c_2-algebra}, under certain conditions on $V$, both $\Gen$ and $\For$ are equivalences of categories, and an admissible module is irreducible if and only if it is irreducible as an object in the category of $V$-modules.
\end{remark}

Let $V$ be a $\mathbb{Z}$-graded conformal vertex algebra, and let $M$ be a $(V, \omega)$-module.
As usual, we write $Y^M(\omega, z) = \sum_{n \in \mathbb{Z}}L^M_nz^{-n - 2}$.
We say $M$ is \emph{ordinary} if:
\begin{enumerate}
\item $\dim(M_{\Delta}) < \infty$ for $\Delta \in \mathbb{C}$;
\item For $\Delta \in \mathbb{C}$, there is $N \in \mathbb{N}$ such that for $n \in \mathbb{N}$ with $n \ge N$, $M_{\Delta - n} = 0$.
\end{enumerate}
The ordinary $V$-modules form a subcategory of $V$-Mod, and they satisfy \eqref{eq:30}.
By \Cref{prp:10}, we can make an ordinary module into an admissible module.
Thus, we can think of the following inclusions of categories
\begin{equation*}
  \{\text{ordinary $V$-modules}\} \subseteq \{\text{admissible $V$-modules}\} \subseteq \{\text{$V$-modules}\}.
\end{equation*}

A positive energy representation $M$ of the conformal vertex algebra $(V, \omega)$ is ordinary if for $n \in \mathbb{N}$, $\dim(M_{h + n}) < \infty$, where $M_h$ is a top degree component of $M$.
For an ordinary positive energy representation $M$, the \emph{character of $M$} is a formal power series defined by
\begin{equation*}
  \ch_M(q) = \sum_{n \in \mathbb{N}}\dim(M_{h + n})q^{h + n} \in q^h\mathbb{C}[[q]].
\end{equation*}

\begin{example}
  \label{exa:11}
  Let $M$ be a highest weight representation of $\Vir$ with highest weight $(c, h)$ (see \Cref{sec:high-weight-repr} ahead) and highest weight vector $v$.
  Then $M$ is a smooth $\Vir$-module of central charge $c$.
  We note that $L_0$ is diagonalizable.
  By \Cref{thr:25} and \Cref{thr:27}, $M$ is an $h + \mathbb{N}$-graded $(\Vir^c, L_{-2}\vac)$-module.
  We set $M(n) = M_{h + n}$ for $n \in \mathbb{Z}$.
  By \Cref{thr:26}(ii), $M = \bigoplus_{n \in \mathbb{Z}}M(n)$ is an admissible $\Vir^c$-module with top degree component $\mathbb{C}v$.
  Furthermore, $M$ is an ordinary positive energy representation of $\Vir^c$.
\end{example}

Let $V$ be a vertex operator algebra.
We say that $V$ is \emph{rational} if every admissible $V$-module is completely reducible, i.e., a direct sum of simple admissible $V$-modules.
We say that $V$ is \emph{regular} if every $V$-module is a direct sum of simple ordinary $V$-modules.
Regularity is a stronger form of complete reducibility of modules.

The definition of ordinary and admissible modules is similar to that of vertex operator algebras (in the sense that we required them to be lower truncated) except that modules are not required to be $\mathbb{Z}$-graded.
Indeed, one of our objectives is to study $L(1/2, 1/2)$ and $L(1/2, 1/16)$, which are $\mathbb{Q}$-graded.

\begin{theorem}[{\cite{dong_twisted_1998}}]
  \label{thr:28}
  If $V$ is a rational vertex operator algebra, then there are only finitely many simple admissible modules up to isomorphism, and any simple admissible module is an ordinary module.
\end{theorem}

\begin{example}
  \label{exa:12}
  It was proved in \cite{wang_rationality_1993} that when $c$ is of the form $c_{p, q}$ for some $p, q \ge 2$ relatively prime integers, $\Vir_c$ is rational.
  In fact, as we will see in \Cref{thr:44}, a complete list of all the irreducible modules over $\Vir_c$ is given in that article.
  Actually, we will see later that in that case, $\Vir_c$ is regular.
\end{example}

\subsection{Lie algebras associated to vertex algebras}
\label{sec:lie-algebr-assoc}

\begin{lemma}
  \label{lmm:13}
  For a vertex algebra $V$, $V/TV$ is a Lie algebra with bracket
  \begin{equation*}
    [a + TV, b + TV] = a_{(0)}b + TV \quad \text{for $a, b \in V$}.
  \end{equation*}
\end{lemma}

\begin{proof}
  The skewsymmetry of the bracket follows from skewsymmetry of vertex algebras.
  The Jacobi identity follows from \Cref{thr:16}(x) with $m = n = 0$.
\end{proof}

\begin{lemma}
  \label{lmm:14}
  Let $V$ be a vertex algebra, and let $(R, \partial)$ be a differential commutative associative algebra with unit.
  Then
  \begin{equation*}
    \Lie(V, R) = (V \otimes R)/(T\otimes\Id_R + \Id_V\otimes\partial)(V \otimes R)
  \end{equation*}
  is a Lie algebra with bracket
  \begin{equation*}
    [a\otimes r, b\otimes s] = \sum_{j \in \mathbb{N}}a_{(j)}b\otimes\left(\frac{\partial^jr}{j!}\right)s \quad \text{for $a, b \in V$ and $r, s \in R$}.
  \end{equation*}
\end{lemma}

\begin{proof}
  Since $R$ is a commutative vertex algebra (see \Cref{exa:4}), $V \otimes R$ is a vertex algebra with translation operator $T\otimes\Id_R + \Id_V\otimes\partial$.
  The assertion follows by applying \Cref{lmm:13} to the vertex algebra $V \otimes R$.
\end{proof}

The \emph{Borcherds Lie algebra associated with a vertex algebra $V$} is the Lie algebra
\begin{equation*}
  [V] = \Lie(V, \mathbb{C}[t, t^{-1}]),
\end{equation*}
where $\mathbb{C}[t, t^{-1}]$ is viewed as a differential algebra with the derivation $\partial_t$.
For $a \in V$ and $n \in \mathbb{Z}$, let $a(n)$ be the class of $a\otimes t^n \in V \otimes \mathbb{C}[t, t^{-1}]$.
By definition, we have
\begin{align}
  \label{eq:31}
  [a(m), b(n)] &= \sum_{j \in \mathbb{N}}\binom{m}{j}(a_{(j)}b)(m + n - j) \quad \text{for $a, b \in V$ and $m, n \in \mathbb{Z}$}, \\
  \label{eq:32}
  (Ta)(n) &= -na(n - 1) \quad \text{for $a \in V$ and $n \in \mathbb{Z}$}.
\end{align}
We note that these are exactly the same formulas as in \Cref{thr:16}(iii), (v).

Therefore, we have constructed a functor
\begin{equation*}
  [\bullet]: \{\text{Vertex algebras}\} \to \{\text{Lie algebras}\}.
\end{equation*}

\begin{lemma}
  \label{lmm:15}
  Any $V$-module $M$ is a $[V]$-module by setting
  \begin{align*}
    [V] &\to \mathfrak{gl}(M), \\
    a(n) &\mapsto a^M_{(n)} \quad \text{for $a \in V$ and $n \in \mathbb{Z}$}.
  \end{align*}
\end{lemma}

\begin{proof}
  First, this map is well-defined because of \Cref{thr:24}(ii).
  It is a Lie algebra homomorphism because of \Cref{thr:24}(v).
\end{proof}

Therefore, we have constructed a functor
\begin{equation*}
  [\bullet]: \text{$V$-Mod} \to \text{$[V]$-Mod}.
\end{equation*}

We now assume that $V$ is a $\mathbb{Z}$-graded vertex algebra with Hamiltonian $H$.
Then $[V]$ is a graded Lie algebra by defining $H \in \End([V])$ as
\begin{equation*}
  H(a(n)) = -(n + 1)a(n) + (Ha)(n) \quad \text{for $a \in V$ and $n \in \mathbb{Z}$}.
\end{equation*}
This operator is diagonalizable because for $a \in V$ homogeneous and $n \in \mathbb{Z}$, $H(a(n)) = (\Delta_a - n - 1)a(n)$.
This means that
\begin{equation*}
  \Delta_{a(n)} = \Delta_a - n - 1 \quad \text{for $a \in V$ homogeneous and $n \in \mathbb{Z}$}.
\end{equation*}
Moreover, we can verify that $H$ is a derivation of $[V]$.
We have a $\mathbb{Z}$-grading
\begin{equation*}
  [V] = \bigoplus_{n \in \mathbb{Z}}[V]_n
\end{equation*}
and a triangular decomposition
\begin{equation*}
  [V] = [V]_+ \oplus [V]_0 \oplus [V]_-,
\end{equation*}
where
\begin{equation*}
  [V]_{\pm} = \bigoplus_{n \in \mathbb{Z}_+}[V]_{\pm n}.
\end{equation*}

\begin{remark}
  \label{rmk:27}
  We note that $([V], \{\sum_{n \in \mathbb{Z}}a(n)z^{-n - 1}\}_{a \in V}, T)$ is a regular formal distribution Lie algebra.
  I have not found any use of this, though.
\end{remark}

We observe that $[V]_0$ is spanned by elements of the form $a(\Delta_a - 1)$ for $a \in V$ homogeneous, and it is a Lie subalgebra of $[V]$.
By \eqref{eq:31} and \Cref{thr:20}(vi), the bracket in $[V]_0$ is given by
\begin{equation}
  \label{eq:33}
  [a(\Delta_a - 1), b(\Delta_b - 1)] = \sum_{j \in \mathbb{N}}\binom{\Delta_a - 1}{j}(a_{(j)}b)(\Delta_{a_{(j)}b} - 1) \quad \text{for $a, b \in V$ homogeneous}.
\end{equation}

We consider the surjective linear map
\begin{align*}
  \psi: V &\twoheadrightarrow [V]_0, \\
  \psi(a) &= a(\Delta_a - 1).
\end{align*}

\begin{lemma}
  \label{lmm:16}
  We have
  \begin{equation*}
    \ker(\psi) = (T + H)V.
  \end{equation*}
\end{lemma}

\begin{proof}
  If $a \in V$ is homogeneous, then by \Cref{thr:20}(v) and \eqref{eq:32},
  \begin{equation*}
    \psi((T + H)(a)) = \psi(Ta + \Delta_aa) = (Ta)(\Delta_{Ta} - 1) + \Delta_aa(\Delta_a - 1) = (Ta)(\Delta_a) + \Delta_aa(\Delta_a - 1) = 0.
  \end{equation*}
  Thus, $(T + H)V \subseteq \ker(\psi)$.

  We now assume $a = a_m + a_{m + 1} + \dots + a_n \in \ker(\psi)$, where $a_i \in V_i$ for $i = m, m + 1, \dots, n$, $a_m \neq 0$ and $a_n \neq 0$.
  Unwinding the definitions, we see that $a \in \ker(\psi)$ means that there exist $b_r, b_{r + 1}, \dots, b_s \in V$ such that $b_r \neq 0$, $b_s \neq 0$ and
  \begin{equation*}
    a_m\otimes t^{m - 1} + a_{m + 1}\otimes t^m + \dots + a_n\otimes t^{n - 1} = (T\otimes\Id_{\mathbb{C}[t, t^{-1}]} + \Id_V\otimes\partial_t)(b_r\otimes t^r + b_{r + 1}\otimes t^{r + 1} + \dots + b_s\otimes t^s).
  \end{equation*}
  The last equation implies $r \le m$ and $s \ge n - 1$, and it is equivalent to the following system of equations in $V$:
  \begin{align*}
    rb_r &= 0 \\
    Tb_r + (r + 1)b_{r + 1} &= 0 \\
    \dots \\
    Tb_m + (m + 1)b_{m + 1} &= a_m \\
    Tb_{m + 1} + (m + 2)b_{m + 2} &= a_{m + 1} \\
    \dots \\
    Tb_{n - 1} + nb_n &= a_n \\
    \dots \\
    Tb_{s - 1} + sb_s &= 0 \\
    Tb_s &= 0.
  \end{align*}
  For $i = r, r + 1, \dots, s$, let $c_i$ be the component of $b_i$ in $V_i$.
  The last system of equations in $V$ implies:
  \begin{align*}
    Hc_r &= 0 \\
    Tc_r + Hc_{r + 1} &= 0 \\
    \dots \\
    Tc_m + Hc_{m + 1} &= a_m \\
    Tc_{m + 1} + Hc_{m + 2} &= a_{m + 1} \\
    \dots \\
    Tc_{n - 1} + Hc_n &= a_n \\
    \dots \\
    Tc_{s - 1} + Hc_s &= 0 \\
    Tc_s &= 0.
  \end{align*}
  Adding these equations, we get
  \begin{equation*}
    (T + H)(c_r + c_{r + 1} + \dots + c_s) = a_m + a_{m + 1} + \dots + a_n = a,
  \end{equation*}
  which implies $a \in (T + H)V$.
\end{proof}

By \Cref{lmm:16}, we are led to define
\begin{equation*}
  \Lie_0(V) = V/(T + H)V,
\end{equation*}
whose bracket is given by
\begin{equation*}
  [a + (T + H)V, b + (T + H)V] = \sum_{j \in \mathbb{N}}\binom{\Delta_a - 1}{j}a_{(j)}b + (T + H)V \quad \text{for $a, b \in V$}.
\end{equation*}
From what we have done, there is a natural Lie algebra isomorphism
\begin{align*}
  \Lie_0(V) &\xrightarrow{\sim} [V]_0, \\
  a + (T + H)V &\mapsto a(\Delta_a - 1) \quad \text{for $a \in V$ homogeneous},
\end{align*}
and we have another functor
\begin{equation*}
  \Lie_0: \{\text{$\mathbb{Z}$-graded vertex algebras}\} \to \{\text{Lie algebras}\}.
\end{equation*}

\section{Highest weight representations of the Virasoro Lie algebra}
\label{sec:high-weight-repr}

In this section, we start by reviewing some well-known facts about forms on complex vector spaces.
Then, we consider highest weight representations of the Virasoro Lie algebra with particular interest on the Verma modules $M(c, h)$ and the irreducible representations $L(c, h)$.
Afterward, we construct a contravariant form on an arbitrary highest weight representation.
Next, we present the Kac determinant formula, which allows us to determine $L(c, h)$ explicitly by determining the generating singular vectors of the maximal proper subrepresentation of $M(c, h)$.

\subsection{Unitary and contravariant representations of Lie algebras}
\label{sec:unit-contr-repr}

Let $V$ be a vector space.
A (\emph{sesquilinear}) \emph{form on $V$} is a function
\begin{align*}
  \langle \bullet| \bullet\rangle: V \times V &\to \mathbb{C}, \\
  (u, v) &\mapsto \langle u| v\rangle
\end{align*}
such that for $u, v, w \in V$ and $t \in \mathbb{C}$:
\begin{enumerate}
\item $\langle tu + v| w\rangle = \overline{t}\langle u| w\rangle + \langle v| w\rangle$;
\item $\langle u| tv + w\rangle = t\langle u| v\rangle + \langle u| w\rangle$.
\end{enumerate}
All forms are assumed to be sesquilinear.

A \emph{Hermitian} form on $V$ is a form $\langle\bullet| \bullet\rangle$ satisfying
\begin{equation*}
  \langle u| v\rangle = \overline{\langle v| u\rangle} \quad \text{for $u, v \in V$}.
\end{equation*}

Let $S \subseteq V$ be a subset of a vector space $V$ equipped with a form $\langle\bullet| \bullet\rangle$.
We define the \emph{orthogonal complement of $S$} as the subspace
\begin{equation*}
  S^{\perp} = \{v \in V \mid \text{for $u \in S$, $\langle u| v\rangle = 0$}\}.
\end{equation*}

A form $\langle\bullet| \bullet\rangle$ on $V$ is called \emph{nondegenerate} if $V^{\perp} = 0$, and it is called \emph{positive-definite} if it is Hermitian and
\begin{equation*}
  \langle v| v\rangle > 0 \quad \text{for $v \in V$ with $v \neq 0$}.
\end{equation*}
An \emph{inner product space} is a vector space together with a positive-definite form.

\begin{lemma}[{\cite[\S8.2 Theorem 5]{hoffman_linear_1971}}]
  \label{lmm:17}
  Let $V$ be an inner product space, and let $W$ be a finite dimensional subspace of $V$.
  Then $W \oplus W^{\perp} = V$.
\end{lemma}

Let $V$ be a  vector space.
A map $\omega: V \to V$ is \emph{antilinear} if for $u, v \in V$ and $t \in \mathbb{C}$:
\begin{align*}
  \omega(u + v) &= \omega(u) + \omega(v), \\
  \omega(tu) &= \overline{t}\omega(u).
\end{align*}
Let $\mathfrak{g}$ be a Lie algebra.
A map $\omega: \mathfrak{g} \to \mathfrak{g}$ is an antilinear \emph{anti-involution} if $\omega$ is antilinear and for $a, b \in \mathfrak{g}$:
\begin{align*}
  \omega([a, b]) &= [\omega(b), \omega(a)], \\
  \omega(\omega(a)) &= a.
\end{align*}
We note that this means we can extend $\omega$ to the universal enveloping algebra $U(\mathfrak{g})$ of $\mathfrak{g}$, obtaining a map $\omega: U(\mathfrak{g}) \to U(\mathfrak{g})$ that is still an antilinear anti-involution, i.e., for $a, b \in U(\mathfrak{g})$:
\begin{align*}
  \omega(ab) &= \omega(b)\omega(a), \\
  \omega(\omega(a)) &= a.
\end{align*}

We shall be mostly interested in the Virasoro Lie algebra $\Vir$, which has the following antilinear anti-involution
\begin{align*}
  \omega: \Vir &\to \Vir, \\
  \omega(L_n) &= L_{-n} \quad \text{for $n \in \mathbb{Z}$}, \\
  \omega(C) &= C,
\end{align*}
which is extended by antilinearity.

Let $\mathfrak{g}$ be a Lie algebra with an antilinear anti-involution $\omega: \mathfrak{g} \to \mathfrak{g}$, and let $V$ be a $\mathfrak{g}$-module with a Hermitian form $\langle\bullet| \bullet\rangle$.
We say $\langle\bullet| \bullet\rangle$ is \emph{contravariant} if
\begin{equation*}
  \langle au| v\rangle = \langle u| \omega(a)v\rangle \quad \text{for $a \in \mathfrak{g}$ and $u, v \in V$}.
\end{equation*}
We further say this representation is \emph{unitary} if, in addition, it is positive-definite.

\subsection{Verma modules}
\label{sec:verma-modules}

A \emph{highest weight representation} of $\Vir$ is a $\Vir$-module $V$, which has a nonzero vector $v$ such that there exist complex numbers $c, h \in \mathbb{C}$ satisfying:
\begin{enumerate}
\item $Cv = cv$;
\item $L_0v = hv$;
\item $V = \vspan\{L_{-i_k}\dots L_{-i_1}v \mid i_k \ge \dots \ge i_1 > 0\}$.
\end{enumerate}
The numbers $c$ and $h$ are uniquely determined, and the pair $(c, h)$ is called the \emph{highest weight of $V$}.
The vector $v$ is not uniquely determined; it can be replaced by any nonzero scalar multiple of it, and we call $v$ a \emph{highest weight vector of $V$}.

For $\Delta \in \mathbb{C}$, we set $V_{\Delta} = \ker(L_0 - \Delta\Id_V)$.
We observe that all vectors of the form $L_{-i_k}\dots L_{-i_1}v$ with $i_k \ge \dots \ge i_1 > 0$ and a fixed value of $j = i_1 + \dots + i_k$ belong to $V_{h + j}$.
By axiom (iii), $V = \sum_{j \in \mathbb{N}}V_{h + j}$, and by \Cref{lmm:8}, this is in fact a direct sum
\begin{equation}
  \label{eq:34}
  V = \bigoplus_{j \in \mathbb{N}}V_{h + j}.
\end{equation}
By axiom (ii),
\begin{equation*}
  V_h = \mathbb{C}v.
\end{equation*}
We note that
\begin{equation*}
  L_nV_{h + j} \subseteq V_{h + j - n} \quad \text{for $n \in \mathbb{Z}$ and $j \in \mathbb{N}$}.
\end{equation*}
In particular, we have
\begin{equation}
  \label{eq:35}
  L_nv = 0 \quad \text{for $n \in \mathbb{Z}_+$}.
\end{equation}

For $j \in \mathbb{N}$, let $p(j)$ denote the number of partitions of $n$.
It is clear that
\begin{equation}
  \label{eq:36}
  \dim(V_{h + j}) \le p(j) \quad \text{for $j \in \mathbb{N}$},
\end{equation}
with equality if and only if all vectors of the form $L_{-i_k}\dots L_{-i_1}v$, with $i_k \ge \dots \ge i_1 > 0$ and $j = i_1 + \dots + i_k$, are linearly independent.
By axiom (i), $C$ acts on $V$ as multiplication by $c$ because it commutes with every $L_n$ for $n \in \mathbb{Z}$.
Thus, a highest weight representation of $\Vir$ with highest weight $(c, h)$ is necessarily smooth and of central charge $c$.

\begin{lemma}
  \label{lmm:18}
  Let $V$ be a highest weight representation of $\Vir$ with highest weight $(c, h)$, highest weight vector $v$ and grading $V = \bigoplus_{j \in \mathbb{N}}V_{h + j}$.
  Then:
  \begin{enumerate}
  \item Any subrepresentation $U$ of $V$ is graded
    \begin{equation*}
      U = \bigoplus_{j \in \mathbb{N}}U \cap V_{h + j};
    \end{equation*}
  \item $V$ is indecomposable, i.e., we cannot find nontrivial subrepresentations $U, W$ such that
    \begin{equation*}
      V = U \oplus W;
    \end{equation*}
  \item $V$ has a unique maximal proper subrepresentation $J_{\max}$, and $V/J_{\max}$ is the unique irreducible quotient of $V$, which is also a highest weight representation with highest weight $(c, h)$.
  \end{enumerate}
\end{lemma}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item This is \Cref{lmm:9} with $H = L_0$.
  \item We assume we have found such a decomposition.
    Both $U$ and $W$ are graded subrepresentations, and therefore we must have either $v \in U$ or $v \in W$, which implies either $U = V$ or $W = V$.
  \item We just take $J_{\max}$ as the sum of all proper subrepresentations of $V$. \qedhere
  \end{enumerate}
\end{proof}

Let $V$ be a highest weight representation of $\Vir$ with highest weight $(c, h)$.
The \emph{character of $V$} is a formal power series defined by
\begin{equation*}
  \ch_V(q) = \sum_{j \in \mathbb{N}}\dim(V_{h + j})q^{h + j} \in q^h\mathbb{C}[[q]].
\end{equation*}
The character of $V$ satisfies the inequality
\begin{equation*}
  \ch_V(q) \le \frac{q^h}{\prod_{k \in \mathbb{Z}_+}(1 - q^k)}.
\end{equation*}

A \emph{Verma representation} is a highest weight representation of $\Vir$ in which all vectors of the form $L_{-i_k}\dots L_{-i_1}v$, with $i_k \ge \dots \ge i_1 > 0$, are linearly independent.
Since all vectors of the form $L_{-i_k}\dots L_{-i_1}v$, with $i_k \ge \dots \ge i_1 > 0$, in a Verma representation $V$ are linearly independent, it follows that they form a basis of $V$.
Consequently, there is a homomorphism from $V$ to any other highest weight representation of $\Vir$ with the same highest weight $(c, h)$, mapping a highest weight vector to a highest weight vector.
In particular, for any pair $(c, h)$ of complex numbers, there is at most one Verma representation having $(c, h)$ as its highest weight.

We now show we do have a Verma representation for each pair $(c, h)$ of complex numbers using standard Lie algebra techniques.
We set $\Vir_{\ge 0} = \bigoplus_{n \in \mathbb{N}}\mathbb{C}L_n$.
The subalgebra $\Vir_{\ge 0} \oplus \mathbb{C}C$ of $\Vir$ acts on $\mathbb{C}$ as follows:
\begin{equation*}
  \text{$L_n1 = 0$ for $n \in \mathbb{Z}_+$, $L_01 = h$ and $C1 = c$}.
\end{equation*}
Then
\begin{equation*}
  M(c, h) = \Ind^{\Vir}_{\Vir_{\ge 0} \oplus \mathbb{C}C}(\mathbb{C}) = U(\Vir) \otimes_{U(\Vir_{\ge 0} \oplus \mathbb{C}C)} \mathbb{C}
\end{equation*}
is a $\Vir$-module, where $\Vir$ acts by left multiplication.
We set $|c, h\rangle = 1\otimes1$.

For a partition $\lambda = [\lambda_1, \dots, \lambda_m]$, we define
\begin{equation*}
  L_{\lambda} = L_{-\lambda_1}\dots L_{-\lambda_m} \in U(\Vir).
\end{equation*}
By the PBW theorem, the set
\begin{equation*}
  \{L_{\lambda}|c, h\rangle \mid \text{$\lambda$ is a partition}\}
\end{equation*}
is a vector space basis of $M(c, h)$.
Therefore, $M(c, h)$ is a Verma representation of $\Vir$ with highest weight $(c, h)$ and highest weight vector $|c, h\rangle$.
We usually simplify $|c, h\rangle$ to just $|h\rangle$ when $c$ is understood.
By \eqref{eq:36}, the character of a Verma representation is given by
\begin{equation*}
  \ch_{M(c, h)}(q) = \frac{q^h}{\prod_{k \in \mathbb{Z}_+}(1 - q^k)}.
\end{equation*}

Any other highest weight representation $V$ with highest weight $(c, h)$ is a quotient of $M(c, h)$: we simply map $v$ to a highest weight vector of $V$, the resulting homomorphism is surjective, and $V$ is isomorphic to $M(c, h)$ quotiented by the kernel of this homomorphism.

By \Cref{lmm:18}(iii), $M(c, h)$ has a unique maximal proper subrepresentation, denoted by $J(c, h)$.
The quotient
\begin{equation*}
  L(c, h) = M(c, h)/J(c, h)
\end{equation*}
is an irreducible highest weight representation with highest weight $(c, h)$.
Actually, this is the unique irreducible highest weight representation with highest weight $(c, h)$ because if $V$ is such a representation, then $V$ is isomorphic to $M(c, h)/U$ for some proper subrepresentation $U$ of $M(c, h)$ which has to be maximal, implying $U = J(c, h)$.
We wish to determine when is $L(c, h)$ equal to $M(c, h)$.

\begin{lemma}
  \label{lmm:19}
  Let $V$ be a $\Vir$-module.
  If $u \in V$ is nonzero and $L_1u = L_2u = 0$, then $u$ is a singular vector.
\end{lemma}

\begin{proof}
  The condition $L_1u = L_2u = 0$ implies, using induction, that $L_nu = 0$ for $n \ge 3$.
\end{proof}

\begin{remark}
  \label{rmk:28}
  By \eqref{eq:35}, a highest weight vector is singular.
  By \eqref{eq:34}, we can write a singular vector $u$ as $u = \sum_{j \in \mathbb{N}}u_j$, where $u_j \in V_{h + j}$ for $j \in \mathbb{N}$.
  Then all the nonzero vectors $u_j$ are also singular vectors.
  Therefore, we can focus on homogeneous singular vectors.
\end{remark}

\begin{theorem}
  \label{thr:29}
  Let $V$ be a highest weight representation of $\Vir$ with a contravariant form $\langle\bullet| \bullet\rangle$.
  Then all eigenspaces of $L_0$ are pairwise orthogonal.
  Let $U$ be a subrepresentation of $V$.
  Then $U^{\perp}$ is a subrepresentation of $V$.
  Moreover, if $\langle\bullet| \bullet\rangle$ is unitary, then $U \oplus U^{\perp} = V$.
\end{theorem}

\begin{proof}
  Let $(c, h)$ be the highest weight of $V$, and let $v$ be a highest weight vector of $V$.
  We have the decomposition $V = \bigoplus_{j \in \mathbb{N}}V_{h + j}$.
  First, we note that if $j_1 \neq j_2$, then $\langle V_{h + j_1}| V_{h + j_2}\rangle = 0$.
  This is because if $u \in V_{h + j_1}$ and $w \in V_{h + j_2}$, then
  \begin{equation*}
    (\overline{h} + j_1)\langle u| w\rangle = \langle L_0u| w\rangle = \langle u| L_0w\rangle = (h + j_2)\langle u| w\rangle
  \end{equation*}
  which implies $(h - \overline{h} + j_2 - j_1)\langle u| w\rangle = 0$ and $\langle u| w\rangle = 0$.
  We know $\langle U| U^{\perp}\rangle = 0$ and $L_jU \subseteq U$ for $j \in \mathbb{Z}$.
  Then $0 = \langle L_jU| U^{\perp}\rangle = \langle U| L_{-j}U^{\perp}\rangle$ which implies $L_jU^{\perp} \subseteq U^{\perp}$ for $j \in \mathbb{Z}$, so $U^{\perp}$ is a subrepresentation of $V$.
  By \Cref{lmm:18}(i),
  \begin{equation*}
    U^{\perp} = \bigoplus_{j \in \mathbb{N}}U^{\perp} \cap V_{h + j} = \bigoplus_{j \in \mathbb{N}}(U \cap V_{h + j})^{\perp|V_{h + j}},
  \end{equation*}
  where $(U \cap V_{h + j})^{\perp|V_{h + j}}$ denotes the orthogonal subspace of $U \cap V_{h + j}$ in $V_{h + j}$.
  If $\langle\bullet| \bullet\rangle$ is unitary, then by \Cref{lmm:17}, $U \cap V_{h + j} \oplus (U \cap V_{h + j})^{\perp|V_{h + j}} = V_{h + j}$ for $j \in \mathbb{N}$ because all the vector spaces $V_{h + j}$ are finite dimensional.
  It is now clear that $U \oplus U^{\perp} = V$.
\end{proof}

\begin{corollary}
  \label{crl:2}
  A highest weight representation $V$ with a unitary form is irreducible.
\end{corollary}

\begin{proof}
  Let $U$ be a subrepresentation of $V$.
  By \Cref{thr:29}, $U^{\perp}$ is a subrepresentation of $V$ and $U \oplus U^{\perp} = V$.
  By \Cref{lmm:18}(ii), either $U = V$ or $U = 0$.
  We conclude that $V$ is irreducible.
\end{proof}

\subsection{Kac determinant formula and singular vectors}
\label{sec:kac-dete-form}

Let $V$ be a highest weight representation with highest weight $(c, h)$, and we pick a highest weight vector $v$.
We wish to define a contravariant form $\langle\bullet| \bullet\rangle$ on $V$ such that $\langle v| v\rangle = 1$.
We now show we do not have much choice.
Since $V_h = \mathbb{C}v$, it makes sense to define the \emph{expectation value of $u \in V$}, denoted by $\langle u\rangle$, as the coefficient of $u$ with respect to the direct sum $V = \bigoplus_{j \in \mathbb{N}}V_{h + j}$, i.e., as the unique $t \in \mathbb{C}$ such that $u - tv \in \bigoplus_{j \in \mathbb{Z}_+}V_{h + j}$.
We consider $L_{\lambda} \in U(\Vir)$ for a partition $\lambda$ and $u \in V$.
By contravariance, we must have $\langle L_{\lambda}v| u\rangle = \langle v| \omega(L_{\lambda})u\rangle$.
But $\langle v| \omega(L_{\lambda})u\rangle = \langle\omega(L_{\lambda})u\rangle$ because all eigenspaces of $L_0$ are pairwise orthogonal by \Cref{thr:29}.
Therefore, if $\langle\bullet| \bullet\rangle$ is a contravariant Hermitian nonzero form on $V$ such that $\langle v| v\rangle = 1$, we are forced to have
\begin{equation}
  \label{eq:37}
  \langle L_{\lambda}v| u\rangle = \langle\omega(L_{\lambda})u\rangle \quad \text{for a partition $\lambda$ and $u \in V$}.
\end{equation}

Contravariance of $\langle\bullet| \bullet\rangle$ and \eqref{eq:37} impose conditions on the highest weight $(c, h)$.
Let $a \in U(\Vir)$.
Then
\begin{equation*}
  \overline{\langle av\rangle} = \overline{\langle\omega(\omega(a))v\rangle} = \overline{\langle\omega(a)v| v\rangle} = \langle v| \omega(a)v\rangle = \langle av| v\rangle = \langle\omega(a)v\rangle.
\end{equation*}
Taking $a = C$ and $a = L_0$, we obtain $c, h \in \mathbb{R}$.

We note, however, that initially we cannot define the form using \eqref{eq:37} for a general highest weight representation because there may be linear dependences between terms of the form $L_{\lambda}v$ for partitions $\lambda$, so we may ask if it is well-defined in the first place.
That is only possible for $M(c, h)$, and later we will see that it is also possible for any highest weight representation.

\begin{theorem}[{\cite[Proposition 3.4]{kac_bombay_2013}}]
  \label{thr:30}
  Let $M(c, h)$ be the Verma representation of $\Vir$ with highest weight $(c, h)$, where $c, h \in \mathbb{R}$.
  We pick a highest weight vector $v$, and we define the form $\langle\bullet| \bullet\rangle$ on $M(c, h)$ using equation \eqref{eq:37}.
  Then:
  \begin{enumerate}
  \item $\langle\bullet| \bullet\rangle$ is a contravariant Hermitian form on $M(c, h)$ such that $\langle v| v\rangle = 1$.
  \item The eigenspaces of $L_0$ are pairwise orthogonal.
  \item $M(c, h)^{\perp} = J(c, h)$.
  \item Let $V$ be a highest weight representation with highest weight vector $v'$.
    There is a unique contravariant form $\langle\bullet| \bullet\rangle$ on $V$ such that $\langle v'| v'\rangle = 1$ and is defined by equation \eqref{eq:37} with $v'$ in place of $v$.
    This form satisfies properties \emph{(i)--(iii)} of this Theorem.
    If we pick other highest weight vector, the resulting contravariant form is the previously defined form times a nonzero constant.
    In particular, for $L(c, h)$, this form is nondegenerate.
  \end{enumerate}
\end{theorem}

Let $V$ be a highest weight representation with highest weight $(c, h)$, where $c, h \in \mathbb{R}$, and we pick a highest weight vector $v$.
Let $\langle\bullet| \bullet\rangle$ be the contravariant form on $V$ defined by \eqref{eq:37}.
We say $V$ is \emph{unitary} if this form is unitary.
By \Cref{thr:30}, this is independent of the choice of the highest weight vector $v$, and there is essentially one form.
By \Cref{crl:2}, a unitary highest weight representation is necessarily irreducible, and it is of the form $L(c, h)$ for some real numbers $c, h \in \mathbb{R}$.
We wish to study when is $L(c, h)$ unitary.
A simple necessary condition is given by the next theorem.

\begin{theorem}
  \label{thr:31}
  If $L(c, h)$ is unitary then $c \ge 0$ and $h \ge 0$.
\end{theorem}

\begin{proof}
  We pick a highest weight vector $v$ and assume $\langle v| v\rangle = 1$.
  A necessary condition for unitarity is that
  \begin{equation*}
    c_n = \langle L_{-n}v| L_{-n}v\rangle > 0 \quad \text{for $n \in \mathbb{N}$}.
  \end{equation*}
  But contravariance and the commutation rules of Virasoro show that
  \begin{equation}
    \label{eq:38}
    c_n = 2nh + c(n^3 - n)/12.
  \end{equation}
  Putting $n = 1$, we get $c_1 = 2h$ so that we must have $h \ge 0$.
  Moreover, \eqref{eq:38} shows that $c_n$ is dominated by $cn^3$ for large $n$, so that $c \ge 0$ is also necessary.
\end{proof}

Let $M(c, h)$ be the Verma representation with highest weight $(c, h)$.
For $n \in \mathbb{N}$, the subspace $M(c, h)_{h + n}$ is finite dimensional.
Therefore, we can consider the determinant $\det_n(c, h)$ of the contravariant Hermitian form $\langle\bullet| \bullet\rangle$ restricted to $M(c, h)_{h + n}$.
This is well-defined up to a nonzero constant.

\begin{theorem}
  \label{thr:32}
  The Verma representation $M(c, h)$ is irreducible if and only if for $n \in \mathbb{Z}_+$, $\det_n(c, h) \neq 0$.
\end{theorem}

\begin{proof}
  By \Cref{thr:30}, $M(c, h)$ is irreducible if and only if $M(c, h)^{\perp} = 0$.
  By \Cref{thr:29}, $M(c, h)^{\perp} = \bigoplus_{j \in \mathbb{N}}M(c, h)^{\perp} \cap M(c, h)_{h + j} = \bigoplus_{j \in \mathbb{N}}M(c, h)_{h + j}^{\perp}$.
  Therefore, $M(c, h)$ is irreducible if and only if for $j \in \mathbb{N}$, $M(c, h)_{h + j}^{\perp} = 0$, which is equivalent to for $n \in \mathbb{Z}_+$, $\det_n(c, h) \neq 0$.
\end{proof}

Thus, to determine when $M(c, h)$ is irreducible, it is worthwhile to study the number $\det_n(c, h)$ for $n \in \mathbb{N}$.
Fortunately, there is a formula for this.

\begin{theorem}[Kac determinant formula {\cite[Theorem 4.2]{iohara_representation_2011}}]
  \label{thr:33}
  For $n \in \mathbb{N}$,
  \begin{equation*}
    \textstyle\det_n(c, h) = \displaystyle\text{constant}\cdot\prod_{\substack{k, l \in \mathbb{Z}_+ \\ k \ge l \\ 1 \le kl \le n}}\phi_{k, l}(c, h)^{p(n - kl)},
  \end{equation*}
  where
  \begin{equation*}
    \phi_{k, l}(c, h) =
    \begin{cases}
      (h + \frac{(k^2 - 1)(c - 13)}{24} + \frac{kl - 1}{2})(h + \frac{(l^2 - 1)(c - 13)}{24} + \frac{kl - 1}{2}) + \frac{(k^2 - l^2)^2}{16} &\text{if $k \neq l$};\\
      h + \frac{(k^2 - 1)(c - 13)}{24} + \frac{k^2 - 1}{2} &\text{if $k = l$}.
    \end{cases}
  \end{equation*}
\end{theorem}

\begin{remark}
  \label{rmk:29}
  Using Kac determinant formula, it is possible to prove that $L(1/2, h)$ unitary implies $h = 0$, $1/2$ or $1/16$ (see \cite[\S3]{kac_bombay_2013}).
  This is one of the reasons we study $L(1/2, 1/2)$ and $L(1/2, 1/16)$ in this thesis.
\end{remark}

We will need to find the maximal proper submodules of $M(1/2, 1/2)$ and $M(1/2, 1/16)$ explicitly.
Kac determinant formula also helps with this, allowing us to compute $J(c, h)$ for rational numbers $c$ and $h$.

It turns out that $J(c, h)$ is generated by at most two singular vectors, which can be computed explicitly for isolated cases.
It is always possible to write (nonuniquely)
\begin{equation*}
  c = \frac{(3r + 2s)(3s + 2r)}{rs}, h = \frac{(r + s)^2 - t^2}{4rs}
\end{equation*}
for some $r, s \in \mathbb{C} \setminus \{0\}$ and $t \in \mathbb{C}$.
Then
\begin{equation*}
  \phi_{k, l}(c, h) =
  \begin{cases}
    \frac{(rk + sl + t)(sk + rl + t)(rk + sl - t)(sk + rl - t)}{rs} &\text{if $k \neq l$};\\
    \frac{(rk + sk + t)(rk + sk - t)}{4rs} &\text{if $k = l$}.
  \end{cases}
\end{equation*}

Therefore, to find singular vectors in $M(c, h)$, we have to study integral solutions to the linear equation $rk + sl + t = 0$.
This line is real if and only if $c \le 1$ or $c \ge 25$.
Let $l_{c, h}$ denote the solutions to this linear equation.

\begin{theorem}[{\cite{astashkevich_structure_1997}}]
  \label{thr:34}
  Let $c$ and $h$ be real numbers such that $c \le 1$ or $c \ge 25$.
  The integral points (the points in $\mathbb{Z}^2$) of $l_{c, h}$ determine the maximal proper subrepresentation of $M(c, h)$ completely according to the following three cases:
  \begin{description}[leftmargin = !]
  \item[Case I] The line $l_{c, h}$ contains no integral points.
    In this case, $J(c, h) = 0$.
  \item[Case II] The line $l_{c, h}$ contains exactly one integral point $(k, l)$.
    We have three subcases:
    \begin{description}[leftmargin = !]
    \item[Subcase II$_+$] The product $kl > 0$.
      Let $u$ be a singular vector in $M(c, h + kl)$.
      Then $J(c, h) = U(\Vir)\{u\}$.
    \item[Subcase II$_0$] The product $kl = 0$.
      In this subcase, $J(c, h) = 0$.
    \item[Subcase II$_-$] The product $kl < 0$.
      In this subcase, $J(c, h) = 0$.
    \end{description}
  \item[Case III] The line $l_{c, h}$ contains infinitely many integral points.
    Let $(k_1, l_1), (k_2, l_2), \dots$ be all integral points on the line $l_{c, h}$ up to equivalence relation $(k, l)\sim(k', l')$ if and only if $kl = k'l'$ and such that $kl > 0$.
    We ordered them in such a way that $k_il_i < k_{i + 1}l_{i + 1}$ for $i \in \mathbb{Z}_+$.
    We have two subcases:
    \begin{description}[leftmargin = !]
    \item[Subcase $c \le 1$] We have three subsubcases:
      \begin{description}[leftmargin = !]
      \item[Subsubcase III$^{00}_-$] Line $l_{c, h}$ intersects both axes at integral points.
        Let $u$ be a singular vector in $M(c, h + k_1l_1)$.
        Then $J(c, h) = U(\Vir)\{u\}$.
      \item[Subsubcase III$^0_-$] Line $l_{c, h}$ intersects only one axis at an integral point.
        Let $u$ be a singular vector in $M(c, h + k_1l_1)$.
        Then $J(c, h) = U(\Vir)\{u\}$.
      \item[Subsubcase III$_-$] Line $l_{c, h}$ intersects both axes at nonintegral points.
        Let $u$ and $w$ be singular vectors in $M(c, h + k_1l_1)$ and $M(c, h + k_2l_2)$, respectively.
        Then $J(c, h) = U(\Vir)\{u, w\}$.
      \end{description}
    \item[Subcase $c \ge 25$] We have three subsubcases:
      \begin{description}[leftmargin = !]
      \item[Subsubcase III$^{00}_+$] Line $l_{c, h}$ intersects both axes at integral points.
        Let $u$ be a singular vector in $M(c, h + k_1l_1)$.
        Then $J(c, h) = U(\Vir)\{u\}$.
      \item[Subsubcase III$^0_+$] Line $l_{c, h}$ intersects only one axis at an integral point.
        Let $u$ be a singular vector in $M(c, h + k_1l_1)$.
        Then $J(c, h) = U(\Vir)\{u\}$.
      \item[Subsubcase III$_+$] Line $l_{c, h}$ intersects both axes at nonintegral points.
        Let $u$ and $w$ be singular vectors in $M(c, h + k_1l_1)$ and $M(c, h + k_2l_2)$, respectively.
        Then $J(c, h) = U(\Vir)\{u, w\}$.
      \end{description}
    \end{description}
  \end{description}
\end{theorem}

\begin{remark}
  \label{rmk:30}
  \Cref{thr:33} gives us an algorithm to find $J(c, h)$ for a given highest weight $(c, h)$, with $c, h$ rational numbers.
  We merely need to find the levels at which the singular vectors that generate $J(c, h)$ lie, and then by \Cref{lmm:19}, we have to solve the linear equations $L_1u = L_2 u = 0$ assuming $u$ lies in the right level to obtain our desired singular vector.
\end{remark}

\begin{remark}
  \label{rmk:31}
  For $c \in \mathbb{C}$, $\Vir^c = M(c, 0)/U(\Vir)\{L_{-1}\vac\}$ and $\Vir_c = L(c, 0)$ because by \Cref{rmk:23}, the ideals of $\Vir^c$ are in bijection with the submodules of $M(c, 0)/U(\Vir)\{L_{-1}\vac\}$.
  If $c = c_{p, q}$ for some $p, q \ge 2$ relatively prime integers, then the singular vector of $\Vir^c$ can be computed by solving the linear equation $L_1u = L_2u = 0$ for $u \in \Vir^c_{(p - 1)(q - 1)}$ (see \Cref{thr:23}, \Cref{lmm:19} and \Cref{thr:45} ahead).
\end{remark}

One of the objectives of this thesis is to find a PBW basis of $L(1/2, 1/2)$ and $L(1/2, 1/16)$ similar to what was done for the Ising model $\Vir_{3, 4} = L(1/2, 0)$ in \cite{andrews_singular_2022}.
The $\Vir$-modules $L(1/2, 1/2)$ and $L(1/2, 1/16)$ are not vertex algebras, but they are modules (vertex algebra modules) over both $\Vir^{1/2}$ and $\Vir_{3, 4}$, as we will see later.

\begin{remark}
  \label{rmk:32}
  The irreducible highest weight representations $L(1/2, 1/2)$ and $L(1/2, 1/16)$ can be constructed explicitly as the even or odd part of some induced representations, without using Verma representations and passing to the quotient as was done here (cf.\ \cite[\S3]{kac_bombay_2013}).
  Moreover, $L(1/2, 1/2)$ is isomorphic to $F_{\one}$, where $F = F(\mathbb{C}a)$ is the fermionic vertex superalgebra associated to a purely odd one dimensional superspace $\mathbb{C}a$ with an antisupersymmetric form defined by $\langle a| a\rangle = 1$ (see \Cref{exa:10}).
\end{remark}

\section{Modules over the simple Virasoro vertex algebras}
\label{sec:modules-over-simple}

In this section, the objective is to describe the irreducible admissible modules over $\Vir^c$ and $\Vir_c$.
To do that, we first study the Zhu algebra $\Zhu(V)$ of a $\mathbb{Z}$-graded vertex algebra $V$ introduced in \cite{zhu_modular_1996}.
This naturally leads to a functor $\Omega: \text{$V$-Mod} \to \text{$\Zhu(V)$-Mod}$.
Next, we construct an inverse $L: \text{$\Zhu(V)$-Mod} \to \{\text{admissible $V$-modules}\}$ of the functor $\Omega$ using the associated Lie algebras of a vertex algebra constructed in \Cref{sec:lie-algebr-assoc}.
We end this section by describing the irreducible admissible modules over $\Vir^c$ and $\Vir_c$ explicitly in terms of the irreducible highest weight representations $L(c, h)$ for certain values of $h$.

\subsection{The Zhu algebra}
\label{sec:zhu-algebra}

Let $V$ be a $\mathbb{Z}$-graded vertex algebra with Hamiltonian $H$.
First, we define two operations on $V$.
For $a, b \in V$ with $a$ homogeneous, we set:
\begin{align*}
  a\circ b &= \res_z\left(\frac{(1 + z)^{\Delta_a}}{z^2}Y(a, z)b\right) \in V, \\
  a*b &= \res_z\left(\frac{(1 + z)^{\Delta_a}}{z}Y(a, z)b\right) \in V.
\end{align*}
We extend these operations linearly to obtain bilinear products on $V$, and we define
\begin{equation*}
  O(V) = \vspan\{a\circ b \mid a, b \in V\}.
\end{equation*}

\begin{lemma}
  \label{lmm:20}
  For $a, b \in V$:
  \begin{enumerate}
  \item $a\circ\vac = (T + H)a$;
  \item $a*\vac = a$;
  \item $(T + H)V \subseteq O(V)$.
  \end{enumerate}
\end{lemma}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item We just expand the definition of $a\circ\vac$ recalling that $Ta = a_{(-2)}\vac$ and $Ha = \Delta_aa$ when $a$ is homogeneous.
  \item Again, we just expand the definition recalling that $a = a_{(-1)}\vac$.
  \item This follows from (i). \qedhere
  \end{enumerate}
\end{proof}

\begin{lemma}[{\cite[Lemma 2.2]{dong_twisted_1998}}]\leavevmode
  \label{lmm:21}
  \begin{enumerate}
  \item We assume $a \in V$ is homogeneous, $b \in V$ and $m \ge n \ge 0$.
    Then
    \begin{equation*}
      \res_z\left(\frac{(1 + z)^{\Delta_a + n}}{z^{m + 2}}Y(a, z)b\right) \in O(V).
    \end{equation*}
  \item We assume $a, b \in V$ are homogeneous.
    Then
    \begin{equation*}
      a*b - \res_z\left(\frac{(1 + z)^{\Delta_b - 1}}{z}Y(b, z)a\right) \in O(V).
    \end{equation*}
  \item We assume $a \in V$ is homogeneous.
    Then
    \begin{equation*}
      a*b - b*a - \res_z((1 + z)^{\Delta_a - 1}Y(a, z)b) \in O(V).
    \end{equation*}
  \end{enumerate}
\end{lemma}

\begin{theorem}[{\cite[Proposition 2.3 and Theorem 2.4]{dong_twisted_1998}}]
  \label{thr:35}
  Let $V$ be a $\mathbb{Z}$-graded vertex algebra.
  Then $O(V)$ is a two-sided ideal of $V$ under the operation $*$, and $V/O(V)$ becomes an associative algebra with unit $\vac + O(V)$.
\end{theorem}

The quotient
\begin{equation*}
  \Zhu(V) = V/O(V)
\end{equation*}
is called the \emph{Zhu algebra of $V$}.
The Zhu algebra is closely related to the Borcherds Lie algebra, as the following theorem shows.

\begin{theorem}
  \label{thr:36}
  Let $V$ be a $\mathbb{Z}$-graded vertex algebra.
  The following map
  \begin{align*}
    [V]_0 &\to [\Zhu(V)], \\
    a(\Delta_a - 1) &\mapsto a + O(V) \quad \text{for $a \in V$ homogeneous}
  \end{align*}
  defines an epimorphism of Lie algebras.
\end{theorem}

\begin{proof}
  We know $\Lie_0(V)$ is isomorphic to $[V]_0$ (see \Cref{sec:lie-algebr-assoc}) and by \Cref{lmm:20}(iii), there is a natural linear epimorphism
  \begin{align*}
    \Lie_0(V) &\twoheadrightarrow [\Zhu(V)], \\
    a + (T + H)V &\mapsto a + O(V).
  \end{align*}
  It remains to show this is a Lie algebra homomorphism.
  Let $a, b \in V$ with $a$ homogeneous.
  By \Cref{lmm:21}(iii) and the definition of the bracket of $\Lie_0(V)$, we have
  \begin{align*}
    [a + (T + H)V, b + (T + H)V] &= \sum_{j \in \mathbb{N}}\binom{\Delta_a - 1}{j}a_{(j)}b + (T + H)V \\
                                 &\mapsto \sum_{j \in \mathbb{N}}\binom{\Delta_a - 1}{j}a_{(j)}b + O(V) \\
                                 &= \res_z((1 + z)^{\Delta_a - 1}Y(a, z)b) + O(V) \\
                                 &= a*b - b*a + O(V) \\
                                 &= [a + O(V), b + O(V)]. \qedhere
  \end{align*}
\end{proof}

We still assume $V$ is a $\mathbb{Z}$-graded vertex algebra.
We recall from \Cref{sec:lie-algebr-assoc} that $[V]$ is a $\mathbb{Z}$-graded Lie algebra with a triangular decomposition $[V] = [V]_+ \oplus [V]_0 \oplus [V]_-$.
Let $W$ be a $[V]$-module.
We denote by $\Omega(W)$ the subspace of \emph{lowest weight vectors of $W$} with respect to the triangular decomposition of $[V]$, that is,
\begin{equation*}
  \Omega(W) = \{u \in W \mid [V]_-u = 0\}.
\end{equation*}
If $M$ is a $V$-module, then by \Cref{lmm:15}, $[M]$ is a $[V]$-module, and we define the subspace of \emph{lowest weight vectors of $M$} as
\begin{equation*}
  \Omega(M) = \Omega([M]).
\end{equation*}
By \eqref{eq:20}, we have
\begin{equation*}
  \Omega(M) = \{u \in M \mid \text{for $a \in V$ homogeneous and $n \in \mathbb{Z}_+$, $a_nu = 0$}\}.
\end{equation*}
One of the most important properties of the Zhu algebra is that it simplifies the theory of representations of vertex algebras, as the following theorem shows.

\begin{theorem}[{\cite[Theorem 5.3]{dong_twisted_1998}}]
  \label{thr:37}
  Let $V$ be a $\mathbb{Z}$-graded vertex algebra, and let $M$ be a $V$-module.
  Then the following map
  \begin{align*}
    \Zhu(V) &\to \End(\Omega(M)), \\
    a + O(V) &\mapsto a^M_0 = a^M_{(\Delta_a - 1)} \quad \text{for $a \in V$ homogeneous}
  \end{align*}
  defines a $\Zhu(V)$-module structure on $\Omega(M)$.
\end{theorem}

Because our constructions are natural, it is evident that we have constructed a functor
\begin{equation*}
  \Omega: \text{$V$-Mod} \to \text{$\Zhu(V)$-Mod}.
\end{equation*}
To be more precise, if $f: M_1 \to M_2$ is a homomorphism of $V$-modules, then $[f]: [M_1] \to [M_2]$ is a homomorphism of $[V]$-modules.
This implies that $\Omega(M_1) \subseteq \Omega(M_2)$.
Therefore, we can define $\Omega(f) = f|_{\Omega(M_1)}: \Omega(M_1) \to \Omega(M_2)$, which is evidently a $\Zhu(V)$-module homomorphism.

\begin{example}
  \label{exa:13}
  If $V = \Vir^c$, and $M$ is a $\Vir^c$-module, then
  \begin{equation*}
    \Omega(M) = \{u \in M \mid \text{for $n \in \mathbb{Z}_+$, $L_nu = 0$}\}
  \end{equation*}
  is the subspace of singular vectors of $M$.
\end{example}

\begin{theorem}[{\cite[Proposition 5.4]{dong_twisted_1998}}]
  \label{thr:38}
  Let $V$ be a $\mathbb{Z}$-graded vertex algebra, and let $M$ be an irreducible admissible $V$-module.
  Then:
  \begin{enumerate}
  \item $\Omega(M) = M(0)$;
  \item $\Omega(M)$ is an irreducible $\Zhu(V)$-module.
  \end{enumerate}
\end{theorem}

\subsection{The inverse of the lowest weight subspace functor}
\label{sec:inverse-lowes-weight}

Our objective is to construct an inverse of some sort of the functor $\Omega$.
However, it turns out that this is not possible, and we have to restrict $\Omega$ to the full subcategory of completely reducible objects.

Given the $\Zhu(V)$-module $U$, it is a fortiori a module over the Lie algebra $[\Zhu(V)]$.
Thanks to \Cref{thr:36}, we can consider $U$ as a module over the Lie algebra $[V]_0$, and then $U$ is a module over the Lie algebra $[V]_- \oplus [V]_0$ by letting $[V]_-$ act trivially.
Thus, we define
\begin{equation*}
  M(U) = \Ind^{[V]}_{[V]_- \oplus [V]_0}(U) = U([V]) \otimes_{U([V]_- \oplus [V]_0)} U.
\end{equation*}

We recall from \Cref{sec:lie-algebr-assoc} that $H$ is a derivation of $[V]$.
The operator $DU(H) \in \End(U([V]))$ is diagonalizable and makes $U([V])$ into a $\mathbb{Z}$-graded associative algebra.
This means
\begin{equation*}
  U([V])_mU([V])_n \subseteq U([V])_{m + n} \quad \text{for $m, n \in \mathbb{Z}$},
\end{equation*}
where the subindex denotes the respective eigenspace, as usual.
We consider the operator
\begin{equation*}
  H^{M(U)} = DU(H)\otimes\Id_U \in \End(M(U)).
\end{equation*}
We can verify that $H^{M(U)}$ is diagonalizable and makes $M(U)$ into a $\mathbb{Z}$-graded $[V]$-module with grading
\begin{equation*}
  M(U) = \bigoplus_{n \in \mathbb{Z}}M(U)_n
\end{equation*}
such that $M(U)_n = 0$ if $n < 0$.
This means that
\begin{equation*}
  [V]_mM(U)_n \subseteq M(U)_{m + n} \quad \text{for $m, n \in \mathbb{Z}$}.
\end{equation*}
The PBW theorem implies that
\begin{equation*}
  M(U)_n = U([V])_nU
\end{equation*}
and, in particular,
\begin{equation*}
  M(U)_0 = U.
\end{equation*}

Taking a hint from \Cref{lmm:15}, we define
\begin{equation*}
  Y^{M(U)}(a, z) = \sum_{n \in \mathbb{Z}}a(n)z^{-1 - n} \in \mathcal{F}(M(U)) \quad \text{for $a \in V$},
\end{equation*}
where $a(n) \in [V]$ acts on $M(U)$ by left multiplication.
We want $M(U)$ becoming an admissible $V$-module by setting
\begin{equation*}
  M(U)(n) = M(U)_n \quad \text{for $n \in \mathbb{Z}$}.
\end{equation*}
However, we are not done yet because all the conditions in \Cref{prp:9} are met except \eqref{eq:25}.
Therefore, we need to divide by the respective relations.

In the following, we let $U^* = \Hom_{\mathbb{C}}(U, \mathbb{C})$ and extend $U^*$ to $M(U)$ by letting $U^*$ annihilate $\bigoplus_{n \in \mathbb{Z}_+}M(U)(n)$.
We now define:
\begin{align*}
  J &= \{u \in M(U) \mid \text{for $u' \in U^*$ and $x \in U([V])$, $\langle u', xu\rangle = 0$}\}, \\
  L(U) &= M(U)/J,
\end{align*}
and let the grading of $L(U)$ and $Y^{L(U)}$ be inherited from $M(U)$ in the obvious way.

\begin{theorem}[{\cite[Theorem 6.3]{dong_twisted_1998}}]
  \label{thr:39}
  With notation as above, $L(U)$ is an admissible $V$-module, and we have defined a functor
  \begin{equation*}
    L: \text{\emph{$\Zhu(V)$-Mod}} \to \{\text{\emph{admissible $V$-modules}}\}
  \end{equation*}
  such that $\Omega\circ L$ is naturally equivalent to the identity.
\end{theorem}

\begin{remark}
  \label{rmk:33}
  Since $U([V])U = M(U)$, we see that $U([V])U = L(U)$.
  This implies that $L(U)$ is strongly generated by $U$ as a vertex algebra.
\end{remark}

At this point, we have a pair of functors $\Omega, L$ defined on appropriate module categories
\begin{equation*}
  \begin{tikzcd}
    \text{$\Zhu(V)$-Mod} \arrow[r, "L", shift left] & \{\text{admissible $V$-modules}\} \arrow[l, "\Omega", shift left]
  \end{tikzcd}
\end{equation*}
Although $\Omega\circ L$ is equivalent to the identity, one cannot expect that $L\circ\Omega$ is also equivalent to the identity in general.
This is essentially because there are examples of $\mathbb{Z}$-graded vertex algebras $V$ for which the category of admissible $V$-modules contains objects which are not completely reducible.

\begin{lemma}[{\cite[Lemma 7.1]{dong_twisted_1998}}]
  \label{lmm:22}
  Suppose that $U$ is an irreducible $\Zhu(V)$-module.
  Then $L(U)$ is an irreducible admissible $V$-module.
\end{lemma}

\begin{theorem}[{\cite[Theorem 7.2]{dong_twisted_1998}}]
  \label{thr:40}
  $L$ and $\Omega$ are equivalences when restricted to the full subcategories of completely reducible $\Zhu(V)$-modules and completely reducible admissible $V$-modules respectively.
  In particular, $L$ and $\Omega$ induces mutually inverse bijections on the isomorphism classes of irreducible objects in the category of $\Zhu(V)$-modules and admissible $V$-modules respectively.
\end{theorem}

\begin{remark}
  \label{rmk:34}
  The functor $L$ plays well with vertex algebra homomorphism.
  To elaborate a bit more, let $f: V_1 \to V_2$ be a homomorphism of $\mathbb{Z}$-graded vertex algebras.
  We naturally define the functors $\circ f: \text{$V_2$-Mod} \to \text{$V_1$-Mod}$ and $\circ \Zhu(f): \text{$\Zhu(V_2)$-Mod} \to \text{$\Zhu(V_1)$-Mod}$.
  Then the following diagram of functors commutes
  \begin{equation*}
    \begin{tikzcd}
      \text{$\Zhu(V_2)$-Mod} \arrow[r, "L_{V_2}"] \arrow[d, "\circ \Zhu(f)"] & \{\text{completely reducible admissible $V_2$-modules}\} \arrow[d, "\circ f"] \\
      \text{$\Zhu(V_1)$-Mod} \arrow[r, "L_{V_1}"]                           & \{\text{completely reducible admissible $V_1$-modules}\}
    \end{tikzcd}
  \end{equation*}
  By commuting, we mean that the functors $\circ f \circ L_{V_2}$ and $L_{V_1} \circ(\circ\Zhu(f))$ are isomorphic.
\end{remark}

\begin{remark}
  \label{rmk:35}
  In some articles such as \cite[\S2]{de_sole_finite_2006}, the functor $\Omega$ is defined as $\Omega(M) = M(0)$, where $M$ is an admissible $V$-module.
  There are some difficulties with this approach:
  \begin{enumerate}
  \item This is not even a functor.
    For example, if $V = \Vir^{1/2}$, $N = U(\Vir)\{a_{3, 4}\}$ and $\inc: N \hookrightarrow V$ is the inclusion, there is no sensible way of defining $\Omega(\inc)$ if $\Omega(M) = M(0)$.
    On the other hand, if we use the definition of $\Omega$ given in \cite{dong_twisted_1998}, the problem disappears (see \Cref{exa:13}).
  \item It is slightly less general because \cite{dong_twisted_1998} defines $\Omega(M)$ when $M$ is any $V$-module (called weak $V$-module there).
  \end{enumerate}
\end{remark}

\begin{remark}
  \label{rmk:36}
  It is not necessary to consider conformal vertex algebras to do the theory of the Zhu algebra, $\mathbb{Z}$-graded vertex algebras are enough.
\end{remark}

\subsection{Modules over the Virasoro vertex algebras}
\label{sec:modul-over-viras}

We wish to determine all irreducible admissible modules over both $\Vir^c$ and $\Vir_c$.
This is why we studied the Zhu algebra.
We start with $\Vir^c$, which is easier.

\begin{theorem}[{\cite{wang_rationality_1993}}]
  \label{thr:41}
  For $c \in \mathbb{C}$, we have the following isomorphism of algebras
  \begin{align*}
    \Zhu(\Vir^c) &\xrightarrow{\sim} \mathbb{C}[x], \\
    L_{-2}\vac + O(\Vir^c) &\mapsto x.
  \end{align*}
\end{theorem}

\begin{theorem}
  \label{thr:42}
  For $c \in \mathbb{C}$, the irreducible admissible modules over $\Vir^c$ are $L(c, h)$ for $h \in \mathbb{C}$.
\end{theorem}

\begin{proof}
  The irreducible modules over $\mathbb{C}[x]$ are $\mathbb{C}_h = \mathbb{C}$ for $h \in \mathbb{C}$, where $x$ acts by multiplication by $h$.
  By \Cref{thr:40} and \Cref{thr:41}, the irreducible admissible modules over $\Vir^c$ are $L(\mathbb{C}_h)$ for $h \in \mathbb{C}$.
  By \Cref{thr:27}, for $h \in \mathbb{C}$, $L(\mathbb{C}_h)$ is a smooth $\Vir$-module of central charge $c$.
  Also, $L_0 = (L_{-2}\vac)^{L(\mathbb{C}_h)}_{(1)}$ acts by multiplication by $h$ on $\mathbb{C}_h$ and by \Cref{rmk:33}, $L(\mathbb{C}_h)$ is strongly generated by $\mathbb{C}_h$ as a vertex algebra.
  Therefore, $L(\mathbb{C}_h)$ is an irreducible highest weight representation of $\Vir$, i.e., $L(\mathbb{C}_h) = L(c, h)$.
\end{proof}

We now move on to $\Vir_c$.
If $c$ is not of the form $c_{p, q}$ for some $p, q \ge 2$ relatively prime integers, then $\Vir_c = \Vir^c$, and we have already solved the problem.

\begin{theorem}[{\cite{wang_rationality_1993}}]
  \label{thr:43}
  We set $c = c_{p, q}$ for some $p, q \ge 2$ relatively prime integers.
  We have the following isomorphism of algebras
  \begin{align*}
    \Zhu(\Vir_c) &\xrightarrow{\sim} \mathbb{C}[x]/(G_{p, q}(x)), \\
    L_{-2}\vac + O(\Vir_c) &\mapsto x + (G_{p, q}(x)),
  \end{align*}
  where $G_{p ,q}(x)^2 = \prod_{m = 1}^{p - 1}\prod_{n = 1}^{q - 1}(x - h_{m, n})$, and $h_{m, n} \in \mathbb{Q}$ is defined by
  \begin{equation}
    \label{eq:39}
    h_{m, n} = \frac{(np - mq)^2 - (p - q)^2}{4pq}.
  \end{equation}
\end{theorem}

\begin{theorem}
  \label{thr:44}
  We set $c = c_{p, q}$ for some $p, q \ge 2$ relatively prime integers.
  Then the irreducible admissible modules over $\Vir_c$ are $L(c, h_{m, n})$ for integers $m, n$ such that $0 < m < p$ and $0 < n < q$.
  Let $Y^{L(c, h_{m, n})}_{\Vir^c}: \Vir^c \to \mathcal{F}(L(c, h_{m, n}))$ be the state-field correspondence of $L(c, h_{m, n})$ as a module over $\Vir^c$, and let $Y^{L(c, h_{m, n})}_{\Vir_c}: \Vir_c \to \mathcal{F}(L(c, h_{m, n}))$ be the state-field correspondence of $L(c, h_{m, n})$ as a module over $\Vir_c$.
  Then the following diagram commutes
  \begin{equation*}
    \begin{tikzcd}
      \Vir^c \arrow[r, two heads] \arrow[rd, "{Y^{L(c, h_{m, n})}_{\Vir^c}}"'] & {\Vir_c} \arrow[d, "{Y^{L(c, h_{m, n})}_{\Vir_c}}"] \\
      & {\mathcal{F}(L(c, h_{m, n}))}
    \end{tikzcd}
  \end{equation*}
  where the horizontal arrow is the quotient map.
\end{theorem}

\begin{proof}
  The irreducible modules over $\mathbb{C}[x]/(G_{p, q}(x))$ are $\mathbb{C}_{h_{m, n}} = \mathbb{C}$ for integers $m, n$ such that $0 < m < p$ and $0 < n < q$, where $x + (G_{p, q}(x))$ acts by multiplication by $h_{m, n}$.
  We conclude from \Cref{thr:42} that the $\Vir_c$-module corresponding to $\mathbb{C}_{h_{m, n}}$ is $L(c, h_{m, n})$, and the commutativity of the diagram follows from \Cref{rmk:34}.
\end{proof}

It follows from \Cref{thr:44} that the irreducible admissible modules over the Ising model $\Vir_{3, 4}$ are $\Vir_{3, 4} = L(1/2, 0)$, $L(1/2, 1/2)$ and $L(1/2, 1/16)$.

\begin{theorem}
  \label{thr:45}
  We set $c = c_{p, q}$ for some $p, q \ge 2$ relatively prime integers, and we consider the real number $h_{m, n}$ for integers $m, n$ such that $0 < m < p$ and $0 < n < q$, as defined in \eqref{eq:39}.
  Then the maximal proper subrepresentation $J(c, h_{m, n})$ of $M(c, h_{m, n})$ is generated by two singular vectors $u$ and $w$ in $M(c, h_{m, n})_{h_{m, n} + mn}$ and $M(c, h_{m, n})_{h_{m, n} + (p - m)(q - n)}$, respectively.
\end{theorem}

\begin{proof}
  Solving the equations
  \begin{equation*}
    c = \frac{(3r + 2s)(3s + 2r)}{rs}, h = \frac{(r + s)^2 - t^2}{4rs}
  \end{equation*}
  for $r, s \in \mathbb{C} \setminus \{0\}$ and $t \in \mathbb{C}$, we obtain
  \begin{equation*}
    r = p, s = -q, t = (np - mq)^2.
  \end{equation*}
  The solutions $(k, l)$ of the linear equation $pk - ql + (np - mq)^2 = 0$ are
  \begin{equation}
    \label{eq:40}
    \{(n + qj, m + pj) \mid j \in \mathbb{Z}\}.
  \end{equation}
  We are in Subsubcase III$_-$ of \Cref{thr:34}, and we see that the first two elements of the solutions in \eqref{eq:40} are $(n, m)$ and $(n - q, m - p)$ (not necessarily in that order).
\end{proof}

\section{Vertex Poisson algebras and filtrations of vertex algebras}
\label{sec:vert-poiss-algeb}

In this section, we review the theory of filtrations for vertex algebras.
We can consider either the Li filtration $(F_pV)_{p \in \mathbb{Z}}$ or the standard filtration $(G^pV)_{p \in \mathbb{Z}}$.
Both of these filtrations lead to a vertex Poisson algebra, namely $\gr_F(V)$ and $\gr^G(V)$, as was shown by Haisheng Li in \cite{li_abelianizing_2005} and \cite{li_vertex_2004}.
In \cite{arakawa_remark_2012}, it was shown by Arakawa that the resulting vertex Poisson algebra is the same.
Then, we introduce the Li filtration $(F_pM)_{p \in \mathbb{Z}}$ and the standard filtration $(G^pM)_{p \in \mathbb{Z}}$ for modules.
This leads to modules $\gr_F(M)$ and $\gr^G(M)$ that are again isomorphic.
Finally, we introduce the Zhu $C_2$-algebra and derive consequences of the $C_2$-cofiniteness condition.

\subsection{Vertex Lie superalgebras and their modules}
\label{sec:vert-lie-supera}

Let $V$ be a vector space.
Given a formal distribution $f(x_1, \dots, x_n) \in V[[x_1^{\pm 1}, \dots, x_n^{\pm 1}]]$, we can write it as
\begin{equation*}
  f(x_1, \dots, x_n) = \sum_{m_1, \dots, m_n \in \mathbb{Z}}f_{(m_1, \dots, m_n)}x_1^{-m_1 - 1}\dots x_n^{-m_n - 1}.
\end{equation*}
We set
\begin{equation*}
  \sing(f(x_1, \dots, x_n)) = \sum_{m_1, \dots, m_n \in \mathbb{N}}f_{(m_1, \dots, m_n)}x_1^{-m_1 - 1}\dots x_n^{-m_n - 1}.
\end{equation*}

A \emph{vertex Lie superalgebra} is the data $(V, T, Y_-)$, where $V$ is a vector superspace, $Y_-: V \to \mathcal{F}(V)$ is a linear and parity preserving map such that $Y_-(a, z) = \sing(Y_-(a, z))$ (i.e., $Y_-: V \to \Hom(V, z^{-1}V[z^{-1}])$) for $a \in V$ and $T \in \End(V)$.
The data must satisfy the following axioms for $a, b \in V$:
\begin{enumerate}
\item $Y_-(Ta, z) = \partial_zY_-(a, z)$;
\item $Y_-(a, z)b = \sing(p(a, b)(e^{Tz}Y_-(b, -z)a))$;
\item $[Y_-(a, z), Y_-(b, w)] = \sing(\sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}Y_-(a_{(j)}b, w))$, where $Y_-(a, z) = \sum_{n \in \mathbb{N}}a_{(n)}z^{-n - 1}$, $a_{(n)} \in \End(V)$.
\end{enumerate}

\begin{remark}
  \label{rmk:37}
  Axiom (i) of vertex Lie superalgebras implies that $T \in \End(V)_{\zero}$.
\end{remark}

Concepts like homomorphisms, vertex Lie subalgebras and ideals are defined in the usual way.
We obtain the category of vertex Lie superalgebras.

Let $V$ be vertex Lie superalgebra.
We can make $V$ into a $C[\partial]$-module by declaring $\partial = T$.
Then axioms (i) and (ii) are the respective axioms of Lie conformal superalgebras given in \Cref{sec:lie-conf-super}.
We take $a, b \in V$.
Since
\begin{equation*}
  \sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}Y_-(a_{(j)}b, w) = \sum_{m, n \in \mathbb{Z}}\left(\sum_{\substack{j, k \in \mathbb{N} \\ j + k = m + n}}\binom{m}{j}(a_{(j)}b)_{(k)}\right)z^{-m - 1}w^{-n - 1},
\end{equation*}
we have
\begin{equation*}
  \sing\left(\sum_{j \in \mathbb{N}}\frac{\partial^j_w\delta(z, w)}{j!}Y_-(a_{(j)}b, w)\right) = \sum_{m, n \in \mathbb{N}}\sum_{j = 0}^m\binom{m}{j}(a_{(j)}b)_{(m + n - j)}z^{-m - 1}w^{-n - 1}.
\end{equation*}
On the other hand,
\begin{equation*}
  [Y_-(a, z), Y_-(b, w)] = \sum_{m, n \in \mathbb{N}}[a_{(m)}, b_{(n)}]z^{-m - 1}w^{-n - 1}.
\end{equation*}
Therefore, axiom (iii) of vertex Lie superalgebras is equivalent to
\begin{equation*}
  [a_{(m)}, b_{(n)}] = \sum_{j = 0}^m\binom{m}{j}(a_{(j)}b)_{(m + n - j)} \quad \text{for $a, b \in V$ and $m, n \in \mathbb{Z}$}.
\end{equation*}
This is just axiom (iii) of Lie conformal superalgebras.
Thus, the category of vertex Lie superalgebras and the category of Lie conformal superalgebras are isomorphic.
Consequently, we have three equivalent concepts: vertex Lie superalgebras, Lie conformal superalgebras and regular formal distribution Lie superalgebras.

\begin{theorem}
  \label{thr:46}
  Let $V$ be a vertex Lie superalgebra.
  For $a, b \in V$ and $m, j \in \mathbb{N}$:
  \begin{enumerate}
  \item $[T, Y_-(a, z)] = Y_-(Ta, z) = \partial_zY_-(a, z)$;
  \item $(a_{(j)}b)_{(m)} = \sum_{k = 0}^j\binom{j}{k}(-1)^k[a_{(j - k)}, b_{(m + k)}]$.
  \end{enumerate}
\end{theorem}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item This is \Cref{prp:4}.
  \item This is \Cref{thr:10}. \qedhere
  \end{enumerate}
\end{proof}

Let $V$ be a vertex Lie superalgebra.
A \emph{Hamiltonian operator of $V$} is a diagonalizable operator $H \in \End(V)$ such that
\begin{equation*}
  [H, Y_-(a, z)] = z\partial_zY_-(a, z) + Y_-(Ha, z) \quad \text{for $a \in V$}.
\end{equation*}
A vertex Lie superalgebra with a Hamiltonian operator is called \emph{graded}.
The \emph{grading of $V$} is the eigenspace decomposition of $H$
\begin{equation*}
  V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta}.
\end{equation*}

A \emph{module over $V$} is a vector superspace $M$ together with a linear and parity preserving map $Y^M_-: V \to \Hom(M, z^{-1}M[z^{-1}])$, written as $Y^M_-(a, z) = \sum_{n \in \mathbb{N}}a^M_{(n)}z^{-n - 1}$, $a^M_{(n)} \in \End(M)$, such that for $a, b \in V$ and $m, n \in \mathbb{N}$:
\begin{enumerate}
\item $(Ta)^M_{(n)} = -na^M_{(n - 1)}$;
\item $[a^M_{(m)}, b^M_{(n)}] = \sum_{j = 0}^m\binom{m}{j}(a_{(j)}b)^M_{(m + n - j)}$.
\end{enumerate}
Concepts like homomorphisms and vertex Lie submodules are defined in the usual way.
Given a vertex Lie superalgebra $V$, we obtain the abelian category $V$-Mod of modules over $V$.

Let $M$ be a module over a graded vertex Lie superalgebra $V$ with Hamiltonian operator $H$.
A \emph{Hamiltonian operator of $M$} is a diagonalizable operator $H^M \in \End(M)$ such that
\begin{equation*}
  [H^M, Y^M_-(a, z)] = z\partial_zY^M_-(a, z) + Y^M_-(Ha, z) \quad \text{for $a \in V$}.
\end{equation*}
A $V$-module together with a Hamiltonian operator is called \emph{graded}.
The \emph{grading of $M$} is the eigenspace decomposition of $H^M$
\begin{equation*}
  M = \bigoplus_{\Delta \in \mathbb{C}}M_{\Delta}.
\end{equation*}

Let $V$ be a vertex Lie superalgebra, and let $M$ be a $V$-module.
We say $T^M \in \End(M)$ is a \emph{differential of $M$} if
\begin{equation*}
  [T^M, Y^M_-(a, z)] = Y^M_-(Ta, z) \quad \text{for $a \in V$}.
\end{equation*}
A \emph{differential} $V$-module is a module equipped with a differential.

\subsection{Vertex Poisson algebras and their modules}
\label{sec:vert-poiss-algeb-1}

A \emph{vertex Poisson algebra} is the data consisting of three elements $(V, T, Y_-)$ such that:
\begin{enumerate}
\item $(V, T)$ is a differential commutative associative algebra with unit $1$;
\item $(V, T, Y_-)$ is a vertex Lie algebra;
\item The left Leibniz rule holds
  \begin{equation*}
    Y_-(a, z)(bc) = (Y_-(a, z)b)c + b(Y_-(a, z)c) \quad \text{for $a, b, c \in V$}.
  \end{equation*}
\end{enumerate}
The left Leibniz rule implies that $a_{(n)} \in \Der(A)$ for $a \in A$ and $n \in \mathbb{N}$.
Therefore, we have
\begin{equation*}
  Y_-(a, z) \in z^{-1}\Der(A)[[z^{-1}]] \quad \text{for $a \in A$}.
\end{equation*}
In particular, $a_{(n)}1 = 0$ for $a \in A$ and $n \in \mathbb{N}$.
Therefore,
\begin{equation*}
  Y_-(a, z)1 = 0 \quad \text{for $a \in A$}.
\end{equation*}
By skewsymmetry,
\begin{equation*}
  Y_-(1, z) = 0.
\end{equation*}

Let $V_1$ and $V_2$ be vertex Poisson algebras.
A \emph{vertex Poisson algebra homomorphism} $f: V_1 \to V_2$ is simultaneously a differential algebra and a vertex Lie algebra homomorphism.
We obtain the category of vertex Poisson algebras.

Let $V$ be a vertex Poisson algebra.
A \emph{module over $V$} is a module $(M, Y^M_-)$ over $V$ as a vertex Lie algebra and a module over $V$ as a commutative associative algebra such that
\begin{equation*}
  a^M_{(n)}(bu) = (a_{(n)}b)u + b(a^M_{(n)}u) \quad \text{for $a, b \in V$, $u \in M$ and $n \in \mathbb{N}$}.
\end{equation*}
Concepts like homomorphisms and vertex Poisson submodules are defined in the usual way.
Given a vertex Poisson algebra $V$, we obtain the abelian category $V$-Mod of modules over $V$.

\begin{proposition}[{\cite[Proposition 2.3.1]{arakawa_remark_2012}}]
  \label{prp:11}
  Let $R$ be a finitely generated Poisson algebra.
  Then there is a unique vertex Poisson algebra structure on $JR$ such that
  \begin{equation*}
    a_{(n)}b = \delta_{n, 0}\{a, b\} \quad \text{for $a, b \in R$ and $n \in \mathbb{N}$}.
  \end{equation*}
\end{proposition}

The vertex Poisson algebra structure on $JR$ given in \Cref{prp:11} for a finitely generated Poisson algebra $R$ will be called the \emph{level 0 vertex Poisson algebra structure of $JR$}.

If $R$ is a finitely generated Poisson algebra, and $M$ is an $R$-module, then we can verify that $JR \otimes_{R} M$ is a $JR$-module by defining the Poisson structure as
\begin{equation*}
  a_{(n)}(b\otimes u) = (a_{(n)}b)\otimes u + \delta_{n, 0}b\otimes\{a, u\} \quad \text{for $a, b \in R$ and $u \in M$}.
\end{equation*}
We have a natural inclusion $\inc: M \hookrightarrow JR \otimes M$, which is an $R$-module homomorphism.
The $JR$-module $M$ together with the $R$-module homomorphism $\inc: M \hookrightarrow JR \otimes M$ satisfy a universal property similar to that of $JR$ (see \Cref{sec:jet-algebras-jet}).
Let $N$ be a module over the vertex Poisson algebra $JR$, and let $f: M \to N$ be a homomorphism of modules over the Poisson algebra $R$.
Thus, $N$ is a module over the algebra $JR$ and in particular, a module over the algebra $R$ because we have an inclusion $\inc: R \hookrightarrow JR$.
Also, $f$ can be considered as an algebra homomorphism.
Therefore, there is a homomorphism $\overline{f}: JR \otimes M \to N$ of modules over the algebra $JR$ such that the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    M \arrow[r, "\inc", hook] \arrow[rd, "f"'] & JR \otimes M \arrow[d, "\overline{f}"] \\
    & N
  \end{tikzcd}
\end{equation*}

\begin{proposition}
  \label{prp:12}
  The homomorphism $\overline{f}$ as defined above is a $JR$-module homomorphism.
\end{proposition}

\begin{proof}
  We just expand the definitions and verify the axioms of modules over vertex Poisson algebras.
\end{proof}

We have constructed a functor
\begin{equation*}
  JR\otimes\bullet: \text{$R$-Mod} \to \text{$JR$-Mod},
\end{equation*}
which is left adjoint to the forgetful functor $\text{$JR$-Mod} \to \text{$R$-Mod}$, i.e., for $M \in \text{$R$-Mod}$ and $N \in \text{$JR$-Mod}$, we have a natural isomorphism
\begin{equation*}
  \Hom_{\text{$JR$-Mod}}(JR \otimes M, N) \cong \Hom_{\text{$R$-Mod}}(M, N).
\end{equation*}

\subsection{Filtrations of vertex algebras}
\label{sec:filtr-vert-algebr}

Let $V$ be a vertex algebra, and let $(a^i)_{i \in I}$ be a family of strong generators of $V$.
For $p \in \mathbb{Z}$, we set
\begin{equation*}
  F_pV = \vspan\{a^{i_1}_{(-n_1 - 1)}\dots a^{i_s}_{(-n_s - 1)}\vac \mid s, n_1, \dots, n_s \in \mathbb{N}, i_1, \dots, i_s \in I, n_1 + \dots + n_s \ge p\}.
\end{equation*}

\begin{proposition}[{\cite{li_abelianizing_2005}}]
  \label{prp:13}
  The filtration $(F_pV)_{p \in \mathbb{Z}}$ satisfies:
  \begin{enumerate}
  \item $F_pV = V$ for $p \le 0$;
  \item $\vac \in F_0V \supseteq F_1V \supseteq \dots$;
  \item $T(F_pV) \subseteq F_{p + 1}V$ for $p \in \mathbb{Z}$;
  \item $a_{(n)}F_qV \subseteq F_{p + q - n - 1}V$ for $p, q \in \mathbb{Z}$, $a \in F_pV$ and $n \in \mathbb{Z}$;
  \item $a_{(n)}F_qV \subseteq F_{p + q - n}V$ for $p, q \in \mathbb{Z}$, $a \in F_pV$ and $n \in \mathbb{N}$.
  \end{enumerate}
\end{proposition}

Let
\begin{equation*}
  \gr_F(V) = \bigoplus_{p \in \mathbb{N}}F_pV/F_{p + 1}V
\end{equation*}
be the associated graded vector space.
By \cite{li_abelianizing_2005}, the vector space $\gr_F(V)$ is a vertex Poisson algebra with operations given as follows.
For $p, q \in \mathbb{N}$, $a \in F_pV$ and $b \in F_qV$, we set:
\begin{align*}
  \sigma_p(a)\sigma_q(b) &= \sigma_{p + q}(a_{(-1)}b), \\
  T(\sigma_p(a)) &= \sigma_{p + 1}(Ta), \\
  Y_-(\sigma_p(a), z)\sigma_q(b) &= \sum_{n \in \mathbb{N}}\sigma_{p + q - n}(a_{(n)}b)z^{-n - 1},
\end{align*}
where $\sigma_p: F_pV \to \gr_F(V)$ is the \emph{principal symbol map}, which is the composition of the natural maps $F_pV \twoheadrightarrow F_pV/F_{p + 1}V$ and $F_pV/F_{p + 1}V \hookrightarrow \gr_F(V)$.
The unit is $\sigma^0(\vac)$.
The filtration $(F_pV)_{p \in \mathbb{Z}}$ is called the \emph{Li filtration of $V$}.

\begin{lemma}[{\cite[Lemma 2.9]{li_abelianizing_2005}}]
  \label{lmm:23}
  Let $V$ be a vertex algebra.
  Then
  \begin{equation*}
    F_pV = \vspan\{a_{(-i - 1)}b \mid a \in V, i \in \mathbb{Z}_+, b \in F_{p - i}V\} \quad \text{for $p \in \mathbb{Z}_+$}.
  \end{equation*}
\end{lemma}

By \Cref{lmm:23}, the Li filtration depends only on $V$ and not on the choice of the strong generators.
If $V$ is graded by a Hamiltonian $H$ with grading $V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta}$, then $H(F_pV) \subseteq F_pV$ because in that case, for $p \in \mathbb{Z}$,
\begin{equation*}
  \begin{split}
    F_pV = \vspan\{a^1_{(-n_1 - 1)}\dots a^s_{(-n_s - 1)}\vac &\mid \text{$s, n_1, \dots, n_s \in \mathbb{N}$, $a^1, \dots, a^s \in V$ homogeneous,} \\
                                                              &\quad n_1 + \dots + n_s \ge p\}.
  \end{split}
\end{equation*}

Therefore, we can define an operator $H \in \End(\gr_F(V))$ as $H(\sigma_p(a)) = \sigma_p(Ha)$ for $p \in \mathbb{N}$ and $a \in F_pV$.
For $p \in \mathbb{Z}$ and $\Delta \in \mathbb{C}$, we define $F_pV_{\Delta} = F_pV \cap V_{\Delta}$.
Since $H(F_pV) \subseteq F_pV$ for $p \in \mathbb{Z}$, \Cref{lmm:9} implies that
\begin{equation*}
  F_pV = \bigoplus_{\Delta \in \mathbb{C}}F_pV_{\Delta} \quad \text{for $p \in \mathbb{Z}$}.
\end{equation*}
For $\Delta \in \mathbb{C}$, we define $\gr_F(V)_{\Delta} = \bigoplus_{p \in \mathbb{N}}\sigma_p(F_pV_{\Delta})$.
Then $Ha = \Delta a$ for $a \in \gr_F(V)_{\Delta}$.
The family of subspaces $(\gr_F(V)_{\Delta})_{\Delta \in \mathbb{C}}$ satisfies $\gr_F(V) = \bigoplus_{\Delta \in \mathbb{C}}\gr_F(V)_{\Delta}$.
Therefore, the operator $H \in \End(\gr_F(V))$ is diagonalizable with $\gr_F(V)_{\Delta} = \ker(H - \Delta\Id_{\gr_F(V)})$.
In fact, more is true.

\begin{theorem}
  \label{thr:47}
  This diagonalizable operator $H$ is a Hamiltonian of $\gr_F(V)$.
\end{theorem}

\begin{proof}
  For $p, q \in \mathbb{N}$, $a \in F_pV$ and $b \in F_qV$,
  \begin{align*}
    [H, Y_-(\sigma_p(a), z)]\sigma_q(b) &= \sum_{n \in \mathbb{N}}\sigma_{p + q - n}([H, a_{(n)}]b)z^{-n - 1} \\
                                        &= \sum_{n \in \mathbb{N}}\sigma_{p + q - n}((-(n + 1)a_{(n)} + (Ha)_{(n)})b)z^{-n - 1} \\
                                        &= (z\partial_zY_-(\sigma_p(a), z) + Y_-(\sigma_p(Ha), z))\sigma_q(b). \qedhere
  \end{align*}
\end{proof}

We have the natural vector space isomorphisms
\begin{equation*}
  \sigma_p(F_pV_{\Delta}) \cong F_pV_{\Delta}/F_{p + 1}V_{\Delta} \quad \text{for $p \in \mathbb{Z}$ and $\Delta \in \mathbb{C}$}
\end{equation*}
and the refined grading
\begin{equation}
  \label{eq:41}
  \gr_F(V) = \bigoplus_{\substack{p \in \mathbb{N} \\ \Delta \in \mathbb{C}}}\sigma_p(F_pV_{\Delta}).
\end{equation}
By \eqref{eq:41}, when $\dim(V_{\Delta}) < \infty$ for $\Delta \in \mathbb{C}$, it is natural to define the \emph{refined character of $V$ with respect to the Li filtration} as
\begin{equation*}
  \ch_{\gr_F(V)}(t, q) = \sum_{\substack{p \in \mathbb{N} \\ \Delta \in \mathbb{C}}}\dim(\sigma_p(F_pV_{\Delta}))t^pq^{\Delta}.
\end{equation*}

If $f: V_1 \to V_2$ is a homomorphism of vertex algebras, then
\begin{align*}
  \gr_F(f): \gr_F(V_1) &\to \gr_F(V_2), \\
  \gr_F(f)(\sigma^{V_1}_p(a)) &= \sigma^{V_2}_p(f(a)) \quad \text{for $p \in \mathbb{N}$ and $a \in F_pV_1$}
\end{align*}
defines a homomorphism of vertex Poisson algebras.
If $V_1$ and $V_2$ are graded, then we require that $f$ respects the gradings of $V_1$ and $V_2$, and this implies that $\gr_F(f)$ also respects the gradings of $\gr_F(V_1)$ and $\gr_F(V_2)$.
Therefore, we obtain a functor
\begin{equation*}
  \gr_F: \{\text{(graded) vertex algebras}\} \to \{\text{(graded) vertex Poisson algebras}\}.
\end{equation*}

We now assume that $V$ is an $\mathbb{N}$-graded vertex algebra with Hamiltonian $H$.
Let $(a^i)_{i \in I}$ be a family of homogeneous strong generators of $V$.
For $p \in \mathbb{Z}$, we set
\begin{equation*}
  G^pV = \vspan\{a^{i_1}_{(-n_1 - 1)}\dots a^{i_s}_{(-n_s - 1)}\vac \mid s, n_1, \dots, n_s \in \mathbb{N}, i_1, \dots, i_s \in I, \Delta_{a^{i_1}} + \dots + \Delta_{a^{i_s}} \le p\}.
\end{equation*}

\begin{proposition}[{\cite{li_vertex_2004}}]
  \label{prp:14}
  The filtration $(G^pV)_{p \in \mathbb{Z}}$ satisfies:
  \begin{enumerate}
  \item $G^pV = 0$ for $p < 0$;
  \item $\vac \in G^0V \subseteq G^1V \subseteq \dots$;
  \item $V_n \subseteq G^nV$ for $n \in \mathbb{Z}$;
  \item $V = \bigcup_{p \in \mathbb{N}}G^pV$;
  \item $a_{(n)}G^qV \subseteq G^{p + q}V$ for $p, q \in \mathbb{Z}$, $a \in G^pV$ and $n \in \mathbb{Z}$;
  \item $a_{(n)}G^qV \subseteq G^{p + q - 1}V$ for $p, q \in \mathbb{Z}$, $a \in G^pV$ and $n \in \mathbb{N}$;
  \item $H(G^pV) \subseteq G^pV$ and $T(G^pV) \subseteq G^pV$ for $p \in \mathbb{Z}$.
  \end{enumerate}
\end{proposition}

Let
\begin{equation*}
  \gr^G(V) = \bigoplus_{p \in \mathbb{N}}G^pV/G^{p - 1}V
\end{equation*}
be the associated graded vector space.
By \cite{li_vertex_2004}, the vector space $\gr^G(V)$ is a vertex Poisson algebra with operations given as follows.
For $p, q \in \mathbb{N}$, $a \in G^pV$ and $b \in G^qV$, we set:
\begin{align*}
  \alpha^p(a)\alpha^q(b) &= \alpha^{p + q}(a_{(-1)}b), \\
  T(\alpha^p(a)) &= \alpha^p(Ta), \\
  Y_-(\alpha^p(a), z)\alpha^q(b) &= \sum_{n \in \mathbb{N}}\alpha^{p + q - 1}(a_{(n)}b)z^{-n - 1},
\end{align*}
where $\alpha^p: G^pV \to \gr^G(V)$ is the principal symbol map.
The unit is $\alpha^0(\vac)$.
The filtration $(G^pV)_{p \in \mathbb{Z}}$ is called the \emph{standard filtration of $V$}.
By \Cref{prp:15} ahead, the standard filtration does not depend on the choice of the strong generators of $V$.

By \Cref{prp:14}(vii), we can define an operator $H \in \End(\gr^G(V))$ as $H(\alpha^p(a)) = \alpha^p(Ha)$ for $p \in \mathbb{Z}$ and $a \in G^pV$.
For $p \in \mathbb{Z}$ and $n \in \mathbb{N}$, we define $G^pV_n = G^pV \cap V_n$.
Since $H(G^pV) \subseteq G^pV$ for $p \in \mathbb{Z}$, \Cref{lmm:9} implies that
\begin{equation*}
  G^pV = \bigoplus_{n \in \mathbb{N}}G^pV_n \quad \text{for $p \in \mathbb{Z}$}.
\end{equation*}
For $n \in \mathbb{N}$, we define $\gr^G(V)_n = \bigoplus_{p \in \mathbb{N}}\alpha^p(G^pV_n)$.
Then $Ha = na$ for $a \in \gr^G(V)_n$.
The family of subspaces $(\gr^G(V)_n)_{n \in \mathbb{N}}$ satisfies $\gr^G(V) = \bigoplus_{n \in \mathbb{N}}\gr^G(V)_n$.
Therefore, the operator $H \in \End(\gr^G(V))$ is diagonalizable with $\gr^G(V)_n = \ker(H - n\Id_{\gr^G(V)})$.
In fact, more is true.

\begin{theorem}
  \label{thr:48}
  This diagonalizable operator $H$ is a Hamiltonian of $\gr^G(V)$.
\end{theorem}

\begin{proof}
  The proof of \Cref{thr:47} also works here.
\end{proof}

We have the natural vector space isomorphisms
\begin{equation*}
  \alpha^p(G^pV_n) \cong G^pV_n/G^{p - 1}V_n \quad \text{for $p \in \mathbb{Z}$ and $n \in \mathbb{N}$}
\end{equation*}
and the refined grading
\begin{equation}
  \label{eq:42}
  \gr^G(V) = \bigoplus_{p, n \in \mathbb{N}}\alpha^p(G^pV_n).
\end{equation}
By \eqref{eq:42}, when $\dim(V_n) < \infty$ for $n \in \mathbb{N}$, it is natural to define the \emph{refined character of $V$ with respect to the standard filtration} as
\begin{equation*}
  \ch_{\gr^G(V)}(t, q) = \sum_{p, n \in \mathbb{N}}\dim(\alpha^p(G^pV_n))t^pq^n \in \mathbb{C}[[t, q]].
\end{equation*}

If $f: V_1 \to V_2$ is a homomorphism of $\mathbb{N}$-graded vertex algebras, then
\begin{align*}
  \gr^G(f): \gr^G(V_1) &\to \gr^G(V_2), \\
  \gr^G(f)(\alpha_{V_1}^p(a)) &= \alpha_{V_2}^p(f(a)) \quad \text{for $p \in \mathbb{N}$ and $a \in G^pV_1$}
\end{align*}
defines a homomorphism of $\mathbb{N}$-graded vertex Poisson algebras.
Therefore, we obtain a functor
\begin{equation*}
  \gr^G: \{\text{$\mathbb{N}$-graded vertex algebras}\} \to \{\text{$\mathbb{N}$-graded vertex Poisson algebras}\}.
\end{equation*}

\begin{proposition}[{\cite[Proposition 2.6.1]{arakawa_remark_2012}}]
  \label{prp:15}
  Let $V$ be an $\mathbb{N}$-graded vertex algebra.
  Then the Li filtration and standard filtration satisfy
  \begin{equation*}
    F_pV_n = G^{n - p}V_n \quad \text{for $p, n \in \mathbb{N}$}.
  \end{equation*}
  An explicit isomorphism $\gr_F(V) \xrightarrow{\sim} \gr^G(V)$ of vertex Poisson algebras is defined by extending linearly the isomorphisms of vector spaces given by
  \begin{align*}
    \sigma_p(F_pV_n) &\xrightarrow{\sim} \alpha^{n - p}(G^{n - p}V_n), \\
    \sigma_p(a) &\mapsto \alpha^{n - p}(a),
  \end{align*}
  where $p, n \in \mathbb{N}$ and $a \in F_pV_n$.
\end{proposition}

\begin{remark}
  \label{rmk:38}
  In \cite{arakawa_remark_2012}, it is suggested in a footnote that it is possible to consider more general $\tfrac{1}{r_0}\mathbb{N}$-graded vertex algebras instead of $\mathbb{N}$-graded vertex algebras.
  However, we encounter difficulties doing this.
  For example, if $V = \Vir^{1/2}$, which is the case we are interested here, then $V$ is $\tfrac{1}{2}\mathbb{N}$-graded.
  According to the definition of $\gr^G(V)$ given in \cite{arakawa_remark_2012}, we should have $\gr^G(V) = \bigoplus_{p \in \frac{1}{2}\mathbb{N}}G_pV/G_{p - 1}V = G_0V/G_{-1}V \oplus G_{1/2}V/G_{-1/2}V \oplus \dots = \mathbb{C}\vac \oplus \mathbb{C}\vac \oplus \dots$, which means ``the vacuum is doubled''.
  That is probably not intended, and also the proof of \cite[Proposition 2.6.1]{arakawa_remark_2012} does not work for $\tfrac{1}{r_0}\mathbb{N}$-graded vertex algebras.
  But the hypothesis $V_0 = \mathbb{C}\vac$ can be removed, just as Arakawa wrote.
\end{remark}

\begin{theorem}
  \label{thr:49}
  Let $V$ be an $\mathbb{N}$-graded vertex algebra with $\dim(V_n) < \infty$ for $n \in \mathbb{N}$.
  The refined characters of $V$ are related as follows:
  \begin{enumerate}
  \item $\ch_V(q) = \ch_{\gr_F(V)}(q) = \ch_{\gr^G(V)}(q) = \ch_{\gr_F(V)}(1, q) = \ch_{\gr^G(V)}(1, q)$;
  \item $\ch_{\gr^G(V)}(t^{-1}, tq) = \ch_{\gr_F(V)}(t, q)$.
  \end{enumerate}
\end{theorem}

\begin{proof}
  See the proof of \Cref{prp:19} ahead.
\end{proof}

\begin{example}[$\gr^G(\Vir^c)$]
  \label{exa:14}
  We pick any $c \in \mathbb{C}$ and define the subalgebra $\Vir_{\le -2} = \bigoplus_{n \le -2}\mathbb{C}L_{n}$ of $\Vir$.
  By the PBW theorem and \Cref{exa:5}, for $s \in \mathbb{N}$, a basis of $U(\Vir_{\le -2})^s$ (see \Cref{sec:almost-comm-algebr} for the definition of $U(\Vir_{\le -2})^s$) is given by
  \begin{equation*}
    \{L_{\lambda} \mid \text{$t \le s$ and $[\lambda_1, \dots, \lambda_t]$ is a partition with $\lambda_t \ge 2$}\}.
  \end{equation*}
  We recall that $\Delta_{L_{-2}\vac} = 2$.
  From the definition of the standard filtration, we see that for $s \in \mathbb{Z}$, $G^{2s}\Vir^c = G^{2s + 1}\Vir^c \cong U(\Vir_{\le -2})^s$.
  This implies that the quotients $G^{2s}\Vir^c/G^{2s + 1}\Vir^c$ are $0$ for $s \in \mathbb{N}$.
  Therefore, we have a vector space isomorphism
  \begin{align*}
    \gr^G(\Vir^c) &\xrightarrow{\sim} \gr(U(\Vir_{\le -2})), \\
    \alpha^{2s}(L_{\lambda}\vac) &\mapsto \gamma^s(L_{\lambda}) \quad \text{for $s \in \mathbb{N}$ and $\lambda = [\lambda_1, \dots, \lambda_s]$ a partition with $\lambda_s \ge 2$}.
  \end{align*}
  We now show this is an algebra homomorphism.
  We need to show that for $s, t \in \mathbb{N}$ and partitions $[\lambda_1, \dots, \lambda_s], [\eta_1, \dots, \eta_t]$ with $\lambda_s, \eta_t \ge 2$,
  \begin{equation*}
    \alpha^{2s}(L_{\lambda}\vac)\alpha^{2t}(L_{\eta}\vac) \mapsto \gamma^{s + t}(L_{\lambda}L_{\eta}),
  \end{equation*}
  which is equivalent to
  \begin{equation*}
    \alpha^{2s + 2t}((L_{\lambda}\vac)_{(-1)}(L_{\eta}\vac)) \mapsto \gamma^{s + t}(L_{\lambda}L_{\eta}).
  \end{equation*}
  Therefore, we have to show that
  \begin{equation}
    \label{eq:43}
    (L_{\lambda}\vac)_{(-1)}(L_{\eta}\vac) = (L_{\lambda}L_{\eta})\vac + a \quad \text{for some $a \in G^{2s + 2t - 1}\Vir^c$}.
  \end{equation}

  If $s = 0$ or $s = 1$, \eqref{eq:43} is clear.
  We assume $s \ge 2$.
  By \Cref{crl:1},
  \begin{align*}
    (L_{\lambda}\vac)_{(-1)}(L_{\eta}\vac) &= \left(\frac{:\partial_z^{\lambda_1 - 2}L(z)\dots\partial_z^{\lambda_s - 2}L(z):}{(\lambda_1 - 2)!\dots(\lambda_s - 2)!} \right)_{(-1)}(L_{\eta}\vac) \\
                                           &= \frac{(:\partial_z^{\lambda_1 - 2}L(z)\dots\partial_z^{\lambda_s - 2}L(z):)_{(-1)}(L_{\eta}\vac)}{(\lambda_1 - 2)!\dots(\lambda_s - 2)!},
  \end{align*}
  where $L(z) = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2} \in \mathcal{F}(\Vir^c)$.
  We now use \Cref{lmm:3} with $V = \Vir^c$, $a^k(z) = \partial^{\lambda_k - 2}L(z)$ for $k = 1, \dots, s$ and $b = L_{\eta}\vac$.
  First, we note that for $k = 1, \dots, s$,
  \begin{align*}
    a^k(z) &= \partial_z^{\lambda_k - 2}L(z) \\
           &= \sum_{n \in \mathbb{Z}}(-n - 2)\dots(-n - 2 - (\lambda_k - 3))L_nz^{-n - 2 - (\lambda_k - 2)} \\
           &= \sum_{n \in \mathbb{Z}}(-n + \lambda_k - 3)\dots(-n)L_{n + 1 - \lambda_k}z^{-n - 1},
  \end{align*}
  which says that
  \begin{equation*}
    a^k_{(n)} = (-n + \lambda_k - 3)\dots(-n)L_{n + 1 - \lambda_k} \quad \text{for $k = 1, \dots, s$ and $n \in \mathbb{Z}$}.
  \end{equation*}

  We note that each expression $R^{-1, k}_{n_1, \dots, n_{s - 1}}L_{\eta}\vac$ in \Cref{lmm:3}, where we omitted the fields $a^k(z)$ from the notation, is the sum of elements of the form
  \begin{equation*}
    \text{scalar}\cdot L_{\kappa_1}\dots L_{\kappa_s}(L_{\eta}\vac),
  \end{equation*}
  where $\kappa_k \in \mathbb{Z}$ for $k = 1, \dots, s$.
  Furthermore, we note that if $\kappa_k \ge -1$ for some $k = 1, \dots, s$, then $L_{\kappa_1}\dots L_{\kappa_s}(L_{\eta}\vac) \in G^{2s + 2t - 1}\Vir^c$.
  We now study these expressions $R^{-1, k}_{n_1, \dots, n_{s - 1}}L_{\eta}\vac$ by considering the elements that appear in the sum defining it.
  We consider several disjoint cases:
  \begin{enumerate}
  \item $k > 0$.
    If $n_{i_1} \ge \lambda_{i_1} - 2$, then $n_{i_1} + 1 - \lambda_{i_1} \ge -1$, so we get
    \begin{equation*}
      a^{j_1}_{(-n_{j_1} - 1)}\dots a^{j_{s - 1 - k}}_{(-n_{j_{s - 1 - k}} - 1)}a^s_{(l - k - \sum_{r = 1}^kn_{i_r} + \sum_{r = 1}^{s - 1 - k}n_{j_r})}a^{i_k}_{(n_{i_k})}\dots a^{i_1}_{(n_{i_1})}L_{\eta}\vac \in G^{2s + 2t - 1}\Vir^c.
    \end{equation*}
    If $n_{i_1} \le \lambda_{i_1} - 3$, then $a^{i_1}(z)_{(n_{i_1})}L_{\eta}\vac = 0$ because $(-n + \lambda_k - 3)\dots(-n) = 0$, so we get
    \begin{equation*}
      a^{j_1}_{(-n_{j_1} - 1)}\dots a^{j_{s - 1 - k}}_{(-n_{j_{s - 1 - k}} - 1)}a^s_{(l - k - \sum_{r = 1}^kn_{i_r} + \sum_{r = 1}^{s - 1 - k}n_{j_r})}a^{i_k}_{(n_{i_k})}\dots a^{i_1}_{(n_{i_1})}L_{\eta}\vac = 0.
    \end{equation*}
    Therefore, we obtain
    \begin{equation*}
      R^{-1, k}_{n_1, \dots, n_{s - 1}}L_{\eta}\vac \in G^{2s + 2t - 1}\Vir^c.
    \end{equation*}
  \item $k = 0$ and there exists some $j = 1, \dots, s - 1$ such that $n_j > 0$.
    In this case, we get
    \begin{equation*}
      R^{-1, 0}_{n_1, \dots, n_{s - 1}}L_{\eta}\vac = a^1_{(-n_1 - 1)}\dots a^{s - 1}_{(-n_{s - 1} - 1)}a^s_{(-1 + \sum_{r = 1}^{s - 1}n_r)}L_{\eta}\vac \in G^{2s + 2t - 1}\Vir^c
    \end{equation*}
    because we can repeat the reasoning of (i) with $-1 + \sum_{r = 1}^{s - 1}n_r$ instead of $n_{i_1}$.
  \item $k = 0$ and $n_1 = \dots = n_{s - 1} = 0$.
    In this case, we get
    \begin{equation*}
      R^{-1, 0}_{0, \dots, 0} = a^1_{(-1)}\dots a^{s - 1}_{(-1)}a^s_{(-1)}L_{\eta}\vac = (\lambda_1 - 2)!\dots(\lambda_s - 2)!L_{\lambda}L_{\eta}\vac.
    \end{equation*}
  \end{enumerate}
  From these three cases, we obtain \eqref{eq:43}.

  We conclude that we have an algebra isomorphism $\gr^G(\Vir^c) \xrightarrow{\sim} \gr(U(\Vir_{\le -2}))$.
  Composing this with the inverse of the isomorphism $S(\Vir_{\le -2}) \xrightarrow{\sim} \gr(U(\Vir_{\le -2}))$ in \Cref{sec:almost-comm-algebr} and taking $(L_n)_{n \le -2}$ as the basis of $\Vir_{\le -2}$, we obtain the following isomorphism of commutative associative algebras with unit
  \begin{align*}
    \gr^G(\Vir^c) &\xrightarrow{\sim} \mathbb{C}[L_{-2}, L_{-3}, \dots], \\
    \alpha^{2s}(L_{-n_1 - 2}\dots L_{-n_s - 2}\vac) &\mapsto L_{-n_1 - 2}\dots L_{-n_s - 2} \quad \text{for $s, n_1, \dots, n_s \in \mathbb{N}$}.
  \end{align*}
  In particular, the isomorphism does not depend on $c$.

  The endomorphism $T \in \End(\mathbb{C}[L_{-2}, L_{-3}, \dots])$ is given by $T(L_{-n}) = (n - 1)L_{-n - 1}$ for $n \ge 2$, which is extended to a derivation.

  The Poisson structure of $\gr^G(\Vir^c)$ is trivial (i.e., the map $Y_-$ is zero) because for $s \in \mathbb{Z}$, $G^{2s}\Vir^c = G^{2s + 1}\Vir^c$.

  Since $\Delta_{L_{-2}\vac} = 2$,
  \begin{equation*}
    \ch_{\gr^G(\Vir^c)}(t, q) = \frac{1}{\prod_{k \ge 2}(1 - t^2q^k)}.
  \end{equation*}
\end{example}

\begin{remark}
  \label{rmk:39}
  It is worth noting that we do not use the Poisson structure of $\gr(U(\Vir_{\le -2}))$ given in \Cref{exa:19}.
\end{remark}

\subsection{Filtrations of modules over vertex algebras}
\label{sec:filtr-modul-over}

Let $V$ be a vertex algebra, let $(a^i)_{i \in I}$ be a family of strong generators of $V$, and let $M$ be a $V$-module.
For $p \in \mathbb{Z}$, we set
\begin{equation*}
  F_pM = \vspan\{a^{i_1M}_{(-n_1 - 1)}\dots a^{i_sM}_{(-n_s - 1)}u \mid s, n_1, \dots, n_s \in \mathbb{N}, i_1, \dots, i_s \in I, u \in M, n_1 + \dots + n_s \ge p\}.
\end{equation*}

\begin{proposition}[{\cite{li_abelianizing_2005}}]
  \label{prp:16}
  The filtration $(F_pM)_{p \in \mathbb{Z}}$ satisfies:
  \begin{enumerate}
  \item $M = F_pM$ for $p \le 0$;
  \item $F_0M \supseteq F_1M \supseteq \dots$;
  \item $a_{(n)}F_qM \subseteq F_{p + q - n - 1}M$ for $p, q \in \mathbb{Z}$, $a \in F_pV$ and $n \in \mathbb{Z}$;
  \item $a_{(n)}F_qM \subseteq F_{p + q - n}M$ for $p, q \in \mathbb{Z}$, $a \in F_pV$ and $n \in \mathbb{N}$.
  \end{enumerate}
\end{proposition}

Let
\begin{equation*}
  \gr_F(M) = \bigoplus_{p \in \mathbb{N}}F_pM/F_{p + 1}M
\end{equation*}
be the associated graded vector space.
By \cite{li_abelianizing_2005}, the vector space $\gr_F(M)$ is a module over $\gr_F(V)$ with operations given as follows.
For $p, q \in \mathbb{N}$, $a \in F_pV$ and $u \in F_pM$, we set:
\begin{align*}
  \sigma_p(a)\sigma^M_q(u) &= \sigma^M_{p + q}(a^M_{(-1)}u), \\
  Y^M_-(\sigma_p(a), z)\sigma^M_q(u) &= \sum_{n \in \mathbb{N}}\sigma^M_{p + q - n}(a^M_{(n)}u)z^{-n - 1},
\end{align*}
where $\sigma^M_p: F_pM \to \gr_F(M)$ is the principal symbol map.
The filtration $(F_pM)_{p \in \mathbb{Z}}$ is called the Li filtration of $M$.

We note that if $V$ were conformal with conformal vector $\omega$, then we do not always have the property $L_{-1}^M(F_pM) \subseteq F_{p + 1}M$ for $p \in \mathbb{Z}$, where $Y(\omega, z) = \sum_{n \in \mathbb{Z}}L^M_nz^{-n - 2}$.
For example, for $V = \Vir^{1/2}$, $M = M(1/2, 1/2)$ and $\vachalf \in F_0M$, we have $L_{-1}\vachalf \notin F_1M$.

\begin{remark}
  \label{rmk:40}
  The observation above makes \cite[Lemma 3.1.2]{arakawa_remark_2012} incorrect because the expression $\sigma_{p - 1}(\omega_{(0)}m)$ that is written there (that should be $\sigma_{p + 1}(\omega_{(0)}m)$, but it still does not work) is not well-defined.
  It is probably not possible to define a differential on $\gr_F(M)$ in a meaningful way.
  We will not need that differential in this thesis, though.
\end{remark}

\begin{lemma}[{\cite[Lemma 2.9]{li_abelianizing_2005}}]
  \label{lmm:24}
  Let $V$ be a vertex algebra, and let $M$ be a $V$-module.
  Then
  \begin{equation*}
    F_pM = \vspan\{a^M_{(-i - 1)}u \mid a \in V, i \in \mathbb{Z}_+, u \in F_{p - i}M\} \quad \text{for $p \in \mathbb{Z}_+$}.
  \end{equation*}
\end{lemma}

By \Cref{lmm:24}, the Li filtration depends only on $M$ and not on the choice of the strong generators of $V$.
If $V$ is graded by a Hamiltonian $H$, and $M$ is graded by a Hamiltonian $H^M$, then $H^M(F_pM) \subseteq F_pM$ because in that case, for $p \in \mathbb{Z}$,
\begin{equation*}
  \begin{split}
    F_pM = \vspan\{a^{1M}_{(-n_1 - 1)}\dots a^{sM}_{(-n_s - 1)}u &\mid \text{$s, n_1, \dots, n_s \in \mathbb{N}$, $a^1, \dots, a^s \in V$ homogeneous,} \\
                                                                 &\quad \text{$u \in M$ homogeneous, $n_1 + \dots + n_s \ge p$}\}.
  \end{split}
\end{equation*}

Therefore, we can define an operator $H^M \in \End(\gr_F(M))$ as $H^M(\sigma^M_p(u)) = \sigma^M_p(Hu)$ for $p \in \mathbb{N}$ and $u \in F_pM$.
For $p \in \mathbb{Z}$ and $\Delta \in \mathbb{C}$, we define $F_pM_{\Delta} = F_pM \cap M_{\Delta}$.
Since $H^M(F_pM) \subseteq F_pM$ for $p \in \mathbb{Z}$, \Cref{lmm:9} implies that
\begin{equation*}
  F_pM = \bigoplus_{\Delta \in \mathbb{C}}F_pM_{\Delta} \quad \text{for $p \in \mathbb{Z}$}.
\end{equation*}
For $\Delta \in \mathbb{C}$, we define $\gr_F(M)_{\Delta} = \bigoplus_{p \in \mathbb{N}}\sigma^M_p(F_pM_{\Delta})$.
Then $H^Mu = \Delta u$ for $u \in \gr_F(M)_{\Delta}$.
The family of subspaces $(\gr_F(M)_{\Delta})_{\Delta \in \mathbb{C}}$ satisfies $\gr_F(M) = \bigoplus_{\Delta \in \mathbb{C}}\gr_F(M)_{\Delta}$.
Therefore, the operator $H^M \in \End(\gr_F(M))$ is diagonalizable with $\gr_F(M)_{\Delta} = \ker(H^M - \Delta\Id_{\gr_F(M)})$.
In fact, more is true.

\begin{theorem}
  \label{thr:50}
  This diagonalizable operator $H^M$ is a Hamiltonian of $\gr_F(M)$.
\end{theorem}

\begin{proof}
  The proof of \Cref{thr:47} also works here.
\end{proof}

We have the natural vector space isomorphisms
\begin{equation*}
  \sigma^M_p(F_pM_{\Delta}) \cong F_pM_{\Delta}/F_{p + 1}M_{\Delta} \quad \text{for $p \in \mathbb{Z}$ and $\Delta \in \mathbb{C}$}
\end{equation*}
and the refined grading
\begin{equation}
  \label{eq:44}
  \gr_F(M) = \bigoplus_{\substack{p \in \mathbb{N} \\ \Delta \in \mathbb{C}}}\sigma_p(F_pM_{\Delta}).
\end{equation}
By \eqref{eq:44}, when $\dim(M)_{\Delta} < \infty$ for $\Delta \in \mathbb{C}$, it is natural to define the refined character of $M$ with respect to the Li filtration as
\begin{equation*}
  \ch_{\gr_F(M)}(t, q) = \sum_{\substack{p \in \mathbb{N} \\ \Delta \in \mathbb{C}}}\dim(\sigma_p(F_pM_{\Delta}))t^pq^{\Delta}.
\end{equation*}

If $f: M_1 \to M_2$ is a homomorphism of $V$-modules, then
\begin{align*}
  \gr_F(f): \gr_F(M_1) &\to \gr_F(M_2), \\
  \gr_F(f)(\sigma^{M_1}_p(u)) &= \sigma^{M_2}_p(f(u)) \quad \text{for $p \in \mathbb{N}$ and $u \in F_pM_1$}
\end{align*}
defines a homomorphism of $\gr_F(V)$-modules.
If $M_1$ and $M_2$ are graded, then we require that $f$ respects the gradings of $M_1$ and $M_2$, and this implies that $\gr_F(f)$ also respects the gradings of $\gr_F(M_1)$ and $\gr_F(M_2)$.
Therefore, we obtain a functor
\begin{equation*}
  \gr_F: \{\text{(graded) $V$-modules}\} \to \{\text{(graded) $\gr_F(V)$-modules}\}.
\end{equation*}

We now introduce a definition not given by Li in \cite{li_vertex_2004}.
Let $V$ be an $\mathbb{N}$-graded conformal vertex algebra with conformal vector $\omega$, let $(a^i)_{i \in I}$ be a family of homogeneous strong generators of $V$, and let $M$ be an $h + \mathbb{N}$-graded $(V, \omega)$-module.
This means $M$ is a $V$-module with $L_0^M$ diagonalizable whose eigenvalues are in the set $h + \mathbb{N}$ for some $h \in \mathbb{C}$.
We set $M_{\Delta} = \ker(L^M_0 - \Delta\Id_M)$ for $\Delta \in \mathbb{C}$, so we have $M = \bigoplus_{n \in \mathbb{N}}M_{h + n}$.
For $p \in \mathbb{Z}$, we set
\begin{equation*}
  \begin{split}
    G^pM = \vspan\{a^{i_1M}_{(-n_1 - 1)}\dots a^{i_sM}_{(-n_s - 1)}u &\mid \text{$s, n_1, \dots, n_s \in \mathbb{N}$, $i_1, \dots, i_s \in I$, $u \in M$ homogeneous,} \\
                                                                     &\quad \Delta_{a^{i_1}} + \dots + \Delta_{a^{i_s}} + \Delta_u - h \le p\}.
  \end{split}
\end{equation*}

\begin{proposition}
  \label{prp:17}
  The filtration $(G^pM)_{p \in \mathbb{Z}}$ satisfies:
  \begin{enumerate}
  \item $G^pM = 0$ for $p < 0$;
  \item $G^0M \subseteq G^1M \subseteq \dots$;
  \item $M_{h + n} \subseteq G^nM$ for $n \in \mathbb{Z}$;
  \item $M = \bigcup_{p \in \mathbb{N}}G^pM$;
  \item $a^M_{(n)}G^qM \subseteq G^{p + q}M$ for $p, q \in \mathbb{Z}$, $a \in G^pV$ and $n \in \mathbb{Z}$;
  \item $a^M_{(n)}G^qM \subseteq G^{p + q - 1}M$ for $p, q \in \mathbb{Z}$, $a \in G^pV$ and $n \in \mathbb{N}$;
  \item $L^M_0(G^pM) \subseteq G^pM$ and $L^M_{-1}(G^pM) \subseteq G^{p + 1}M$ for $p \in \mathbb{Z}$.
  \end{enumerate}
\end{proposition}

\begin{proof}
  The proofs in \cite{li_vertex_2004} also work here.
\end{proof}

\begin{remark}
  \label{rmk:41}
  We do not have the property $L_{-1}^M(G^pM) \subseteq G^pM$ as in the case of vertex algebras.
\end{remark}

Let
\begin{equation*}
  \gr^G(M) = \bigoplus_{p \in \mathbb{N}}G^pM/G^{p - 1}M
\end{equation*}
be the associated graded vector space.
The vector space $\gr^G(M)$ is a module over $\gr^G(V)$ with operations given as follows.
For $p, q \in \mathbb{N}$, $a \in G^pV$ and $u \in G^qM$, we set:
\begin{align*}
  \alpha^p(a)\alpha_M^q(u) &= \alpha_M^{p + q}(a^M_{(-1)}u), \\
  Y^M_-(\alpha^p(a), z)\alpha_M^q(u) &= \sum_{n \in \mathbb{N}}\alpha_M^{p + q - 1}(a^M_{(n)}u)z^{-n - 1},
\end{align*}
where $\alpha_M^p: G^pM \to \gr^G(M)$ is the principal symbol map.
The filtration $(G^pM)_{p \in \mathbb{Z}}$ is called the standard filtration of $M$.
By \Cref{prp:18} ahead, the standard filtration does not depend on the choice of the strong generators of $V$.

By \Cref{prp:14}(vii), we can define an operator $H^M \in \End(\gr^G(M))$ as $H^M(\alpha_M^p(u)) = \alpha_M^p(L^M_0u)$ for $p \in \mathbb{Z}$ and $u \in G^pM$.
For $p \in \mathbb{Z}$ and $n \in \mathbb{N}$, we define $G^pM_{h + n} = G^pV \cap M_{h + n}$.
Since $L_0^M(G^pM) \subseteq G^pM$ for $p \in \mathbb{Z}$, \Cref{lmm:9} implies that
\begin{equation*}
  G^pM = \bigoplus_{n \in \mathbb{N}}G^pM_{h + n} \quad \text{for $p \in \mathbb{Z}$}.
\end{equation*}
For $n \in \mathbb{N}$, we define $\gr^G(M)_{h + n} = \bigoplus_{p \in \mathbb{N}}\alpha_M^p(G^pM_{h + n})$.
Then $H^Mu = (h + n)u$ for $u \in \gr^G(M)_{h + n}$.
The family of subspaces $(\gr^G(M)_{h + n})_{n \in \mathbb{N}}$ satisfies $\gr^G(M) = \bigoplus_{n \in \mathbb{N}}\gr^G(M)_{h + n}$.
Therefore, the operator $H^M \in \End(\gr^G(M))$ is diagonalizable with $\gr^G(M)_{h + n} = \ker(H - (h + n)\Id_{\gr^G(M)})$.
In fact, more is true.

\begin{theorem}
  \label{thr:51}
  This diagonalizable operator $H^M$ is a Hamiltonian of $\gr^G(M)$.
\end{theorem}

\begin{proof}
  The proof of \Cref{thr:47} also works here.
\end{proof}

We have the natural vector space isomorphisms
\begin{equation*}
  \alpha_M^p(G^pM_{h + n}) \cong G^pM_{h + n}/G^{p - 1}M_{h + n} \quad \text{for $p \in \mathbb{Z}$ and $n \in \mathbb{N}$}
\end{equation*}
and the refined grading
\begin{equation}
  \label{eq:45}
  \gr^G(M) = \bigoplus_{p, n \in \mathbb{N}}\alpha_M^p(G^pM_{h + n}).
\end{equation}
By \eqref{eq:45}, when $M$ is ordinary, which means $\dim(M_{h + n}) < \infty$ for $n \in \mathbb{N}$, it is natural to define the refined character of $M$ with respect to the standard filtration as
\begin{equation*}
  \ch_{\gr^G(M)}(t, q) = \sum_{p, n \in \mathbb{N}}\dim(\alpha_M^p(G^pM_{h + n}))t^pq^{h + n} \in q^h\mathbb{C}[[t, q]].
\end{equation*}

If $f: M_1 \to M_2$ is a homomorphism of $h + \mathbb{N}$-graded $(V, \omega)$-modules, then
\begin{align*}
  \gr^G(f): \gr^G(M_1) &\to \gr^G(M_2), \\
  \gr^G(f)(\alpha^p_{M_1}(u)) &= \alpha^p_{M_2}(f(u)) \quad \text{for $p \in \mathbb{N}$ and $u \in G^pM_1$}
\end{align*}
defines a homomorphism of $h + \mathbb{N}$-graded $\gr^G(V)$-modules.
Therefore, we obtain a functor
\begin{equation*}
  \gr^G: \{\text{$h + \mathbb{N}$-graded $(V, \omega)$-modules}\} \to \{\text{$h + \mathbb{N}$-graded $\gr^G(V)$-modules}\}.
\end{equation*}

\begin{proposition}
  \label{prp:18}
  Let $(V, \omega)$ be an $\mathbb{N}$-graded conformal vertex algebra, and let $M$ be an $h + \mathbb{N}$-graded $(V, \omega)$-module.
  Then the Li filtration and the standard filtration satisfy
  \begin{equation*}
    F_pM_{h + n} = G^{n - p}M_{h + n} \quad \text{for $p, n \in \mathbb{N}$}.
  \end{equation*}
  An explicit isomorphism $\gr_F(M) \xrightarrow{\sim} \gr^G(M)$ of modules is defined by extending linearly the isomorphisms of vector spaces given by
  \begin{align*}
    \sigma^M_p(F_pM_{h + n}) &\xrightarrow{\sim} \alpha^{n - p}_M(G^{n - p}M_{h + n}), \\
    \sigma^M_p(u) &\mapsto \alpha^{n - p}_M(u),
  \end{align*}
  where $p, n \in \mathbb{N}$ and $u \in F_pM_{h + n}$.
\end{proposition}

\begin{proof}
  We recall three facts:
  \begin{enumerate}[(a)]
  \item $M_{h + n} \subseteq G^nM$ for $n \in \mathbb{Z}$;
  \item $\Delta_{a^M_{(n)}u} = \Delta_a + \Delta_u - n - 1$ for homogeneous $a \in V$, $u \in M$ and $n \in \mathbb{Z}$;
  \item For $p \in \mathbb{Z}_+$ and $n \in \mathbb{N}$,
    \begin{equation*}
      \begin{split}
        F_pM_{h + n} = \vspan\{a^{i_1M}_{(-n_1 - 1)}u &\mid \text{$i_1 \in I$, $n_1 \in \mathbb{Z}_+$ and $u \in F_{p - n_1}M_{\Delta_u}$} \\
                                                      &\quad \text{satisfy $\Delta_{a^{i_1}} + \Delta_u + n_1 = h + n$}\}.
      \end{split}
    \end{equation*}
  \end{enumerate}

  First, we prove the inclusion $F_pM_{h + n} \subseteq G^{n - p}M_{h + n}$ for $p, n \in \mathbb{N}$.
  We do this by induction on $p \in \mathbb{N}$.
  The base case $p = 0$ is true by property (a) above.
  We now assume $p \ge 1$ and $F_qM_{h + n} \subseteq G^{n - q}M_{h + n}$ for $q < p$ and $n \in \mathbb{N}$.
  We pick an element $a^{i_1M}_{(-n_1 - 1)}u$ from the spanning set of $F_pM_{h + n}$ in property (c) above, with $i_1 \in I$, $n_1 \in \mathbb{Z}_+$ and $u \in F_{p - n_1}M_{\Delta_u}$.
  By the induction hypothesis, we know that $u \in G^{\Delta_u - h - p + n_1}M_{\Delta_u}$, and also $a \in V_{\Delta_{a^{i_1}}} \subseteq G^{\Delta_{a^{i_1}}}V$.
  Therefore, by \Cref{prp:17}(v), $a^{i_1M}_{(-n_1 - 1)}u \in G^{\Delta_{a^{i_1}} + \Delta_u - h - p + n_1}M = G^{n - p}M$.

  We now prove the inclusion $G^{n - p}M_{h + n} \subseteq F_pM_{h + n}$.
  We pick an element $a^{i_1M}_{(-n_1 - 1)}\dots a^{i_sM}_{(-n_s - 1)}u$ from the spanning set of $G^{n - p}M_{h + n}$, where $u \in M_{\Delta_u}, s, n_1, \dots, n_s \in \mathbb{N}, i_1, \dots, i_s \in I$ and $\Delta_{a^{i_1}} + \dots + \Delta_{a^{i_s}} + \Delta_u - h \le n - p$.
  By property (b) above, we must have $\Delta_{a^{i_1}} + \dots + \Delta_{a^{i_s}} + \Delta_u + n_1 + \dots + n_s = h + n$.
  Therefore, $p \le n_1 + \dots + n_s$, so we get $a^{i_1M}_{(-n_1 - 1)}\dots a^{i_sM}_{(-n_s - 1)}u \in F_pM$ straight from the definition of $F_pM$.

  We verify that we obtain an isomorphism $\gr_F(M) \xrightarrow{\sim} \gr^G(M)$ directly from the definitions (cf.\ \Cref{prp:15}).
\end{proof}

\Cref{prp:18} translates into an identity of the refined characters of $M$, as the following proposition shows.
This is also valid for vertex algebras because all the definitions are compatible.

\begin{proposition}
  \label{prp:19}
  Let $(V, \omega)$ be an $\mathbb{N}$-graded conformal vertex algebra, and let $M$ be an $h + \mathbb{N}$-graded $(V, \omega)$-module.
  Then:
  \begin{enumerate}
  \item $\ch_M(q) = \ch_{\gr_F(M)}(q) = \ch_{\gr^G(M)}(q) = \ch_{\gr_F(M)}(1, q) = \ch_{\gr^G(M)}(1, q)$;
  \item $\ch_{\gr^G(M)}(t^{-1}, tq) = t^h\ch_{\gr_F(M)}(t, q)$.
  \end{enumerate}
\end{proposition}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item This is clear from the properties and definitions of the filtrations.
  \item This follows from \Cref{prp:18} and by replacing $p$ by $n - p$ in the following computation
    \begin{align*}
      \ch_{\gr^G(M)}(t^{-1}, tq) &= \sum_{p, n \in \mathbb{N}}\dim(\alpha^p_M(G^pM_{h + n}))t^{-p}(tq)^{h + n} \\
                                 &= \sum_{p, n \in \mathbb{N}}\dim(\alpha^p_M(G^pM_{h + n}))t^{h + n - p}q^{h + n} \\
                                 &= \sum_{p, n \in \mathbb{N}}\dim(\alpha^{n - p}_M(G^{n - p}M_{h + n}))t^{h + p}q^{h + n} \\
                                 &= t^h\ch_{\gr_F(M)}(t, q). \qedhere
    \end{align*}
  \end{enumerate}
\end{proof}

\begin{example}[$\gr^G(M(c, h))$]
  \label{exa:15}
  We pick $c, h \in \mathbb{C}$.
  By \Cref{thr:25}, the Verma module $M(c, h)$ is a module over $\Vir^c$.
  From \Cref{exa:14}, $\gr^G(\Vir^c)$ is isomorphic to $\mathbb{C}[L_{-2}, L_{-3}, \dots]$.
  Similarly, we can prove that $\gr^G(M(c, h))$ is a free $\gr^G(\Vir^c)$-module
  \begin{equation*}
    \gr^G(M(c, h)) = \bigoplus_{k \in \mathbb{N}}\gr^G(\Vir^c)L_{-1}^k.
  \end{equation*}
  More precisely, the isomorphism is given by
  \begin{align*}
    \gr^G(M(c, h)) &\xrightarrow{\sim} \bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k, \\
    \alpha_{M(c, h)}^{2s + k}(L_{-n_1 - 2}^{M(c, h)}\dots L_{-n_s - 2}^{M(c, h)}(L_{-1}^{M(c, h)})^k|c, h\rangle) &\mapsto L_{-n_1 - 2}\dots L_{-n_s - 2}L_{-1}^k,
  \end{align*}
  where $s, k, n_1, \dots, n_s \in \mathbb{N}$.

  Since $\Delta_{L_{-2}\vac} = 2$ and $\Delta_{(L_{-1}^{M(c, h)})^k|c, h\rangle} = k + h$ for $k \in \mathbb{N}$,
  \begin{equation*}
    \ch_{\gr^G(M(c, h))}(t, q) = \frac{q^h}{(1 - tq)\prod_{k \ge 2}(1 - t^2q^k)}.
  \end{equation*}
\end{example}

\begin{remark}
  \label{rmk:42}
  That $+k$ in the isomorphism above is what makes this filtration different from the PBW filtration (see \Cref{sec:almost-comm-algebr}), where all $L_n$ for $n \le -1$ have the same length.
  On the other hand, with the standard filtration, $L_{-1}$ has length equal to $1$, while $L_{-2}$, $L_{-3}$, $\dots$ have length equal to $2$.
\end{remark}

\begin{remark}
  \label{rmk:43}
  The definition of the standard filtration $(G^pM)_{p \in \mathbb{Z}}$ apparently depends on $h$, so we should write it as $(G^p_hM)_{p \in \mathbb{Z}}$.
  However, since $G^p_{h - 1}M = G^{p - 1}_hM$ for $p \in \mathbb{Z}$, $\gr^G_h(M)$ and $\gr^G_{h - 1}(M)$ are isomorphic and $\ch_{\gr^G_{h - 1}(M)}(t, q) = t\ch_{\gr^G_h(M)}(t, q)$.
  If we further require that $M_h \neq 0$ when $M \neq 0$, then $\gr^G(M)$ and $\ch_{\gr^G(M)}(t, q)$ are well-defined.
\end{remark}

\begin{remark}
  \label{rmk:44}
  We could have done the theory of standard filtrations of modules for admissible modules over $\mathbb{N}$-graded vertex algebras (or maybe even over lower truncated $\mathbb{Z}$-graded vertex algebras, as it is done in \cite{li_vertex_2004}).
\end{remark}

\subsection{The Zhu $C_2$-algebra and the $C_2$-cofiniteness condition}
\label{sec:zhu-c_2-algebra}

Let $V$ be a vertex algebra.
By \Cref{lmm:23}, we have
\begin{equation*}
  C_2V = \vspan\{a_{(-2)}b \mid a, b \in V\} = F_1V.
\end{equation*}
We define the \emph{Zhu $C_2$-algebra of $V$} by
\begin{equation*}
  R_V = V/C_2V = F_0V/F_1V \subseteq \gr_F(V).
\end{equation*}
In Zhu's original article \cite{zhu_modular_1996} and other works, $R_V$ is denoted by $A(V)$.

The fact that $\gr_F(V)$ is a vertex Poisson algebra implies that $R_V$ is a Poisson algebra with operations given as follows.
For $a, b \in V$, we set:
\begin{align*}
  \sigma_0(a)\sigma_0(b) &= \sigma_0(a_{(-1)}b), \\
  \{\sigma_0(a), \sigma_0(b)\} &= \sigma_0(a_{(0)}b).
\end{align*}
We have constructed a functor
\begin{equation*}
  R: \{\text{Vertex algebras}\} \to \{\text{Poisson algebras}\}.
\end{equation*}

Oftentimes, some condition on $R_V$ implies or is equivalent to some condition on $V$, as we shall see in this section.
The vertex algebra $V$ is called \emph{$C_2$-cofinite} if $R_V$ is finite dimensional.

If $V$ is graded, then, as we explained in \Cref{sec:filtr-vert-algebr}, $\gr_F(V)$ is graded.
Thus, $R_V$ is also graded, i.e.,
\begin{equation*}
  R_V = \bigoplus_{\Delta \in \mathbb{C}}(R_V)_{\Delta}.
\end{equation*}
Furthermore, if $\sigma_0(a)$ and $\sigma_0(b)$ are homogeneous, then $\sigma_0(a)\sigma_0(b)$ and $\{\sigma_0(a), \sigma_0(b)\}$ are homogeneous with conformal weight:
\begin{align*}
  \Delta_{\sigma_0(a)\sigma_0(b)} &= \Delta_{\sigma_0(a)} + \Delta_{\sigma_0(b)}, \\
  \Delta_{\{\sigma_0(a), \sigma_0(b)\}} &= \Delta_{\sigma_0(a)} + \Delta_{\sigma_0(b)} - 1.
\end{align*}

\begin{example}
  \label{exa:16}
  We pick $c \in \mathbb{C}$ and compute $R_{\Vir^c}$ and $R_{\Vir_c}$.
  We consider $\mathbb{C}[L_{-2}]$ as the polynomial algebra in one variable $L_{-2}$, and we equip it with the trivial Poisson bracket.
  By \Cref{exa:14} and \Cref{prp:15}, we have the following isomorphism of Poisson algebras
  \begin{align*}
    R_{\Vir^c} &\xrightarrow{\sim} \mathbb{C}[L_{-2}], \\
    \sigma_0(L_{-2}\vac) &\mapsto L_{-2}.
  \end{align*}

  We now move onto $\Vir_c$.
  If $c$ is not of the form $c_{p, q}$ for some $p, q \ge 2$ relatively prime integers, then $\Vir_c = \Vir^c$, and we have already solved the problem.
  Therefore, we assume $c$ is of this form.

  We have a natural quotient map
  \begin{align*}
    \pi^c_0: \Vir^c &\twoheadrightarrow \Vir_c, \\
    \pi^c_0(a) &= a + U(\Vir)\{a_{p, q}\}.
  \end{align*}
  Applying the functor $R$, we obtain an epimorphism
  \begin{equation*}
    R_{\pi^c_0}: R_{\Vir^c} \twoheadrightarrow R_{\Vir_c}.
  \end{equation*}
  From the equation $\ker(R_{\pi^c_0}) = \sigma_0(U(\Vir)\{a_{p, q}\})$ and \Cref{thr:23}, we obtain
  \begin{equation*}
    \ker(R_{\pi^c_0}) = \sigma_0(L_{-2}^{(p - 1)(q - 1)/2}\vac).
  \end{equation*}
  In summary,
  \begin{equation*}
    R_{\Vir_c} \cong \mathbb{C}[L_{-2}]/(L_{-2}^{(p - 1)(q - 1)/2}).
  \end{equation*}
  Thus, $\Vir^c$ is never $C_2$-cofinite, while $\Vir_c$ is $C_2$-cofinite only when $c$ is of the form $c_{p, q}$ for some $p, q \ge 2$ relatively prime integers.
\end{example}

Let $V$ be a vertex algebra (no condition on $V$).
The \emph{associated variety of $V$}, denoted by $X_V$, and the \emph{singular support of $V$}, denoted by $SS(V)$, are defined by:
\begin{align*}
  X_V &= \Spec(R_V), \\
  SS(V) &= \Spec(\gr_F(V)).
\end{align*}

\begin{lemma}[{\cite[Lemma 4.2]{li_abelianizing_2005}}]
  \label{lmm:25}
  Let $V$ be a vertex algebra.
  As a differential algebra, $\gr_F(V)$ is generated by $R_V$, i.e., $\gr_F(V) = \mathbb{C}\left[\bigcup_{n \in \mathbb{N}}T^n(R_V)\right]$.
\end{lemma}

We have a natural algebra inclusion $\inc: R_V \hookrightarrow \gr_F(V)$.
We now assume that $R_V$ is finitely generated.
By the universal property of $JR_V$ (see \Cref{sec:jet-algebras-jet}), there is a differential algebra homomorphism $\phi_V: JR_V \to \gr_F(V)$ such that the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    R_V \arrow[rd, "\inc"', hook] \arrow[r, "\inc", hook] & JR_V \arrow[d, "\phi_V"] \\
    & \gr_F(V)
  \end{tikzcd}
\end{equation*}
Because $R_V$ is a Poisson algebra, we can equip $JR_V$ with the level 0 vertex Poisson algebra structure.
From now on, $JR_V$ will be considered as a vertex Poisson algebra.

\begin{lemma}
  \label{lmm:26}
  Let $V$ be a vertex algebra such that $R_V$ is finitely generated.
  The differential algebra homomorphism $\phi_V: JR_V \to \gr_F(V)$ defined above is surjective and is actually a vertex Poisson algebra homomorphism.
  Thus, $SS(V)$ is isomorphic to a closed subscheme of $JX_V$
\end{lemma}

\begin{proof}
  The homomorphism $\phi_V$ is surjective by \Cref{lmm:25}.
  The fact that $\phi_V$ is a vertex Poisson algebra homomorphism is explained in \cite[Proposition 2.5.1]{arakawa_remark_2012}.
\end{proof}

When $\phi_V$ is an isomorphism, we say $V$ is \emph{classically free}.

\begin{example}
  \label{exa:17}
  It was proven in \cite{andrews_singular_2022} that the Ising model $\Vir_{3, 4}$ is not classically free.
  In fact, by \cite[Theorem 2]{andrews_singular_2022},
  \begin{equation*}
    \ker(\phi_{\Vir_{3, 4}}) = (b)_{\partial},
  \end{equation*}
  where
  \begin{equation*}
    b = L_{-4}L_{-3}L_{-2} + \tfrac{1}{6}L_{-5}L_{-2}^2
  \end{equation*}
  and $(b)_{\partial}$ is the differential ideal generated by $b$, cf.\ \Cref{sec:jet-algebras-jet} and \Cref{exa:14} where $\partial$ is denoted by $T$.
\end{example}

In algebra, commutative algebras are often required to be finitely generated.
In the theory of $\mathbb{N}$-graded vertex algebras, the equivalent of this is assuming that $V$ is finitely strongly generated.
Fortunately, these two concepts are related, as the following theorem shows.

\begin{theorem}
  \label{thr:52}
  Let $S \subseteq V$ be a subset of homogeneous elements of an $\mathbb{N}$-graded vertex algebra $V$.
  The following are equivalent:
  \begin{enumerate}
  \item $S$ strongly generates $V$;
  \item $\sigma_0(S)$ generates $R_V$ as an algebra without the Poisson structure.
  \end{enumerate}
  In particular, $V$ is finitely strongly generated if and only if $R_V$ is finitely generated.
\end{theorem}

\begin{proof}
  We assume that $S$ strongly generates $V$.
  Let $\sigma_0(a) \in R_V$ with $a \in V$ arbitrary.
  We know that $a$ is a linear combination of elements of the form $a^1_{(-n_1 - 1)}\dots a^s_{(-n_s - 1)}\vac$, where $s, n_1, \dots, n_s \in \mathbb{N}$ and $a^1, \dots, a^s \in S$.
  However, $\sigma_0(a^1_{(-n_1 - 1)}\dots a^s_{(-n_s - 1)}\vac) = 0$ if any $n_i > 0$, and if $n_1 = \dots = n_s = 0$, we have $\sigma_0(a^1_{(-n_1 - 1)}\dots a^s_{(-n_s - 1)}\vac) = \sigma_0(a^1_{(-1)}\dots a^s_{(-1)}\vac) = \sigma_0(a^1)\dots\sigma_0(a^s) \in \mathbb{C}[\sigma_0(S)]$.
  Therefore, $\sigma_0(a) \in \mathbb{C}[\sigma_0(S)]$ and $R_V = \mathbb{C}[\sigma_0(S)]$.

  We now assume that $R_V = \mathbb{C}[\sigma_0(S)]$.
  We define the subspace $W$ strongly generated by $S$ by setting
  \begin{equation*}
    W = \vspan\{a^1_{(-n_1 - 1)}\dots a^s_{(-n_s - 1)}\vac \mid s, n_1, \dots, n_s \in \mathbb{N}, a^1, \dots, a^s \in S\}.
  \end{equation*}
  As the elements of $S$ are homogeneous, the subspace $W$ is $H$-invariant.
  By \Cref{lmm:9},
  \begin{equation}
    \label{eq:46}
    W = \sum_{n \in \mathbb{N}}W \cap V_n.
  \end{equation}
  Our objective is to show that $V = W$.
  By \Cref{thr:16}(i)--(ii) and \Cref{crl:1}, for $m, n \in \mathbb{N}$ and $a, b \in V$, we have
  \begin{align*}
    \sigma_n(T^n(a))\sigma_m(T^m(b)) &= \sigma_n(n!a_{(-n - 1)}\vac)\sigma_m(m!b_{(-m - 1)}\vac) \\
                                     &= \sigma_{n + m}((n!a_{(-n - 1)}\vac)_{(-1)}(m!b_{(-m - 1)}\vac)) \\
                                     &= n!m!\sigma_{n + m}(a_{(-n - 1)}b_{(-m - 1)}\vac).
  \end{align*}
  By \Cref{lmm:25},
  \begin{equation*}
    \gr_F(V) = \mathbb{C}\left[\bigcup_{n \in \mathbb{N}}T^n(R_V)\right] = \mathbb{C}\left[\bigcup_{n \in \mathbb{N}}T^n(\mathbb{C}[\sigma_0(S)])\right] = \mathbb{C}\left[\bigcup_{n \in \mathbb{N}}T^n(\sigma_0(S))\right].
  \end{equation*}
  It is enough to show that for $n \in \mathbb{N}$, $V_n \subseteq W$.
  Thus, we fix $n_0 \in \mathbb{N}$.
  By \Cref{prp:15}, there exists $N \in \mathbb{N}$ such that $F_pV_{n_0} = 0$ for $p > N$.
  We now pick $a \in F_NV_{n_0}$.
  We know there exist $s, n_1, \dots, n_s \in \mathbb{N}$, $a^1, \dots, a^s \in S$ and $p(x_1, \dots, x_s) = \sum_{v \in \mathbb{N}^s}t_vx_1^{v_1}\dots x_s^{v_s} \in \mathbb{C}[x_1, \dots, x_s]$, where $t_v \in \mathbb{C}$ for $v \in \mathbb{N}^s$, such that
  \begin{align*}
    \sigma_N(a) &= p(T^{n_1}(\sigma_0(a^1)), \dots, T^{n_s}(\sigma_0(a^s))) \\
                &= p(\sigma_{n_1}(T^{n_1}(a^1)), \dots, \sigma_{n_s}(T^{n_s}(a^s))) \\
                &= \sum_{v \in \mathbb{N}^s}t_v(n_1!)^{v_1}\dots(n_s!)^{v_s}\sigma_{v_1n_1 + \dots + v_sn_s}((a^1_{(-n_1 - 1)})^{v_1}\dots(a^s_{(-n_s - 1)})^{v_s}\vac).
  \end{align*}
  Therefore,
  \begin{equation*}
    \sigma_N(a) = \sigma_N(b),
  \end{equation*}
  where
  \begin{equation*}
    b = \sum_{\substack{v \in \mathbb{N}^s \\ v_1n_1 + \dots + v_sn_s = N}}t_v(n_1!)^{v_1}\dots(n_s!)^{v_s}(a^1_{(-n_1 - 1)})^{v_1}\dots(a^s_{(-n_s - 1)})^{v_s}\vac \in W.
  \end{equation*}
  This means $a - b \in F_{N + 1}V$.
  By \eqref{eq:46}, we can write $b = \sum_{n \in \mathbb{N}}b_n$, where $b_n \in W \cap V_n$ for $n \in \mathbb{N}$.
  Therefore, $a - b_{n_0} \in F_{N + 1}V_{n_0} = 0$, and this implies $a \in W$.
  We concluded that $F_NV_{n_0} \subseteq W$ from $F_{N + 1}V_{n_0} = 0 \subseteq W$.
  In the same way, we can conclude that $F_{N - 1}V_{n_0} \subseteq W$ from $F_NV_{n_0} \subseteq W$, and we conclude using induction that $F_0V_{n_0} = V_{n_0} \subseteq W$, finishing the proof.
\end{proof}

\begin{remark}
  \label{rmk:45}
  For a generalization of \Cref{thr:52} assuming $V$ is a lower truncated $\mathbb{Z}$-graded vertex algebra, see \cite[Theorem 4.8]{li_abelianizing_2005}.
\end{remark}

\begin{remark}
  \label{rmk:46}
  In the proof of \cite[Corollary 2.6.2]{arakawa_remark_2012}, it is commented that the principal symbol map gives the isomorphism $V \xrightarrow{\sim} \gr_F(V)$.
  However, there are some difficulties with this because if there were such an isomorphism, it should be natural and valid for every vertex algebra $V$, given that $V$ is defined for every vertex algebra (see \Cref{sec:filtr-vert-algebr}).
  We now present an example in which $V$ and $\gr_F(V)$ satisfy:
  \begin{enumerate}
  \item $\bigcap_{p \in \mathbb{N}}F_pV = 0$;
  \item The vector spaces $V$ and $\gr_F(V)$ have different dimensions;
  \item $R_V$ is finitely generated, but $V$ is not finitely strongly generated.
  \end{enumerate}
  We consider the commutative vertex algebra $V = \mathbb{C}[[t]]$ with derivation $T = t^2\frac{d}{dt}$.
  We have:
  \begin{align*}
    F_0V &= \mathbb{C}[[t]], \\
    F_pV &= t^{1 + p}\mathbb{C}[[t]] \quad \text{for $p \in \mathbb{Z}_+$}.
  \end{align*}
  From this, we get (i), and we have the following isomorphisms of vector spaces:
  \begin{align*}
    \gr_F(V) &= \bigoplus_{p \in \mathbb{N}}F_pV/F_{p + 1}V \\
             &= \mathbb{C}[[t]]/t^2\mathbb{C}[[t]] \oplus t^2\mathbb{C}[[t]]/t^3\mathbb{C}[[t]] \oplus t^3\mathbb{C}[[t]]/t^4\mathbb{C}[[t]] \oplus \dots \\
             &\cong \mathbb{C}^2 \oplus \mathbb{C} \oplus \mathbb{C} \oplus \dots, \\
    R_V &= V/F_1V \\
             &= \mathbb{C}[[t]]/t^2\mathbb{C}[[t]] \\
             &\cong \mathbb{C}[t]/(t^2).
  \end{align*}
  Thus, $\gr_F(V)$ has countable dimension.
  However, $V$ has uncountable dimension, and we get (ii).

  From the definition of the Zhu $C_2$-algebra, we see that $R_V$ is isomorphic to $\mathbb{C}[t]/(t^2)$ as an algebra, and the latter is generated by the single element $t + (t^2)$.
  However, $V$ cannot be finitely strongly generated because it has uncountable dimension, and we get (iii).

  From this example, we see that the assumption of $V$ being $\mathbb{N}$-graded cannot be removed in \Cref{thr:52}, although we can assume that $V$ is lower truncated $\mathbb{Z}$-graded.
\end{remark}

\begin{theorem}
  \label{thr:53}
  Let $V$ be a vertex algebra such that $R_V$ is finitely generated.
  Then the following are equivalent:
  \begin{enumerate}
  \item $V$ is $C_2$-cofinite;
  \item $\dim(X_V) = 0$;
  \item $X_V$ is finite and discrete;
  \item $\dim(SS(V)) = 0$.
  \end{enumerate}
  If $V$ is conical, then $(R_V)_0 = \mathbb{C}\sigma_0(\vac)$ and \emph{(i)--(iv)} are also equivalent to
  \begin{enumerate}
    \setcounter{enumi}{4}
  \item $X_V = \{\mathrm{point}\}$.
  \end{enumerate}
\end{theorem}

\begin{proof}\leavevmode
  \begin{description}[font = \normalfont, leftmargin = *]
  \item [(i)$\iff$(ii)] By \cite[Exercise 19.17]{altman_term_2018}, $R_V$ is finite dimensional if and only if $R_V$ is Artinian, and by \cite[Theorem 19.8]{altman_term_2018}, $R_V$ is Artinian if and only if $0 = \dim(R_V) = \dim(X_V)$.
  \item[(ii)$\implies$(iii)] By \cite[Theorem 19.8]{altman_term_2018}, $X_V$ is finite.
    Since $\dim(X_V) = 0$, every prime ideal is maximal.
    Thus, $X_V$ is discrete.
  \item[(iii)$\implies$(ii)] Clear.
  \item[(ii)$\implies$(iv)] By \Cref{thr:59}, $\dim(JX_V) = 0$.
    By \Cref{lmm:26}, $\dim(SS(V)) = 0$.
  \item[(iv)$\implies$(ii)] This follows by considering the projection onto the $0$-th component $\gr_F(V) \twoheadrightarrow R_V$ which shows that $\dim(R_V) \le \dim(\gr_F(V))$.
  \end{description}

  We now assume that $V$ is conical, i.e., $V = \bigoplus_{n \in \mathbb{N}}V_n$ and $V_0 = \mathbb{C}\vac$.
  Clearly, $R_V = \bigoplus_{n \in \mathbb{N}}(R_V)_n$ and $(R_V)_0 = \mathbb{C}\sigma_0(\vac)$.
  Since $\Delta_{\Delta_0(a)\Delta_0(b)} = \Delta_{\sigma_0(a)} + \Delta_{\sigma_0(b)}$, $\sum_{n \in \mathbb{Z}_+}(R_V)_n$ is a maximal ideal of $R_V$.
  In fact, it is the unique maximal proper ideal of $R_V$.
  \begin{description}[font = \normalfont, leftmargin = *]
  \item[(ii)$\implies$(v)] By definition, every prime in $R_V$ is maximal.
    Since $R_V$ has a unique maximal proper ideal, $X_V = \{\mathrm{point}\}$.
  \item[(v)$\implies$(iii)] Clear. \qedhere
  \end{description}
\end{proof}

Thus, $C_2$-cofinite vertex algebras can be regarded as a generalization of finite-dimensional finitely generated algebras.

\begin{theorem}[{\cite[Theorem 4.5]{abe_rationality_2003}}]
  \label{thr:54}
  Let $V$ be a conical conformal vertex algebra.
  Then $V$ is regular if and only if $V$ is $C_2$-cofinite and rational.
\end{theorem}

\begin{example}
  \label{exa:18}
  Assume $c$ is of the form $c_{p, q}$ for some $p, q \ge 2$ relatively prime integers.
  By \Cref{exa:12}, \Cref{exa:16} and \Cref{thr:54}, $\Vir_c$ is regular.
\end{example}

Let $V$ be a vertex algebra, and let $M$ be a module over $V$.
By \Cref{lmm:24}, we have
\begin{equation*}
  C_2M = \vspan\{a^M_{(-2)}u \mid a \in V, u \in M\} = F_1M.
\end{equation*}
We define the \emph{Zhu $C_2$-module of $M$} by
\begin{equation*}
  R_M = M/C_2M = F_0M/F_1M \subseteq \gr_F(M).
\end{equation*}
The fact that $\gr_F(M)$ is a module over $\gr_F(V)$ implies that $R_M$ is a module over $R_V$ with operations given as follows.
For $a \in V$ and $u \in M$, we set:
\begin{align*}
  \sigma_0(a)\sigma^M_0(u) &= \sigma^M_0(a^M_{(-1)}u), \\
  \{\sigma_0(a), \sigma^M_0(u)\} &= \sigma^M_0(a^M_{(0)}u).
\end{align*}
We have constructed a functor
\begin{equation*}
  R: \text{$V$-Mod} \to \text{$R_V$-Mod}.
\end{equation*}

A $V$-module $M$ is called \emph{$C_2$-cofinite} if $R_M$ is finite dimensional.
The condition of $C_2$-cofiniteness on modules has several implications, as we will see later.

Let $V$ be a vertex algebra (no condition on $V$), and let $M$ be a $V$-module.
The \emph{associated variety of $M$}, denoted by $X_M$, and the \emph{singular support of $M$}, denoted by $SS(M)$, are defined by:
\begin{align*}
  X_M &= \Supp_{R_M}(R_V), \\
  SS(M) &= \Supp_{\gr_F(V)}(\gr_F(M)).
\end{align*}

\begin{theorem}[{\cite[Lemma 4.2]{li_abelianizing_2005}}]
  \label{thr:55}
  Let $V$ be a vertex algebra, and let $M$ be a $V$-module.
  As a $\gr_F(V)$-module without the Poisson structure, $\gr_F(M)$ is generated by $R_M$, i.e.,
  \begin{equation*}
    \gr_F(M) = \gr_F(V)R_M.
  \end{equation*}
\end{theorem}

Let $V$ be a vertex algebra such that $R_V$ is finitely generated, and let $M$ be a $V$-module.
We have a natural inclusion $\inc: R_M \hookrightarrow \gr_F(M)$ of $R_V$-modules.
As we have explained in \Cref{sec:vert-poiss-algeb-1}, we can consider $JR_V \otimes R_M$ as a $JR_V$-module.
Because we have an epimorphism of vertex Poisson algebras $\phi_V: JR_V \twoheadrightarrow \gr_F(V)$, we can consider the $\gr_F(V)$-module $\gr_F(M)$ as a $JR_V$-module.
By the universal property of the $JR_V$-module $JR_V \otimes R_M$ (see \Cref{sec:vert-poiss-algeb-1}), there is a $JR_V$-module homomorphism $\phi_M: JR_V \otimes_{R_V} R_M \to \gr_F(M)$ such that the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    R_M \arrow[r, "\inc", hook] \arrow[rd, "\inc"', hook] & JR_V \otimes_{R_V} R_M \arrow[d, "\phi_M"] \\
    & \gr_F(M)
  \end{tikzcd}
\end{equation*}

\begin{lemma}
  \label{lmm:27}
  The $JR_V$-module homomorphism $\phi_M: JR_V \otimes_{R_V} R_M \to \gr_F(M)$ defined above is surjective.
\end{lemma}

\begin{proof}
  The assertion follows from \Cref{thr:55}.
\end{proof}

\begin{theorem}
  \label{thr:56}
  Let $V$ be a vertex operator algebra, let $M$ be an admissible $V$-module, and let $T \subseteq M$ be a subset of homogeneous elements of $M$.
  The following are equivalent:
  \begin{enumerate}
  \item $M$ is strongly generated over $V$ by $T$;
  \item $\sigma^M_0(T)$ generates $R_M$ as a module over $R_V$ without the Poisson structure.
  \end{enumerate}
  In particular, $M$ is finitely strongly generated over $V$ if and only if $R_M$ is a finitely generated $R_V$-module.
\end{theorem}

\begin{proof}
  We assume that $M$ is strongly generated over $V$ by $T$.
  Let $\sigma^M_0(v) \in R_V$ with $v \in M$ arbitrary.
  We know that $v$ is a linear combination of elements of the form $a^{1M}_{(-n_1 - 1)}\dots a^{sM}_{(-n_s - 1)}u$, where $s, n_1, \dots, n_s \in \mathbb{N}$ and $a^1, \dots, a^s \in V$ and $u \in T$.
  However, $\sigma^M_0(a^{1M}_{(-n_1 - 1)}\dots a^{sM}_{(-n_s - 1)}u) = 0$ if any $n_i > 0$, and if $n_1 = \dots = n_s = 0$, we have $\sigma_0(a^{1M}_{(-n_1 - 1)}\dots a^{sM}_{(-n_s - 1)}u) = \sigma_0(a^{1M}_{(-1)}\dots a^{sM}_{(-1)}u) = \sigma_0(a^1)\dots\sigma_0(a^s)\sigma^M_0(u) \in R_V\sigma^M_0(T)$.
  Therefore, $\sigma_0(v) \in R_V\sigma^M_0(T)$ and $R_M = R_V\sigma^M_0(T)$.

  We now assume that $R_M = R_V\sigma^M_0(T)$.
  We define
  \begin{equation*}
    M^0 = \vspan\{a^M_{(-1)}u \mid \text{$a \in V$ homogeneous and $u \in T$}\}.
  \end{equation*}
  Because any element of $V$ is a sum of a finite number of homogeneous elements, the equation $R_M = R_V\sigma^M_0(T)$ implies that $M = M^0 + C_2M$.
  By \cite[Proposition 4.12]{li_abelianizing_2005},
  \begin{equation*}
    M = \vspan\{a^{1M}_{(-n_1 - 1)}\dots a^{sM}_{(-n_s - 1)}w \mid s \in \mathbb{Z}_+, n_1 > \dots > n_s \ge 0, a^1, \dots, a^s \in V, w \in M^0\}.
  \end{equation*}
  By the definition of $M^0$, we conclude that $M$ is strongly generated over $V$ by $T$.
\end{proof}

\begin{theorem}
  \label{thr:57}
  Let $V$ be a vertex algebra such that $R_V$ is finitely generated, let $M$ be a $V$-module, and we assume that $R_M$ is a finitely generated $R_V$-module.
  Then the following are equivalent:
  \begin{enumerate}
  \item $M$ is $C_2$-cofinite;
  \item $\dim(X_M) = 0$;
  \item $X_M$ is finite and discrete;
  \item $\dim(SS(M)) = 0$.
  \end{enumerate}
  If $V$ is conical, then \emph{(i)--(iv)} are also equivalent to
  \begin{enumerate}
    \setcounter{enumi}{4}
  \item $X_M = \{\mathrm{point}\}$.
  \end{enumerate}
\end{theorem}

\begin{proof}
  The proof of \Cref{thr:53} works with minor modifications.
\end{proof}

\begin{theorem}
  \label{thr:58}
  Let $V$ be a $C_2$-cofinite conical conformal vertex algebra.
  Then:
  \begin{enumerate}
  \item Any $V$-module $M$ satisfies $M = M^{\Gen}$ and \eqref{eq:30};
  \item $\For\circ\Gen = \Id_{\text{\emph{$V$-Mod}}}$;
  \item Both $\For$ and $\Gen$ are equivalences of categories;
  \item If $M$ is a $V$-module, then $M$ is irreducible as a $V$-module if and only if $M$ with grading $\bigoplus_{n \in \mathbb{Z}}M^{\Gen}(n)$ is irreducible as an admissible $V$-module;
  \item Any irreducible $V$-module is an irreducible ordinary positive energy representation of $V$.
  \end{enumerate}
\end{theorem}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item The equality $M = M^{\Gen}$ is proved in \cite[Proposition 5.7]{abe_rationality_2003} and \eqref{eq:30} is proved in \cite[Lemma 5.6]{abe_rationality_2003}.
  \item This is obvious.
  \item By \Cref{prp:10}(iv), both $\For$ and $\Gen$ are essentially surjective functors.
    Both are fully faithful by definition.
    Thus, both are equivalences of categories.
  \item If $M$ is irreducible as a $V$-module then it clearly is irreducible as an admissible $V$-module.
    We now assume $M$ is irreducible as an admissible $V$-module.
    By (i), we can assume that $M = \bigoplus_{n \in \mathbb{Z}}M^{\Gen}(n)$.
    Let $N$ be a proper submodule of $M$.
    Then $L_0^M(N) \subseteq N$.
    By \Cref{lmm:10}(iii), $N = \sum_{\Delta \in \mathbb{C}}N \cap M^{\Gen}_{\Delta}$.
    This implies that $N = \sum_{n \in \mathbb{Z}}N \cap M^{\Gen}(n)$, i.e., $N$ is a proper graded submodule of $M$.
    Therefore, $N = 0$.
    In conclusion, $M$ is irreducible as a $V$-module.
  \item This is \cite[Corollary 5.8]{abe_rationality_2003}. \qedhere
  \end{enumerate}
\end{proof}

By \Cref{thr:58}, when $V$ is a $C_2$-cofinite conical conformal vertex algebra, to find all irreducibles in the category of $V$-modules, it is enough to find all irreducibles in the category of admissible $V$-modules.
By \Cref{exa:16}, the Ising model $\Vir_{3, 4} = \Vir_{1/2}$ satisfies these conditions.

\section{PBW basis of $L(1/2, 1/2)$ and its refined character}
\label{sec:pbw-basis-l12}

In this section, our objective is to determine a PBW basis of $L(1/2, 1/2)$ explicitly and a formula for the refined character of $\gr^G(L(1/2, 1/2))$ with respect to the standard filtration, as introduced in \Cref{sec:filtr-modul-over}.
We present a family of series in two variables $f_{a, b, c, d}(t, q)$, where $a, b, c, d \in \mathbb{N}$ are the parameters, which are Nahm sums for the same matrix $\left(\begin{smallmatrix} 8 & 3 \\ 3 & 2 \end{smallmatrix}\right)$ (cf.\ \cite{Nahm2007}) when we set $t = 1$.
These series satisfy some recursive relations which will help us to prove series identities.
Then, we find a formula for the refined character of $\gr^G(L(1/2, 1/2))$ using these series and the recursive relations they satisfy.
The arguments are elementary and combinatorial but lengthy.
We recover the series obtained in \cite[Theorem 4]{andrews_singular_2022} when we set $t = 1$, as expected.
In the explicit monomial basis of \Cref{thr:4}, there are ordinary and exceptional partitions.
The ordinary partitions are handled by the theory of $\Vir_{1/2}$-modules done in \Cref{sec:modul-over-viras}.
The exceptional partitions are handled with computer software.
As we can see, the arguments are similar to those in \cite{andrews_singular_2022}, but there are some differences such as the use of the Zhu algebra here but not in \cite{andrews_singular_2022}, and the fact that we do not have a differential available (see \Cref{rmk:40}).
Finally, we give formal proofs of \Cref{thr:3} and \Cref{thr:4}.

\subsection{Conventions and notation}
\label{sec:conventions-notation}

Throughout this section, $V$ will always denote the vertex algebra $\Vir^{1/2}$.
From now on, some subscripts or superscripts of modules will be omitted, so for example, $\alpha^p_M$ simplifies to $\alpha^p$.
We set:
\begin{equation*}
  M = M(1/2, 1/2), L = L(1/2, 1/2), W = J(1/2, 1/2).
\end{equation*}
Then $M$ and $L$ are $V$-modules and, by definition, $L = M/W$.
By \Cref{thr:45},
\begin{equation}
  \label{eq:47}
  W = U(\Vir)\{u_2, u_3\},
\end{equation}
where the generating singular vectors are:
\begin{equation}
  \label{eq:48}
  u_2 = (L_{-1}^2 - \tfrac{4}{3}L_{-2})\vachalf, u_3 = (L_{-1}^3 - 3L_{-2}L_{-1} + \tfrac{3}{4}L_{-3})\vachalf.
\end{equation}

We have a natural epimorphism of $V$-modules
\begin{align*}
  \pi: M &\twoheadrightarrow L, \\
  \pi(u) &= u + W.
\end{align*}
Applying the functor $\gr^G$, we obtain an epimorphism of modules over $\gr^G(V)$
\begin{equation*}
  \gr^G(\pi): \gr^G(M) \twoheadrightarrow \gr^G(L),
\end{equation*}
and this produces a natural isomorphism of modules over $\gr^G(V)$
\begin{equation*}
  \gr^G(M)/K \xrightarrow{\sim} \gr^G(L),
\end{equation*}
where
\begin{equation}
  \label{eq:49}
  K = \ker(\gr^G(\pi)).
\end{equation}

The isomorphism in \Cref{exa:15} justifies the following definitions.
For a partition $\lambda = [\lambda_1, \dots, \lambda_m, 1, \dots, 1]$ with exactly $n$ ones, we define $u_{\lambda} \in \bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k$ by setting
\begin{equation*}
  u_{\lambda} = L_{-\lambda_1}\dots L_{-\lambda_m}L_{-1}^n.
\end{equation*}
We define the \emph{length of $\lambda$} as
\begin{equation*}
  \len(\lambda) = 2m + n
\end{equation*}
and the \emph{weight of $\lambda$} as
\begin{equation*}
  \Delta(\lambda) = \lambda_1 + \dots + \lambda_m + n.
\end{equation*}
Therefore, for a partition $\lambda$, we have
\begin{equation*}
  L_{\lambda}\vachalf \in G^{\len(\lambda)}M_{1/2 + \Delta(\lambda)}.
\end{equation*}
For a partition $\lambda = [\lambda_1, \dots, \lambda_m]$ with $\lambda_m \ge 2$, we define $p_{\lambda} \in \mathbb{C}[L_{-2}, L_{-3}, \dots]$ by setting
\begin{equation*}
  p_{\lambda} = L_{-\lambda_1}\dots L_{-\lambda_m}.
\end{equation*}

From the epimorphism of $V$-modules $\pi: M \twoheadrightarrow L$, we deduce the following four isomorphisms which are going to be used frequently implicitly.

\begin{proposition}
  \label{prp:20}
  We have four (conformal) weight-preserving vector space isomorphisms:
  \begin{align*}
    M &\xrightarrow{\sim} \gr^G(M), \\
    L_{\lambda}\vachalf &\mapsto \alpha^{\len(\lambda)}(L_{\lambda}\vachalf), \\
    \gr^G(M) &\xrightarrow{\sim} \bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k, \\
    \alpha^{\len(\lambda)}(L_{\lambda}\vachalf) &\mapsto u_{\lambda}, \\
    L &\xrightarrow{\sim} \gr^G(L), \\
    L_{\lambda}(\vachalf + W) &\mapsto \alpha^{\len(\lambda)}(L_{\lambda}(\vachalf + W)), \\
    \gr^G(L) &\xrightarrow{\sim} \gr^G(M)/K, \\
    \alpha^{\len(\lambda)}(L_{\lambda}(\vachalf + W)) &\mapsto \alpha^{\len(\lambda)}(L_{\lambda}\vachalf) + K,
  \end{align*}
  where $\lambda$ is a partition.
\end{proposition}

In this thesis, we will deal with polynomial algebras written as $\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]$ and free modules of the form $\bigoplus_{n \le N}\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]L_{-1}^n$ for some $N \in \mathbb{N}$.
We will always use the degree reverse lexicographic order with $L_{-2} > L_{-3} > \dots > L_{-N}$ and TOP (term over position) with $L_{-1}^0 < L_{-1}^1 < \dots < L_{-1}^N$, see \cite[\S3.5]{adams_introduction_1994}.
Let $u \in \bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k$.
We can define the \emph{leading monomial of $u$}, denoted by $\lm(u)$, as follows.
We pick $N$ large enough so that $u \in \bigoplus_{n \le N}\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]L_{-1}^n$.
Then, we define $\lm(u)$ as the leading monomial in $\bigoplus_{n \le N}\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]L_{-1}^n$, which is naturally a subset of $\bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k$.
This does not depend on the choice of $N$.

When working with $q$-series, the following notation is useful.
The \emph{$q$-Pochhammer symbol} is $(q)_n = \prod_{j = 1}^n(1 - q^j) \in \mathbb{C}[q]$ for $n \in \mathbb{N}$.
The recursive proof of the series identities in \cite{andrews_singular_2022} suggests the following definition.
For $a, b, c, d \in \mathbb{N}$, we define
\begin{equation*}
  f_{a, b, c, d}(t, q) = \sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2 + d}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2 + ak_1 + bk_2 + c}}{(q)_{k_1}(q)_{k_2}} \in \mathbb{C}[[t, q]].
\end{equation*}
The following lemma will be used frequently to verify series identities.

\begin{lemma}
  \label{lmm:28}
  The series $f_{a, b, c, d}(t, q)$ satisfies:
  \begin{enumerate}
  \item $t^mq^nf_{a, b, c, d}(t, q) = f_{a, b, c + n, d + m}(t, q)$ for $m, n \in \mathbb{N}$;
  \item $f_{a, b, c, d}(tq^n, q) = f_{a + 4n, b + 2n, c + dn, d}(t, q)$ for $n \in \frac{1}{2}\mathbb{N}$ and $d \in 2\mathbb{N}$;
  \item $f_{a, b, c, d}(t, q) - f_{a + n, b, c, d}(t, q) = \sum_{k = 0}^{n - 1}f_{a + 8 + k, b + 3, a + c + 4 + k, d + 4}(t, q)$ for $n \in \mathbb{Z}_+$;
  \item $f_{a, b, c, d}(t, q) - f_{a, b + n, c, d}(t, q) = \sum_{k = 0}^{n - 1}f_{a + 3, b + 2 + k, b + c + 1 + k, d + 2}(t, q)$ for $n \in \mathbb{Z}_+$.
  \end{enumerate}
\end{lemma}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item Clear.
  \item Clear.
  \item The key step is replacing $k_1$ by $k_1 + 1$ in the following computation
    \begin{align*}
      f_{a, b, c, d}(t, q) - f_{a + n, b, c, d}(t, q) &= \sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2 + d}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2 + ak_1 + bk_2 + c}}{(q)_{k_1}(q)_{k_2}}(1 - q^{nk_1}) \\
                                                      &= \sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2 + d}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2 + ak_1 + bk_2 + c}}{(q)_{k_1}(q)_{k_2}}(1 - q^{k_1})\sum_{k = 0}^{n - 1}q^{kk_1} \\
                                                      &= \sum_{k = 0}^{n - 1}\sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2 + d}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2 + (a + k)k_1 + bk_2 + c}}{(q)_{k_1}(q)_{k_2}}(1 - q^{k_1}) \\
                                                      &= \sum_{k = 0}^{n - 1}\sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2 + d + 4}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2 + (a + 8 + k)k_1 + (b + 3)k_2 + a + c + 4 + k}}{(q)_{k_1}(q)_{k_2}} \\
                                                      &= \sum_{k = 0}^{n - 1}f_{a + 8 + k, b + 3, a + c + 4 + k, d + 4}(t, q).
    \end{align*}
  \item Same trick as (iii) but with $k_2$ instead of $k_1$. \qedhere
  \end{enumerate}
\end{proof}

\subsection{A combinatorial argument}
\label{sec:comb-argum}

A partition $\lambda = [\lambda_1, \dots, \lambda_m]$ \emph{contains a partition} $\eta = [\eta_1, \dots, \eta_n]$, written as $\eta \subseteq \lambda$, if $m \ge n$ and there is $i \in \mathbb{Z}_+$ such that $1 \le i \le m - n + 1$ and $[\lambda_i, \lambda_{i + 1}, \dots, \lambda_{i + n - 1}] = \eta$.

We define
\begin{equation*}
  p(t, q) = \sum_{\lambda \in P}t^{\len(\lambda)}q^{\Delta(\lambda)} \in \mathbb{C}[[t, q]],
\end{equation*}
where $P$ is the set of partitions that do not contain any partition in $R$ as defined in \Cref{sec:introduction}, i.e.,
\begin{equation*}
  P = \{\lambda \mid \text{for $\eta \in R$, $\lambda \nsupseteq \eta$}\}.
\end{equation*}
We call the last eight partitions of $R$ \emph{exceptional partitions}, and the others involving $r$ are called \emph{ordinary partitions}.
For $m, n \in \mathbb{N}$, we set:
\begin{align*}
  P(n) &= \{\lambda \in P \mid \Delta(\lambda) = n\}, \\
  p(q) &= \sum_{n \in \mathbb{N}}|P(n)|q^n \in \mathbb{C}[[q]], \\
  P(n, m) &= \{\lambda \in P \mid \text{$\len(\lambda) = m$ and $\Delta(\lambda) = n$}\}.
\end{align*}
Therefore, we have:
\begin{align*}
  p(t, q) &= \sum_{m, n \in \mathbb{N}}|P(n, m)|t^mq^n, \\
  p(1, q) &= p(q).
\end{align*}
We wish to find an expression for $p(t, q)$ as a sum of series $f_{a, b, c, d}(t, q)$ for some tuples $(a, b, c, d)$.

We now define subsets of $P$, which will help us in finding an expression for $p(t, q)$, by setting:
\begin{align*}
  P_{>2} &= \{[\lambda_1, \dots, \lambda_m] \in P \mid \text{$\lambda_m > 2$ or $\lambda = \emptyset$}\}, \\
  P_2 &= \{[\lambda_1, \dots, \lambda_m] \in P \mid \lambda_m = 2\},
\end{align*}
and both $p_{>2}(t, q)$ and $P_{>2}(n, m)$ are defined like $p(t, q)$ and $P(n, m)$ were defined.
Likewise, we define $P_{>6, 5, 3}$, $P_{6, 5, 3}$, $p_{>6, 5, 3}(t, q)$, $p_{6, 5, 3}(t, q)$, $P_{>6, 5, 3}(n, m)$ and $P_{6, 5, 3}(n, m)$.
It turns out that $P$ decomposes as a disjoint union of these smaller objects, and we can find recurrence relations between them to find our desired formula for $p(t, q)$.

\begin{lemma}
  \label{lmm:29}
  The formal power series $p_{>2}(t, q)$ is given by
  \begin{equation*}
    p_{>2}(t, q) = f_{3, 2, 0, 0}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  We consider the disjoint union
  \begin{equation*}
    P_{>2} = P_{4, 3} \cup P_{6, 5, 3} \cup P_{>6, 5, 3} \cup P_{>5, 3} \cup P_{4, 4} \cup P_{5, 4} \cup P_{>5, 4} \cup P_{>4},
  \end{equation*}
  from which we get the formula
  \begin{equation*}
    p_{>2}(t, q) = p_{4, 3}(t, q) + p_{6, 5, 3}(t, q) + p_{>6, 5, 3}(t, q) + p_{>5, 3}(t, q) + p_{4, 4}(t, q) + p_{5, 4}(t, q) + p_{>5, 4}(t, q) + p_{>4}(t, q).
  \end{equation*}
  These subseries satisfy the following recurrences with initial conditions:
  \begin{align*}
    p_{>4}(t, q) &= p_{4, 4}(tq^{1/2}, q) + p_{5, 4}(tq^{1/2}, q) + p_{>5, 4}(tq^{1/2}, q) + p_{>4}(tq^{1/2}, q), &p_{>4}(0, 0) &= 1, \\
    p_{>5, 4}(t, q) &= p_{6, 5, 3}(tq^{1/2}, q) + p_{>6, 5, 3}(tq^{1/2}, q) + p_{>5, 3}(tq^{1/2}, q), &p_{>5, 4}(0, 0) &= 0, \\
    p_{5, 4}(t, q) &= p_{4, 3}(tq^{1/2}, q), &p_{5, 4}(0, 0) &= 0, \\
    p_{4, 4}(t, q) &= t^2q^{3}p_{>6, 5, 3}(tq^{2/2}, q) + t^2q^3p_{>5, 3}(tq^{2/2}, q), &p_{4, 4}(0, 0) &= 0, \\
    p_{>5, 3}(t, q) &= t^2q^3p_{>4}(tq^{1/2}, q), &p_{>5, 3}(0, 0) &= 0, \\
    p_{>6, 5, 3}(t, q) &= t^2q^3p_{>5, 4}(tq^{1/2}, q), &p_{>6, 5, 3}(0, 0) &= 0, \\
    p_{6, 5, 3}(t, q) &= t^2q^3p_{5, 4}(tq^{1/2}, q), &p_{6, 5, 3}(0, 0) &= 0, \\
    p_{4, 3}(t, q) &= t^2q^3p_{4, 4}(tq^{1/2}, q) + t^2q^2p_{>5, 4}(tq^{1/2}, q), &p_{4, 3}(0, 0) &= 0.
  \end{align*}
  The solution to these equations is unique if it exists, and we can verify using \Cref{lmm:28} that:
  \begin{align*}
    p_{>4}(t, q) &= f_{6, 4, 0, 0}(t, q), &p_{>5, 4}(t, q) &= f_{9, 5, 4, 2}(t, q), \\
    p_{5, 4}(t, q) &= f_{13, 6, 9, 4}(t, q), &p_{4, 4}(t, q) &= f_{12, 6, 8, 4}(t, q), \\
    p_{>5, 3}(t, q) &= f_{8, 5, 3, 2}(t, q), &p_{>6, 5, 3}(t, q) &= f_{11, 6, 8, 4}(t, q), \\
    p_{6, 5, 3}(t, q) &= f_{15, 7, 14, 6}(t, q), &p_{4, 3}(t, q) &= f_{11, 5, 7, 4}(t, q),
  \end{align*}
  is a solution to these equations.
  We derive the formula $p_{>2}(t, q) = f_{3, 2, 0, 0}(t, q)$ again from \Cref{lmm:28}.

  The recurrences follow from the following eight bijections for $m, n \in \mathbb{N}$.
  \begin{align*}
    P_{>4}(n, 2m) &\xrightarrow{\sim} P_{4, 4}(n - m, 2m) \cup P_{5, 4}(n - m, 2m) \cup P_{>5, 4}(n - m, 2m) \cup P_{>4}(n - m, 2m), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4, 4] &\text{if $[\lambda_{m - 1}, \lambda_m] = [5, 5]$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 5, 4] &\text{if $[\lambda_{m - 1}, \lambda_m] = [6, 5]$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 1} - 1, 4] &\text{if $[\lambda_m] = [5]$ and $\lambda_{m - 1} > 6$}; \\
                [\lambda_1 - 1, \dots, \lambda_m - 1] &\text{if $\lambda_m > 5$},
              \end{cases}
  \end{align*}
  which can be verified directly from the definition of $P$, as we now show.
  We note that the operation on $\lambda$ is always ``subtract 1 from each entry of $\lambda$''.
  For example, a partition $[\lambda_1, \dots, \lambda_m] \in P_{>4}(n, m)$ satisfies exactly one of the following four conditions:
  \begin{equation*}
    \text{$[\lambda_{m - 1}, \lambda_m] = [5, 5]$, $[\lambda_{m - 1}, \lambda_m] = [6, 5]$, $[\lambda_m] = [5]$ and $\lambda_{m - 1} > 6$, or $\lambda_m > 5$}.
  \end{equation*}
  We assume $\lambda$ satisfies $[\lambda_{m - 1}, \lambda_m] = [5, 5]$.
  Then $[\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4, 4]$ belongs to $P$ because: it cannot contain some ordinary partition (otherwise $\lambda$ would contain some ordinary partition), and we can verify case by case that it cannot contain some exceptional partition.
  Actually, we have $[\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4, 4] \in P_{4, 4}(n - m, 2m)$, as we easily see, so we get the first part of our bijection.
  The other parts follow a similar reasoning, and an explicit inverse of this function can be written if desired.
  We also note that $[5] \mapsto [4]$ and $\emptyset \mapsto \emptyset$ in this bijection.
  We now verify that this bijection implies our first recurrence.
  One key step is replacing $n$ by $n - m$ in the following computation
  \begin{align*}
    &p_{4, 4}(tq^{1/2}, q) + p_{5, 4}(tq^{1/2}, q) + p_{>5, 4}(tq^{1/2}, q) + p_{>4}(tq^{1/2}, q) \\
    &= \sum_{m, n \in \mathbb{N}}(|P_{4, 4}(n, m)| + |P_{5, 4}(n, m)| + |P_{>5, 4}(n, m)| + |P_{>4}(n, m)|)(tq^{1/2})^mq^n \\
    &= \sum_{m, n \in \mathbb{N}}(|P_{4, 4}(n, 2m)| + |P_{5, 4}(n, 2m)| + |P_{>5, 4}(n, 2m)| + |P_{>4}(n, 2m)|)(tq^{1/2})^{2m}q^n \\
    &= \sum_{m, n \in \mathbb{N}}(|P_{4, 4}(n - m, 2m)| + |P_{5, 4}(n - m, 2m)| + |P_{>5, 4}(n - m, 2m)| + |P_{>4}(n - m, 2m)|)t^{2m}q^n \\
    &= \sum_{m, n \in \mathbb{N}}|P_{>4}(n, 2m)|t^{2m}q^n \\
    &= p_{>4}(t, q).
  \end{align*}

  In the next bijections, we do something similar.
  In some cases, the operation on $\lambda$ is ``subtract 2 from each entry of $\lambda$'', and sometimes we need to change the tail of the result after doing this operation to get something in $P$.
  The next two lemmas also employ very similar arguments.
  \begin{align*}
    P_{>5, 4}(n, 2m) &\xrightarrow{\sim} P_{6, 5, 3}(n - m, 2m) \cup P_{>6, 5, 3}(n - m, 2m) \cup P_{>5, 3}(n - m, 2m), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 6, 5, 3] &\text{if $[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [7, 6, 4]$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 5, 3] &\text{if $[\lambda_{m - 1}, \lambda_m] = [6, 4]$ and $\lambda_{m - 2} > 7$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 1} - 1, 3] &\text{if $[\lambda_m] = [4]$ and $\lambda_{m - 1} > 6$},
              \end{cases}
  \end{align*}
  \begin{align*}
    P_{5, 4}(n, 2m) &\xrightarrow{\sim} P_{4, 3}(n - m, 2m), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4, 3],
  \end{align*}
  \begin{align*}
    P_{4, 4}(n, 2m) &\xrightarrow{\sim} P_{>6, 5, 3}(n - 2m - 1, 2(m - 1)) \cup P_{>5, 3}(n - 2m - 1, 2(m - 1)), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 2, \dots, \lambda_{m - 3} - 2, 5, 3] &\text{if $[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [7, 4, 4]$}; \\
                [\lambda_1 - 2, \dots, \lambda_{m - 2} - 2, 3] &\text{if $[\lambda_{m - 1}, \lambda_m] = [4, 4]$ and $\lambda_{m - 2} > 7$},
              \end{cases}
  \end{align*}
  \begin{align*}
    P_{>5, 3}(n, 2m) &\xrightarrow{\sim} P_{>4}(n - m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 1} - 1],
  \end{align*}
  \begin{align*}
    P_{>6, 5, 3}(n, 2m) &\xrightarrow{\sim} P_{>5, 4}(n - m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4],
  \end{align*}
  \begin{align*}
    P_{6, 5, 3}(n, 2m) &\xrightarrow{\sim} P_{5, 4}(n - m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 5, 4],
  \end{align*}
  \begin{align*}
    P_{4, 3}(n, 2m) &\xrightarrow{\sim} P_{4, 4}(n - m - 2, 2(m - 1)) \cup P_{>5, 4}(n - m - 1, 2(m - 1)), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 4, 4] &\text{if $[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [6, 4, 3]$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4] &\text{if $[\lambda_{m - 1}, \lambda_m] = [4, 3]$ and $\lambda_{m - 2} > 6$}. \qedhere
              \end{cases}
  \end{align*}
\end{proof}

\begin{lemma}
  \label{lmm:30}
  The formal power series $p_{>2, 1}(t, q)$ is given by
  \begin{equation*}
    p_{>2, 1}(t, q) = f_{5, 2, 1, 1}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  We consider the disjoint union
  \begin{equation*}
    P_{>2, 1} = P_{5, 3, 1} \cup P_{>5, 3, 1} \cup P_{5, 4, 1} \cup P_{>5, 4, 1} \cup P_{>4, 1}.
  \end{equation*}
  We have bijections:
  \begin{align*}
    P_{>4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{>5, 4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>5, 4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{5, 4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{5, 4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{>5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>6, 5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  from which, together with the proof of \Cref{lmm:29}, we get:
  \begin{align*}
    p_{>4, 1}(t, q) &= tqp_{>4}(t, q) = f_{6, 4, 1, 1}(t, q), \\
    p_{>5, 4, 1}(t, q) &= tqp_{>5, 4}(t, q) = f_{9, 5, 5, 3}(t, q), \\
    p_{5, 4, 1}(t, q) &= tqp_{5, 4}(t, q) = f_{13, 6, 10, 5}(t, q), \\
    p_{>5, 3, 1}(t, q) &= tqp_{>5, 3}(t, q) = f_{8, 5, 4, 3}(t, q), \\
    p_{5, 3, 1}(t, q) &= tqp_{>6, 5, 3}(t, q) = f_{11, 6, 9, 5}(t, q).
  \end{align*}
  The formula for $p_{>2, 1}(t, q)$ then follows from \Cref{lmm:28}.
\end{proof}

\begin{lemma}
  \label{lmm:31}
  The formal power series $p_{>2, 1, 1}(t, q)$ is given by
  \begin{equation*}
    p_{>3, 1, 1}(t, q) = f_{6, 3, 2, 2}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  We consider the disjoint union
  \begin{equation*}
    P_{>3, 1, 1} = P_{4, 1, 1} \cup P_{>4, 1, 1}.
  \end{equation*}
  We have bijections:
  \begin{align*}
    P_{>4, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>4, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  \begin{align*}
    P_{4, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>5, 4, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  from which, together with the proof of \Cref{lmm:30}, we get:
  \begin{align*}
    p_{>4, 1, 1}(t, q) &= tqp_{>4, 1}(t, q) = f_{6, 4, 2, 2}(t, q), \\
    p_{4, 1, 1}(t, q) &= tqp_{>5, 4, 1}(t, q) = f_{9, 5, 6, 4}(t, q).
  \end{align*}
  The formula for $p_{>3, 1, 1}(t, q)$ then follows from \Cref{lmm:28}.
\end{proof}

\begin{lemma}
  \label{lmm:32}
  The formal power series $p(t, q)$ is given by
  \begin{equation*}
    p(t, q) = f_{3, 2, 0, 0}(t, q) + f_{5, 2, 1, 1}(t, q) + f_{6, 3, 2, 2}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  This follows from the disjoint union
  \begin{equation*}
    P = P_{>2} \cup P_{>2, 1} \cup P_{>3, 1, 1}
  \end{equation*}
  together with \Cref{lmm:29}, \Cref{lmm:30} and \Cref{lmm:31}.
\end{proof}

\begin{lemma}
  \label{lmm:33}
  The formal power series $p(q)$ satisfies
  \begin{equation*}
    \ch_{L}(q) = q^{1/2}p(q).
  \end{equation*}
\end{lemma}

\begin{proof}
  This follows from \Cref{lmm:32} by setting $t = 1$ and \cite[Theorem 4]{andrews_singular_2022} together with \Cref{lmm:28}.
\end{proof}

\subsection{Computing leading monomials}
\label{sec:comp-lead-monom}

We recall that we have defined $V = \Vir^{1/2}$, $M = M(1/2, 1/2)$ and $L = L(1/2, 1/2)$.

\begin{lemma}
  \label{lmm:34}
  Let $\lambda = [\lambda_1, \dots, \lambda_m]$ be a partition with $\lambda_m \ge 2$ or $\lambda = \emptyset$, and we consider $M$ as a module over $V$.
  Then
  \begin{equation*}
    (L_{\lambda}\vac)_{(-1)}\vachalf = L_{\lambda}\vachalf + u \quad \text{for some $u \in G^{2m - 1}M$}.
  \end{equation*}
\end{lemma}

\begin{proof}
  The isomorphism $\gr^G(V) \xrightarrow{\sim} \mathbb{C}[L_{-2}, L_{-3}, \dots]$ maps $L_{\lambda}\vac$ to $p_{\lambda}$.
  The isomorphism $\gr^G(M) \xrightarrow{\sim} \bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k$ maps $\vachalf$ to $L_{-1}^0$ and $L_{\lambda}\vachalf$ to $u_{\lambda}$.
  The equality $p_{\lambda}\cdot L_{-1}^0 = u_{\lambda}$ in $\gr^G(M)$ translates to the equality $(L_{\lambda}\vac)_{(-1)}\vachalf = L_{\lambda}\vachalf + u$ in $M$ for some $u \in G^{2m - 1}M$.
\end{proof}

We know $\gr^G(M)$ is a free module over $\gr^G(V)$
\begin{equation*}
  \gr^G(M) = \bigoplus_{k \in \mathbb{N}}\gr^G(V)L_{-1}^k.
\end{equation*}
For $k \in \mathbb{N}$, we call
\begin{equation*}
  \iota_k: \gr^G(V) \hookrightarrow \gr^G(M)
\end{equation*}
the insertion of $\gr^G(V)$ into the $k$-th component of $\gr^G(M)$.

\begin{lemma}
  \label{lmm:35}
  Let $a \in G^pV$ for some $p \in \mathbb{N}$.
  Then $a_{(-1)}\vachalf \in G^pM$ and
  \begin{equation*}
    \iota_0(\alpha^p(a)) = \alpha^p(a_{(-1)}\vachalf).
  \end{equation*}
\end{lemma}

\begin{proof}
  The result follows immediately from \Cref{lmm:34}.
\end{proof}

We have a natural quotient map
\begin{align*}
  \pi_0: V &\twoheadrightarrow \Vir_{3, 4}, \\
  \pi_0(a) &= a + U(\Vir)\{a_{3, 4}\},
\end{align*}
where $a_{3, 4}$ is the singular vector of $V$ that generates its maximal proper ideal as in \cite{andrews_singular_2022} and \eqref{eq:22}.
Applying the functor $\gr^G$, we obtain an epimorphism of $\mathbb{N}$-graded vertex Poisson algebras
\begin{equation*}
  \gr^G(\pi_0): \gr^G(V) \twoheadrightarrow \gr^G(\Vir_{3, 4}).
\end{equation*}
We set $I = \ker(\gr^G(\pi_0))$, following the notation of \cite{andrews_singular_2022}, and we recall the definition of $K$ given in \eqref{eq:49}.

\begin{lemma}
  \label{lmm:36}
  We have the inclusion
  \begin{equation*}
    \iota_0(I) \subseteq K.
  \end{equation*}
\end{lemma}

\begin{proof}
  By \Cref{thr:44}, the following diagram commutes
  \begin{equation*}
    \begin{tikzcd}
      V \arrow[r, "\pi_0", two heads] \arrow[rd, "{Y^L_{V}}"'] & {\Vir_{3, 4}} \arrow[d, "{Y^L_{\Vir_{3, 4}}}"] \\
      & {\mathcal{F}(L)}
    \end{tikzcd}
  \end{equation*}
  The commutativity of this diagram implies the following statement
  \begin{equation*}
    \text{for $a \in U(\Vir)\{a_{3, 4}\}$, $u \in M$ and $n \in \mathbb{Z}$, $a_{(n)}u \in W$},
  \end{equation*}
  where $W$ is defined in \eqref{eq:47}.
  We use this statement in the following simplified form
  \begin{equation}
    \label{eq:50}
    \text{for $a \in U(\Vir)\{a_{3, 4}\}$, $a_{(-1)}\vachalf \in W$}.
  \end{equation}

  We note that
  \begin{equation*}
    I = \sum_{p \in \mathbb{N}}\alpha^p(U(\Vir)\{a_{3, 4}\} \cap G^pV).
  \end{equation*}
  Similarly, we have a formula for $K$
  \begin{equation*}
    K = \sum_{p \in \mathbb{N}}\alpha^p(W \cap G^pM).
  \end{equation*}
  Let $\alpha^p(a) \in I$ with $a \in U(\Vir)\{a_{3, 4}\} \cap G^pV$.
  By \Cref{lmm:35} and \eqref{eq:50}, we have $a_{(-1)}\vachalf \in W \cap G^pM$ and also $\iota_0(\alpha^p(a)) = \alpha^p(a_{(-1)}\vachalf) \in K$, finishing the proof.
\end{proof}

\begin{remark}
  \label{rmk:47}
  The proof of \Cref{lmm:36} also works for other values of $c = c_{p, q}$ and $h = h_{m, n}$ as in \Cref{thr:44}.
\end{remark}

We need to compute all leading monomials of elements of $K$.
To do this, we need to order the PBW basis of $U(\Vir_{\le -1}) = \vspan\{L_{\lambda} \mid \text{$\lambda$ is a partition}\}$ first by length, then by degree reverse lexicographic order and finally by position.
Formally, for any partitions $\lambda$ and $\eta$, we define
\begin{equation*}
  L_{\lambda} \le L_{\eta}\text{ if and only if }
  \begin{cases}
    \len(\lambda) < \len(\eta)\text{ or } \\
    \len(\lambda) = \len(\eta)\text{ and }u_{\lambda} \le u_{\eta}.
  \end{cases}
\end{equation*}
For $x \in U(\Vir_{\le -1})$ with $x \neq 0$, we may write
\begin{equation*}
  x = c_1L_{\lambda_1} + c_2L_{\lambda_2} + \dots + c_rL_{\lambda_r},
\end{equation*}
where for $1 \le i \le r$, $0 \neq c_i \in \mathbb{C}$ and $L_{\lambda_1} > L_{\lambda_2} > \dots > L_{\lambda_r}$.
We define the \emph{leading monomial of $x$} as $\lm(x) = L_{\lambda_1}$.
We set $\lm(0) = 0$.
Next, we extend the definition of $\lm$ from $U(\Vir_{\le -1})$ to $M$ by considering the isomorphism of vector spaces $U(\Vir_{\le -1}) \xrightarrow{\sim} M, L_{\lambda} \mapsto L_{\lambda}\vachalf$, where $\lambda$ is a partition.
For example:
\begin{enumerate}
\item We have $\lm(L_{-1}^2 - \frac{3}{4}L_{-2}) = L_{-2}$ because the power product of $L_{-1}^2$ is $1$, the power product of $L_{-1}^0$ is $L_{-2}$, $L_{-2} > 1$ by degree considerations, and we are using TOP with $L_{-1}^0 < L_{-1}^1 < L_{-1}^2$.
  We also have $\lm((L_{-1}^2 - \frac{3}{4}L_{-2})\vachalf) = L_{-2}\vachalf$ because $\len(L_{-1}^2) = \len(L_{-2}) = 2$.
\item We have $\lm(L_{-1}^3 - 3L_{-2}L_{-1} + \frac{3}{4}L_{-3}) = L_{-2}L_{-1}$ because the power product of $L_{-1}^3$ is $1$, the power product of $L_{-1}^1$ is $L_{-2}$, the power product of $L_{-1}^0$ is $L_{-3}$, $L_{-2} > L_{-3} > 1$ by definition and degree considerations, and we are using TOP with $L_{-1}^0 < L_{-1}^1 < L_{-1}^2 < L_{-1}^3$.
  Again, we have $\lm((L_{-1}^3 - 3L_{-2}L_{-1} + \frac{3}{4}L_{-3})\vachalf) = L_{-2}L_{-1}\vachalf$ because $\len(L_{-1}^3) = \len(L_{-2}L_{-1}) = 3$ and $\len(L_{-3}) = 2$.
\item We have $\lm(L_{-1}^4 - 3L_{-3}L_{-1} - 6L_{-4}) = L_{-3}L_{-1}$ because the power product of $L_{-1}^4$ is $1$, the power product of $L_{-1}^1$ is $L_{-3}$, the power product of $L_{-1}^0$ is $L_{-4}$, $L_{-3} > L_{-4} > 1$ by definition and degree considerations, and we are using TOP with $L_{-1}^0 < L_{-1}^1 < L_{-1}^2 < L_{-1}^3 < L_{-1}^4$.
  However, we now have $\lm((L_{-1}^4 - 3L_{-3}L_{-1} - 6L_{-4})\vachalf) = L_{-1}^4\vachalf$ because $\len(L_{-1}^4) = 4$, $\len(L_{-3}L_{-1}) = 3$ and $\len(L_{-4}) = 2$.
  In fact, we have $(L_{-1}^4 - 3L_{-3}L_{-1} - 6L_{-4})\vachalf \in W$, as we will see in a moment.
\end{enumerate}

\begin{remark}
  \label{rmk:48}
  The definition of the order in the PBW basis of $U(\Vir_{\le -1})$ was made so that for a partition $\lambda$ and $u \in M$, if $\lm(u) = L_{\lambda}\vachalf$, then $\lm(\alpha^{\len(\lambda)}(u)) = u_{\lambda}$.

  This order also helps us in computing the exceptional partitions faster, as we do not have to compute Gröbner bases explicitly because it is enough to transform matrices into row reduced echelon form.
\end{remark}

A basis of $\gr^G(M)_{1/2 + n}$ is given by $\{L_{\lambda}\vachalf \mid \Delta(\lambda) = n\}$ and has $p(n)$ elements.
For $n \in \mathbb{N}$, we compute the matrix $A_n$ with $p(n - 2) + p(n - 3)$ rows and $p(n)$ columns, which is given by stacking the matrix $A^{m_3}_n$ below the matrix $A^{m_2}_n$.
The matrix $A^{m_k}_n$ is given by
\begin{equation*}
  A^{m_k}_n(i, j) = \text{coefficient of $L_{\lambda_j}\vachalf$ in $L_{\lambda_i}u_k$},
\end{equation*}
for $1 \le i \le p(n - k)$, $1 \le j \le p(n)$ and $k = 2, 3$, where $\lambda_1, \dots, \lambda_{p(n)}$ are the partitions of $n$ ordered in such a way that $L_{\lambda_1} > L_{\lambda_2} > \dots > L_{\lambda_{p(n)}}$, and $u_2, u_3$ are given by \eqref{eq:48}.
We now transform $A_n$ into row reduced echelon form, obtaining a matrix $A^W_n$ which has an unknown number of nonzero rows and $p(n)$ columns.
For each pivot $\lambda$ of $A^W_n$, let $u^W_{\lambda}$ be the element of $\gr^G(M)$ corresponding to the row which has $L_{\lambda}\vachalf$ as pivot.
In other words, $u^W_{\lambda} = L_{\lambda}\vachalf + \text{(lower order terms)}$.
We set $u^K_{\lambda} = \alpha^{\len(\lambda)}(u^W_{\lambda})$ for each pivot $\lambda$ of $A^W_n$.

\begin{remark}
  \label{rmk:49}
  By construction and \Cref{rmk:48}, for each pivot $\lambda$ of $A^W_n$, we have $u^W_{\lambda} \in W$, $u^K_{\lambda} \in K$ and $\lm(u^K_{\lambda}) = u_{\lambda}$.
\end{remark}

For example, when $n = 4$, the partitions are ordered in the following way
\begin{equation*}
  [[2, 2], [2, 1, 1], [1, 1, 1, 1], [3, 1], [4]],
\end{equation*}
the matrix $A^W_4$ is given by
\begin{equation*}
  A^W_4=
  \begin{pmatrix}
    1 & 0 & 0 & -\frac{3}{16} & -\frac{15}{8} \\
    0 & 1 & 0 & -\frac{1}{4} & -\frac{5}{2} \\
    0 & 0 & 1 & -3 & -6
  \end{pmatrix},
\end{equation*}
and the pivots are $[2, 2]$, $[2, 1, 1]$ and $[1, 1, 1, 1]$.
Therefore:
\begin{align*}
  u^W_{[2, 2]} &= (L_{[2, 2]} - \tfrac{3}{16}L_{[3, 1]} - \tfrac{15}{8}L_{[4]})\vachalf, &u^K_{[2, 2]} &= L_{-2}L_{-2}, \\
  u^W_{[2, 1, 1]} &= (L_{[2, 1, 1]} - \tfrac{1}{4}L_{[3, 1]} - \tfrac{5}{2}L_{[4]})\vachalf, &u^K_{[2, 1, 1]} &= L_{-2}L_{-1}^2, \\
  u^W_{[1, 1, 1, 1]} &= (L_{[1, 1, 1, 1]} - 3L_{[3, 1]} - 6L_{[4]})\vachalf, &u^K_{[1, 1, 1, 1]} &= L_{-1}^4.
\end{align*}

The partitions $[2]$, $[1, 1, 1]$, $[3, 1, 1]$, $[3, 3]$, $[4, 3, 1]$, $[4, 4, 1]$, $[5, 4, 1, 1]$ and $[6, 5, 3, 1]$ are pivots of the matrices $A^W_2, A^W_3$, $A^W_5$, $A^W_6$, $A^W_8$, $A^W_9$, $A^W_{11}$ and $A^W_{15}$ respectively, see \cite[ising-modules.ipynb]{sagemath2}.
We set
\begin{equation*}
  K' = (u^K_{[2]}, u^K_{[1, 1, 1]}, u^K_{[3, 1, 1]}, u^K_{[3, 3]}, u^K_{[4, 3, 1]}, u^K_{[4, 4, 1]}, u^K_{[5, 4, 1, 1]}, u^K_{[6, 5, 3, 1]}, \iota_0(I))_{\psn},
\end{equation*}
where $\psn$ denotes the Poisson submodule generated by the given subset.
By \Cref{lmm:36}, \Cref{rmk:49} and the fact that $K$ is a vertex Poisson submodule (not just a submodule), we have
\begin{equation*}
  K' \subseteq K.
\end{equation*}

Let us consider the Poisson structure of $\gr^G(M)$ as a module over $\gr^G(V)$.
We have
\begin{align*}
  (L_{-2})_{(0)}(u_{\lambda}) &= \alpha^2(\omega)_{(0)}\alpha^{\len(\lambda)}(L_{\lambda}\vachalf) \\
                              &= \alpha^{\len(\lambda) + 1}(L_{-1}L_{\lambda}\vachalf) \\
                              &= u_{[\lambda, 1]},
\end{align*}
where $\lambda$ is any partition, and $[\lambda, 1]$ denotes the partition $\lambda$ with a $1$ appended at the end.

\begin{remark}
  \label{rmk:50}
  While the Poisson structure of $\gr^G(V)$ is trivial (i.e., is zero), the Poisson structure of $\gr^G(M)$ is not.
  In fact, if $u \in \gr^G(M)$, and $\lambda$ is a partition, then
  \begin{equation*}
    \lm(u) = u_{\lambda}\text{ implies }\lm((L_{-2})_{(0)}(u)) = u_{[\lambda, 1]}.
  \end{equation*}
  It is interesting to note that we use the Poisson structure, unlike most results in \Cref{sec:vert-poiss-algeb} and \cite{andrews_singular_2022}.
\end{remark}

Let $\overline{R}$ be the set of partitions containing some partition of $R$, i.e.,
\begin{equation*}
  \overline{R} = \{\lambda \mid \text{there is some partition $\eta \in R$ such that $\lambda \supseteq \eta$}\}.
\end{equation*}

\begin{lemma}
  \label{lmm:37}
  For $\lambda \in \overline{R}$, there exists $u \in K'$ such that $\lm(u) = u_{\lambda}$.
\end{lemma}

\begin{proof}
  By the definition of $K'$ and \cite[Proposition 5.1]{andrews_singular_2022}, we know that for $\lambda \in R$, there exists $u \in K'$ such that $\lm(u) = u_{\lambda}$.
  We now assume $\lambda \in \overline{R}$, which means there is $\eta \in R$ such that $\lambda \supseteq \eta$.
  Therefore, $\lambda$ is obtained from $\eta$ by adding some integers greater than or equal to two and adding $k$ ones.
  We pick $v \in K'$ such that $\lm(v) = u_{\eta}$ and some power product $p_{\tau} \in \mathbb{C}[L_{-2}, L_{-3}, \dots]$, for some partition $\tau$, such that $\lm((L_{-2})^k_{(0)}(p_{\tau}v)) = u_{\lambda}$ (this can be done because of \Cref{rmk:50} and the fact that $\lm$ is multiplicative).
  Thus, we set $u = (L_{-2})^k_{(0)}(p_{\tau}v) \in K'$ to get $\lm(u) = u_{\lambda}$.
  For example, if we take $\lambda = [3, 2, 1, 1] \in \overline{R}$, then $\eta = [2] \in R$.
  In this case, $v = L_{-2}- 3/4L_{-1}^2 \in K'$ is such that $\lm(v) = u_{[2]}$, and we take $u = L_{-3}L_{-2}L_{-1}^2 - 3/4L_{-3}L_{-1}^4 \in K'$.
\end{proof}

\begin{remark}
  \label{rmk:51}
  For any partitions $\lambda$ and $\eta$ with the same number of ones, if $\lambda \supseteq \eta$, then $u_{\eta} \mid u_{\lambda}$.
  The converse is not true.
  For example, $u_{[4, 2]} \mid u_{[4, 3, 2]}$, but $[4, 3, 2] \nsupseteq [4, 2]$.
  However, if $\eta = [\eta_1, \dots, \eta_m, 1, \dots, 1]$ with $\eta_m \ge 2$ and $\eta_1 - \eta_m \le 1$, then $\lambda \supseteq \eta$ if and only if $u_{\eta} \mid u_{\lambda}$, provided $\lambda$ and $\eta$ have the same number of ones.
\end{remark}

The following lemma says our set of partitions $R$ is special.
If $R$ were $\{[4, 2]\}$, for example, the following lemma would not be true.

\begin{lemma}
  \label{lmm:38}
  There is an alternative description for $P$, namely
  \begin{equation*}
    P = \{\lambda \mid \text{for $\eta \in \overline{R}$, $u_{\eta} \nmid u_{\lambda}$}\}.
  \end{equation*}
\end{lemma}

\begin{proof}
  We have to prove the following equality
  \begin{equation*}
    \{\lambda \mid \text{for $\eta \in R$, $\lambda \nsupseteq \eta$}\} = \{\lambda \mid \text{for $\eta \in \overline{R}$, $u_{\eta} \nmid u_{\lambda}$}\}.
  \end{equation*}

  First, we prove the inclusion $(\supseteq)$.
  We assume $\lambda$ belongs to the right set, and $\lambda \supseteq \eta$ for some $\eta \in R$.
  Then $\lambda$ has $k$ more ones than $\eta$ for some $k \in \mathbb{N}$.
  By \Cref{rmk:51}, $u_{[\eta, 1, \dots, 1]} \mid u_{\lambda}$, where we added $k$ ones to $\eta$, a contradiction.
  Therefore, $\lambda \nsupseteq \eta$ for $\eta \in R$, which means $\lambda$ belongs to the left set.

  We now prove the inclusion $(\subseteq)$.
  We assume $\lambda$ belongs to the left set.
  Then $\lambda$ has $0$, $1$ or $2$ ones.
  We assume $\lambda$ has $0$ ones.
  It is enough to prove that for $\eta \in R$ with $0$ ones, $u_{\eta} \nmid u_{\lambda}$.
  By \Cref{rmk:51}, if $\eta$ is equal to $[2]$, $[3, 3]$, $[r, r, r]$, $[r + 1, r, r]$ or $[r + 1, r + 1, r]$ for some $r \ge 3$, then $u_{\eta} \nmid u_{\lambda}$.
  We assume $\eta = [r + 2, r + 1, r]$ for some $r \ge 3$ and $u_{\eta} \mid u_{\lambda}$.
  Then $\lambda$ contains $[r + 2, r + 1, \dots, r + 1, r]$, where $r + 1$ appears $k \ge 1$ times.
  If $k \ge 2$, then $\lambda$ contains $[r + 1, r + 1, r]$, which is not possible.
  If $k = 1$, then $\lambda$ contains $[r + 2, r + 1, r]$, which is not possible.
  Therefore, we cannot have $u_{\eta} \mid u_{\lambda}$.
  Continuing this way, we obtain that $u_{\eta} \nmid u_{\lambda}$ for $\eta \in R$ with $0$ ones.
  The same argument can be applied when $\lambda$ has $1$ or $2$ ones.
  Therefore, $\lambda$ belongs to the right set.
\end{proof}

\subsection{Proofs of the main theorems}
\label{sec:proofs-main-theorems}

\begin{proof}[Proof of \Cref{thr:4}]
  Since we cannot apply Gröbner basis theory directly on the free module $\bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}, L_{-3}, \dots]L_{-1}^k$, we need to truncate somehow.
  We have to keep in mind the isomorphisms given in \Cref{prp:20}.
  For $N \in \mathbb{N}$, we define:
  \begin{align*}
    \gr^G(M)_{\le 1/2 + N} &= \sum_{n \le N}\gr^G(M)_{1/2 + n}, \\
    \gr^G(L)_{\le 1/2 + N} &= \sum_{n \le N}\gr^G(L)_{1/2 + n}.
  \end{align*}
  We note that $\gr^G(M)_{\le 1/2 + N}$ is a vector subspace of the free module
  \begin{equation*}
    F_N = \bigoplus_{n \le N}\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]L_{-1}^n
  \end{equation*}
  with base ring $\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]$ because a basis of $\gr^G(M)_{\le 1/2 + N}$ is given by elements of the form $u_{\lambda}$, with all the elements of $\lambda$ being less than $N$, and with $\lambda$ having at most $N$ ones.
  We note that $K \cap F_N$ is a submodule of $F_N$ for $N \in \mathbb{N}$.

  For $N \in \mathbb{N}$, we have natural vector space isomorphisms
  \begin{equation}
    \label{eq:51}
    \frac{F_N}{K \cap F_N} \supseteq \frac{\gr^G(M)_{\le 1/2 + N}}{K \cap F_N} \xrightarrow{\sim} \frac{\gr^G(M)_{\le 1/2 + N}}{K \cap \gr^G(M)_{\le 1/2 + N}} \xrightarrow{\sim} \gr^G(L)_{\le 1/2 + N}.
  \end{equation}
  Therefore, if we find a basis of each vector space $\gr^G(M)_{\le 1/2 + N}/K \cap F_N \subseteq F_N/K \cap F_N$ such that each basis is contained in the next one when considering the isomorphism \eqref{eq:51}, we get a basis of $\gr^G(L)$ by taking the union of these bases because $\bigcup_{N \in \mathbb{N}}\gr^G(L)_{\le 1/2 + N} = \gr^G(L)$.

  Let $G_N$ be a Gröbner basis of $K \cap F_N$.
  We define
  \begin{equation*}
    B_N = \{u_{\lambda} \mid \text{$\Delta(\lambda) \le N$ and for $u \in G_N$, $\lm(u) \nmid u_{\lambda}$}\}.
  \end{equation*}
  By \cite[Proposition 3.6.4]{adams_introduction_1994},
  \begin{equation}
    \label{eq:52}
    \{u_{\lambda} + K \cap F_N \mid u_{\lambda} \in B_N\}
  \end{equation}
  is a vector space basis of $\gr^G(M)_{\le 1/2 + N}/K \cap F_N$.
  Therefore, by \Cref{lmm:33}, isomorphism \eqref{eq:51} and the isomorphism between $\gr^G(L)_{1/2 + n}$ and $L_{1/2 + n}$ of \Cref{prp:20}, we have
  \begin{equation*}
    |B_N| = \sum_{n \le N}\dim(\gr^G(L)_{1/2 + n}) = \sum_{n \le N}\dim(L_{1/2 + n}) = \sum_{n \le N}|P(n)|.
  \end{equation*}

  We define
  \begin{equation*}
    \overline{B_N} = \{u_{\lambda} \mid \text{$\Delta(\lambda) \le N$ and for $\eta \in \overline{R}$, $u_{\eta} \nmid u_{\lambda}$}\}.
  \end{equation*}
  By \Cref{lmm:38}, we also have
  \begin{equation*}
    \overline{B_N} = \{u_{\lambda} \mid \text{$\Delta(\lambda) \le N$ and $\lambda \in P$}\}.
  \end{equation*}
  From the definition of $P(n)$, we see that
  \begin{equation*}
    |\overline{B_N}| = \sum_{n \le N}|P(n)|.
  \end{equation*}

  On the other hand, we have $B_N \subseteq \overline{B_N}$ because if $u_{\lambda} \in B_N$ and $\eta \in \overline{R}$, then we have $u_{\eta} \nmid u_{\lambda}$ because if we had $u_{\eta} \mid u_{\lambda}$, then by \Cref{lmm:37}, there would exist $u \in K' \cap F_N \subseteq K \cap F_N$ such that $\lm(u) = u_{\eta}$, then by the definition of Gröbner basis, there would exist $v \in G_N$ such that $\lm(v) \mid \lm(u)$, implying $\lm(v) \mid u_{\lambda}$, a contradiction.
  As both $B_N$ and $\overline{B_N}$ are finite sets and $|B_N| = |\overline{B_N}|$, we get $B_N = \overline{B_N}$.
  We see that the family of bases given by \eqref{eq:52} satisfies the property that one basis is contained in the next one, and this concludes the proof of \Cref{thr:4}.
\end{proof}

\begin{proof}[Proof of \Cref{thr:3}]
  We note that the basis of \Cref{thr:4} is also a basis of $\gr^G(L)$ under the isomorphism between $\gr^G(L)$ and $L$ of \Cref{prp:20}.
  For $\lambda \in P$, we have
  \begin{equation*}
    \alpha^{\len(\lambda)}(L_{\lambda}(\vachalf + W)) \in \alpha^{\len(\lambda)}(G^{\len(\lambda)}L_{1/2 + \Delta(\lambda)}).
  \end{equation*}
  Thus, when calculating the refined character of $\gr^G(L)$, $\Delta(\lambda)$ is incremented by $1/2$.
  Therefore, $\ch_{\gr^G(L)}(t, q) = q^{1/2}p(t, q)$ and together with \Cref{lmm:32}, we conclude the proof of \Cref{thr:3}.
\end{proof}

\begin{corollary}
  \label{crl:3}
  We have the equality
  \begin{equation*}
    K' = K.
  \end{equation*}
\end{corollary}

\begin{proof}
  This proof is a copy of the proof of \Cref{thr:3}.
  We know that $K' \subseteq K$.

  Let $N \in \mathbb{N}$, and let $G'_N$ be a Gröbner basis of $K' \cap F_N$ considered as a submodule of $F_N$.
  Like in the proof of \Cref{thr:3}, we set
  \begin{equation*}
    B'_N = \{u_{\lambda} \mid \text{$\Delta(\lambda) \le N$ and for $u \in G'_N$, $\lm(u) \nmid u_{\lambda}$}\}.
  \end{equation*}
  By \cite[Proposition 3.6.4]{adams_introduction_1994}, we have
  \begin{equation*}
    |B'_N| = \dim\left(\frac{\gr^G(M)_{\le 1/2 + N}}{K' \cap F_N}\right) = \dim\left(\frac{\gr^G(M)_{\le 1/2 + N}}{K' \cap \gr^G(M)_{\le 1/2 + N}}\right).
  \end{equation*}

  We can apply the same argument as in the proof of \Cref{thr:3} and conclude that $B'_N \subseteq \overline{B_N}$, where $\overline{B_N}$ is the defined in the same way.
  But $B_N = \overline{B_N}$ and
  \begin{equation*}
    |B_N| = \dim\left(\frac{\gr^G(M)_{\le 1/2 + N}}{K \cap \gr^G(M)_{\le 1/2 + N}}\right).
  \end{equation*}
  Therefore, we have $|B'_N| \le |B_N|$, and this implies
  \begin{equation*}
    \dim(K' \cap \gr^G(M)_{\le 1/2 + N}) \ge \dim(K \cap \gr^G(M)_{\le 1/2 + N}) \ge \dim(K' \cap \gr^G(M)_{\le 1/2 + N}).
  \end{equation*}
  Consequently, $K' \cap \gr^G(M)_{\le 1/2 + N} = K \cap \gr^G(M)_{\le 1/2 + N}$ for $N \in \mathbb{N}$.
  Taking the union of these subspaces, we get $K' = K$.
\end{proof}

\numberwithin{theorem}{section}
\appendix
\section{Almost commutative algebras}
\label{sec:almost-comm-algebr}

Let $A$ be an associative (not necessarily commutative) algebra with unit $1$ and filtration $(A^p)_{p \in \mathbb{Z}}$ such that:
\begin{enumerate}
\item $A^p = 0$ for $p < 0$;
\item $1 \in A^0$;
\item $A^0 \subseteq A^1 \subseteq \dots$;
\item $A^pA^q \subseteq A^{p + q}$ for $p, q \in \mathbb{Z}$.
\end{enumerate}
Let
\begin{equation*}
  \gr(A) = \bigoplus_{p \in \mathbb{N}}A^p/A^{p - 1}
\end{equation*}
be the associated graded vector space.
The vector space $\gr(A)$ is an associative algebra with unit and multiplication given as follows.
For $p, q \in \mathbb{N}$, $a \in A^p$ and $b \in A^p$, we set
\begin{equation*}
  \gamma^p(a)\gamma^q(b) = \gamma^{p + q}(ab),
\end{equation*}
where $\gamma^p: A^p \to \gr(A)$ is the \emph{principal symbol map}, which is the composition of the natural maps $A^p \twoheadrightarrow A^p/A^{p - 1}$ and $A^p/A^{p - 1} \hookrightarrow \gr(A)$.
The unit of $\gr(A)$ is $\gamma^0(1)$.

We say $A$ is \emph{almost commutative} if the filtration $(A^p)_{p \in \mathbb{Z}}$ satisfies the following condition: for $p, q \in \mathbb{Z}$, if $a \in A^p$ and $b \in A^q$, then $ab - ba \in A^{p + q - 1}$.
If $A$ is almost commutative, then $\gr(A)$ is commutative.

Let $\mathfrak{g}$ be a Lie algebra.
The \emph{tensor algebra of $\mathfrak{g}$}, given by $T(\mathfrak{g}) = \bigoplus_{n \in \mathbb{N}}\mathfrak{g}^{\otimes n}$, is an associative algebra with unit $1$.
The \emph{universal enveloping algebra of $\mathfrak{g}$}, given by $U(\mathfrak{g}) = T(\mathfrak{g})/(xy - yx - [x, y] \mid x, y \in \mathfrak{g})$, is also an associative algebra with $1$, but we also have an inclusion $\inc: \mathfrak{g} \hookrightarrow U(\mathfrak{g})$, which is a Lie algebra homomorphism.
The \emph{PBW filtration of $U(\mathfrak{g})$} is given by
\begin{equation*}
  U(\mathfrak{g})^p = \vspan\{x_1x_2\dots x_s \mid s \le p, x_1, \dots, x_s \in \mathfrak{g}\} \quad \text{for $p \in \mathbb{Z}$}.
\end{equation*}
This filtration clearly satisfies axioms (i)--(iv) above.
Furthermore, $U(\mathfrak{g})^1 = \mathfrak{g}$.
By \cite[Lemma 2.1.5]{dixmier_enveloping_1996}, $U(\mathfrak{g})$ is almost commutative, so $\gr(U(\mathfrak{g}))$ is commutative.
The \emph{symmetric algebra of $\mathfrak{g}$}, given by $S(\mathfrak{g}) = T(\mathfrak{g})/(xy - yx \mid x, y \in \mathfrak{g})$, is a commutative associative algebra with unit $1$, and we have an inclusion $\inc: \mathfrak{g} \hookrightarrow S(\mathfrak{g})$ satisfying a universal property.
We have two natural inclusions of $\mathfrak{g}$: $\gamma^1: \mathfrak{g} \hookrightarrow \gr(U(\mathfrak{g}))$ and $\inc: \mathfrak{g} \hookrightarrow S(\mathfrak{g})$.
By the universal property of $\inc: \mathfrak{g} \hookrightarrow S(\mathfrak{g})$, there is a homomorphism of commutative algebras $S(\mathfrak{g}) \to \gr(U(\mathfrak{g}))$ such that $1 \mapsto 1$, and the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    \mathfrak{g} \arrow[r, "\inc", hook] \arrow[rd, "\gamma^1"', hook] & S(\mathfrak{g}) \arrow[d] \\
    & \gr(U(\mathfrak{g}))
  \end{tikzcd}
\end{equation*}
By \cite[Proposition 2.3.6]{dixmier_enveloping_1996}, the homomorphism $S(\mathfrak{g}) \to \gr(U(\mathfrak{g}))$ is in fact an isomorphism.
If $(x_i)_{i \in I}$ is a basis of $\mathfrak{g}$, then $S(\mathfrak{g})$ is isomorphic to the polynomial algebra $\mathbb{C}[(x_i)_{i \in I}]$.
We have described $\gr(U(\mathfrak{g}))$ explicitly.

\section{Poisson algebras and their modules}
\label{sec:poiss-algebr-their-1}

A \emph{Poisson algebra} is an algebra $A$ together with two operations $\bullet\cdot\bullet: A \times A \to A$ and $\{\bullet, \bullet\}: A \times A \to A$ satisfying:
\begin{enumerate}
\item $(A, \bullet\cdot\bullet)$ is a commutative associative algebra;
\item $(A, \{\bullet, \bullet\})$ is a Lie algebra;
\item The operations $\bullet\cdot\bullet$ and $\{\bullet, \bullet\}$ are related by the left Leibniz rule
  \begin{equation*}
    \{a, b\cdot c\} = \{a, b\}\cdot c + b\cdot\{a, c\} \quad \text{for $a, b, c \in A$}.
  \end{equation*}
\end{enumerate}
The operation $\{\bullet, \bullet\}$ is called \emph{Poisson bracket}.

\begin{lemma}
  \label{lmm:39}
  A Poisson algebra $A$ also satisfies the right Leibniz rule
  \begin{equation*}
    \{ab, c\} = a\{b, c\} + b\{a, c\} \quad \text{for $a, b, c \in A$}.
  \end{equation*}
\end{lemma}

\begin{proof}
  The result follows from the left Leibniz rule and the anticommutativity of the Poisson bracket.
\end{proof}

\begin{example}
  \label{exa:19}
  Let $A$ be an associative almost commutative algebra with $A$ with unit $1$ satisfying (i)--(iv) of \Cref{sec:almost-comm-algebr}.
  We know that $\gr(A)$ is a commutative associative algebra with unit $\gamma^0(1)$.
  We now make $\gr(A)$ into a Poisson algebra by defining the Poisson bracket as follows.
  For $p, q \in \mathbb{N}$, $a \in A^p$ and $b \in A^q$, we set
  \begin{equation*}
    \{\gamma^p(a), \gamma^q(b)\} = \gamma^{p + q - 1}(ab - ba).
  \end{equation*}
  We can verify that this is well-defined and makes $\gr(A)$ into a Poisson algebra.

  Let $\mathfrak{g}$ be a Lie algebra.
  We study the case when $A = U(\mathfrak{g})$ is given the PBW filtration.
  In that case, we see that the Poisson bracket $\{\bullet, \bullet\}: \gr(U(\mathfrak{g})) \times \gr(U(\mathfrak{g})) \to \gr(U(\mathfrak{g}))$ extends the Lie bracket $[\bullet, \bullet]: \mathfrak{g} \times \mathfrak{g} \to \mathfrak{g}$.
  We wish to make this construction more explicit.
  We know $\gr(U(\mathfrak{g}))$ is canonically isomorphic to $S(\mathfrak{g})$.
  Let $(x_i)_{i \in I}$ be a basis of $\mathfrak{g}$.
  Then $S(\mathfrak{g})$ is isomorphic to the polynomial algebra $\mathbb{C}[(x_i)_{i \in I}]$.
  We can write
  \begin{equation*}
    [x_i, x_j] = \sum_{k \in I}c^k_{i, j}x_k \quad \text{for $i, j \in I$}
  \end{equation*}
  for some scalars $c^k_{i, j} \in \mathbb{C}$.
  The left and right Leibniz rules imply that the Poisson bracket is given explicitly by
  \begin{equation*}
    \{f, g\} = \sum_{i, j, k \in I}c^k_{i, j}\frac{\partial f}{\partial x_i}\frac{\partial g}{\partial x_j}x_k \quad \text{for $f, g \in \mathbb{C}[(x_i)_{i \in I}]$}.
  \end{equation*}
  Therefore, this Poisson bracket is the unique Poisson bracket extending the Lie bracket of $\bigoplus_{i \in I}\mathbb{C}x_i \cong \mathfrak{g}$ to a Poisson bracket of $\mathbb{C}[(x_i)_{i \in I}] \cong \gr(U(\mathfrak{g}))$.
\end{example}

Let $A$ be a Poisson algebra.
A \emph{module over $A$} is an $A$-module $M$ in the usual associative sense equipped with a bilinear map $\{\bullet, \bullet\}: A \times M \to M$, which makes $M$ a Lie algebra module over $A$ such that for $a, b \in A$ and $u \in M$:
\begin{enumerate}
\item (Left Leibniz rule) $\{a, bu\} = \{a, b\}u + b\{a, u\}$;
\item (Right Leibniz rule) $\{ab, u\} = a\{b, u\} + b\{a, u\}$.
\end{enumerate}

\begin{remark}
  \label{rmk:52}
  We probably cannot prove the right Leibniz rule from the Left Leibniz rule for modules like in \Cref{lmm:39} because we do not have anticommutativity for modules.
  Some authors only require the left Leibniz rule for modules, but here we also want the right Leibniz rule (see \cite{caressa_examples_2003}).
\end{remark}

\section{Jet algebras and jet schemes}
\label{sec:jet-algebras-jet}

In this appendix alone, by an algebra we will mean a commutative associative algebra with unit.
The categories $\Algf$ of finitely generated algebras and $\DAlg$ of differential algebras will appear frequently in this appendix.

Let $R$ be a finitely generated algebra.
We now construct a differential algebra $JR$ called the \emph{jet algebra of $R$} and an algebra monomorphism $\inc: R \hookrightarrow JR$ universal with this property, i.e., for a differential algebra $A$ and an algebra homomorphism $\phi: R \to A$, there is a unique differential algebra homomorphism $\overline{\phi}: JR \to A$ such that the following diagram commutes
\begin{equation*}
  \begin{tikzcd}
    R \arrow[r, "\inc", hook] \arrow[rd, "\phi"'] & JR \arrow[d, "\overline{\phi}"] \\
    & A
  \end{tikzcd}
\end{equation*}

Assuming $R = \mathbb{C}[x_1, \dots, x_r]/(f_1, \dots, f_s)$ for some polynomials $f_i \in \mathbb{C}[x_1, \dots, x_r]$, the construction is as follows.
We introduce new variables $x^j_{(-i)}$ for $i = 1, 2, \dots$, $j = 1, \dots, r$ and a derivation $\partial$ of the polynomial algebra $\mathbb{C}[x^j_{(-i)} \mid i = 1, 2, \dots, j = 1, \dots, r]$ by setting
\begin{equation*}
  \partial x^j_{(-i)} = ix^j_{(-i - 1)} \quad \text{for $i = 1, 2, \dots$, $j = 1, \dots, r$}.
\end{equation*}
We set (identifying $x^j$ with $x^j_{(-1)}$ when considering $f_i$ in the following equation)
\begin{equation*}
  JR = \mathbb{C}[x^j_{(-i)} \mid i = 1, 2, \dots, j = 1, \dots, r]/(\partial^jf_i \mid i = 1, \dots, s, j = 0, 1, \dots).
\end{equation*}
By our definitions, we can consider $\partial$ as a derivation of $JR$, and we have an obvious algebra monomorphism $\inc: R \hookrightarrow JR$.
The fact that $\inc: R \hookrightarrow JR$ satisfies our desired universal property is explained in \cite[\S2.3]{arakawa_remark_2012} and \cite{ein_jet_2008}.

We have constructed a functor
\begin{equation*}
  J: \Algf \to \DAlg
\end{equation*}
such that for $R \in \Algf$ and $A \in \DAlg$, we have a natural isomorphism
\begin{equation*}
  \Hom_{\DAlg}(JR, A) \cong \Hom_{\Alg}(R, A).
\end{equation*}

The \emph{jet scheme of an affine scheme of finite type $X = \Spec(R)$} is defined by
\begin{equation*}
  JX = \Spec(JR).
\end{equation*}

\begin{remark}
  \label{rmk:53}
  It is possible to define the jet scheme $JX$ of a general scheme $X$ of finite type (see \cite{ein_jet_2008}), but the construction is more elaborate, and we will only need the affine case.
\end{remark}

\begin{theorem}[{\cite{ein_jet_2008}}]
  \label{thr:59}
  Let $R \in \Algf$.
  Then $\dim(R) = 0$ if and only if $\dim(JR) = 0$.
\end{theorem}

\section{An explicit description of $K$}
\label{sec:an-expl-descr}

In \cite[ising-modules.ipynb]{sagemath2}, I wrote a SageMath program to compute $u^W_{\lambda}$ for all partitions $\lambda$ (if $\lambda$ is not a pivot, it returns $0$).
From its output, we obtain:
\begin{align*}
  u^K_{[2]} &= L_{-2} - \tfrac{3}{4}L_{-1}^2, &u^K_{[1, 1, 1]} &= L_{-1}^3, \\
  u^K_{[3, 1, 1]} &= L_{-3}L_{-1}^2, &u^K_{[3, 3]} &= L_{-3}L_{-3} + \tfrac{1}{3}L_{-4}L_{-1}^2, \\
  u^K_{[4, 3, 1]} &= L_{-4}L_{-3}L_{-1}, &u^K_{[4, 4, 1]} &= L_{-4}L_{-4}L_{-1} + \tfrac{9}{8}L_{-5}L_{-3}L_{-1}, \\
  u^K_{[5, 4, 1, 1]} &= L_{-5}L_{-4}L_{-1}^2, &u^K_{[6, 5, 3, 1]} &= L_{-6}L_{-5}L_{-3}L_{-1}.
\end{align*}

However, it turns out that $u^K_{[5, 4, 1, 1]}$ and $u^K_{[6, 5, 3, 1]}$ are redundant, as can be seen in \cite[m11-m15.ipynb]{sagemath2}.
From \cite[Theorem 2]{andrews_singular_2022}, we obtain the following explicit expression for $K$
\begin{equation*}
  K = (u^K_{[2]}, u^K_{[1, 1, 1]}, u^K_{[3, 1, 1]}, u^K_{[3, 3]}, u^K_{[4, 3, 1]}, u^K_{[4, 4, 1]}, \iota_0((a, b)_{\partial}))_{\psn},
\end{equation*}
where
\begin{align*}
  a = L_{-2}^3, b = L_{-4}L_{-3}L_{-2} + \tfrac{1}{6}L_{-5}L_{-2}^2.
\end{align*}

\section{The case $L(1/2, 1/16)$}
\label{sec:case-l12-116}

We can do the same analysis we did for $L(1/2, 1/2)$ but with $L(1/2, 1/16)$ instead.
The arguments are the same, but the computations are, of course, different.
These computations will be shown now.

We recall the definitions of $P^{1/16}$ and $R^{1/16}$ given in \Cref{sec:introduction}.
For the definition of the series $p^{1/16}(t, q)$, the set $P^{1/16}(n, m)$ and other related notation, see \Cref{sec:comb-argum}.
Again, we omit superscripts.

The maximal proper subrepresentation of $M(1/2, 1/16)$ is generated by the singular vectors:
\begin{equation*}
  u_2 = (L_{-2} - \tfrac{4}{3}L_{-1}^2)\vacsixteen, u_4 = (L_{-2}L_{-2} - \tfrac{600}{49}L_{-2}L_{-1}^2 + \tfrac{144}{49}L_{-1}^4 + \tfrac{264}{49}L_{-3}L_{-1} - \tfrac{36}{49}L_{-4})\vacsixteen.
\end{equation*}

\begin{lemma}
  \label{lmm:40}
  The formal power series $p_{>2}(t, q)$ is given by
  \begin{equation*}
    p_{>2}(t, q) = f_{2, 2, 0, 0}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}[Sketch of proof]
  We consider the disjoint union
  \begin{equation*}
    P_{>2} = P_{3, 3} \cup P_{6, 4, 3} \cup P_{>6, 4, 3} \cup P_{6, 5, 3} \cup P_{8, 7, 5, 3} \cup P_{>8, 7, 5, 3} \cup P_{>7, 5, 3} \cup P_{>5, 3} \cup P_{4, 4} \cup P_{5, 4} \cup P_{>5, 4} \cup P_{>4}.
  \end{equation*}
  These subseries satisfy the following recurrences with initial conditions:
  \begin{align*}
    p_{>4}(t, q) &= p_{4, 4}(tq^{1/2}, q) + p_{5, 4}(tq^{1/2}, q) + p_{>5, 4}(tq^{1/2}, q) + p_{>4}(tq^{1/2}, q), &p_{>4}(0, 0) &= 1, \\
    p_{>5, 4}(t, q) &= p_{6, 5, 3}(tq^{1/2}, q) + p_{8, 7, 5, 3}(tq^{1/2}, q) + p_{>8, 7, 5, 3}(tq^{1/2}, q) \\
                 &\quad + p_{>7, 5, 3}(tq^{1/2}, q) + p_{>5, 3}(tq^{1/2}, q), &p_{>5, 4}(0, 0) &= 0, \\
    p_{5, 4}(t, q) &= p_{6, 4, 3}(tq^{1/2}, q) + p_{>6, 4, 3}(tq^{1/2}, q), &p_{5, 4}(0, 0) &= 0, \\
    p_{4, 4}(t, q) &= p_{3, 3}(tq^{1/2}, q), &p_{4, 4}(0, 0) &= 0, \\
    p_{>5, 3}(t, q) &= t^2q^3p_{>4}(tq^{1/2}, q), &p_{>5, 3}(0, 0) &= 0, \\
    p_{>7, 5, 3}(t, q) &= t^2q^3p_{>5, 3}(tq^{2/2}, q), &p_{>7, 5, 3}(0, 0) &= 0, \\
    p_{>8, 7, 5, 3}(t, q) &= t^2q^4p_{>6, 4, 3}(tq^{2/2}, q), &p_{>8, 7, 5, 3}(0, 0) &= 0, \\
    p_{8, 7, 5, 3}(t, q) &= t^2q^3p_{6, 5, 3}(tq^{2/2}, q), &p_{8, 7, 5, 3}(0, 0) &= 0, \\
    p_{6, 5, 3}(t, q) &= t^2q^3p_{5, 4}(tq^{1/2}, q), &p_{6, 5, 3}(0, 0) &= 0, \\
    p_{>6, 4, 3}(t, q) &= t^2q^2p_{>5, 4}(tq^{1/2}, q), &p_{>6, 4, 3}(0, 0) &= 0, \\
    p_{6, 4, 3}(t, q) &= t^2q^3p_{4, 4}(tq^{1/2}, q), &p_{6, 4, 3}(0, 0) &= 0, \\
    p_{3, 3}(t, q) &= t^2q^3p_{>6, 4, 3}(tq^{1/2}, q) + t^2q^2p_{>5, 3}(tq^{1/2}, q), &p_{3, 3}(0, 0) &= 0.
  \end{align*}
  The solution to these equations is unique if it exists, and we can verify using \Cref{lmm:28} that:
  \begin{align*}
    p_{>4}(t, q) &= f_{6, 4, 0, 0}(t, q), &p_{>5, 4}(t, q) &= f_{9, 5, 4, 2}(t, q), \\
    p_{5, 4}(t, q) &= f_{13, 6, 9, 4}(t, q), &p_{4, 4}(t, q) &= f_{12, 6, 8, 4}(t, q), \\
    p_{>5, 3}(t, q) &= f_{8, 5, 3, 2}(t, q), &p_{>7, 5, 3}(t, q) &= f_{12, 7, 8, 4}(t, q), \\
    p_{>8, 7, 5, 3}(t, q) &= f_{15, 8, 15, 6}(t, q), &p_{8, 7, 5, 3}(t, q) &= f_{19, 9, 23, 8}(t, q), \\
    p_{6, 5, 3}(t, q) &= f_{15, 7, 14, 6}(t, q), &p_{>6, 4, 3}(t, q) &= f_{11, 6, 7, 4}(t, q), \\
    p_{6, 4, 3}(t, q) &= f_{14, 7, 13, 6}(t, q), &p_{3, 3}(t, q) &= f_{10, 5, 6, 4}(t, q),
  \end{align*}
  is a solution to these equations.
  We derive the formula $p_{>2}(t, q) = f_{2, 2, 0, 0}(t, q)$ again from \Cref{lmm:28}.

  The recurrences follow from the following twelve bijections for $m, n \in \mathbb{N}$:
  \begin{align*}
    P_{>4}(n, 2m) &\xrightarrow{\sim} P_{4, 4}(n - m, 2m) \cup P_{5, 4}(n - m, 2m) \cup P_{>5, 4}(n - m, 2m) \cup P_{>4}(n - m, 2m), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4, 4] &\text{if $[\lambda_{m - 1}, \lambda_m] = [5, 5]$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 5, 4] &\text{if $[\lambda_{m - 1}, \lambda_m] = [6, 5]$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 1} - 1, 4] &\text{if $[\lambda_m] = [5]$ and $\lambda_{m - 1} > 6$}; \\
                [\lambda_1 - 1, \dots, \lambda_m - 1] &\text{if $\lambda_m > 5$},
              \end{cases}
  \end{align*}
  \begin{align*}
    P_{>5, 4}(n, 2m) &\xrightarrow{\sim} P_{6, 5, 3}(n - m, 2m) \cup P_{8, 7, 5, 3}(n - m, 2m) \cup P_{>8, 7, 5, 3}(n - m, 2m) \\
                     &\quad \cup P_{>7, 5, 3}(n - m, 2m) \cup P_{>5, 3}(n - m, 2m), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 6, 5, 3] &\text{if $[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [7, 6, 4]$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 4} - 1, 8, 7, 5, 3] &\text{if $[\lambda_{m - 3}, \lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [9, 8, 6, 4]$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 7, 5, 3] &\text{if $[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [8, 6, 4]$ and $\lambda_{m - 3} > 9$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 5, 3] &\text{if $[\lambda_{m - 1}, \lambda_m] = [6, 4]$ and $\lambda_{m - 2} > 8$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 1} - 1, 3] &\text{if $[\lambda_m] = [4]$ and $\lambda_{m - 1} > 6$},
              \end{cases}
  \end{align*}
  \begin{align*}
    P_{5, 4}(n, 2m) &\xrightarrow{\sim} P_{6, 4, 3}(n - m, 2m) \cup P_{>6, 4, 3}(n - m, 2m), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 6, 4, 3] &\text{if $[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [7, 5, 4]$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4, 3] &\text{if $[\lambda_{m - 1}, \lambda_m] = [5, 4]$ and $\lambda_{m - 2} > 7$},
              \end{cases}
  \end{align*}
  \begin{align*}
    P_{4, 4}(n, 2m) &\xrightarrow{\sim} P_{3, 3}(n - m, 2m), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 3, 3],
  \end{align*}
  \begin{align*}
    P_{>5, 3}(n, 2m) &\xrightarrow{\sim} P_{>4}(n - m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 1} - 1],
  \end{align*}
  \begin{align*}
    P_{>7, 5, 3}(n, 2m) &\xrightarrow{\sim} P_{>5, 3}(n - 2m - 1, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 2, \dots, \lambda_{m - 1} - 2, 3],
  \end{align*}
  \begin{align*}
    P_{>8, 7, 5, 3}(n, 2m) &\xrightarrow{\sim} P_{>6, 4, 3}(n - 2m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 2, \dots, \lambda_{m - 3} - 2, 4, 3],
  \end{align*}
  \begin{align*}
    P_{8, 7, 5, 3}(n, 2m) &\xrightarrow{\sim} P_{6, 5, 3}(n - 2m - 1, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 2, \dots, \lambda_{m - 4} - 2, 6, 5, 3],
  \end{align*}
  \begin{align*}
    P_{6, 5, 3}(n, 2m) &\xrightarrow{\sim} P_{5, 4}(n - m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 5, 4],
  \end{align*}
  \begin{align*}
    P_{>6, 4, 3}(n, 2m) &\xrightarrow{\sim} P_{>5, 4}(n - m - 1, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 4],
  \end{align*}
  \begin{align*}
    P_{6, 4, 3}(n, 2m) &\xrightarrow{\sim} P_{4, 4}(n - m - 2, 2(m - 1)), \\
    \lambda &\mapsto [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 4, 4],
  \end{align*}
  \begin{align*}
    P_{3, 3}(n, 2m) &\xrightarrow{\sim} P_{>6, 4, 3}(n - m - 2, 2(m - 1)) \cup P_{>5, 3}(n - m - 1, 2(m - 1)), \\
    \lambda &\mapsto
              \begin{cases}
                [\lambda_1 - 1, \dots, \lambda_{m - 3} - 1, 4, 3] &\text{if $[\lambda_{m - 2}, \lambda_{m - 1}, \lambda_m] = [6, 3, 3]$}; \\
                [\lambda_1 - 1, \dots, \lambda_{m - 2} - 1, 3] &\text{if $[\lambda_{m - 1}, \lambda_m] = [3, 3]$ and $\lambda_{m - 2} > 6$}. \qedhere
              \end{cases}
  \end{align*}
\end{proof}

\begin{lemma}
  \label{lmm:41}
  The formal power series $p_{>2, 1}(t, q)$ is given by
  \begin{equation*}
    p_{>2, 1}(t, q) = f_{4, 2, 1, 1}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  We consider the disjoint union
  \begin{equation*}
    P_{>2, 1} = P_{6, 5, 3, 1} \cup P_{8, 7, 5, 3, 1} \cup P_{>8, 7, 5, 3, 1} \cup P_{>7, 5, 3, 1} \cup P_{>5, 3, 1} \cup P_{4, 4, 1} \cup P_{5, 4, 1} \cup P_{>5, 4, 1} \cup P_{>4, 1}.
  \end{equation*}
  We have bijections:
  \begin{align*}
    P_{>4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{>5, 4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>5, 4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{5, 4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{5, 4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{4, 4, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{4, 4}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{>5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{>7, 5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>7, 5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{>8, 7, 5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{>8, 7, 5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{8, 7, 5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{8, 7, 5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  \begin{align*}
    P_{6, 5, 3, 1}(n, 2m + 1) &\xrightarrow{\sim} P_{6, 5, 3}(n - 1, 2m), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m],
  \end{align*}
  from which, together with the proof of \Cref{lmm:40}, we get:
  \begin{align*}
    p_{>4, 1}(t, q) &= tqp_{>4}(t, q) = f_{6, 4, 1, 1}(t, q), \\
    p_{>5, 4, 1}(t, q) &= tqp_{>5, 4}(t, q) = f_{9, 5, 5, 3}(t, q), \\
    p_{5, 4, 1}(t, q) &= tqp_{5, 4}(t, q) = f_{13, 6, 10, 5}(t, q), \\
    p_{4, 4, 1}(t, q) &= tqp_{4, 4}(t, q) = f_{12, 6, 9, 5}(t, q), \\
    p_{>5, 3, 1}(t, q) &= tqp_{>5, 3}(t, q) = f_{8, 5, 4, 3}(t, q), \\
    p_{>7, 5, 3, 1}(t, q) &= tqp_{>7, 5, 3}(t, q) = f_{12, 7, 9, 5}(t, q), \\
    p_{>8, 7, 5, 3, 1}(t, q) &= tqp_{>8, 7, 5, 3}(t, q) = f_{15, 8, 16, 7}(t, q), \\
    p_{8, 7, 5, 3, 1}(t, q) &= tqp_{8, 7, 5, 3}(t, q) = f_{19, 9, 24, 9}(t, q), \\
    p_{6, 5, 3, 1}(t, q) &= tqp_{6, 5, 3}(t, q) = f_{15, 7, 15, 7}(t, q).
  \end{align*}
  The formula for $p_{>2, 1}(t, q)$ then follows from \Cref{lmm:28}.
\end{proof}

\begin{lemma}
  \label{lmm:42}
  The formal power series $p_{>2, 1, 1}(t, q)$ is given by
  \begin{equation*}
    p_{>2, 1, 1}(t, q) = f_{9, 4, 5, 4}(t, q) + f_{5, 3, 2, 2}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  We consider the disjoint union
  \begin{equation*}
    P_{>2, 1, 1} = P_{7, 5, 3, 1, 1} \cup P_{>7, 5, 3, 1, 1} \cup P_{>5, 3, 1, 1} \cup P_{5, 4, 1, 1} \cup P_{>5, 4, 1, 1} \cup P_{>4, 1, 1}.
  \end{equation*}
  We have bijections:
  \begin{align*}
    P_{>4, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>4, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  \begin{align*}
    P_{>5, 4, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>5, 4, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  \begin{align*}
    P_{5, 4, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{5, 4, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  \begin{align*}
    P_{>5, 3, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>5, 4, 1}(n, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_{m - 1}, 4, 1],
  \end{align*}
  \begin{align*}
    P_{>7, 5, 3, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>7, 5, 3, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  \begin{align*}
    P_{7, 5, 3, 1, 1}(n, 2m + 2) &\xrightarrow{\sim} P_{>8, 7, 5, 3, 1}(n - 1, 2m + 1), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 1],
  \end{align*}
  from which, together with the proof of \Cref{lmm:41}, we get:
  \begin{align*}
    p_{>4, 1, 1}(t, q) &= tqp_{>4, 1}(t, q) = f_{6, 4, 2, 2}(t, q), \\
    p_{>5, 4, 1, 1}(t, q) &= tqp_{>5, 4, 1}(t, q) = f_{9, 5, 6, 4}(t, q), \\
    p_{5, 4, 1, 1}(t, q) &= tqp_{5, 4, 1}(t, q) = f_{13, 6, 11, 6}(t, q), \\
    p_{>5, 3, 1, 1}(t, q) &= tp_{>5, 4, 1}(t, q) = f_{9, 5, 5, 4}(t, q), \\
    p_{>7, 5, 3, 1, 1}(t, q) &= tqp_{>7, 5, 3, 1}(t, q) = f_{12, 7, 10, 6}(t, q), \\
    p_{7, 5, 3, 1, 1}(t, q) &= tqp_{>8, 7, 5, 3, 1}(t, q) = f_{15, 8, 17, 8}(t, q).
  \end{align*}
  The formula for $p_{>2, 1, 1}(t, q)$ then follows from \Cref{lmm:28}.
\end{proof}

\begin{lemma}
  \label{lmm:43}
  The formal power series $p_{>3, 1, 1, 1}(t, q)$ is given by
  \begin{equation*}
    p_{>3, 1, 1, 1}(t, q) = f_{7, 3, 3, 3}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  We consider the disjoint union
  \begin{equation*}
    P_{>3, 1, 1, 1} = P_{4, 1, 1, 1} \cup P_{>4, 1, 1, 1}.
  \end{equation*}
  We have bijections:
  \begin{align*}
    P_{>4, 1, 1, 1}(n, 2m + 3) &\xrightarrow{\sim} P_{>4, 3}(n, 2m + 2), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_m, 3],
  \end{align*}
  \begin{align*}
    P_{4, 1, 1, 1}(n, 2m + 3) &\xrightarrow{\sim} P_{3, 3}(n - 1, 2m + 2), \\
    \lambda &\mapsto [\lambda_1, \dots, \lambda_{m - 1}, 3, 3],
  \end{align*}
  from which, together with the proof of \Cref{lmm:40} and \Cref{lmm:28}, we get:
  \begin{align*}
    p_{>4, 1, 1, 1}(t, q) &= tp_{>4, 3}(t, q) \\
                          &= t(p_{6, 5, 3}(t, q) + p_{8, 7, 5, 3}(t, q) + p_{>8, 7, 5, 3}(t, q) + p_{>7, 5, 3}(t, q) + p_{>5, 3}(t, q)) \\
                          &= tf_{7, 4, 3, 2}(t, q) \\
                          &= f_{7, 4, 3, 3}(t, q), \\
    p_{4, 1, 1, 1}(t, q) &= tqp_{3, 3}(t, q) = f_{10, 5, 7, 5}(t, q).
  \end{align*}
  The formula for $p_{>3, 1, 1, 1}(t, q)$ then follows from \Cref{lmm:28}.
\end{proof}

\begin{lemma}
  \label{lmm:44}
  The formal power series $p(t, q)$ is given by
  \begin{equation*}
    p(t, q) = f_{1, 1, 0, 0}(t, q) + f_{4, 2, 1, 1}(t, q) + f_{7, 3, 3, 3}(t, q).
  \end{equation*}
\end{lemma}

\begin{proof}
  This follows from the disjoint union
  \begin{equation*}
    P = P_{>2} \cup P_{>2, 1} \cup P_{>2, 1, 1} \cup P_{>3, 1, 1, 1}
  \end{equation*}
  together with \Cref{lmm:40}, \Cref{lmm:41}, \Cref{lmm:42}, \Cref{lmm:43} and \Cref{lmm:28}.
\end{proof}

The partitions $[2]$, $[1, 1, 1, 1]$, $[3, 1, 1, 1]$, $[3, 3, 1]$, $[4, 3, 1]$, $[4, 4, 1, 1]$, $[5, 4, 1, 1, 1]$, $[5, 5, 1, 1, 1]$, $[6, 5, 3, 1, 1]$, $[6, 6, 3, 1, 1]$, $[7, 6, 4, 1, 1, 1]$ and $[8, 7, 5, 3, 1, 1]$ are pivots of the matrices $A^W_2$, $A^W_4$, $A^W_6$, $A^W_7$, $A^W_8$, $A^W_{10}$, $A^W_{12}$, $A^W_{13}$, $A^W_{16}$, $A^W_{17}$, $A^W_{20}$ and $A^W_{25}$ respectively, see \cite[ising-modules-1-16.ipynb]{sagemath2}.

\bibliographystyle{alpha}
\bibliography{ising-modules.bib}

\end{document}